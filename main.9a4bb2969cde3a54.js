"use strict";(self.webpackChunklime_home=self.webpackChunklime_home||[]).push([[179],{587:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__}),module=__webpack_require__.hmd(module),function(){var p,aa=[];function ca(e){return function(){return aa[e].apply(this,arguments)}}function da(e,o){return aa[e]=o}function ea(e){var o=0;return function(){return o<e.length?{done:!1,value:e[o++]}:{done:!0}}}function fa(e){var o=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return o?o.call(e):{next:ea(e)}}function ha(e){for(var o,f=[];!(o=e.next()).done;)f.push(o.value);return f}var ia="function"==typeof Object.defineProperties?Object.defineProperty:function(e,o,f){e!=Array.prototype&&e!=Object.prototype&&(e[o]=f.value)},ja=typeof window<"u"&&window===this?this:typeof global<"u"&&null!=global?global:this;function la(e,o){if(o){var f=ja;e=e.split(".");for(var m=0;m<e.length-1;m++){var w=e[m];w in f||(f[w]={}),f=f[w]}(o=o(m=f[e=e[e.length-1]]))!=m&&null!=o&&ia(f,e,{configurable:!0,writable:!0,value:o})}}function ma(){ma=function(){},ja.Symbol||(ja.Symbol=na)}function oa(e,o){this.a=e,ia(this,"description",{configurable:!0,writable:!0,value:o})}la("Array.prototype.find",function(e){return e||function(o,f){t:{var m=this;m instanceof String&&(m=String(m));for(var w=m.length,k=0;k<w;k++){var Y=m[k];if(o.call(f,Y,k,m)){o=Y;break t}}o=void 0}return o}}),oa.prototype.toString=function(){return this.a};var na=(o=0,function e(f){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new oa("jscomp_symbol_"+(f||"")+"_"+o++,f)}),o,sa;function pa(){ma();var e=ja.Symbol.iterator;e||(e=ja.Symbol.iterator=ja.Symbol("Symbol.iterator")),"function"!=typeof Array.prototype[e]&&ia(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return qa(ea(this))}}),pa=function(){}}function qa(e){return pa(),(e={next:e})[ja.Symbol.iterator]=function(){return this},e}function ra(e,o){pa(),e instanceof String&&(e+="");var f=0,m={next:function(){if(f<e.length){var w=f++;return{value:o(w,e[w]),done:!1}}return m.next=function(){return{done:!0,value:void 0}},m.next()}};return m[Symbol.iterator]=function(){return m},m}if(la("Array.prototype.keys",function(e){return e||function(){return ra(this,function(o){return o})}}),"function"==typeof Object.setPrototypeOf)sa=Object.setPrototypeOf;else{var ta;t:{var ua={xg:!0},va={};try{va.__proto__=ua,ta=va.xg;break t}catch{}ta=!1}sa=ta?function(e,o){if(e.__proto__=o,e.__proto__!==o)throw new TypeError(e+" is not extensible");return e}:null}var wa=sa;la("Object.setPrototypeOf",function(e){return e||wa}),la("Promise",function(e){function o(Y){this.b=0,this.c=void 0,this.a=[];var _e=this.f();try{Y(_e.resolve,_e.reject)}catch(_o){_e.reject(_o)}}function f(){this.a=null}function m(Y){return Y instanceof o?Y:new o(function(_e){_e(Y)})}if(e)return e;f.prototype.b=function(Y){if(null==this.a){this.a=[];var _e=this;this.c(function(){_e.g()})}this.a.push(Y)};var w=ja.setTimeout;f.prototype.c=function(Y){w(Y,0)},f.prototype.g=function(){for(;this.a&&this.a.length;){var Y=this.a;this.a=[];for(var _e=0;_e<Y.length;++_e){var _o=Y[_e];Y[_e]=null;try{_o()}catch(_u){this.f(_u)}}}this.a=null},f.prototype.f=function(Y){this.c(function(){throw Y})},o.prototype.f=function(){function Y(_u){return function(pd){_o||(_o=!0,_u.call(_e,pd))}}var _e=this,_o=!1;return{resolve:Y(this.R),reject:Y(this.g)}},o.prototype.R=function(Y){if(Y===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(Y instanceof o)this.u(Y);else{t:switch(typeof Y){case"object":var _e=null!=Y;break t;case"function":_e=!0;break t;default:_e=!1}_e?this.s(Y):this.i(Y)}},o.prototype.s=function(Y){var _e=void 0;try{_e=Y.then}catch(_o){return void this.g(_o)}"function"==typeof _e?this.Xa(_e,Y):this.i(Y)},o.prototype.g=function(Y){this.j(2,Y)},o.prototype.i=function(Y){this.j(1,Y)},o.prototype.j=function(Y,_e){if(0!=this.b)throw Error("Cannot settle("+Y+", "+_e+"): Promise already settled in state"+this.b);this.b=Y,this.c=_e,this.m()},o.prototype.m=function(){if(null!=this.a){for(var Y=0;Y<this.a.length;++Y)k.b(this.a[Y]);this.a=null}};var k=new f;return o.prototype.u=function(Y){var _e=this.f();Y.lf(_e.resolve,_e.reject)},o.prototype.Xa=function(Y,_e){var _o=this.f();try{Y.call(_e,_o.resolve,_o.reject)}catch(_u){_o.reject(_u)}},o.prototype.then=function(Y,_e){function _o(sy,gy){return"function"==typeof sy?function(wy){try{_u(sy(wy))}catch(Ey){pd(Ey)}}:gy}var _u,pd,iy=new o(function(sy,gy){_u=sy,pd=gy});return this.lf(_o(Y,_u),_o(_e,pd)),iy},o.prototype.catch=function(Y){return this.then(void 0,Y)},o.prototype.lf=function(Y,_e){function _o(){switch(_u.b){case 1:Y(_u.c);break;case 2:_e(_u.c);break;default:throw Error("Unexpected state: "+_u.b)}}var _u=this;null==this.a?k.b(_o):this.a.push(_o)},o.resolve=m,o.reject=function(Y){return new o(function(_e,_o){_o(Y)})},o.race=function(Y){return new o(function(_e,_o){for(var _u=fa(Y),pd=_u.next();!pd.done;pd=_u.next())m(pd.value).lf(_e,_o)})},o.all=function(Y){var _e=fa(Y),_o=_e.next();return _o.done?m([]):new o(function(_u,pd){function iy(wy){return function(Ey){sy[wy]=Ey,0==--gy&&_u(sy)}}var sy=[],gy=0;do{sy.push(void 0),gy++,m(_o.value).lf(iy(sy.length-1),pd),_o=_e.next()}while(!_o.done)})},o}),la("Object.entries",function(e){return e||function(o){var m,f=[];for(m in o)Object.prototype.hasOwnProperty.call(o,m)&&f.push([m,o[m]]);return f}});var xa="function"==typeof Object.assign?Object.assign:function(e,o){for(var f=1;f<arguments.length;f++){var m=arguments[f];if(m)for(var w in m)Object.prototype.hasOwnProperty.call(m,w)&&(e[w]=m[w])}return e};la("Object.assign",function(e){return e||xa}),la("Math.log2",function(e){return e||function(o){return Math.log(o)/Math.LN2}});var ya=this||self;function za(e,o,f){(e=e.split("."))[0]in(f=f||ya)||typeof f.execScript>"u"||f.execScript("var "+e[0]);for(var m;e.length&&(m=e.shift());)e.length||void 0===o?f=f[m]&&f[m]!==Object.prototype[m]?f[m]:f[m]={}:f[m]=o}function Aa(){}function Ba(e){var o=typeof e;if("object"==o){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return o;var f=Object.prototype.toString.call(e);if("[object Window]"==f)return"object";if("[object Array]"==f||"number"==typeof e.length&&typeof e.splice<"u"&&typeof e.propertyIsEnumerable<"u"&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==f||typeof e.call<"u"&&typeof e.propertyIsEnumerable<"u"&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==o&&typeof e.call>"u")return"object";return o}function Ca(e){var o=Ba(e);return"array"==o||"object"==o&&"number"==typeof e.length}function Da(e){return"function"==Ba(e)}function Ea(e){var o=typeof e;return"object"==o&&null!=e||"function"==o}var Fa="closure_uid_"+(1e9*Math.random()>>>0),Ga=0;function Ha(e,o,f){return e.call.apply(e.bind,arguments)}function Ia(e,o,f){if(!e)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var w=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(w,m),e.apply(o,w)}}return function(){return e.apply(o,arguments)}}function Ka(e,o,f){return(Ka=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ha:Ia).apply(null,arguments)}function La(e,o){var f=Array.prototype.slice.call(arguments,1);return function(){var m=f.slice();return m.push.apply(m,arguments),e.apply(this,m)}}function t(e,o){za(e,o,void 0)}function u(e,o){function f(){}f.prototype=o.prototype,e.l=o.prototype,e.prototype=new f,e.prototype.constructor=e,e.Jo=function(m,w,k){for(var Y=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)Y[_e-2]=arguments[_e];return o.prototype[w].apply(m,Y)}}function Ma(e){if(Error.captureStackTrace)Error.captureStackTrace(this,Ma);else{var o=Error().stack;o&&(this.stack=o)}e&&(this.message=String(e))}function Na(e,o){this.c=e,this.f=o,this.b=0,this.a=null}function Oa(){this.b=this.a=null}u(Ma,Error),Ma.prototype.name="CustomError",Na.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e},Na.prototype.put=function(e){this.f(e),100>this.b&&(this.b++,e.next=this.a,this.a=e)};var Qa=new Na(function(){return new Pa},function(e){e.reset()});function Pa(){this.next=this.b=this.a=null}Oa.prototype.add=function(e,o){var f=Qa.get();f.set(e,o),this.b?this.b.next=f:this.a=f,this.b=f},Oa.prototype.remove=function(){var e=null;return this.a&&(e=this.a,this.a=this.a.next,this.a||(this.b=null),e.next=null),e},Pa.prototype.set=function(e,o){this.a=e,this.b=o,this.next=null},Pa.prototype.reset=function(){this.next=this.b=this.a=null};var Ra=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Sa(e,o){return-1!=e.indexOf(o)}function Ta(e,o){return e<o?-1:e>o?1:0}function Ua(e,o){for(var f in e)if(o.call(void 0,e[f],f,e))return!0;return!1}function Va(e){for(var o in e)return!1;return!0}function Wa(e){var f,o={};for(f in e)o[f]=e[f];return o}var Xa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Za;function Ya(e,o){for(var f,m,w=1;w<arguments.length;w++){for(f in m=arguments[w])e[f]=m[f];for(var k=0;k<Xa.length;k++)f=Xa[k],Object.prototype.hasOwnProperty.call(m,f)&&(e[f]=m[f])}}t:{var $a=ya.navigator;if($a){var ab=$a.userAgent;if(ab){Za=ab;break t}}Za=""}function bb(e){return Sa(Za,e)}var cb=Array.prototype.indexOf?function(e,o){return Array.prototype.indexOf.call(e,o,void 0)}:function(e,o){if("string"==typeof e)return"string"!=typeof o||1!=o.length?-1:e.indexOf(o,0);for(var f=0;f<e.length;f++)if(f in e&&e[f]===o)return f;return-1};function db(e,o){this.b=e===eb&&o||"",this.a=fb}var fb={},eb={},gb=new db(eb,"");function hb(e,o){this.b=e===ib&&o||"",this.a=jb}hb.prototype.lc=function(){return 1};var jb={},ib={};function kb(){this.b="",this.c=lb,this.a=null}function mb(){return nb instanceof kb&&nb.constructor===kb&&nb.c===lb?nb.b:(Ba(nb),"type_error:SafeHtml")}kb.prototype.lc=function(){return this.a};var lb={};function ob(e){var o=new kb;return o.b=e,o.a=0,o}ob("<!DOCTYPE html>");var nb=ob("");function pb(e){var o=new hb(ib,gb instanceof db&&gb.constructor===db&&gb.a===fb?gb.b:"type_error:Const");o instanceof hb&&o.constructor===hb&&o.a===jb?o=o.b:(Ba(o),o="type_error:TrustedResourceUrl"),e.src=o.toString()}function qb(e){return qb[" "](e),e}function rb(e,o){var f=sb;return Object.prototype.hasOwnProperty.call(f,e)?f[e]:f[e]=o(e)}ob("<br>"),qb[" "]=Aa;var tb=bb("Opera"),ub=bb("Trident")||bb("MSIE"),vb=bb("Edge"),wb=bb("Gecko")&&!(Sa(Za.toLowerCase(),"webkit")&&!bb("Edge"))&&!(bb("Trident")||bb("MSIE"))&&!bb("Edge"),xb=Sa(Za.toLowerCase(),"webkit")&&!bb("Edge"),Ab,e;function yb(){var e=ya.document;return e?e.documentMode:void 0}t:{var Bb="",Cb=(e=Za,wb?/rv:([^\);]+)(\)|;)/.exec(e):vb?/Edge\/([\d\.]+)/.exec(e):ub?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):xb?/WebKit\/(\S+)/.exec(e):tb?/(?:Version)[ \/]?(\S+)/.exec(e):void 0);if(Cb&&(Bb=Cb?Cb[1]:""),ub){var Db=yb();if(null!=Db&&Db>parseFloat(Bb)){Ab=String(Db);break t}}Ab=Bb}var sb={},Fb,Ib,Lb;function Eb(e){return rb(e,function(){for(var o=0,f=Ra(String(Ab)).split("."),m=Ra(String(e)).split("."),w=Math.max(f.length,m.length),k=0;0==o&&k<w;k++){var Y=f[k]||"",_e=m[k]||"";do{if(Y=/(\d*)(\D*)(.*)/.exec(Y)||["","","",""],_e=/(\d*)(\D*)(.*)/.exec(_e)||["","","",""],0==Y[0].length&&0==_e[0].length)break;o=Ta(o=0==Y[1].length?0:parseInt(Y[1],10),0==_e[1].length?0:parseInt(_e[1],10))||Ta(0==Y[2].length,0==_e[2].length)||Ta(Y[2],_e[2]),Y=Y[3],_e=_e[3]}while(0==o)}return 0<=o})}function Gb(e){var o=document;return e=String(e),"application/xhtml+xml"===o.contentType&&(e=e.toLowerCase()),o.createElement(e)}function Hb(e){ya.setTimeout(function(){throw e},0)}function Jb(){var e=ya.MessageChannel;if(typeof e>"u"&&typeof window<"u"&&window.postMessage&&window.addEventListener&&!bb("Presto")&&(e=function(){var w=Gb("IFRAME");w.style.display="none",pb(w),document.documentElement.appendChild(w);var k=w.contentWindow;(w=k.document).open(),w.write(mb()),w.close();var Y="callImmediate"+Math.random(),_e="file:"==k.location.protocol?"*":k.location.protocol+"//"+k.location.host;w=Ka(function(_o){("*"==_e||_o.origin==_e)&&_o.data==Y&&this.port1.onmessage()},this),k.addEventListener("message",w,!1),this.port1={},this.port2={postMessage:function(){k.postMessage(Y,_e)}}}),typeof e<"u"&&!bb("Trident")&&!bb("MSIE")){var o=new e,f={},m=f;return o.port1.onmessage=function(){if(void 0!==f.next){var w=(f=f.next).Si;f.Si=null,w()}},function(w){m.next={Si:w},m=m.next,o.port2.postMessage(0)}}return typeof document<"u"&&"onreadystatechange"in Gb("SCRIPT")?function(w){var k=Gb("SCRIPT");k.onreadystatechange=function(){k.onreadystatechange=null,k.parentNode.removeChild(k),k=null,w(),w=null},document.documentElement.appendChild(k)}:function(w){ya.setTimeout(w,0)}}function Kb(e,o){Lb||Mb(),Nb||(Lb(),Nb=!0),Ob.add(e,o)}function Mb(){if(ya.Promise&&ya.Promise.resolve){var e=ya.Promise.resolve(void 0);Lb=function(){e.then(Pb)}}else Lb=function(){var o=Pb;!Da(ya.setImmediate)||ya.Window&&ya.Window.prototype&&!bb("Edge")&&ya.Window.prototype.setImmediate==ya.setImmediate?(Ib||(Ib=Jb()),Ib(o)):ya.setImmediate(o)}}Fb=ya.document&&ub?yb():void 0,!wb&&!ub||ub&&9<=Number(Fb)||wb&&Eb("1.9.1"),ub&&Eb("9");var Nb=!1,Ob=new Oa;function Pb(){for(var e;e=Ob.remove();){try{e.a.call(e.b)}catch(o){Hb(o)}Qa.put(e)}Nb=!1}function Qb(e){if(this.a=Rb,this.j=void 0,this.f=this.b=this.c=null,this.g=this.i=!1,e!=Aa)try{var o=this;e.call(void 0,function(f){Sb(o,Tb,f)},function(f){Sb(o,Ub,f)})}catch(f){Sb(this,Ub,f)}}var Rb=0,Tb=2,Ub=3;function Vb(){this.next=this.c=this.b=this.f=this.a=null,this.g=!1}Vb.prototype.reset=function(){this.c=this.b=this.f=this.a=null,this.g=!1};var Wb=new Na(function(){return new Vb},function(e){e.reset()});function Yb(e,o,f){var m=Wb.get();return m.f=e,m.b=o,m.c=f,m}function Zb(e){if(e instanceof Qb)return e;var o=new Qb(Aa);return Sb(o,Tb,e),o}function $b(e){return new Qb(function(o,f){f(e)})}function ac(){var e,o;return new bc(new Qb(function(m,w){e=m,o=w}),e,o)}function ec(e,o){if(e.a==Rb)if(e.c){var f=e.c;if(f.b){for(var m=0,w=null,k=null,Y=f.b;Y&&(Y.g||(m++,Y.a==e&&(w=Y),!(w&&1<m)));Y=Y.next)w||(k=Y);w&&(f.a==Rb&&1==m?ec(f,o):(k?((m=k).next==f.f&&(f.f=m),m.next=m.next.next):fc(f),gc(f,w,Ub,o)))}e.c=null}else Sb(e,Ub,o)}function hc(e,o){e.b||e.a!=Tb&&e.a!=Ub||ic(e),e.f?e.f.next=o:e.b=o,e.f=o}function cc(e,o,f,m){var w=Yb(null,null,null);return w.a=new Qb(function(k,Y){w.f=o?function(_e){try{var _o=o.call(m,_e);k(_o)}catch(_u){Y(_u)}}:k,w.b=f?function(_e){try{var _o=f.call(m,_e);void 0===_o&&_e instanceof dc?Y(_e):k(_o)}catch(_u){Y(_u)}}:Y}),w.a.c=e,hc(e,w),w.a}function Sb(e,o,f){if(e.a==Rb){e===f&&(o=Ub,f=new TypeError("Promise cannot resolve to itself")),e.a=1;t:{var m=f,w=e.s,k=e.R;if(m instanceof Qb){hc(m,Yb(w||Aa,k||null,e));var Y=!0}else{if(m)try{var _e=!!m.$goog_Thenable}catch{_e=!1}else _e=!1;if(_e)m.then(w,k,e),Y=!0;else{if(Ea(m))try{var _o=m.then;if(Da(_o)){jc(m,_o,w,k,e),Y=!0;break t}}catch(_u){k.call(e,_u),Y=!0;break t}Y=!1}}}Y||(e.j=f,e.a=o,e.c=null,ic(e),o!=Ub||f instanceof dc||kc(e,f))}}function jc(e,o,f,m,w){function k(_o){_e||(_e=!0,m.call(w,_o))}var _e=!1;try{o.call(e,function Y(_o){_e||(_e=!0,f.call(w,_o))},k)}catch(_o){k(_o)}}function ic(e){e.i||(e.i=!0,Kb(e.m,e))}function fc(e){var o=null;return e.b&&(e.b=(o=e.b).next,o.next=null),e.b||(e.f=null),o}function gc(e,o,f,m){if(f==Ub&&o.b&&!o.g)for(;e&&e.g;e=e.c)e.g=!1;if(o.a)o.a.c=null,mc(o,f,m);else try{o.g?o.f.call(o.c):mc(o,f,m)}catch(w){nc.call(null,w)}Wb.put(o)}function mc(e,o,f){o==Tb?e.f.call(e.c,f):e.b&&e.b.call(e.c,f)}function kc(e,o){e.g=!0,Kb(function(){e.g&&nc.call(null,o)})}Qb.prototype.then=function(e,o,f){return cc(this,Da(e)?e:null,Da(o)?o:null,f)},Qb.prototype.$goog_Thenable=!0,Qb.prototype.cancel=function(e){if(this.a==Rb){var o=new dc(e);Kb(function(){ec(this,o)},this)}},Qb.prototype.s=function(e){this.a=Rb,Sb(this,Tb,e)},Qb.prototype.R=function(e){this.a=Rb,Sb(this,Ub,e)},Qb.prototype.m=function(){for(var e;e=fc(this);)gc(this,e,this.a,this.j);this.i=!1};var nc=Hb;function dc(e){Ma.call(this,e)}function bc(e,o,f){this.Ak=e,this.resolve=o,this.reject=f}u(dc,Ma),dc.prototype.name="cancel";var x=this;function oc(){return Object.create(y,void 0)}var z=Ka,pc=String,qc=x.Object.freeze||function(e){return e};function rc(e){for(var m,o=Object.keys(e),f=o.length;f--;)Ea(m=e[o[f]])&&rc(m);return qc(e)}function sc(e){var o=Ba(e);if("object"==o||"array"==o){if(Da(e.clone))return e.clone();for(var f in o="array"==o?[]:{},e)e.hasOwnProperty(f)&&(o[f]=sc(e[f]));return o}return e}var B=[].pop(),y=/x/.exec("");function tc(e,o){return pc(e).split(o!==B?o:" ")}var uc="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(e,o,f,m,w){if(!(o=e instanceof o)&&f)throw new D(f,m,vc(w)?w:e);return o}function wc(e,o){if(!0===(C(e,o)&&e.constructor===o))throw new TypeError("Illegal constructor "+xc(o))}function yc(e,o,f,m,w){if(!(o=zc(e)===o)&&f)throw new D(f,m,vc(w)?w:e);return o}function Ac(e,o,f,m){return yc(e,"Array",o,f,m)}function vc(e){return e!==B}function Bc(e){return"string"==typeof e}t("H.lang.isArray",Ac),t("H.lang.isString",Bc);var Cc=parseInt,Dc=parseFloat,E=isNaN;function Ec(e){return e===+e}function Fc(e){return!E(+e)}function zc(e){var o=Object[uc[0]][uc[6]].call(e).match(/^\[object (\w+)\]$/);return o?o[1]:typeof e}t("H.lang.isNumber",Ec),t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(e){return"number"==typeof e&&e%1==0});var Gc=[];function Hc(e){0>Gc.indexOf(e)&&Gc.push(e)}function xc(e,o,f,m){var Y,w="",k=2>arguments.length;return k&&(o={H:x.H},f="",m=Gc.slice()),Ic(o,!0,function(_e,_o){try{if(_o=Jc(_e,Y=_e[_o]),!(Ea(Y)&&Y.window===Y&&Y.self===Y||Ea(Y)&&0<Y.nodeType&&Da(Y.cloneNode))&&Ea(Y)){if(Y===e)return w=f+"."+_o,!0;if(0>m.indexOf(Y)&&(m.push(Y),w=xc(e,Y,f+"."+_o,m)))return!0}}catch{}}),k&&(w=w?w.substr(1).replace("."+uc[0]+".","#"):"~"+(Da(e)?Kc(e)+"()":zc(e))),w}function Jc(e,o){var f=[];return Ic(e,!1,function(m,w){m[w]===o&&f.push(w)}),f.sort(Lc)[0]}function Lc(e,o){return o.length-e.length}Hc(Gc);var Mc=Object[uc[0]][uc[2]];function Ic(e,o,f){var m;if(e){for(w in e)if((!o||Mc.call(e,w))&&f(e,w,!0))return;for(m=uc.length;m--;){var w=uc[m];if((!o||Mc.call(e,w))&&f(e,w,!1))break}}}function Kc(e){return(e=/^\s*function ([^\( ]+)/.exec(e))?e[1]:"anonymous"}function Nc(e,o,f){f[o]="#"+o}var Oc=!!x.__karma__;function Pc(){throw Error("unimplemented method")}function Qc(e,o){"status"in(o=o||{})&&(this.status=+o.status),"statusText"in o&&(this.statusText=o.statusText),this.ok=200<=this.status&&300>this.status,this.f=!1,e?"string"==typeof e?this.c=e:(o=x.ArrayBuffer)&&o.prototype.isPrototypeOf(e)?this.a=e:o&&e.buffer?this.a=e.buffer:x.Blob.prototype.isPrototypeOf(e)&&(this.b=e):this.c=""}function Rc(e){if(e.f)return $b(new TypeError("Already read"));e.f=!0}function Sc(e){var o=new FileReader;return o.readAsText(e),new Qb(function(f,m){o.onload=function(){f(o.result)},o.onerror=function(){m(o.error)}})}function D(e,o,f){var m=arguments.length;if((o=o!==B?+o:o)!==B){var w=(w=/^.*?\(([^\)]+)/.exec((""+e).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?tc(w[1].replace(/\s+/g,""),","):[];w.forEach(Nc),w=w[o]||"#"+o}var k=e?xc(e):"";return m=2<m?pc(f):"",(w||m)&&(k+=" (Argument "+(w||"")+(m?" "+m:"")+")"),m=Error(k),Object.setPrototypeOf(m,D.prototype),m}function Tc(e,o,f){var w,k,Y,_e=f&&f.headers||{},_o={},_u=this;if(!Da(o))throw new D(Tc,1,"function required");Ya(_e,Wc.headers,_e),Ya(_o,Wc,f||{}),_o.headers=_e,this.c=o,this.a=w=new XMLHttpRequest,o=_o.method;try{for(k in w.open(o,e,!0),_e)_e.hasOwnProperty(k)&&(Y=_e[k])&&w.setRequestHeader(k,Y);w.withCredentials=!!_o.withCredentials,function m(){var pd=z(_u.b,_u),iy=+_o.timeout||0;Uc?(Vc(_u,"timeout",pd),w.timeout=iy):iy&&(_u.f=setTimeout(function(){w.abort(),_u.b({type:"timeout"})},iy)),Vc(_u,"error",pd),Vc(_u,"load",pd),w.send(_o.data)}()}catch{this.b({type:"cors"})}}t("H.net.Response",Qc),Qc.prototype.type="default",Qc.prototype.type=Qc.prototype.type,Qc.prototype.status=200,Qc.prototype.status=Qc.prototype.status,Qc.prototype.statusText="OK",Qc.prototype.statusText=Qc.prototype.statusText,Qc.error=function(){return Qc.a||(Qc.a=new Qc(null,{status:0,statusText:""}),Qc.a.type="error"),Qc.a},Qc.error=Qc.error,Qc.prototype.text=function(){var e=Rc(this);if(!e)if(this.c)e=Zb(this.c);else if(this.a){var m,o=(e=new Uint8Array(this.a)).length,f=Array(o);for(m=0;m<o;m++)f[m]=String.fromCharCode(e[m]);e=Zb(f.join(""))}else e=this.b?Sc(this.b):$b("Unsupported response body");return e},Qc.prototype.json=function(){return this.text().then(x.JSON.parse)},Qc.prototype.blob=function(){var e,o=Rc(this);return o||(this.b?e=this.b:this.a&&(e=new Blob([this.a],{type:"application/octet-stream"}))),o||Zb(e)},Qc.prototype.arrayBuffer=function(){return this.a?Rc(this)||Zb(this.a.slice(0)):this.blob().then(Qc.b)},Qc.b=function(e){var o=new FileReader;return o.readAsArrayBuffer(e),new Qb(function(f,m){o.onload=function(){f(o.result)},o.onerror=function(){m(o.error)}})},!Oc&&x.Response&&x.Response.error&&(Qc=x.Response,Hc(Qc.prototype)),u(D,Error),t("H.lang.InvalidArgumentError",D),D.prototype.name="InvalidArgumentError",t("H.net.Xhr",Tc);var Wc={method:"GET",headers:{},data:null},Xc="withCredentials"in new XMLHttpRequest,Uc="timeout"in new XMLHttpRequest,$c,ad,bd,ed,fd;function Vc(e,o,f){Xc?e.a.addEventListener(o,f):e.a["on"+o]=f}function Yc(e,o,f){Xc?e.a.removeEventListener(o,f):e.a["on"+o]=null}function Zc(e,o){var f=[];return e&&f.push(xc(e)),1<arguments.length&&f.push(""+o),f=Error(f.join(" ")),Object.setPrototypeOf(f,Zc.prototype),f}function cd(){if(this.constructor=this.constructor,!Bc("STATIC_DB"))throw new D(this.constructor,0);if(this.g=dd(),!this.g)throw new Zc(this.constructor,"This browser does not support IndexedDB");this.a=[],this.c=[],this.Ph=z(this.Ph,this)}function ld(e,o,f){if(e.b)e.a?(e.a.push(o),f&&e.c.push(f)):e.f?f&&f(e.f):o(e.b.result);else{e.b=e.g.open("H_STATIC_DB",1),e.b.onupgradeneeded=e.Ph;var m=e.b.onerror=function(){clearTimeout(e.i),e.f=this.error,e.c.forEach(function(w){w(e.f)}),delete e.a,delete e.c};e.i=setTimeout(function(){m.call({error:Error("DbOpenTimeoutError")})},500),e.b.onsuccess=function(){clearTimeout(e.i),e.a?(e.a.forEach(function(w){w(this.result)},this),delete e.a,delete e.c):(delete e.b,delete e.f,e.a=[],e.c=[])},e.a.push(o),f&&e.c.push(f)}}function id(e,o,f){ld(e,function(m){m=m.transaction(["data"],"readwrite"),o(m.objectStore("data"))},f)}function jd(e,o,f){o&&(e.onsuccess=function(){o(this.result)}),f&&(e.onerror=function(){f(this.error)})}function hd(e){var o=Object.prototype.toString.call(e);return"[object Blob]"===o||"[object ArrayBuffer]"===o||Bc(e)||Ea(e)}function md(){return ed||(ed=new cd),ed}function dd(){return x.indexedDB||x.webkitIndexedDB||x.mozIndexedDB||x.msIndexedDB}function nd(){var e="";if(!vc(fd))if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)fd=!1;else{try{var o=dd();e="H_TEST_DB";var f=o&&o.open(e,1)}catch{}fd=!!f&&null===f.onupgradeneeded,f&&o.deleteDatabase&&o.deleteDatabase(e)}return fd}function od(){0!=qd&&(rd[this[Fa]||(this[Fa]=++Ga)]=this),this.wd=this.wd,this.Xa=this.Xa}Tc.prototype.abort=function(){this.a&&(this.a.abort(),this.a&&this.b({type:"abort"}))},Tc.prototype.abort=Tc.prototype.abort,Tc.prototype.b=function(e){var f,o=e.type;e=this.a,this.f&&clearTimeout(this.f),"load"===o?e instanceof XMLHttpRequest&&200!==e.status&&(f="network"):f=4===e.readyState&&0===e.status&&"error"==o?"cors":"error"!=o?o:"network",Yc(this,"timeout",o=this.b),Yc(this,"error",o),Yc(this,"load",o),e=0===e.status||f&&"network"!==f?Qc.error():new Qc(e.responseText||null,e),f=this.c,delete this.b,delete this.c,delete this.a,f(e)},u(Zc,Error),t("H.lang.IllegalOperationError",Zc),Zc.prototype.name="IllegalOperationError",p=cd.prototype,p.put=function(e,o,f,m){if(!Bc(e)&&!Ec(e))throw new D(this.put,0);if(!hd(o))throw new D(this.put,1);id(this,function(w){jd(w.put(o,e),f,m)},m)},p.get=function(e,o,f){var m;if(!Bc(e)&&!Ec(e))throw new D(this.get,0);if(!Da(o))throw new D(this.get,1);return id(this,function(w){jd(m=w.get(e),o,f)},f),{cancel:function(){m&&(m.onsuccess=kd)}}},p.remove=function(e,o,f){if(!Bc(e)&&!Ec(e))throw new D(this.remove,0);id(this,function(m){jd(m.delete(e),o,f)},f)},p.clear=function(e,o){id(this,function(f){jd(f.clear(),e,o)},o)},p.Ph=function(){var e=this.b.result;e.objectStoreNames.contains("data")||e.createObjectStore("data")},t("H.util.IndexedDBStorage.getInstance",md),t("H.util.IndexedDBStorage.isSupported",nd);var qd=0,rd={};function sd(e){e&&"function"==typeof e.D&&e.D()}function td(e,o){this.type=e,this.currentTarget=this.target=o,this.c=this.a=!1,this.Ik=!0}function ud(e,o,f){ud.l.constructor.call(this,e,f),this.data=o}function vd(e,o,f){vd.l.constructor.call(this,e,f),this.message=o}od.prototype.wd=!1,od.prototype.D=function(){if(!this.wd&&(this.wd=!0,this.o(),0!=qd)){var e=this[Fa]||(this[Fa]=++Ga);if(0!=qd&&this.Xa&&0<this.Xa.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete rd[e]}},od.prototype.nb=function(e,o){this.wd?void 0!==o?e.call(o):e():(this.Xa||(this.Xa=[]),this.Xa.push(void 0!==o?Ka(e,o):e))},od.prototype.o=function(){if(this.Xa)for(;this.Xa.length;)this.Xa.shift()()},td.prototype.stopPropagation=function(){this.a=!0},td.prototype.preventDefault=function(){this.c=!0,this.Ik=!1},t("H.util.Event",td),td.prototype.stopPropagation=td.prototype.stopPropagation,td.prototype.stopPropagation=td.prototype.stopPropagation,td.prototype.CAPTURING_PHASE=1,td.prototype.CAPTURING_PHASE=td.prototype.CAPTURING_PHASE,td.prototype.AT_TARGET=2,td.prototype.AT_TARGET=td.prototype.AT_TARGET,td.prototype.BUBBLING_PHASE=3,td.prototype.BUBBLING_PHASE=td.prototype.BUBBLING_PHASE,td.prototype.eventPhase=0,td.prototype.eventPhase=td.prototype.eventPhase,u(ud,td),t("H.util.DataEvent",ud),u(vd,td),t("H.util.ErrorEvent",vd);var wd=Math,xd=wd.min,yd=wd.max,zd=wd.round,Ad=wd.floor,Bd=wd.ceil,Cd=wd.abs,Dd=wd.log,Ed=wd.sqrt,Fd=wd.pow,Gd=wd.exp,Hd=wd.sin,Id=wd.asin,Jd=wd.cos,Kd=wd.tan,Ld=wd.atan,Md=wd.atan2,Nd=wd.LN2,Od=wd.PI,Pd=Od/2,Qd=Od/4,Rd=2*Od,Sd=3*Od,Td=Od/180,Ud=180/Od,Vd=1/0,Wd=Fd(-2,53),Xd=Xd||function(e){return Dd(e)/Nd};function Yd(e,o){var f;return 0>(f=e%o)==0>o?f:f+o}function Zd(e,o,f){return o-=f=f||0,(e-=f)-Ad(e/o)*o+f}function $d(e,o,f){return e>f?f:e<o?o:e}function ae(e,o,f,m){return m||(m=0),o<f?e>=o-m&&e<=f+m:e>=f-m&&e<=o+m}function be(e,o,f,m,w,k){return Ed(Fd((e-w)*(m-k)-(o-k)*(f-w),2)/(Fd(f-w,2)+Fd(m-k,2)))}t("H.math.normalize",Zd),t("H.math.clamp",$d);var ce={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function de(e,o,f,m,w,k){var Y=f.length,_e=Y,_o=f[0],_u=0,pd=0,iy=0;m=m/2||0;var sy=k||2;k=sy*(w?0:1)+1;for(var gy=sy-2;1!=_u&&_e>k;){_e-=gy;var wy=f[--_e];sy=f[--_e];var Ey=f[_e?_e-gy-1:(Y+(_e-gy-1))%Y],Py=f[_e?_e-gy-2:(Y+(_e-gy-2))%Y];sy>=e-m&&sy<=e+m&&wy>=o-m&&wy<=o+m||Py>=e-m&&Py<=e+m&&Ey>=o-m&&Ey<=o+m?_u=1:_u||sy!==e?!_u&&ae(e,sy,Py,m)&&((sy<e&&Py>e||sy>e&&Py<e)&&(pd+=(_o=wy+(e-sy)/(Py-sy)*(Ey-wy))>o,iy+=_o<o),_u=ae(o,wy,Ey,m)&&be(e,o,sy,wy,Py,Ey)<=m?2:0):(Py===e&&(wy<o&&Ey>o||wy>o&&Ey<o)||(_o<=e&&Py>e||_o>=e&&Py<e)&&(wy>=o?++pd:++iy),_u=ae(o,wy,Ey,m)&&be(e,o,sy,wy,Py,Ey)<=m?2:0),_o=sy}return!_u&&w&&0!==iy&&pd%2!=0&&(_u=3),_u}function ee(e,o){return de(e.x,e.y,o,0,!0)!==ce.NONE}function fe(e){for(var o=e.length,f=new Float64Array(2*o),m=o&&vc(e[0].x);o--;){var w=e[o],k=o<<1;f[k]=m?w.x:w[0],f[k+1]=m?w.y:w[1]}return f}function ge(){}function he(e,o,f){this.type=e,this.data=o,this.c=ac(),this.resolve=z(this.resolve,this),this.reject=z(this.reject,this),this.priority=ie,f!==B&&(this.priority=f),this.Xg().add(this)}t("H.math.CoverType",ce),t("H.math.isPointInsidePolygon",ee),t("H.math.flatten",fe),t("H.util.ICancelable",ge),ge.prototype.cancel=function(){},ge.prototype.cancel=ge.prototype.cancel;var ie=1,je={Do:0,Go:ie,Bo:2};function ke(e){var o;for(o in this.a={},je)this.a[je[o]]=[];this.Ve=e,this.Ve.addEventListener("allocatable",z(this.b,this))}p=he.prototype,p.then=function(e,o,f){return this.c.Ak.then(e,o,f)},p.resolve=function(e){this.Wd=3,this.c.resolve(e)},p.reject=function(e){this.Wd=5,this.c.reject(e)},p.Wd=0,p.cancel=function(){3>this.Wd&&(this.ke(),this.Xg().remove(this),this.Wd=4)},he.prototype.cancel=he.prototype.cancel,t("H.util.JobManager",ke);var le=Object.keys(je).map(function(e){return je[e]}).sort().reverse();function me(e,o,f){var m=[],w=arguments.length;return e&&m.push(xc(e)),1<w&&(w=2<w&&Ac(f)?" out of ["+f[0]+"..."+f[1]+"]":"",m.push("("+o+w+")")),m=Error(m.join(" ")),Object.setPrototypeOf(m,me.prototype),m}ke.prototype.add=function(e){C(e,he,this.add,0),this.a[e.priority].push(e),this.b()},ke.prototype.contains=function(e){return-1<this.a[e.priority].indexOf(e)},ke.prototype.remove=function(e){var o=e.priority,f=this.a[o].indexOf(e);return-1<f?(this.a[o].splice(f,1),!0):(e.Bi&&this.Ve.rf(e.Bi),!1)},ke.prototype.b=function(){le.forEach(function(e){this.a[e]=this.a[e].filter(function(o){var f;if((f=this.Ve.Cg(o))===y)return!0;var m=z(this.Ve.rf,this.Ve,f,o);o.Bi=f,o.then(m,m),o.Wd=o.gj(f)?1:5},this)},this)},u(me,Error),t("H.lang.OutOfRangeError",me),me.prototype.name="OutOfRangeError";var ne="closure_listenable_"+(1e6*Math.random()|0);function oe(e){return!(!e||!e[ne])}var pe=0;function qe(e,o,f,m,w){this.listener=e,this.proxy=null,this.src=o,this.type=f,this.capture=!!m,this.Ff=w,this.key=++pe,this.Zd=this.kf=!1}function re(e){e.Zd=!0,e.listener=null,e.proxy=null,e.src=null,e.Ff=null}function se(e){this.src=e,this.a={},this.b=0}function ue(e,o){var f=o.type;if(!(f in e.a))return!1;var k,m=e.a[f],w=cb(m,o);return(k=0<=w)&&Array.prototype.splice.call(m,w,1),k&&(re(o),0==e.a[f].length&&(delete e.a[f],e.b--)),k}function ve(e,o){var f=void 0!==o,m=f?o.toString():"";return Ua(e.a,function(w){for(var k=0;k<w.length;++k)if(!f||w[k].type==m)return!0;return!1})}function te(e,o,f,m){for(var w=0;w<e.length;++w){var k=e[w];if(!k.Zd&&k.listener==o&&k.capture==!!f&&k.Ff==m)return w}return-1}se.prototype.add=function(e,o,f,m,w){var k=e.toString();(e=this.a[k])||(e=this.a[k]=[],this.b++);var Y=te(e,o,m,w);return-1<Y?(o=e[Y],f||(o.kf=!1)):((o=new qe(o,this.src,k,!!m,w)).kf=f,e.push(o)),o},se.prototype.remove=function(e,o,f,m){if(!((e=e.toString())in this.a))return!1;var w=this.a[e];return-1<(o=te(w,o,f,m))&&(re(w[o]),Array.prototype.splice.call(w,o,1),0==w.length&&(delete this.a[e],this.b--),!0)},se.prototype.ma=function(e){e=e&&e.toString();var f,o=0;for(f in this.a)if(!e||f==e){for(var m=this.a[f],w=0;w<m.length;w++)++o,re(m[w]);delete this.a[f],this.b--}return o};var we=!ub||9<=Number(Fb),xe=ub&&!Eb("9");!xb||Eb("528"),wb&&Eb("1.9b")||ub&&Eb("8")||tb&&Eb("9.5")||xb&&Eb("528"),wb&&!Eb("8")||ub&&Eb("9");var ye=function(){if(!ya.addEventListener||!Object.defineProperty)return!1;var e=!1,o=Object.defineProperty({},"passive",{get:function(){e=!0}});try{ya.addEventListener("test",Aa,o),ya.removeEventListener("test",Aa,o)}catch{}return e}();function ze(e,o){if(td.call(this,e?e.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.b=null,e){var f=this.type=e.type,m=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.currentTarget=o,o=e.relatedTarget){if(wb){t:{try{qb(o.nodeName);var w=!0;break t}catch{}w=!1}w||(o=null)}}else"mouseover"==f?o=e.fromElement:"mouseout"==f&&(o=e.toElement);this.relatedTarget=o,m?(this.clientX=void 0!==m.clientX?m.clientX:m.pageX,this.clientY=void 0!==m.clientY?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Ae[e.pointerType]||"",this.b=e,e.defaultPrevented&&this.preventDefault()}}u(ze,td);var Ae={2:"touch",3:"pen",4:"mouse"};ze.prototype.stopPropagation=function(){ze.l.stopPropagation.call(this),this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0},ze.prototype.preventDefault=function(){ze.l.preventDefault.call(this);var e=this.b;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,xe)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch{}};var Be="closure_lm_"+(1e6*Math.random()|0),Ce={},De=0;function Ee(e,o,f,m,w){if(m&&m.once)return Fe(e,o,f,m,w);if("array"==Ba(o)){for(var k=0;k<o.length;k++)Ee(e,o[k],f,m,w);return null}return f=Ge(f),oe(e)?e.R.add(String(o),f,!1,Ea(m)?!!m.capture:!!m,w):He(e,o,f,!1,m,w)}function He(e,o,f,m,w,k){if(!o)throw Error("Invalid event type");var Y=Ea(w)?!!w.capture:!!w,_e=Ie(e);if(_e||(e[Be]=_e=new se(e)),(f=_e.add(o,f,m,Y,k)).proxy)return f;if(m=Je(),f.proxy=m,m.src=e,m.listener=f,e.addEventListener)ye||(w=Y),void 0===w&&(w=!1),e.addEventListener(o.toString(),m,w);else if(e.attachEvent)e.attachEvent(Ke(o.toString()),m);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(m)}return De++,f}function Je(){var e=Le,o=we?function(f){return e.call(o.src,o.listener,f)}:function(f){if(!(f=e.call(o.src,o.listener,f)))return f};return o}function Fe(e,o,f,m,w){if("array"==Ba(o)){for(var k=0;k<o.length;k++)Fe(e,o[k],f,m,w);return null}return f=Ge(f),oe(e)?e.R.add(String(o),f,!0,Ea(m)?!!m.capture:!!m,w):He(e,o,f,!0,m,w)}function Me(e,o,f,m,w){if("array"==Ba(o)){for(var k=0;k<o.length;k++)Me(e,o[k],f,m,w);return null}return m=Ea(m)?!!m.capture:!!m,f=Ge(f),oe(e)?e.R.remove(String(o),f,m,w):!!(e&&(e=Ie(e))&&(o=e.a[o.toString()],e=-1,o&&(e=te(o,f,m,w)),f=-1<e?o[e]:null))&&Ne(f)}function Ne(e){if("number"==typeof e||!e||e.Zd)return!1;var o=e.src;if(oe(o))return ue(o.R,e);var f=e.type,m=e.proxy;return o.removeEventListener?o.removeEventListener(f,m,e.capture):o.detachEvent?o.detachEvent(Ke(f),m):o.addListener&&o.removeListener&&o.removeListener(m),De--,(f=Ie(o))?(ue(f,e),0==f.b&&(f.src=null,o[Be]=null)):re(e),!0}function Ke(e){return e in Ce?Ce[e]:Ce[e]="on"+e}function Oe(e,o,f,m){var w=!0;if((e=Ie(e))&&(o=e.a[o.toString()]))for(o=o.concat(),e=0;e<o.length;e++){var k=o[e];k&&k.capture==f&&!k.Zd&&(k=Pe(k,m),w=w&&!1!==k)}return w}function Pe(e,o){var f=e.listener,m=e.Ff||e.src;return e.kf&&Ne(e),f.call(m,o)}function Le(e,o){if(e.Zd)return!0;if(!we){if(!o)t:{o=["window","event"];for(var f=ya,m=0;m<o.length;m++)if(null==(f=f[o[m]])){o=null;break t}o=f}if(o=new ze(m=o,this),f=!0,!(0>m.keyCode||null!=m.returnValue)){t:{var w=!1;if(0==m.keyCode)try{m.keyCode=-1;break t}catch{w=!0}(w||null==m.returnValue)&&(m.returnValue=!0)}for(m=[],w=o.currentTarget;w;w=w.parentNode)m.push(w);for(e=e.type,w=m.length-1;!o.a&&0<=w;w--){o.currentTarget=m[w];var k=Oe(m[w],e,!0,o);f=f&&k}for(w=0;!o.a&&w<m.length;w++)o.currentTarget=m[w],k=Oe(m[w],e,!1,o),f=f&&k}return f}return Pe(e,new ze(o,this))}function Ie(e){return(e=e[Be])instanceof se?e:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ge(e){return Da(e)?e:(e[Qe]||(e[Qe]=function(o){return e.handleEvent(o)}),e[Qe])}function F(){od.call(this),this.R=new se(this),this.nn=this,this.Kg=null}function Re(e){var o=(e=e||{}).callback;this.b=e.label,Da(o)&&(this.callback=o),this.a=!!e.disabled,Re.l.constructor.call(this)}u(F,od),F.prototype[ne]=!0,p=F.prototype,p.Fb=function(){return this.Kg},p.ia=function(e){this.Kg=e},p.addEventListener=function(e,o,f,m){Ee(this,e,o,f,m)},p.removeEventListener=function(e,o,f,m){Me(this,e,o,f,m)},p.dispatchEvent=function(e){var o,f=this.Fb();if(f)for(o=[];f;f=f.Fb())o.push(f);f=this.nn;var m=e.type||e;if("string"==typeof e)e=new td(e,f);else if(e instanceof td)e.target=e.target||f;else{var w=e;Ya(e=new td(m,f),w)}if(w=!0,o)for(var k=o.length-1;!e.a&&0<=k;k--){var Y=e.currentTarget=o[k];w=Y.ed(m,!0,e)&&w}if(e.a||(w=(Y=e.currentTarget=f).ed(m,!0,e)&&w,e.a||(w=Y.ed(m,!1,e)&&w)),o)for(k=0;!e.a&&k<o.length;k++)w=(Y=e.currentTarget=o[k]).ed(m,!1,e)&&w;return w},p.o=function(){F.l.o.call(this),this.R&&this.R.ma(void 0),this.Kg=null},p.ed=function(e,o,f){if(!(e=this.R.a[String(e)]))return!0;e=e.concat();for(var m=!0,w=0;w<e.length;++w){var k=e[w];if(k&&!k.Zd&&k.capture==o){var Y=k.listener,_e=k.Ff||k.src;k.kf&&ue(this.R,k),m=!1!==Y.call(_e,f)&&m}}return m&&0!=f.Ik},t("H.util.EventTarget",F),F.prototype.ia=F.prototype.ia,F.prototype.setParentEventTarget=F.prototype.ia,F.prototype.Fb=F.prototype.Fb,F.prototype.getParentEventTarget=F.prototype.Fb,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.D=F.prototype.D,F.prototype.dispose=F.prototype.D,F.prototype.nb=F.prototype.nb,F.prototype.addOnDisposeCallback=F.prototype.nb,F.prototype.on=F.prototype.ed,F.prototype.ed=function(e,o,f){var m,w,k=!0,Y=f[f.currentTarget===f.target?"AT_TARGET":o?"CAPTURING_PHASE":(m=!0,"BUBBLING_PHASE")];return(!m||"pointerenter"!==(w=f.type)&&"pointerleave"!==w)&&(f.eventPhase=Y,k=F.prototype.on.apply(this,arguments),m&&this.Fb&&null===this.Fb()&&delete f.eventPhase),k},F.prototype.Tk=function(e){for(var o,f=this;f&&(o=f.Fb())&&o!==e;)f=o;o||f.ia(e)},F.prototype.setRootParentEventTarget=F.prototype.Tk,u(Re,F),t("H.util.ContextItem",Re),Re.prototype.Ce=function(){return this.b},Re.prototype.getLabel=Re.prototype.Ce,Re.prototype.Cc=function(e){return this.b!==e&&(this.b=e,this.dispatchEvent("update")),this},Re.prototype.setLabel=Re.prototype.Cc,Re.prototype.Yb=function(){return this.a},Re.prototype.isDisabled=Re.prototype.Yb,Re.prototype.ta=function(e){return e!==this.a&&(this.a=e,this.dispatchEvent("update")),this},Re.prototype.setDisabled=Re.prototype.ta;var Se=new Re;function Te(e){if(x.document){var o=document.createElement("canvas");return o.width=o.height=1,o.getContext("2d",{No:e})}return null}function Ue(){return window.devicePixelRatio||1}Re.SEPARATOR=Se,t("H.util.getPixelRatio",Ue);var Ve=/^rgba\(([^,]+),([^,]+),([^,]+),([^)]+)\)$/;function We(e){var o=Xe[e],f=x.RegExp;return o||(x.Uint8ClampedArray||(x.Uint8ClampedArray=function(m){return m instanceof Number?Array(m):m.map(function(w){return $d(zd(w),0,255)})}),"none"===e?o=new Uint8ClampedArray([0,0,0,0]):(Ze.fillStyle="black",Ze.fillStyle=e,Ve.test(Ze.fillStyle)?o=new Uint8ClampedArray([f.$1,f.$2,f.$3,255*f.$4]):(Ze.clearRect(0,0,1,1),Ze.fillRect(0,0,1,1),o=Ze.getImageData(0,0,1,1).data)),Xe[e]=o),o}function $e(e){return"none"!==e&&0<We(e)[3]}var Xe=oc(),af=!!x.VBArray;function bf(e,o){return e!==B?e:o}function cf(e){return/^<svg/.test(e)?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e):e}function df(e){this.$b=0<+e?wd.round(e):0}t("H.util.eval",function(a){return eval(a)}),t("H.util.provide",function(e){var o=ya.$jscomp;if(o&&"function"==typeof o.Ul&&o.Ul())throw Error("goog.provide cannot be used within a module.");za(e,void 0)}),df.prototype.next=function(e){if(9007199254740992===this.$b)throw new me(e,this.$b,[0,9007199254740991]);return this.$b++};var ef=new df,ff=z(ef.next,ef);function gf(){return!0}function hf(){return!1}function kd(){}var jf=qc([]),kf=qc({});function lf(e){return"CANVAS"===e.tagName?[e]:e.getElementsByTagName("CANVAS")}function mf(e,o,f){var m;if(o=e.ownerDocument===o?e.cloneNode(!0):o.importNode(e,!0),f)for(e=lf(e),m=(f=lf(o)).length;m--;)f[m].getContext("2d").drawImage(e[m],0,0);return o}var Ze=Te(!0),nf=Te(!1);function of(e){var o=e.complete,f=0<e.naturalWidth;if(o&&!f&&af)try{nf.drawImage(e,0,0),f=!0}catch{}return o&&f}var pf=x.BlobBuilder||x.WebKitBlobBuilder||x.MozBlobBuilder;function qf(e,o){if(o=o||"",pf){var f=new pf;f.append(e),e=f.getBlob(o)}else e=new Blob([e],{type:o});return e}var rf=x.navigator;function sf(){var e=sf.a;return e||(sf.a=e=this,Hc(sf.a),F.call(e),tf(this)),e}function tf(e){e.g=10,e.i=6,e.a=oc(),e.b=oc(),e.c=0}function uf(e,o,f,m){if(!vf[e])throw new D(uf,0,"Mime type is not supported");this.f=e,"crossOrigin"in(e=m?Wa(m):{})||(e.crossOrigin="anonymous"),this.a=e,wf.href=o.toString(),he.call(this,wf.protocol+"//"+wf.hostname,o,f)}ad=/Edge\/\d+/.test(rf.appVersion),bd=/(A|a)ndroid/.test(rf.appVersion),u(sf,F),sf.prototype.o=function(){sf.l.o.call(this),tf(this)},sf.prototype.Cg=function(e){var o=this.a[e=e.type]||0;if(this.c<this.g&&o<this.i){var f=++this.f;return this.c++,this.a[e]=o+1,this.b[f+""]=e,f}return y},sf.prototype.rf=function(e){var o=this.b[e];if(!vc(o)||!this.a[o])throw new Zc(this.rf,"Unknown requestId");this.c--,this.a[o]--,this.a[o]||delete this.a[o],delete this.b[e],this.dispatchEvent("allocatable")},sf.prototype.f=-1,u(uf,he),uf.prototype.gj=function(){return this.b=vf[this.f].call(this),!0},uf.prototype.ke=function(){this.b&&(this.b.abort(),delete this.b)};var vf={"application/json":function(){var e=this,o=xf(this.a),f=o.headers;return o.headers=f=f?Wa(f):{},f.Accept="application/json",new Tc(this.data,function(m){200<=m.status&&300>m.status?e.resolve(m.json()):e.reject(m)},o)},"text/plain":function(){var e=this;return new Tc(this.data,function(o){200<=o.status&&300>o.status?e.resolve(o.text()):e.reject(o)},xf(this.a))},image:function(){var e=x.document.createElement("img"),o=this,f=this.data;return e.onload=z(this.resolve,this,e),e.onerror=function(){o.reject(Qc.error())},e.crossOrigin=this.a.crossOrigin,e.src=f,{abort:function(){e.onerror=e.onload=null,af&&of(e)||e.removeAttribute("src")}}}};!function(){try{var e=new XMLHttpRequest;e.open("get","/",!0)}catch{e={}}"response"in e&&(vf.arraybuffer=function(){var k,o=new XMLHttpRequest,f=this,m=this.a,w=m.headers;if(o.open("GET",this.data),yf(o,m),o.responseType="arraybuffer",w)for(k in w)o.setRequestHeader(k,w[k]);return o.onerror=o.ontimeout=function(){f.reject(Qc.error())},o.onload=function(){f.resolve(new Qc(o.response))},o.send(),o})}();var zf=new ke(new sf);uf.prototype.Xg=function(){return zf};var wf=x.document.createElement("a");function xf(e){var o=Wa(e);return delete o.crossOrigin,yf(o,e),o}function yf(e,o){e.withCredentials="use-credentials"===o.crossOrigin}function G(e,o){this.x=+e,this.y=+o}function Af(e){if(!e)throw Error("invalid argument");return e instanceof G?e:new G(e.x,e.y)}function Bf(e){var o=Cf[e];if(!o)if(e in Df)o=Cf[e]=e;else{o=Ef.length;var f="",m=e.charAt(0).toUpperCase()+e.substr(1),w="",k=!1;for((Ff&&(k=(w=Ff+m)in Df));o--&&!k;)k=(w=(f=Ef[o])+m)in Df;if(k&&(Ff=f),!(o=k?w:null))throw Error("Could not find any variant of CSS property ["+e+"]");Cf[e]=o}return o}t("H.math.Point",G),G.prototype.set=G,G.prototype.set=G.prototype.set,G.prototype.clone=function(e){return e?(e.x=this.x,e.y=this.y):e=new G(this.x,this.y),e},G.prototype.clone=G.prototype.clone,G.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},G.prototype.add=G.prototype.add,G.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},G.prototype.sub=G.prototype.sub,G.prototype.scale=function(e,o){return this.x*=e,this.y*=void 0===o?e:o,this},G.prototype.scale=G.prototype.scale,G.prototype.round=function(){return this.x=zd(this.x),this.y=zd(this.y),this},G.prototype.round=G.prototype.round,G.prototype.floor=function(){return this.x=Ad(this.x),this.y=Ad(this.y),this},G.prototype.floor=G.prototype.floor,G.prototype.ceil=function(){return this.x=Bd(this.x),this.y=Bd(this.y),this},G.prototype.ceil=G.prototype.ceil,G.prototype.ga=function(e){return!(!e||this.x!==e.x||this.y!==e.y)},G.prototype.equals=G.prototype.ga,G.prototype.vj=function(e,o){var f=o.x-e.x,m=o.y-e.y,w=e;if(f||m){var k=((this.x-e.x)*f+(this.y-e.y)*m)/(f*f+m*m);w=0>=k?e:1<=k?o:new G(e.x+k*f,e.y+k*m)}return w},G.prototype.getNearest=G.prototype.vj,G.prototype.Ta=function(e){return Ed(Fd(this.x-e.x,2)+Fd(this.y-e.y,2))},G.prototype.distance=G.prototype.Ta,G.fromIPoint=Af,t("H.dom.cssPrefixer.prefix",Bf);var Ef=["O","Ms","ms","Moz","Webkit"],Cf={},Ff="",Df=document.createElement("span").style;function Gf(e,o,f,m){if(!e||!o||!f)throw new D(Gf,B,"Must specify name, version and revision parameter");this.name=e,this.version=o,this.revision=f,m&&Ya(this,m)}t("H.util.BuildInfo",Gf),Gf.prototype.toString=function(){var e,o=[];for(e in this)Bc(this[e])&&o.push(this[e]);return o.join(";")};var Hf={};function If(e,o,f,m){if(!e)throw new D(If,1,"Must specify a name parameter");return Hf[e]||(Hf[e]=new Gf(e,o,f,m))}function Jf(){Jf.l.constructor.call(this),this.a=Kf(this),this.f=oc(),this.c=z(this.c,this),this.a.addEventListener("message",this.c),this.b={}}Gf.get=If,u(Jf,F),Jf.prototype.o=function(){this.a.terminate()},Jf.prototype.g=function(e){var o=e.type,m=e.data,w=Lf++,k=m&&m.uo?m.uo:B,Y=!0;return this.f[o]?(this.b[w]=e,Mf(this,o,w,m&&m.message,k)):(e.reject(new D(this.g,0,"processor_not_found")),Y=!1),Y},Jf.prototype.c=function(e){var o=this.b[(e=e.data).taskId],f=e.taskId,m=e.data,w=this;if(2===e.type)new uf("arraybuffer",m).then(function(k){return k.arrayBuffer()}).then(function(k){w.a.postMessage(["3",f,[k]],[k])},function(){w.a.postMessage(["3",f,[null,"ERROR"]])});else{if(o){switch(e.type){case 1:o.resolve(m);break;case 0:o.reject(m)}delete this.b[f]}this.dispatchEvent(new td(this.A.IDLE))}};var Lf=0,Rf,Uf;function Nf(e,o,f){var w,m=Lf++;return e.b[m]=w=ac(),Mf(e,o,m,f),w.Ak}function Mf(e,o,f,m,w){m===B||Ca(m)||(m=[m]);try{e.a.postMessage([o,f,m],w)}catch(k){(e=e.b[f]).reject(k.message)}}function Kf(a){var b=x.H.__bootstrap__;if(b=Da(b)?(""+b).replace(/^[^{]+{((.|[\r\n])+?)}\s*$/,"$1"):""+b,x.Worker&&x.URL)try{var c=new x.Worker(x.URL.createObjectURL(qf(b,"application/javascript")))}catch{}return c||(a=new Of(a),function(){eval("var self = arguments[0];"+b)}(a),c=new Pf(a)),c}function Pf(e){F.call(this),this.a=e}function Of(e){F.call(this),this.a=e,this.addEventListener=z(this.addEventListener,this),this.removeEventListener=z(this.removeEventListener,this),this.postMessage=z(this.postMessage,this),this.eval=z(eval,this)}function Qf(){var e=Rf;return e||(e=Rf=this,F.call(e),Sf(this)),e}function Sf(e){var f,o=e.b;if(o)for(f=o.length;f--;)o[f].D();e.b=[],Hc(e.b),e.c={},e.f=oc()}function Tf(e,o,f){he.call(this,e,o,f)}function Vf(e,o,f,m,w,k){var Y,_e,_u,pd,_o=e.length;if(_o)for(Y=[];_o--;){var iy=e[_o],sy=iy.length,gy=0;for(_u=1;_u<sy;_u++)if(pd=Wf(iy[_u-1],iy[_u],f,o,m,w)){var Ey=pd[1];gy&&gy.ga(pd[0])?_e.push(Ey):Y.push(_e=pd),gy=Ey,k&&(_u=sy,_o=0)}}else Y=e;return Y}function Wf(e,o,f,m,w,k){var Y=e.x;e=-e.y;var _e=o.x;if(o=-o.y,f=-f,k=-k,Y>_e){if(_e>w||Y<m)return;var _o=Y,_u=e;Y=_e,e=o,_e=_o,o=_u,_o=1}else if(Y>w||_e<m)return;if(e>o){if(o>f||e<k)return;var pd=1;e=-e,o=-o,_u=k,k=-f,f=-_u}else if(e>f||o<k)return;if(Y<m){if((e+=(m-Y)*(o-e)/(_e-Y))>f)return;Y=m}if(e<k){if((Y+=(k-e)*(_e-Y)/(o-e))>w)return;e=k}return _e>w&&(o=e+(w-Y)*(o-e)/(_e-Y),_e=w),o>f&&(_e=Y+(f-e)*(_e-Y)/(o-e),o=f),pd&&(e=-e,o=-o),_o?[new G(_e,-o),new G(Y,-e)]:[new G(Y,-e),new G(_e,-o)]}function Xf(e,o,f){e=Yf(e,!0),o=Yf(o,!1);var m,w,k={},Y=m=1;switch(~~(f||0)){case 1:Y=m=0;break;case 2:m=0,Y=1;break;case 3:m=1,Y=0}f=m;var _e=Y;if(o&&e){for(o.oe=new Zf(o.x,o.y,null,$f(o)),e.oe=new Zf(e.x,e.y,null,$f(e)),Y=o;Y.next;Y=Y.next)if(!Y.Va)for(m=e;m.next;m=m.next)if(!m.Va){var _o=ag(Y.next),_u=ag(m.next);if(w=bg(Y,_o,m,_u,k)){var pd=k.pl,iy=k.xo,sy=k.yo;cg(w=new Zf(iy,sy,null,null,null,null,!0,0,0,w=k.ol),Y,_o),cg(_o=new Zf(iy,sy,null,null,null,null,!0,0,0,pd),m,_u),w.Jh=_o,_o.Jh=w}}for(k=ee(o,dg(e)),f&&(k=!k),Y=o;Y;Y=Y.next)Y.Va&&(Y.lh=k,k=!k);for(k=ee(e,dg(o)),_e&&(k=!k),m=e;m.next;m=m.next)m.Va&&(m.lh=k,k=!k);for(eg(o),eg(e);(e=fg(o))!=o;){for(f=null;!e.pg;e=e.Jh){for(k=e.lh;(f=new Zf(e.x,e.y,f)).artificial=e.Va||e.Qj,e.pg=1,e=k?e.next:e.ac;)if(e.Va){e.pg=1;break}if(!e)break}f.Kh=gy||null;var gy=f}return gy}}function Zf(e,o,f,m,w,k,Y,_e,_o,_u){this.x=e,this.y=o,this.next=f||null,this.ac=m||null,this.Kh=w||null,this.Jh=k||null,this.Va=!!Y,this.lh=!!_e,this.pg=_o||0,this.alpha=_u||0,m&&(m.next=this),f&&(f.ac=this),this.Qj=!1,this.oe=null}function ag(e){for(;e&&e.Va;)e=e.next;return e}function $f(e){if(e)for(;e.next;)e=e.next;return e}function fg(e){var o=e;if(o)do{o=o.next}while(o!=e&&(!o.Va||o.Va&&o.pg));return o}function eg(e){var o=$f(e);o.ac.next=e,e.ac=o.ac}function bg(e,o,f,m,w,k){var Y,_e=o.x-e.x,_o=o.y-e.y,_u=m.x-f.x,pd=m.y-f.y,iy=_e*pd-_o*_u;return!iy||(_u=((f.x-e.x)*pd-(f.y-e.y)*_u)/iy,iy=(_o*(f.x-e.x)-_e*(f.y-e.y))/iy,0>_u||1<_u||0>iy||1<iy)?0:(0===_u?Y=e:1===_u?Y=o:0===iy?Y=f:1===iy&&(Y=m),Y&&!k?(Y.x+=2480549651603763e-20,Y.y+=7321997314118067e-20,Y.oe&&(Y.oe.x=Y.x,Y.oe.y=Y.y),bg(e,o,f,m,w)):(w.xo=e.x+_u*_e,w.yo=e.y+_u*_o,w.ol=_u,w.pl=iy,1))}function dg(e){for(var o=[];e;)o.push(e.x,e.y),e=e.next;return o}function cg(e,o,f){for(o=o.next;o!==f&&o.alpha<=e.alpha;)o=o.next;e.next=o,e.ac=o.ac,e.next.ac=e,e.ac.next=e}function Yf(e,o){for(var f,m=null,w=0,k=e.length;w<k;w++)(f=new Zf(e[w].x,e[w].y,m)).Qj=o,(f.next=m)&&(m.ac=f),m=f;return m}function hg(e,o,f){var m=$d(+e,-90,90);if(o&&E(m))throw new D(o,f,e);return m}function ig(e,o,f){var m=+e;if((-180>m||180<m)&&(m=Yd(m+180,360)-180),o&&E(m))throw new D(o,f,e);return m}function jg(e,o,f){var m;if(e!==B&&E(m=+e)&&o)throw new D(o,f,e);return m}function kg(e,o){return 0>e!=0>o&&180<Cd(o-e)}function lg(){wc(this,lg)}function mg(e,o,f){this.lat=hg(e,mg,0),this.lng=ig(o,mg,1),f!==B&&(this.alt=jg(f,mg,2))}function ng(e,o,f){var m=Ea(e)&&!(E(e.lat=hg(e.lat))||E(e.lng=ig(e.lng))||e.alt!==B&&E(e.alt=jg(e.alt)));if(!m&&o)throw new D(o,f,e);return m}function og(e){if(!e)throw new D(og,0,e);return new mg(e.lat,e.lng,e.alt)}function K(e,o,f,m){pg(this,hg(e,K,0),ig(o,K,1),hg(f,K,2),ig(m,K,3))}function pg(e,o,f,m,w){return e.a=f,e.b=w,o<m&&(f=o,o=m,m=f),e.c=o,e.f=m,e.j=e.g=e.i=null,e}function rg(e,o){return(e=o-e)+(0>e?360:0)}function qg(e,o){return(e+=o/2)-(180<e?360:0)}function sg(e,o,f,m,w,k,Y,_e,_o){f=xd(f,Y),e=yd(e,w);var _u=qg(o,w=rg(o,m)),pd=qg(k,Y=rg(k,_e))-_u;if(180>(pd+=0>pd-1e-6?360:0)-1e-6){_u=o;var iy=_e}else pd=360-pd,_u=k,iy=m;return 360<=(pd=pd+w/2+Y/2)+5e-7?(_u=-180,iy=180):pd-5e-7<w?(_u=o,iy=m):pd-5e-7<Y&&(_u=k,iy=_e),_o?pg(_o,e,_u,f,iy):new K(e,_u,f,iy)}function tg(e,o,f){return f||(ng(e,tg,0),ng(o,tg,1)),new K(e.lat,e.lng,o.lat,o.lng)}function ug(e,o){var f=1,m=e.length,w=null;if(!Ca(e))throw new D(ug,0,e);if(0<m){var k=e[0];for(w=tg(k,k,o);f<m;f++)w.Sc((k=e[f]).lat,k.lng,o,w)}return w}function vg(e,o){var w,f=3,m=e.length;if(!(o||e&&null!=e.length))throw new D(vg,0,e);if(0<m)for(w=new K(e[0],e[1],e[0],e[1]);f<m;f+=3)w.Sc(e[f],e[f+1],o,w);return w}function wg(e,o){var w,f=1,m=e.length;if(o&&(!e||null==e.length))throw new D(wg,0,e);if(0<m)for(w=new K(e[0].c,e[0].a,e[0].f,e[0].b);f<m;f++)w.Zb(e[f],o,w);return w}function xg(e,o,f,m,w,k){wc(this,xg),this.c=e||10,this.b=null,this.f=m||0,this.g=w||0,this.i=o||1,this.j=f||1,this.s=!!k,this.flush()}function yg(e){var o=e.b;if(e.s&&!o){var f=e.head;(f.entries||f[0]||f[1]||f[2]||f[3])&&(o=zg([o=[f],o,o,o],[f[6],f[7],f[4],f[5]]),e.b=o)}return o}function zg(e,o){var f,m,w,k,Y=0;for(f=3;0<=f;f--){var _e=f+4,_o=0<f%3,_u=[],pd=o[f],iy=e[f];for(m=iy.length;m--;){var sy=iy[m];if(w=sy.entries)for(k=w.length;k--;){var gy=w[k].a(f);(_o?gy>pd:gy<pd)&&(pd=gy)}for(k=4;k--;)(w=sy[k])&&(_o?w[_e]>pd:w[_e]<pd)&&_u.push(w)}Y+=_u.length,o[f]=pd,e[f]=_u}return Y&&(o=zg(e,o)),o}function Ag(e,o,f){var m,w;if(e.s&&(m=e.b))for(w=3;0<=w;w--){var k=o.a(w);if(w%3?k>=m[w]:k<=m[w]){if(!f){e.b=null;break}m[w]=k}}}function Cg(e,o){var m,f=e.head;if(o){var w=o;if(w!==f)for(f=w;w=w.parent;)(w.entries||1<w.a)&&(f=w)}else for(;!f.entries&&2>(m=f.a)&&m;)f=w;e.head=f}function Dg(e,o,f,m,w,k,Y,_e,_o){var Py,_u=o.entries,pd=o[7],iy=o[4],sy=o[5],gy=o[6],wy=o[8],Ey=o[9];if(_u){var Jy=_u.length;if(w>iy||m>pd||Y<gy||k<sy)for(;Jy--;)iy=(pd=_u[Jy]).a(3),sy=pd.a(0),gy=pd.a(1),pd.a(2)>=w&&gy>=m&&(sy<Y||_e&&sy==Y)&&(iy<k||_o&&iy==k)&&f.push(pd);else for(;Jy--;)f.push(_u[Jy])}(k>wy||_o&&k==wy)&&(w<Ey&&(Py=o[1])&&Dg(e,Py,f,m,w,k,Y,_e,_o),(Y>Ey||_e&&Y==Ey)&&(Py=o[3])&&Dg(e,Py,f,m,w,k,Y,_e,_o)),m<wy&&(w<Ey&&(Py=o[0])&&Dg(e,Py,f,m,w,k,Y,_e,_o),(Y>Ey||_e&&Y==Ey)&&(Py=o[2])&&Dg(e,Py,f,m,w,k,Y,_e,_o))}Jf.prototype.A={IDLE:"idle",Di:"error"},Jf.prototype.i=function(e,o){var f=this.j||(this.j=new td(this.A.Di));f.data=o,delete this.f[e],this.dispatchEvent(f)},u(Pf,F),Pf.prototype.postMessage=function(e){x.setTimeout(z(this.b,this,e),0)},Pf.prototype.b=function(e){var o=new td("message");o.data=e,this.a.dispatchEvent(o)},Pf.prototype.terminate=function(){this.a.D(),this.D()},u(Of,F),Of.prototype.postMessage=function(e){var o=new td("message");o.data=e,x.setTimeout(z(this.a.c,this.a,o),0)},u(Qf,F),Qf.prototype.o=function(){Qf.l.o.call(this),Sf(this)},Qf.prototype.Cg=function(e){var o;if(!(o=this.f[e=e.type]))throw new Zc(this.Cg,'Unknown type "'+e+'"');var f=this.b,m=f[0];return m||(m=f[0]=new Jf,this.nb(La(sd,m)),Va(this.c)||Nf(m,"0",f=x.Object.keys(this.c))),(f=m).f[e]||(f.f[e]=o,Nf(f,"1",[e,Da(o)?o+"":o]).then(kd,z(f.i,f,e))),m},Qf.prototype.rf=function(){},Qf.prototype.a=function(e,o){var f=this.f,m=f[e];if(m){if(o!==m)throw new Zc(this.a,'Type "'+e+'" is already registered')}else f[e]=o},u(Tf,he),Tf.prototype.Xg=function(){return Uf||(Uf=new ke(new Qf)),Uf},Tf.prototype.ke=function(){},Tf.prototype.gj=function(e){return e.g(this)},t("H.math.clipping.clipStrips",Vf),t("H.math.clipping.clipPolygon",Xf),t("H.geo.isDBC",kg),t("H.geo.AbstractGeometry",lg),lg.prototype.getBoundingBox=lg.prototype.J,lg.prototype.equals=lg.prototype.ga,lg.prototype.mb="",lg.prototype.Ab="",lg.prototype.toString=function(){return this.Yc([this.mb.toUpperCase()," "]).join("")},lg.prototype.toString=lg.prototype.toString,lg.prototype.Dc=function(){return{type:this.Ab,coordinates:this.Xc()}},lg.prototype.toGeoJSON=lg.prototype.Dc,lg.prototype.W=function(){return{type:this.mb,coordinates:this.kc(),boundingBox:this.J().W()}},lg.prototype.forWorkerMessage=lg.prototype.W,u(mg,lg),t("H.geo.Point",mg),mg.prototype.ga=function(e){return this===e||!!e&&this.lat===e.lat&&this.lng===e.lng&&(this.alt||0)===(e.alt||0)},mg.prototype.equals=mg.prototype.ga,mg.prototype.Ta=function(e){if(this===e||this.lat===e.lat&&this.lng===e.lng)e=0;else{var o=this.lat*Td,f=e.lat*Td;e=12742001.58*Id(xd(1,Ed(Fd(Hd((o-f)/2),2)+Jd(o)*Jd(f)*Fd(Hd((this.lng*Td-e.lng*Td)/2),2))))}return e},mg.prototype.distance=mg.prototype.Ta,mg.prototype.qg=function(e,o,f){var m;if(f){if(m=o/6371000.79){o=e*Td;var w=Hd(e=Td*this.lat);f=Hd(m);var k=Jd(m);m=Td*this.lng;var Y=Jd(e);e=Id(Y*Jd(o)*f+w*k),o=(m+(o=Md(Hd(o)*Y*f,k-w*Hd(e)))+Od)%(2*Od)-Od,w=new mg(e*Ud,(540+(o*=Ud))%360-180)}return w||this}return(90+(e=(e%360+360)%360))%180==0?(e=this.lng+o/(6371000.79*Rd*Jd(this.lat*Td))*(270===e?-360:360),new mg(this.lat,(e+540)%360-180)):((o/=6371000.79)&&(f=this.lng*Td,k=(m=(w=this.lat*Td)+o*Jd(e*=Td))-w,Y=Dd(Kd(m/2+Qd)/Kd(w/2+Qd)),Y=E(k/Y)?Jd(w):k/Y,e=o*Hd(e)/Y,Cd(m)>Pd&&(m=0<m?Od-m:-(Od+m)),m=new mg(m*Ud,((f+e+Sd+(Cd(w+k)>Pd?Od:0))%Rd-Od)*Ud)),m||this)},mg.prototype.walk=mg.prototype.qg,mg.prototype.J=function(){return new K(this.lat,this.lng,this.lat,this.lng)},mg.prototype.getBoundingBox=mg.prototype.J,mg.validate=ng,mg.fromIPoint=og,p=mg.prototype,p.mb="Point",p.Yc=function(e){return e.push("(",this.lng," ",this.lat,")"),e},p.Ab="Point",p.Xc=function(){return[this.lng,this.lat,this.alt||0]},p.kc=function(){return[this.lat,this.lng,this.alt||0]},u(K,lg),t("H.geo.Rect",K),K.prototype.mb="Polygon",K.prototype.Yc=function(e){var o=this.c,f=this.a,m=this.f,w=this.b;return e.push("(","(",f," ",o,",",w," ",o,",",w," ",m,",",f," ",m,",",f," ",o,")",")"),e},K.prototype.ga=function(e){var o=this===e;return!o&&C(e,K)&&(o=this.c===e.c&&this.a===e.a&&this.f===e.f&&this.b===e.b),o},K.prototype.equals=K.prototype.ga,K.prototype.clone=function(){return new K(this.c,this.a,this.f,this.b)},K.prototype.clone=K.prototype.clone,K.prototype.Gb=function(){return this.j||(this.j=new mg(this.c,this.a)),this.j},K.prototype.getTopLeft=K.prototype.Gb,K.prototype.Cb=function(){return this.g||(this.g=new mg(this.f,this.b)),this.g},K.prototype.getBottomRight=K.prototype.Cb,K.prototype.Um=function(){return this.c},K.prototype.getTop=K.prototype.Um,K.prototype.Ol=function(){return this.f},K.prototype.getBottom=K.prototype.Ol,K.prototype.qm=function(){return this.a},K.prototype.getLeft=K.prototype.qm,K.prototype.Km=function(){return this.b},K.prototype.getRight=K.prototype.Km,K.prototype.Za=function(){return this.i||(this.i=new mg(this.f+(this.c-this.f)/2,qg(this.a,this.tb()))),this.i},K.prototype.getCenter=K.prototype.Za,K.prototype.tb=function(){return rg(this.a,this.b)},K.prototype.getWidth=K.prototype.tb,K.prototype.Jd=function(){return this.c-this.f},K.prototype.getHeight=K.prototype.Jd,K.prototype.ub=function(){return this.a>this.b},K.prototype.isCDB=K.prototype.ub,K.prototype.If=function(){return!this.tb()&&!this.Jd()},K.prototype.isEmpty=K.prototype.If,K.prototype.J=function(){return new K(this.c,this.a,this.f,this.b)},K.prototype.getBoundingBox=K.prototype.J,K.prototype.nf=function(e,o,f){var m=this.Za();return f||(e=hg(e,this.nf,0),o=ig(o,this.nf,1)),(e=(o=this.Sc(e,o,f)).Za()).lat===m.lat&&e.lng===m.lng&&this.Jd()===o.Jd()&&this.tb()===o.tb()},K.prototype.containsLatLng=K.prototype.nf,K.prototype.bd=function(e,o){return o||ng(e,this.bd,0),this.nf(e.lat,e.lng,o)},K.prototype.containsPoint=K.prototype.bd,K.prototype.Ig=function(e,o){var f=this.Za();if(!o&&!C(e,K))throw new D(this.Ig,0,e);return(e=(o=this.Zb(e,o)).Za()).lat===f.lat&&e.lng===f.lng&&this.Jd()===o.Jd()&&this.tb()===o.tb()},K.prototype.containsRect=K.prototype.Ig,K.prototype.Sc=function(e,o,f,m){if(!f){if(E(e=hg(e)))throw new D(this.Sc,0,e);if(E(o=ig(o)))throw new D(this.Sc,1,o)}return sg(this.c,this.a,this.f,this.b,e,o,e,o,m)},K.prototype.mergeLatLng=K.prototype.Sc,K.prototype.jk=function(e,o,f){return o||ng(e,this.jk,0),this.Sc(e.lat,e.lng,o,f)},K.prototype.mergePoint=K.prototype.jk,K.prototype.Zb=function(e,o,f){if(!o&&!C(e,K))throw new D(this.Zb,0,e);return sg(this.c,this.a,this.f,this.b,e.c,e.a,e.f,e.b,f)},K.prototype.mergeRect=K.prototype.Zb,K.prototype.uc=function(e,o,f,m,w,k){return w||(e=hg(e,this.uc,0),o=ig(o,this.uc,1),f=hg(f,this.uc,2),m=ig(m,this.uc,3)),sg(this.c,this.a,this.f,this.b,e,o,f,m,k)},K.prototype.mergeTopLeftBottomRight=K.prototype.uc,K.prototype.jd=function(e,o){var f=this.a<=this.b,m=e.a<=e.b,w=this.a<e.b,k=e.a<this.b;if(!o&&!C(e,K))throw new D(this.jd,0,e);return this.f<=e.c&&e.f<=this.c&&(!f&&(!m||w||k)||!m&&(w||k)||w&&k)},K.prototype.intersects=K.prototype.jd,K.merge=sg,K.fromPoints=tg,K.coverPoints=ug,K.coverLatLngAlts=vg,K.coverRects=wg,K.prototype.Hk=function(e,o){var f=this.a,m=this.c,w=this.b,k=this.f,Y=this.Za().lng;ng(e,this.Hk,0);var _e=e.lat-k-(m-k)/2,_o=e.lng-Y;return e=-180>(e=f+(0>(_o=180<_o||-180>_o?-(Y+e.lng):_o)?2*_o:0))?360+e:e,w=180<(w+=0<_o?2*_o:0)?w-360:w,90<=(m=0<_e?m+2*_e:m)&&(m=90),-90>=(k=0>_e?k+2*_e:k)&&(k=-90),o?pg(o,m,e,k,w):new K(m,e,k,w)},K.prototype.resizeToCenter=K.prototype.Hk,K.prototype.Ab="Polygon",K.prototype.Xc=function(){return[[this.a,this.c,0],[this.b,this.c,0],[this.b,this.f,0],[this.a,this.f,0],[this.a,this.c,0]]},K.prototype.W=function(){return this.kc()},K.prototype.kc=function(){return[this.c,this.a,this.f,this.b]},xg.prototype.remove=function(e){var o,f,m,w=!1;return e&&(o=e.node)&&o.b===this&&(f=o.entries)&&0<=(m=f.indexOf(e))&&(f.splice(m,1),this.m(o),Ag(this,e,!1),w=!0),w},xg.prototype.flush=function(){var e=new Bg(B,NaN,this.f-this.i,this.g-this.j,this.f+this.i,this.g+this.j);e.b=this,this.head=this.a=e,this.b=null},xg.prototype.Va=function(e,o,f,m,w,k){var Y=[],_e=this.head,_o=this.a;return e<=_e[5]&&o<=_e[6]&&(w?f>=_e[7]:f>_e[7])&&(k?m>=_e[4]:m>_e[4])&&Dg(this,_e,Y,e,o,f,m,k||m>=_o[6],w||f>=_o[5]),Y},xg.prototype.Ec=ca(1);var Eg=0;function Bg(e,o,f,m,w,k){this.c=o,e&&(this.parent=e,this.b=e.b,1&o?(f=e[8],w=e[5]):(f=e[7],w=e[8]),2&o?(m=e[9],k=e[6]):(m=e[4],k=e[9])),this[7]=f,this[5]=w,this[8]=(f+w)/2,this[4]=m,this[6]=k,this[9]=(m+k)/2}function Fg(e,o){return e[o]||(++e.a,e[o]=new Bg(e,o))}function Gg(e,o){(e.entries||(e.entries=[])).push(o),o.node=e}function Hg(e,o,f,m,w){var k=e[5],Y=e[6];return e[7]<=o&&e[4]<=f&&(k>m||k===m&&k===e.b.a[5])&&(Y>w||Y===w&&Y===e.b.a[6])}function Ig(e,o,f,m,w,k){Ig.l.constructor.apply(this,arguments)}function Jg(e,o,f,m,w){if(Hg(e.a,o,f,m,w))return Kg(e,e.a,o,f,m,w,e.c);throw Error("Coordinates out of bounds")}function Kg(e,o,f,m,w,k,Y){var _e=o[8],_o=o[9],_u=0,pd=0;return Y&&(w<_e||(_u=+(f>=_e)))&&(k<_o||(pd=+(m>=_o)))?f=Kg(e,Fg(o,_u|pd<<1),f,m,w,k,Y-1):(Gg(o,f=new Lg(f,m,w,k)),Ag(e,f,!0),Cg(e,o)),f}function Lg(e,o,f,m){this.id=Eg++,this[0]=o,this[1]=f,this[2]=m,this[3]=e}function Mg(e){this.g=new Ig(+e||10,180,90,0,0,!0),this.f=[],this.i=!1,this.a=this.b=this.c=null}function Ng(e,o,f,m,w,k){return k?(k=new Lg(w,-o,f+360,-m),e.f.push(k),e.i=!0,e.a&&e.a.uc(o,f,m,w,!0,e.a)):(k=Jg(e.g,f,-o,w,-m),e.b&&e.b.uc(o,f,m,w,!0,e.b)),++e.uh,e.c=null,k}function Og(e,o,f,m,w,k,Y){var _u,_e=(e=e.f).length,_o=[];if(_e){var pd=f+360;for(_u=w+360;_e--;){var iy=e[_e];(Pg(iy,o,f,m,w,k,Y)||Pg(iy,o,pd,m,_u,k,Y))&&_o.push(iy)}}return _o}function Pg(e,o,f,m,w,k,Y){var _e=e[3],_o=e[0],_u=e[1];return e=e[2],(k?_o<=m:_o<m)&&(Y?_e<=w:_e<w)&&e>=o&&_u>=f}function Qg(e,o){var f,m,w;if(f=o.length){var k=e.length;for(m={};k--;)m[e[k].id]=1;for(;f--;)(w=o[f]).id in m||e.push(w)}}Bg.prototype.a=0,Bg.prototype.removeChild=function(e){var o=e.c;this[o]===e&&(delete this[o],delete e.parent,--this.a)},Bg.prototype.Ec=ca(0),u(Ig,xg),Ig.prototype.m=function(e){for(var o,f,m=this.head;e&&!((o=e.entries)&&o.length||(o&&delete e.entries,e.a||!(f=e.parent)));)f.removeChild(e),m===e&&(m=f),e=f;this.head!==m&&(this.head=m,Cg(this))},Ig.prototype.rc=function(e,o){return Jg(this,e,o,e,o)},Lg.prototype.a=function(e){return this[e]},t("H.geo.QuadTree",Mg),p=Mg.prototype,p.uh=0,p.Mc=function(){return this.uh},p.ub=function(){return this.i},p.J=function(){var e,o;if(!this.c){var m,w,k,f=[];if(!this.b&&(e=yg(this.g))&&(this.b=new K(-e[0],e[3],-e[2],e[1])),(o=this.b)&&f.push(o),!this.a&&(k=(w=this.f).length)){e=90;var Y=360,_e=-90;for(m=0;k--;){var _o=w[k];e=xd(e,_o[0]),Y=xd(Y,_o[3]),_e=yd(_e,_o[2]),m=yd(m,_o[1])}this.a=new K(-e,Y,-_e,m-360)}(o=this.a)&&f.push(o),(o=f[0])&&(f[1]&&(o=o.Zb(f[1],!0)),this.c=o)}return this.c},p.rc=function(e){var o=e.lng;return Ng(this,e=e.lat,o,e,o,!1)},p.Nj=function(e){var o=e.Gb(),f=e.Cb();return(e=e.ub())?Ng(this,o.lat,f.lng,f.lat,o.lng,e):Ng(this,o.lat,o.lng,f.lat,f.lng,e)},Mg.prototype.insertBoundingBox=Mg.prototype.Nj,Mg.prototype.remove=function(e){var o;if(e.node){var f=this.g.remove(e);this.b=null}else(f=0<=(e=(o=this.f).indexOf(e)))&&(o.splice(e,1),this.i=0<o.length,this.a=null);return f&&(--this.uh,this.c=null),f},Mg.prototype.remove=Mg.prototype.remove,Mg.prototype.Hf=function(e,o,f){var m=this.g,w=e.Gb(),k=e.Cb(),Y=-w.lat;w=w.lng;var _e=-k.lat;return k=k.lng,!o&&Y===_e||!f&&w===k?e=[]:e.ub()?(Qg(e=m.Va(-180,Y,k,_e,f,o),m.Va(w,Y,180,_e,!1,o)),Qg(e,Og(this,Y,k,_e,w+360,o,f))):Qg(e=m.Va(w,Y,k,_e,f,o),Og(this,Y,w,_e,k,o,f)),e},Mg.prototype.intersectBoundingBox=Mg.prototype.Hf;var Rg=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Sg=typeof BigInt<"u"?BigInt:Number;function Tg(e){var o=Sg(0),f=Sg(0),m=[];if(e.split("").forEach(function(w){w=Sg(Rg[w.charCodeAt(0)-45]),o|=(w&Sg(31))<<f,(w&Sg(32))===Sg(0)?(m.push(o),o=Sg(0),f=Sg(0)):f+=Sg(5)}),0<f)throw Error("Invalid encoding");return m}function Ug(e){return e&Sg(1)&&(e=~e),+(e>>=Sg(1)).toString()}function Vg(e){var o=void 0===e.precision?5:e.precision,f=void 0===e.cf?0:e.cf,m=void 0===e.df?0:e.df;e=e.Th;var w=Math.pow(10,o),k=Math.pow(10,m);o=Wg(o,f,m);var Y=[],_e=Sg(0),_o=Sg(0),_u=Sg(0);return e.forEach(function(pd){var iy=Sg(Math.round(pd[0]*w));Y.push(Xg(iy-_e)),_e=iy,iy=Sg(Math.round(pd[1]*w)),Y.push(Xg(iy-_o)),_o=iy,f&&(pd=Sg(Math.round(pd[2]*k)),Y.push(Xg(pd-_u)),_u=pd)}),(o instanceof Array?o:ha(fa(o))).concat(Y instanceof Array?Y:ha(fa(Y))).join("")}function Wg(e,o,f){if(0>e||15<e)throw Error("precision out of range. Should be between 0 and 15");if(0>f||15<f)throw Error("thirdDimPrecision out of range. Should be between 0 and 15");if(0>o||7<o||4===o||5===o)throw Error("thirdDim should be between 0, 1, 2, 3, 6 or 7");return e|=f<<7|o<<4,Yg(1)+Yg(e)}function Yg(e){var o="";for(e=Sg(e);31<e;)o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[e&Sg(31)|Sg(32)],e>>=Sg(5);return o+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[e]}function Xg(e){var o=0>(e=Sg(e));return e<<=Sg(1),o&&(e=~e),Yg(e)}function Zg(e){return Vg({Th:e.polyline,precision:e.precision,cf:e.thirdDim,df:e.thirdDimPrecision})}function $g(e){if(1!=+(e=Tg(e))[0].toString())throw Error("Invalid format version");var o=+e[1].toString();o={precision:15&o,cf:o>>4&7,df:o>>7&15};for(var f=Math.pow(10,o.precision),m=Math.pow(10,o.df),w=o.cf,k=0,Y=0,_e=0,_o=[],_u=2;_u<e.length;){var pd=Ug(e[_u])/f;k+=pd,Y+=Ug(e[_u+1])/f,w?(pd=Ug(e[_u+2])/m,_o.push([k,Y,_e+=pd]),_u+=3):(_o.push([k,Y]),_u+=2)}if(_u!==e.length)throw Error("Invalid encoding. Premature ending reached");return{polyline:(e=Object.assign({},o,{Th:_o})).Th,precision:e.precision,thirdDim:e.cf,thirdDimPrecision:e.df}}function L(e){L.l.constructor.call(this),e&&ah(e,L,0),this.X=e||[],this.a=bh(this,0,this.X.length)}function bh(e,o,f){e=e.X;var m=0;for(o=yd(o,0),f=xd(f,e.length),f-=2,o+=1;o<f;)m+=kg(e[o],e[o+=3]);return m}function ch(e,o,f,m,w){var k=e.X.length;o=hg(o,w),f=ig(f,w),e.X.push(hg(o,w),ig(f,w),m===B?0:jg(m,w)),k&&(e.a+=kg(e.X[k-2],f)),delete e.b,delete e.c}function ah(e,o,f){for(var k,m=e.length,w=!(m%3);w&&m;)w=!(E(e[--m]=jg((k=e[m])===B?0:k))||E(e[--m]=ig(e[m]))||E(e[--m]=hg(e[m])));if(!w&&o)throw new D(o,f,e)}function dh(e){var o=new L,f=0,m=e.length;if(m%2)throw new D(dh,0,e);for(;f<m;)ch(o,e[f++],e[f++],0,dh);return o}function eh(e,o){return e.b-o.b}function fh(e,o){var k,f=e.X,m=-2,w=[],Y=e.c;if(!Y){Y=e.c=new Mg;var _e=0,_o=e.X,_u=_o.length;for(k=0;k<_u;k+=3){var pd=_o[k],iy=_o[k+1];if(k){if(gy<iy)var sy=gy,gy=iy;else sy=iy;if(Ey<pd)var wy=pd;else{wy=Ey;var Ey=pd}(sy=Ng(Y,wy,sy,Ey,gy,180<gy-sy)).b=_e++}Ey=pd,gy=iy}}for(_o=(Y=Y.Hf(o).sort(eh)).length,o=0;o<_o;o++){if(_u=3*(_e=(_e=Y[o]).b),_e>m+1){var Py=[f[_u],f[_u+1]];w.push(Py)}m=_e,Py.push(f[_u+3],f[_u+4])}if(e.a){for(f=[],m=w.length,o=0;o<m;o++)if(Y=(Py=w[o]).length){for(_o=[],e=0;e<Y;e+=2)_o.push(_e=Py[e],_u=Py[e+1]),k=Py[e-1],e&&kg(_u,k)&&(f.push(_o),(_o=[]).push(Py[e-2],k+=0>k?360:-360,_e,_u));f.push(_o)}w=f}return w}function gh(e){var o=$g(e);e=o.polyline;var f=o.thirdDim;if(o=2===f||3===f,f=0===f,!e)throw new D(gh,0,"data");if(o||f){f=e.length;for(var m=Array(3*f),w=0,k=0;w<f;w++){var Y=e[w];m[k++]=Y[0],m[k++]=Y[1],m[k++]=o?Y[2]:0}}if(!m)throw new D(gh,0,"only ABSENT, ALTITUDE or ELEVATION are supported as type of the 3rd dimension");return new L(m)}function hh(e){wc(this,hh),hh.l.constructor.call(this),this.ja=ih(this,e,this.constructor,0)}function ih(e,o,f,m){var w,k=[];if(!Ac(o))throw new D(f,m);for(w=0;w<o.length;w++){if(!e.b(o[w]))throw new D(f,m);k.push(e.c(o[w]))}return k}function jh(e){jh.l.constructor.call(this,e)}function kh(){}t("H.util.flexiblePolyline.encode",Zg),t("H.util.flexiblePolyline.decode",$g),u(L,lg),t("H.geo.LineString",L),L.prototype.Xh=function(e,o,f){ch(this,e,o,f,this.Xh)},L.prototype.pushLatLngAlt=L.prototype.Xh,L.prototype.af=function(e,o,f){f&&ah(f,this.af,2),void 0===o&&(o=this.X.length),o&&(this.a-=bh(this,e-3,e+o+3));var m=f?this.X.splice.apply(this.X,[e,o].concat(f)):this.X.splice(e,o);return f&&(this.a+=bh(this,e-3,e+f.length+3)),o&&!f&&(this.a+=bh(this,e-3,e-3)),delete this.b,delete this.c,m},L.prototype.spliceLatLngAlts=L.prototype.af,L.prototype.Oj=function(e,o,f,m){this.af(e,0,[o,f,m])},L.prototype.insertLatLngAlt=L.prototype.Oj,L.prototype.Dk=function(e){this.af(e,3)},L.prototype.removeLatLngAlt=L.prototype.Dk,L.prototype.nd=function(e){ch(this,e.lat,e.lng,e.alt,this.nd)},L.prototype.pushPoint=L.prototype.nd,L.prototype.rc=function(e,o){this.Oj(3*e,o.lat,o.lng,o.alt)},L.prototype.insertPoint=L.prototype.rc,L.prototype.Te=function(e){this.Dk(3*e)},L.prototype.removePoint=L.prototype.Te,L.prototype.te=function(e,o){var f=this.X,m=3*e;e=f[m];var w=f[m+1];return f=f[m+2],o&&(o.lat=e,o.lng=w,o.alt=f),o||new mg(e,w,f)},L.prototype.extractPoint=L.prototype.te,L.prototype.Dl=function(e,o,f){var m=this.X;o=o||0,f=bf(f,m.length/3);for(var w=3*o;o<f;)e(m[w++],m[w++],m[w++],o++)},L.prototype.eachLatLngAlt=L.prototype.Dl,L.isDBC=kg,L.prototype.Wg=function(e){var o=this.a;return e&&(o+=kg((e=this.X)[e.length-2],e[1])),o},L.prototype.getDBCs=L.prototype.Wg,L.prototype.De=function(){return this.X.length/3},L.prototype.getPointCount=L.prototype.De,L.prototype.om=function(){return this.X},L.prototype.getLatLngAltArray=L.prototype.om,L.prototype.b=y,L.prototype.J=function(){var e;if(!(e=this.b)){var m,w,o=(e=this.X).length,f=3,k=y;if(3<=o){var Y=m=e[0],_e=w=e[1];for(k=new K(Y,_e,m,w);f<o;f+=3){if(Y=e[f-3],m=e[f],(_e=e[f-2])>(w=e[f+1])&&180<w-_e||_e<w&&-180>_e-w||w<_e&&180>Cd(w-_e)){var _o=_e;_e=w,w=_o}Y<m&&(_o=Y,Y=m,m=_o),sg(k.c,k.a,k.f,k.b,Y,_e,m,w,k)}}e=this.b=k}return e},L.prototype.getBoundingBox=L.prototype.J,L.prototype.dn=function(){return this.b!==y},L.prototype.hasBoundingBox=L.prototype.dn,L.fromLatLngArray=dh,L.prototype.ga=function(e){var f,o=this===e;if(!o&&(o=C(e,L))){var m=this.X;for(o=(f=m.length)===(e=e.X).length;o&&f--;)o=m[f]==e[f]}return o},L.prototype.equals=L.prototype.ga,p=L.prototype,p.mb="LineString",p.Yc=function(e,o){var w,f=this.X,m=f.length;if(m){for(e.push("("),w=0;w<m;w+=3)w&&e.push(","),e.push(f[w+1]," ",f[w]);o&&(f[0]!==f[m-3]||f[1]!==f[m-2])&&e.push(",",f[1]," ",f[0]),e.push(")")}else e.push("EMPTY");return e},p.Ab="LineString",p.Xc=function(){var m,e=[],o=this.X,f=o.length;for(m=0;m<f;m+=3)e.push([o[m+1],o[m],o[m+2]]);return e},p.kc=function(){var o,e=this.X;if(this.J().ub()){var f=1;for(o=(e=e.slice()).length;f<o;f+=3)0>e[f]&&(e[f]+=360)}return e},p.so=function(e){e=void 0===e?5:e;for(var o=this.X,f=o.length,m=[],w=0;w<f;w+=3)m.push([o[w],o[w+1],o[w+2]]);return Zg({polyline:m,precision:e,thirdDim:2,thirdDimPrecision:e})},L.prototype.toFlexiblePolyline=L.prototype.so,L.fromFlexiblePolyline=gh,u(hh,lg),t("H.geo.MultiGeometry",hh),hh.prototype.splice=function(e,o,f){return e=[e],o!==B&&e.push(o),f&&(o=ih(this,f,this.splice,2),e=e.concat(o)),this.a=y,this.ja.splice.apply(this.ja,e)},hh.prototype.splice=hh.prototype.splice,hh.prototype.bc=function(e){var o=this.ja.length;if(!(0<=e&&e<o))throw new me(this.bc,e,[0,o-1]);return this.a=y,this.ja.splice(e,1)[0]},hh.prototype.removeAt=hh.prototype.bc,hh.prototype.remove=function(e){if(0<=(e=this.ja.indexOf(e))){var o=this.ja.splice(e,1)[0];this.a=y}return o||y},hh.prototype.remove=hh.prototype.remove,hh.prototype.gm=function(){return this.ja},hh.prototype.getGeometries=hh.prototype.gm,hh.prototype.push=function(e){var o=ih(this,[e],this.push,0)[0];this.a&&(this.a=this.a.Zb(e.J())),this.ja.push(o)},hh.prototype.push=hh.prototype.push,hh.prototype.J=function(){var e,o,f;if(!(e=this.a)&&(e=y,this.ja.length))for(e=this.ja[0].J(),f=1;f<this.ja.length;f++)(o=this.ja[f].J())&&(e=e?e.Zb(o):o);return this.a=e},hh.prototype.getBoundingBox=hh.prototype.J,hh.prototype.a=y,hh.prototype.c=function(e){return e},hh.prototype.ga=function(e){var f,o=this===e;if(!o&&(o=C(e,this.constructor))){var m=this.ja;for(o=(f=m.length)===(e=e.ja).length;o&&f--;)o=m[f].ga(e[f])}return o},hh.prototype.equals=hh.prototype.ga,hh.prototype.Yc=function(e){var m,w,o=this.ja,f=o.length,k=!1;if(f){for(e.push("("),m=0;m<f;m++)(w=0<m&&k)&&e.push(","),o[m].Yc(e),"EMPTY"===e[e.length-1]?e.splice(-1-+w,+w+1):k=!0;k?e.push(")"):e.splice(-1,1,"EMPTY")}else e.push("EMPTY");return e},hh.prototype.kc=function(){for(var e=[],o=this.ja,f=o.length;f--;)e[f]=o[f].kc();return e},hh.prototype.W=function(){var e=hh.l.W.call(this);return e.type=this.mb,e},hh.prototype.Xc=function(){for(var e=[],o=this.ja,f=o.length;f--;)e[f]=o[f].Xc();return e},u(jh,hh),t("H.geo.MultiLineString",jh),jh.prototype.b=function(e){return C(e,L)},jh.prototype.mb="Multi"+L.prototype.mb,jh.prototype.Ab="Multi"+L.prototype.Ab,t("H.map.provider.Invalidations",kh),kh.MARK_INITIAL=Wd,kh.prototype.update=function(e,o){o!==lh.NONE&&(this.a=e,o&lh.SPATIAL&&(this.f=e),o&lh.VISUAL&&(this.g=e),o&lh.ADD&&(this.b=e),o&lh.REMOVE&&(this.c=e),o&lh.Z_ORDER&&(this.j=e),o&lh.VOLATILITY&&(this.i=e))},kh.prototype.update=kh.prototype.update,kh.prototype.um=function(){return this.a},kh.prototype.getMark=kh.prototype.um,kh.prototype.a=Wd,kh.prototype.hn=function(e){return this.a>e},kh.prototype.isAny=kh.prototype.hn,kh.prototype.g=Wd,kh.prototype.Td=function(e){return this.g>e},kh.prototype.isVisual=kh.prototype.Td,kh.prototype.f=Wd,kh.prototype.oh=function(e){return this.f>e},kh.prototype.isSpatial=kh.prototype.oh,kh.prototype.b=Wd,kh.prototype.Pj=function(e){return this.b>e},kh.prototype.isAdd=kh.prototype.Pj,kh.prototype.c=Wd,kh.prototype.Jf=function(e){return this.c>e},kh.prototype.isRemove=kh.prototype.Jf,kh.prototype.j=Wd,kh.prototype.ph=function(e){return this.j>e},kh.prototype.isZOrder=kh.prototype.ph,kh.prototype.i=Wd,kh.prototype.mn=function(e){return this.i>e},kh.prototype.isVolatility=kh.prototype.mn;var lh={NONE:0,VISUAL:1,SPATIAL:2,ADD:4,REMOVE:8,Z_ORDER:16,VOLATILITY:32};function mh(e){mh.l.constructor.call(this),void 0!==e&&(this.data=e)}function M(e){if(wc(this,M),M.l.constructor.call(this,e?e.data:B),this.Y=nh.next(),e){var o="min";Ec(e[o])&&(this.s=e[o]),Ec(e[o="max"])&&(this.m=e[o]),(o="visibility")in e&&(this.u=!!e[o]),(o="volatility")in e&&(this.S=!!e[o]),(o="zIndex")in e&&(this.j=+e[o]||0),(o="provider")in e&&!C(e[o],N)&&(this.la=e[o],this.pa(lh.ADD))}}kh.Flag=lh,u(mh,F),t("H.map.Feature",mh),mh.prototype.getData=function(){return this.data},mh.prototype.getData=mh.prototype.getData,mh.prototype.o=function(){mh.l.o.call(this),delete this.data},u(M,mh),t("H.map.Object",M);var nh=new df(1),oh={ANY:31,OVERLAY:1,SPATIAL:2,MARKER:4,DOM_MARKER:8,GROUP:16};function ph(e,o,f){var m,w;if(!f||e[0]|o[0]){var k=e.length,Y=o.length,_e=xd(k,Y),_o=1;for(w=+f+1;_o<_e;_o+=w)if(m=e[_o]-o[_o])return m}return f?0:k-Y}function qh(e,o){return e.Ti(o)}function rh(e,o,f){if(null===o||o===B)return null;if(0<=Object.keys(o).length&&"[object Object]"!==Object.prototype.toString.call(o))throw Error(wh(e,f));try{return JSON.stringify(o),o}catch{throw Error(wh(e,f))}}function wh(e,o){return"Object Remote-Id: "+e.i+" - "+(o?"The value returned by the callback is not a valid JSON object and cannot be set as Feature properties.":"The given object data is not a valid JSON object and cannot be set as Feature properties.")}function O(e){var o;if(e){var f=xh;for(o=C(e,O);f--;){var m=yh[f];if(e.hasOwnProperty(m)){var w=e[m];if(o)this[m]=w;else{if((w=zh[f](w))===Ah)throw new D(O,0,m+": "+e[m]);w!==this[m]&&w!==B&&(this[m]=w)}}}(f=o?e.b:this.lineWidth&&$e(this.strokeColor))||(this.b=f),(f=o?e.Hb:$e(this.fillColor))||(this.Hb=f),(f=o?e.a:"none"!==this.strokeColor&&this.lineWidth)||(this.a=f)}qc(this)}M.Type=oh,M.prototype.$a=function(){return this.Y},M.prototype.getId=M.prototype.$a,M.prototype.pi=function(e){if(!Ec(e)&&!Bc(e))throw new D(this.pi,0,"id must be a number or a string");return this.i=e,this},M.prototype.setRemoteId=M.prototype.pi,M.prototype.Jm=function(){return this.i},M.prototype.getRemoteId=M.prototype.Jm,M.prototype.s=-1/0,M.prototype.m=1/0,M.prototype.sj=function(e){var o=this.m;if(e)for(e=this;e=e.Ca;)o=xd(o,e.m);return o},M.prototype.getMax=M.prototype.sj,M.prototype.uj=function(e){var o=this.s;if(e)for(e=this;e=e.Ca;)o=yd(o,e.s);return o},M.prototype.getMin=M.prototype.uj,M.prototype.u=!0,M.prototype.lb=function(e){return(e=!!e)!==this.u&&(this.u=e,this.invalidate(lh.VISUAL)),this},M.prototype.setVisibility=M.prototype.lb,M.prototype.pc=function(e){for(var f,o=this;(f=o.u)&&e&&(o=o.Ca););return f},M.prototype.getVisibility=M.prototype.pc,M.prototype.S=!1,M.prototype.Ef=function(e){for(var f,o=this;!(f=o.S)&&e&&(o=o.Ca););return f},M.prototype.getVolatility=M.prototype.Ef,M.prototype.Vk=function(e){var o=this.S;return o!==!!e&&(this.S=!o,this.invalidate(lh.VOLATILITY)),this},M.prototype.setVolatility=M.prototype.Vk,M.prototype.j=B,M.prototype.Gj=function(){return this.j},M.prototype.getZIndex=M.prototype.Gj,M.prototype.ce=function(e){return e!==this.j&&(this.Ue(),this.j=e,this.invalidate(lh.Z_ORDER)),this},M.prototype.setZIndex=M.prototype.ce,M.prototype.K=B,M.prototype.Pc=function(){var o,f,e=this.K;if(!e){var m=+((o=this.j)!==B);(e=this.Ca)?(e=e.Pc().slice())[0]|=m:e=[m],e.push(o||0,0>(f=this.ti)?this.Y:f),this.K=e}return e},M.prototype.getZInfo=M.prototype.Pc,M.prototype.Ue=function(){this.K=B},M.compareZInfo=ph,M.compareZOrder=qh,M.prototype.Ti=function(e){return this.da-e.da||ph(this.Pc(),e.Pc(),!1)},M.prototype.compareZOrder=M.prototype.Ti,p=M.prototype,p.previousSibling=y,p.nextSibling=y,p.ti=-1,p.Ca=y,p.ym=function(){return this.Ca},M.prototype.getParentGroup=M.prototype.ym,M.prototype.Wb=function(){for(var o,e=this;o=e.Ca;)e=o;return e},M.prototype.getRootGroup=M.prototype.Wb,M.prototype.contains=function(e){return this===e},M.prototype.contains=M.prototype.contains,M.prototype.ia=function(e){if(this.Ca)throw new Zc(this.ia,"Not allowed for a child of a group");M.l.ia.call(this,e)},M.prototype.setParentEventTarget=M.prototype.ia,M.prototype.draggable=!1,M.prototype.la=y,M.prototype.ka=function(){return this.la},M.prototype.getProvider=M.prototype.ka,M.prototype.be=function(e,o){var m,f=this.la;if(m=f!==e){if(o&&(f&&!C(f,N)||e&&!C(e,N)))throw new Zc(o,"Only LocalObjectProvider allows an object transfers");o=this.type!==oh.GROUP,f&&(this.invalidate(lh.REMOVE),o&&f.Da(this)),(this.la=e)&&(o&&e.aa(this),this.ra=y,this.invalidate(lh.ADD))}return m},M.prototype.ra=y,M.prototype.Eb=function(){return this.ra||(this.ra=new kh)},M.prototype.getInvalidations=M.prototype.Eb,M.prototype.pa=function(e){var f,o=this.ka();return(f=!!o)&&o.invalidateObject(this,e),f},M.prototype.invalidate=M.prototype.pa,M.prototype.o=function(){this.Ca&&this.Ca.Da(this),M.l.o.call(this)},M.prototype.setData=function(e){return this.data=e,this},M.prototype.setData=M.prototype.setData,M.prototype.Dc=function(e){var o;if(e&&!Da(e))throw new D(M.prototype.Dc,0,"opt_callback must be a function");return e=rh(this,e?e(this.data):this.data,!!e),o=this instanceof sh||this instanceof th||this instanceof uh||this instanceof vh?{type:"Feature",properties:e,geometry:this.ca().Dc()}:{type:"FeatureCollection",features:jf},this.i&&(o.id=this.i),o},M.prototype.toGeoJSON=M.prototype.Dc,M.prototype.W=function(){return{id:this.Y,properties:{min:this.uj(),max:this.sj(),zIdx:this.j,sIdx:this.ti,parent:this.Ca?this.Ca.$a():0,visible:this.pc(),volatile:this.Ef()},type:"Feature"}},M.prototype.forWorkerMessage=M.prototype.W,t("H.map.SpatialStyle",O),O.prototype.Hb=!0,O.prototype.b=!0,O.prototype.a=!0;var yh="strokeColor fillColor lineWidth lineCap lineJoin miterLimit lineDash lineDashOffset lineHeadCap lineTailCap".split(" ");O.prototype.strokeColor="rgba(0,85,170,.6)",O.prototype.strokeColor=O.prototype.strokeColor,O.prototype.fillColor="rgba(0,85,170,.4)",O.prototype.fillColor=O.prototype.fillColor,O.prototype.lineWidth=2,O.prototype.lineWidth=O.prototype.lineWidth,O.prototype.lineCap="round",O.prototype.lineCap=O.prototype.lineCap,O.prototype.lineJoin="miter",O.prototype.lineJoin=O.prototype.lineJoin,O.prototype.miterLimit=1,O.prototype.miterLimit=O.prototype.miterLimit,O.prototype.rn=jf,O.prototype.lineDash=O.prototype.rn,O.prototype.lineDashOffset=0,O.prototype.lineDashOffset=O.prototype.lineDashOffset,O.prototype.sn=B,O.prototype.lineHeadCap=O.prototype.sn,O.prototype.tn=B,O.prototype.lineTailCap=O.prototype.tn;var xh=yh.length;O.prototype.ga=function(e){var o=this===e;if(!o&&e){for(o=0;o<xh;o++){var f=yh[o];if(this[f]!==e[f])break}o=o===xh}return o},O.prototype.equals=O.prototype.ga,O.prototype.kj=function(e){if(e){var o={};Ya(o,this,e)}else o=this;return new O(o)},O.prototype.getCopy=O.prototype.kj;var Ah=qc({}),zh=[function(e){return e?pc(e):Ah},function(e){return e?pc(e):Ah},function(e){return 0<=e&&100>=e?+e:Ah},function(e){return"butt"===(e=pc(e))||"square"===e||"round"===e||"arrow-head"===e||"arrow-tail"===e?e:Ah},function(e){return"round"===e||"bevel"===e||"miter"===e?e:Ah},function(e){return 0<e&&100>=e?+e:Ah},function(e){return e&&e.every&&e.every(Fc)?e:Ah},function(e){return E(+e)?Ah:+e},function(e){return vc(e)?zh[3](e):B},function(e){return vc(e)?zh[3](e):B}];O.MAX_LINE_WIDTH=100;var Bh=new O;O.DEFAULT_STYLE=Bh;var Ch="fillColor strokeColor lineWidth lineCap lineJoin miterLimit lineDashOffset lineDash lineTailCap lineHeadCap".split(" ");function Dh(e){var o;if(e){var f=C(e,Dh);for(o in e)if(o in this){var m=e[o];m!==this[o]&&("fillColor"===o||0<(m=+m))&&(this[o]=m)}(e=f?e.Hb:!!($e(this.fillColor)&&this.width&&this.width))||(this.Hb=e)}qc(this)}function Eh(e,o){var f;Eh.l.constructor.call(this,o),o&&this.dc(o.style),e&&(this.g=!0),o&&(f=o.arrows)&&this.Mk(f)}function Fh(e,o){var w,f=!1,m=!1;if(o.length){for(f=0;f<o.length;f++)if(o[f]!==Gh){m=!0;break}o=e.style,f=m?o.b||o.Hb&&e.g||(w=e.c||!1)&&o.a&&w.Hb:o.Hb}return f&&e.pc(!0)}function Hh(e,o){Hh.l.constructor.call(this,e,o)}function Ih(e,o,f,m){var Y,w=[],k=o.length;for(Y=0;Y<k;Y++){var _e=o[Y];_e.length&&w.push(Jh(e,_e,f,m))}return w}function Jh(e,o,f,m){var w,k=[],Y=o.length,_e=0;for(e.ya=0,w=w||0;_e<Y;)k.push(Kh(e,o[_e++],o[_e++],w,m));return f&&k.push(Kh(e,o[0],o[1],w,m)),k}function Kh(e,o,f,m,w){var k=e.ya;return k&&180<Cd(k-f)&&(f+=0>k?-360:360),e.ya=f,w.qh(o,f+m)}function Lh(e,o,f){for(var w,Y,_e,m=o,k=e.length+o;m--;){for(Y=(o=e[m]).length,w=Array(Y);Y--;)w[Y]=new G((_e=o[Y]).x+f,_e.y);e[--k]=w}}function Mh(e,o,f){this.paths=this.a=e,o!==B&&(this.interiorsIndex=this.b=o),f!==B&&(this.outlinesIndex=this.c=f)}O.prototype.W=function(){for(var f,e={},o=Ch.length;o--;)e[f=Ch[o]]=this[f];return e},O.prototype.forWorkerMessage=O.prototype.W,t("H.map.ArrowStyle",Dh),Dh.prototype.Hb=!0,Dh.prototype.fillColor="rgba(255,255,255,.75)",Dh.prototype.width=1.2,Dh.prototype.length=1.6,Dh.prototype.frequency=5,Dh.prototype.jj=function(){return new Dh(this)},Dh.prototype.ga=function(e){var o=this===e;return!o&&e&&(o=e.width===this.width&&e.fillColor===this.fillColor&&e.length===this.length&&e.frequency===this.frequency),o},Dh.prototype.equals=Dh.prototype.ga,u(Eh,M),t("H.map.Spatial",Eh),Eh.prototype.type=oh.SPATIAL,Eh.prototype.da=0,Eh.prototype.style=Bh,Eh.prototype.ea=function(){return this.style},Eh.prototype.getStyle=Eh.prototype.ea,Eh.prototype.dc=function(e){var o=!0;return e?this.style=C(e,O)?e:new O(e):this.style?delete this.style:o=!1,o&&this.invalidate(lh.VISUAL),this},Eh.prototype.setStyle=Eh.prototype.dc,Eh.prototype.Ll=function(){return this.c},Eh.prototype.getArrows=Eh.prototype.Ll,Eh.prototype.Mk=function(e){var o=this.c,f=!1;return!e&&o?(delete this.c,f=!0):!e||o&&o.ga(e)||(this.c=new Dh(e),f=!0),f&&"none"!==this.style.strokeColor&&this.pa(1),this},Eh.prototype.setArrows=Eh.prototype.Mk,Eh.prototype.g=!1,Eh.prototype.jn=function(){return this.g},Eh.prototype.isClosed=Eh.prototype.jn,Eh.prototype.getGeometriesForTile=Eh.prototype.Id,Eh.prototype.Yg=function(){return B},Eh.prototype.getLabels=Eh.prototype.Yg,u(Hh,Eh),t("H.map.GeoShape",Hh),Hh.prototype.getBoundingBox=Hh.prototype.J,Mh.prototype.b=Vd,Mh.prototype.interiorsIndex=Mh.prototype.b,Mh.prototype.c=Vd,Mh.prototype.outlinesIndex=Mh.prototype.c;var Gh=rc(new Mh([])),Nh=qc([]),Qh;function uh(e,o){uh.l.constructor.call(this,!1,o),this.$(e)}function Oh(e,o){if(!C(e,L)||2>e.De())throw new D(o,0)}function Ph(e,o,f,m){var w=fh(o,f.Af());if(w.length&&(w=(e=Ih(e,w,!1,o=f.Cf())).length)){var k=f.Ge();o=o.w,f.x||Lh(e,w,-o),f.x===(1<<f.z)-1&&Lh(e,w,o),(f=Vf(e,k.left,k.top,k.right,k.bottom,!1)).length&&m.push(new Mh(f))}}function Rh(e,o){if(x.URL)return new x.URL(e,o).toString();if(!e||!Sh(e))return e;if(!o||Sh(o))throw new TypeError("Failed to construct 'URL': Invalid base URL");Qh||Hc(Qh=document.createElement("a"));var f=Qh;return f.href=o,"/"!==e[0]?e=f.href.replace(/\/[^\/]*$/,"/")+e:((o=f.origin)||(o=f.protocol+"//"+f.host),e=o+e),e}function Sh(e){var o=!1;return"string"==typeof e&&(o=!(-1<e.search(/^(http|https|data|blob):/)||"//"===e.substr(0,2))),o}function Th(e,o){if(Th.l.constructor.call(this),o&&Sh(o))throw new D(Th,1,"Base URL must be absolute");this.i=Uh.INIT,this.a=null,this.m=o}u(uh,Hh),t("H.map.Polyline",uh),uh.prototype.J=function(){return this.a.J()},uh.prototype.getBoundingBox=uh.prototype.J,uh.prototype.$=function(e){var f,m,o=this.$;if(C(e,jh)){var w=e.ja;if(!(f=w.length))throw new D(o,0);for(m=0;m<f;m++)Oh(w[m],o)}else Oh(e,o);return this.b=!!w,this.a=e,this.pa(lh.SPATIAL),this},uh.prototype.setGeometry=uh.prototype.$,uh.prototype.ca=function(){return this.a},uh.prototype.getGeometry=uh.prototype.ca,uh.prototype.clip=function(e){var o=this.a;return fh(this.b?o.ja[0]:o,e)},uh.prototype.clip=uh.prototype.clip,uh.prototype.Id=function(e){var f,o=this.a,m=[];if(this.b)for(f=(o=o.ja).length;f--;)Ph(this,o[f],e,m);else Ph(this,o,e,m);return m.length?m:B},uh.prototype.getGeometriesForTile=uh.prototype.Id,uh.prototype.W=function(){var e=uh.l.W.call(this),o=e.properties;return e.geometry=this.ca().W(),o.style=this.ea().W(),o.height=0,e},uh.prototype.forWorkerMessage=uh.prototype.W,u(Th,F),t("H.map.render.Style",Th),Th.prototype.load=Th.prototype.load,Th.prototype.getState=function(){return this.i},Th.prototype.getState=Th.prototype.getState,Th.prototype.O=function(e){this.i=e},Th.prototype.setState=Th.prototype.O,Th.prototype.Bb=function(){return this.m},Th.prototype.getBaseUrl=Th.prototype.Bb,Th.prototype.Lc=function(){return sc(this.a)},Th.prototype.getConfig=Th.prototype.Lc,Th.prototype.Sl=function(){return this.a},Th.prototype.getConfigReference=Th.prototype.Sl,Th.prototype.sd=function(e){this.a=e},Th.prototype.setConfig=Th.prototype.sd,Th.prototype.zb=function(e){this.a=null,this.O(Uh.ERROR),ve(this.R,void 0!==Vh?String(Vh):void 0)?this.dispatchEvent(new vd(Vh,e,this)):console.error(e)},Th.prototype.dispatchError=Th.prototype.zb,Th.prototype.o=function(){Th.l.o.call(this),this.a=null};var Vh="error",Wh={$c:"change",Di:Vh},Uh={ERROR:-1,INIT:0,LOADING:1,READY:2};function Xh(e,o){var f,w,k,m=arguments.length;for(f=1;f<m;f++)if((w=arguments[f])&&w!==e&&w!==Y){var Y=w;for(k in w){var _e=w[k];e[k]!==_e&&(Yh(_e)?e[k]=Yh(e[k])?Xh(e[k],_e):sc(_e):void 0!==_e&&(e[k]=sc(_e)))}}return e}Th.State=Uh,t("H.util.webgl.mergeObjects",Xh);var Zh=oc();function $h(e,o,f){var m=f[e];return o&&m in o&&0>uc.indexOf(m)?(o=o[m],++e<f.length?$h(e,o,f):o):Zh}var ai=$h.bind(null,0),bi={polygons:1,lines:1,"pattern-lines":1,points:1,text:1,raster:1,custom_icons:1,overlays:1},ci={data:1,draw:1,enabled:1,filter:1,properties:1},di=Object.keys(ci);function ei(e,o,f,m,w,k){var Y=m[e],_e=f[Y];if(++e<m.length){var _o=o[Y]||{};for(f=di.length;f--;){var _u=di[f];if("draw"!==_u||!k){var pd=_e[_u];pd!==B&&(_o[_u]=sc(pd))}}ei(e,_o,_e,m,w,k)}else w?_o=sc(_e):(_o=_e,delete f[Y]);o[Y]=o[Y]?Xh(o[Y],_o):_o}var fi=ei.bind(null,0);function gi(e,o){e in bi&&(o[e]=1)}function hi(e,o,f){var m,w,k;for(m in e)if(ci[m]){if("draw"===m){var Y=e[m];for(w in Y){var _e=Y[w];(k=_e.style)?(_e.style=o+k,gi(k,f)):(delete Y[w],Y[o+w]=_e,gi(w,f))}}}else hi(e[m],o,f)}function ii(e,o){var m,w,k,Y,f={};if(o+="_",m=(e=Xh({},e)).styles)for(w in m){var _e=m[w];if(delete m[w],m[o+w]=_e,k=_e.mix)for(Bc(k)&&(k=[k]),Y=k.length;Y--;)gi(k[Y],f),k[Y]=o+k[Y];(Y=_e.base)&&(k||(k=_e.mix=[]),k.unshift(o+Y),delete _e.base,gi(Y,f)),gi(w,f)}else m=e.styles={};if(_e=e.layers)for(w in _e)k=_e[w],delete _e[w],(Y=k.data)&&!Y.layer&&(Y.layer=w),_e[o+w]=k,hi(k,o,f);for(w in f)m[o+w]={base:w};return e}function ji(e,o){var k,f=e.sources,m=Object.keys(f)[0],w=Xh(f[m],{uid:o});for(k in f=e.layers,e.sources={},e.sources[o]=w,f)(e=f[k]).data?e.data.source===m&&(e.data.source=o):e.data={source:o}}function ki(e,o){var f,m=e.textures;for(f in e=e.fonts,m){var w=m[f];w.url&&(w.url=Rh(w.url,o))}for(f in e)if(Ac(w=e[f]))for(m=0;m<w.length;m++){var k=w[m];k.url=k.url&&Rh(k.url,o)}else(k=w).url=k.url&&Rh(k.url,o)}function li(e,o){return"function(){return feature."+e+(o||"")+";}"}function mi(e){return li("style."+e,void 0)}function ni(e,o,f,m){return e={base:e,blend:o,blend_order:f},m&&(e.clean_depth=!!m),e}function oi(e){var o={};return o["translucent-"+(e?"extruded-":"")+"polygons"]={color:mi("fillColor"),order:1,interactive:!0,extrude:e},o}function pi(e,o,f,m){return e={data:{source:e,layer:o}},f&&(e.draw=f),m&&(e.filter=m),e}function Yh(e){return Ea(e)&&!Ac(e)}function qi(e,o){if(qi.l.constructor.call(this,e,o),Bc(e))ri.test(e)&&-1===e.indexOf("import:")?(this.c=e,o||(this.j=Sh(this.c)?B:this.c)):this.f=e;else{if(!Ea(e))throw new D(qi,0,"invalid style configuration");this.sd(sc(e))}}function xi(e){var f,o=e.a;if(Ea(o)){var m;if(m=e.g){for(var w in m=!1,o=o&&o.sources)if(o[w].type===e.g){m=!0;break}m=!(!o||m)}m&&(f="invalid source, the only valid type is "+e.g)}else f="invalid style configuration";return f&&e.zb(f),!f}function vi(e){e.dispatchEvent(new td("change",e))}function ti(e){if(e.getState()!==Uh.READY)throw new Zc(e.Je,"style is not ready yet")}function ui(e,o,f,m){var Y,_e,w=[],k=Ac(o)?o:[o];for(void 0===m&&(m=!0),k=k.sort().reverse();Y=k.pop();){o=String(Y).split(".");for(var _o=e.a,_u=o.length;_u--&&!ci[o[_u]];);if(_o&&0>_u&&Yh(_o=ai(_o.layers,o))||(_o=Zh),_o===Zh)throw new D(f,0,'Unresolvable layer ID "'+Y+'"');if(w.push({id:o,ab:_o}),m)for(_e in _o)!ci[_e]&&Yh(_o[_e])&&k.push(Y+"."+_e)}return w}function wi(e,o){var m,f=0;for(m=o.length;f!==m;){var w=o[f++],k=e;if(!(e=k[w]))break}return f===m?{node:e,parent:k,Wf:w}:void 0}u(qi,Th),t("H.map.render.webgl.Style",qi),qi.prototype.load=function(){var e=this,o=this.Bb();this.c?(this.O(Uh.LOADING),new uf("text/plain",this.c).then(function(f){var m={};return si(f,o,!1,(m[o]=!0,m))}).then(function(f){return e.sd(f)},function(f){return e.zb(f.message)}),delete this.c):this.f&&(this.O(Uh.LOADING),si(this.f,o).then(function(f){return e.sd(f)},function(f){return e.zb(f.message)}),delete this.f)},qi.prototype.load=qi.prototype.load,qi.prototype.Rk=function(e,o,f){var m;for(ti(this),e=ui(this,e,this.Rk,f),f=0;f<e.length;f++){var w=e[f].ab.draw;for(m in w){var k=w[m];Yh(k)&&(k.interactive=!!o)}}vi(this)},qi.prototype.setInteractive=qi.prototype.Rk,qi.prototype.setProperty=function(e,o,f){var m,w=e.split("."),k=0,Y=w.length;if(ti(this),!vc(o))throw new D(this.setProperty,1,"value");if(m=wi(this.a,w)){if(!(m.parent instanceof Object)||m.parent instanceof Array){if(!f)throw new D(this.setProperty,0,e+" property is not primitive type");w.pop(),w=wi(this.a,w),m.parent=w.parent[w.Wf]={}}m.parent[m.Wf]=o}else{for(m=this.a;k!==Y-1;)m[w[k]]={},m=m[w[k++]];m[w[k]]=o}xi(this)&&vi(this)},qi.prototype.setProperty=qi.prototype.setProperty,qi.prototype.dh=function(e){return ti(this),(e=wi(this.a,e.split(".")))?sc(e.node):void 0},qi.prototype.getProperty=qi.prototype.dh,qi.prototype.removeProperty=function(e){ti(this),(e=wi(this.a,e.split(".")))&&e.parent&&e.parent.hasOwnProperty(e.Wf)&&(delete e.parent[e.Wf],xi(this)&&vi(this))},qi.prototype.removeProperty=qi.prototype.removeProperty,qi.prototype.se=function(e,o,f){var m;ti(this);var w=this.a,k=w.layers,Y=ui(this,e,this.se,!1);for(e=Y.length,m={};e--;)fi(m,k,Y[e].id,!!o,!!f);for(f={},e=(Y=Object.keys(w)).length;e--;){var _e=Y[e],_o=w[_e];f[_e]=_o===k?m:sc(_o)}return o||vi(this),f},qi.prototype.extractConfig=qi.prototype.se,qi.prototype.Je=function(e){if(ti(this),!Ea(e))throw new D(this.Je,0,"config");this.sd(Xh(this.a,e))},qi.prototype.mergeConfig=qi.prototype.Je,qi.prototype.b=ca(2),qi.prototype.toString=function(){return this.getState()===Uh.READY?x.H.gl.yaml.safeDump(this.a,{lineWidth:120}):""},qi.prototype.o=function(){qi.l.o.call(this),delete this.f,delete this.c};var ri=/^(http[s]?)?.*\.ya?ml/i;function si(e,o,f,m){f=void 0!==f&&f,m=void 0===m?{}:m;try{var w=x.H.gl.yaml.safeLoad(e,{json:!0})}catch(k){return Promise.reject(k)}return w&&(Bc(e=w.import)&&(e=[e]),f&&o&&yi(w,o),delete w.import,Ac(e)&&e.length)?(f=e.reduce(function(k,Y){var _e=o?Rh(Y,o):Y;return m[_e]||(m[_e]=!0,k.push(new uf("text/plain",_e).then(function(_o){return si(_o,_e,!0,m)}))),k},[]),Promise.all(f).then(function(k){var Y={};return k.forEach(function(_e){return _e&&Xh(Y,_e)}),Xh(Y,w),Y})):Promise.resolve(w)}function yi(e,o){function f(Y){Y.url&&(Y.url=Rh(Y.url,o))}var m=e&&e.fonts;if(m)for(var w in m)Ac(m[w])?m[w].forEach(f):f(m[w]);if(e=e&&e.textures)for(var k in e)f(e[k])}function P(e,o){var f;if(P.l.constructor.call(this),C(e,L,P,0),o!==B&&Ac(o,P,1)){for(f=0;f<o.length;f++)C(o[f],L,P,1,"index "+f);this.a=o}else this.a=[];this.b=e,this.c=[]}function zi(e){var o=P,f=L,m=e.c,w=e.a,k=e.f,Y=e.b;return w=[m,w,B,m,Y,B,k,Y,B,k,w,B],180<=e.tb()&&(w.splice(9,0,k,e=e.Za().lng,B),w.splice(3,0,m,e,B)),new o(new f(w))}qi.normalize=yi,qi.prototype.sd=function(e){qi.l.sd.call(this,e),xi(this)&&(this.O(Uh.READY),vi(this))},qi.prototype.Lc=function(){return qi.l.Lc.call(this)},qi.prototype.getConfig=qi.prototype.Lc,qi.prototype.Bb=function(){return this.j||qi.l.Bb.call(this)},qi.prototype.getBaseUrl=qi.prototype.Bb,t("H.map.Style",qi),qi.State=Uh,u(P,lg),t("H.geo.Polygon",P),P.fromRect=zi;var Ai={NORTH:90,SOUTH:-90};function Bi(e,o){var f,m,w;return(w=e.J())&&((f=e.Wg(!0))&&(m=e.De())&&(w=w.Zb(ug([e.te(0),e.te(m-1)],!0),!0)),360===w.tb()&&f%2==1&&(w=w.Sc(o,0))),w}function Ci(e,o,f,m){m=void 0===m||m;var w=e.a,k=Di.bind(null,o,f);return!(de(o,f,e.b.X,0,!0,3)===ce.NONE||m&&w.some(k))}function Di(e,o,f){return de(e,o,f.X,0,!0,3)===ce.SURFACE}function Ei(e,o){var f,m,w=(o=o.X).length-3,k=(e=e.b.X).length-3,Y={};for(f=0;f<w;f+=3){var _e=o[f],_o=o[f+1],_u=o[f+3],pd=o[f+4];for(m=0;m<k;m+=3){var iy=e[m],sy=e[m+1],gy=e[m+3],wy=e[m+4];if(bg(new Zf(_o,_e),new Zf(pd,_u),new Zf(sy,iy),new Zf(wy,gy),Y,!0))return!0}}return!1}function Fi(e,o){var f=o.b,m=o.a,w=m.length,k=f.X,Y=k.length,_e=e.b.X,_o=_e.length;if(Ei(e,f))return!0;for(f=0;f<Y;f+=3)if(Ci(e,k[f],k[f+1]))return!0;for(f=0;f<_o;f+=3)if(Ci(o,_e[f],_e[f+1]))return!0;for(f=0;f<w;f++)if(Ei(e,m[f]))return!0;return!1}function Gi(e){Gi.l.constructor.call(this,e)}function vh(e,o){var f=o&&(+o.extrusion||+o.extrude)||0,m=o&&+o.elevation||0,w=0;if(vh.l.constructor.call(this,!0,o),0<m&&(w+=m,this.b=m),0<f&&(w+=f,this.f=f),2047<w)throw new me(vh,w,[0,2047]);C(e,L)?this.$(new P(e)):this.$(e)}P.Direction=Ai,P.prototype.ld=Ai.NORTH,P.prototype.Sk=function(e){return this.ld!==e&&(this.f=y,this.c.length=0,this.ld=e),this},P.prototype.setPoleCovering=P.prototype.Sk,P.prototype.Bm=function(){return this.ld},P.prototype.getPoleCovering=P.prototype.Bm,P.prototype.bm=function(){return this.b},P.prototype.getExterior=P.prototype.bm,P.prototype.Pk=function(e){if(!C(e,L))throw new D(this.Pk,0,e);this.b=e,this.f=y},P.prototype.setExterior=P.prototype.Pk,P.prototype.lm=function(){return this.a},P.prototype.getInteriors=P.prototype.lm,P.prototype.og=function(e,o,f){var w,m=arguments.length;for(w=2;w<m;w++)C(arguments[w],L,this.og,w);var k=this.a.splice.apply(this.a,arguments);for(w=2;w<m;w++)arguments[w]=B;return this.c.splice.apply(this.c,arguments),k},P.prototype.spliceInteriors=P.prototype.og,P.prototype.Zn=function(e){return this.og(e,1)[0]},P.prototype.removeInteriorAt=P.prototype.Zn,P.prototype.Yn=function(e){return 0>(e=this.a.indexOf(e))?B:this.og(e,1)[0]},P.prototype.removeInterior=P.prototype.Yn,P.prototype.Bk=function(e){if(!C(e,L))throw new D(this.Bk,0,e);this.a.push(e)},P.prototype.pushInterior=P.prototype.Bk,P.prototype.J=function(){var e=this.f;return e||(this.f=e=Bi(this.b,this.ld)),e},P.prototype.getBoundingBox=P.prototype.J,p=P.prototype,p.ij=function(e){var o=this.a.length;if(0>e||e>=o)throw new me(this.ij,e,[0,o-1]);return(o=this.c[e])||(this.c[e]=o=Bi(this.a[e],this.ld)),o},p.mb="Polygon",p.Yc=function(e){var m,o=this.a,f=o.length;if(this.b.De()){for(e.push("("),this.b.Yc(e,!0),m=0;m<f;m++)o[m].De()&&(e.push(","),o[m].Yc(e,!0));e.push(")")}else e.push("EMPTY");return e},p.Ab="Polygon",p.Xc=function(){var e,o=[],f=this.a,m=this.b.Xc();for(m[0].toString()!==m[m.length-1].toString()&&m.push(m[0]),o.push(m),e=0;e<f.length;e++)(m=f[e].Xc())[0].toString()!==m[m.length-1].toString()&&m.push(m[0]),o.push(m);return o},p.W=function(){var e=P.l.W.call(this);return this.J().ub()&&(e.type="Multi"+e.type),e},p.kc=function(){var e=[],o=this.a,f=o.length;for(e.push(this.b.kc());f--;)e[f+1]=o[f].kc();return this.J().ub()?[e]:e},p.ga=function(e){var o=!1;if(C(e,P)){var f=e.a,m=this.a.length;o=f.length;var w=0;for(o=this.b.ga(e.b)&&m===o;o&&w<m;)o=o&&this.a[w].ga(f[w]),w++}return o},P.prototype.equals=P.prototype.ga,u(Gi,hh),t("H.geo.MultiPolygon",Gi),Gi.prototype.b=function(e){return C(e,P)},Gi.prototype.mb="Multi"+P.prototype.mb,Gi.prototype.Ab="Multi"+P.prototype.Ab,u(vh,Hh),t("H.map.Polygon",vh);var Hi=new P(new L([0,0,0,0,0,0,0,0,0]));function Ii(e,o,f,m){var w,k,Y=0,_e=!0;if(w=Ji(e,o.b,f,m,o.J())){var _o=new Mh(w),_u=o.a;if(k=_u.length)for(_o.b=_o.a.length;Y<k;Y++)(w=Ji(e,_u[Y],f,m,o.ij(Y)))&&(_o.a=_o.a.concat(w));for(k=_o.a.length,Y=0;Y<k;Y++)if(_o.a[Y]!==Nh){_e=!1;break}_e&&(_o=Y%2?Gh:B)}return _o}function Ji(e,o,f,m,w){var sy,k=f.Ge(),Y=w,_e=Y.tb(),_o=[[]],_u=o.X,pd=[],iy=_u.length,gy=!1;for(sy=0;sy<iy;sy+=3){var wy=_u[sy],Ey=_u[sy+1];gy||180!=Cd(Ey)||(pd.push(wy),pd.push(Ey),pd.push(wy),pd.push(-Ey),gy=!0),pd.push(wy),pd.push(Ey)}if(_u=pd,360>_e&&-180==Y.a&&(Y=new K(Y.c,180,Y.f,Y.b)),360>_e&&180==Y.b&&(Y=new K(Y.c,Y.a,Y.f,-180)),Y.ub()){for(wy=(_e=_u).length,_u=-1,pd=0;pd<wy-2;pd+=2)if(kg(_e[pd+1],_e[pd+3])){_u=pd+2;break}-1===_u&&kg(_e[wy-1],_e[1])&&(_u=wy),-1!==_u&&(pd=_e[_u-1],sy=_e[_u%wy],gy=_e[(_u+1)%wy],180!==Cd(iy=_e[_u-2])&&180!==Cd(sy)&&(Ey=Cd(sy-iy),wy=Cd(gy-pd),wy+=180<wy?-360:0,gy=Cd(180-gy),gy+=180<gy?-360:0,wy&&gy&&(Ey/=Cd(wy)/Cd(gy),_e.splice(_u,0,iy=sy+(sy>iy?-Ey:Ey),pd=0<pd?180:-180,iy,-pd)))),_u=_e}if(_o[0]=Ki(_u.concat(),Y.a),360>Y.tb()&&Y.bd(new mg(Y.c,180))&&(_u=Ki(_u.concat(),Y.b),_o.push(_u)),e=Ih(e,_o,!0,Y=f.Cf()),360===w.tb()&&o.Wg(!0)%2==1){for(o=e,e=f.Ge(),o[0][1].x>o[0][o[0].length-1].x&&(o[0]=o[0].reverse()),_u=[],_e=o[0].length-1,_o=0;_o<_e;_o++)_u[_o]=new G((pd=o[0][_o]).x-2*Y.w,pd.y),_u[_o+_e]=new G(pd.x-Y.w,pd.y),_u[_o+2*_e]=new G(pd.x,pd.y),_u[_o+3*_e]=new G(pd.x+Y.w,pd.y),_u[_o+4*_e]=new G(pd.x+2*Y.w,pd.y);o[0]=_u,(_o=Y.qh(m,0)).y=2*e[m===Ai.NORTH?"top":"bottom"],m=_o.clone(),_o.x=o[0][o[0].length-1].x+1,m.x=o[0][0].x-1,o[0].push(_o,m),e=o}if(Vf(e,m=k.left,o=k.top,_o=k.right,k=k.bottom,!0).length){if(!f.Af().Ig(w)){for(f=e,w=[new G(m,o),new G(_o,o),new G(_o,k),new G(m,k)],k=[],e=f.length;e--;)if(m=Xf(w,f[e]))for(o=Li(m),k.push(o);m.Kh;)o=Li(m=m.Kh),k.push(o);e=k}}else f=Mi(m,o,e[0]),e[1]&&(f=f!==Mi(m,o,e[1])),e=f?[Nh]:B;return e}function Mi(e,o,f){var m,w,k,Y=m=f[0].x,_e=w=f[0].y,_o=1;for(k=f.length;_o<k;_o++){var _u=f[_o].x,pd=f[_o].y;_u>m?m=_u:_u<Y&&(Y=_u),pd>w?w=pd:pd<_e&&(_e=pd)}return Y<=e&&e<=m&&_e<=o&&o<=w&&ee({x:e,y:o},fe(f.concat(f[0])))}function Li(e){var o=[],f=e;do{var m=zd(100*(f.Qn?f.Qn:f.x))/100,w=zd(100*(f.Rn?f.Rn:f.y))/100;if(!k||.01<Ed(Fd(k.x-m,2)+Fd(k.y-w,2))){var k=new G(m,w);o.push(k)}f=f.next}while(f&&f!==e);return o}function Ki(e,o){var f,m=Number.POSITIVE_INFINITY,w=-1,k=e.length;for(f=0;f<k;f+=2){var Y=Cd(e[f+1]-o);(Y+=180<Y?360-Y:Y)<m&&(m=Y,w=f)}return 0<f?(o=e.splice(w,e.length-w)).concat(e):e}function Oi(e,o,f){Oi.l.constructor.call(this,Hi,f),this.ig(e),this.oi(o),f&&"precision"in f&&this.ni(f.precision)}function Pi(e){e.a!==y&&Oi.l.$.call(e,Qi(e))}function Qi(e){var o=e.N,f=o.lat,m=e.V,w=0,k=new L;if(90===Cd(f))for(f=o.qg(0,m,!0).lat;360>w;w+=120)k.Xh(f,w-180,B);else for(e=360/(e=e.B);360>w;w+=e)k.nd(o.qg(w,m,!0));return o=new P(k),0>f&&o.Sk(Ai.SOUTH),o}function Ri(e,o){if(!C(e,Element)){if(Si.innerHTML=e,!(e=Si.firstElementChild))throw new D(Ri,0,"No element data");Si.removeChild(e);var f=!0;Si.innerHTML=""}this.a=0!==lf(e).length,this.f=f?e:mf(e,x.document,this.a),o&&((f="onAttach")in o&&yc(e=o[f],"Function",Ri,1,f)&&(this.Lh=e),(f="onDetach")in o&&yc(e=o[f],"Function",Ri,1,f)&&(this.b=e))}vh.prototype.f=0,vh.prototype.b=0,vh.prototype.a=Hi,vh.MAX_EXTRUDE_HEIGHT=2047,vh.prototype.fi=function(e){var o=+e;if(o!==e)throw new D(this.fi,0,e);if(0>o||2047<this.b+o)throw new me(this.fi,this.b+o,[0,2047]);this.f=o,this.pa(lh.SPATIAL)},vh.prototype.setExtrusion=vh.prototype.fi,vh.prototype.cm=function(){return this.f},vh.prototype.getExtrusion=vh.prototype.cm,vh.prototype.ei=function(e){var o=+e;if(o!==e)throw new D(this.ei,0,e);if(0>o||2047<this.f+o)throw new me(this.ei,this.f+o,[0,2047]);this.b=o,this.pa(lh.SPATIAL)},vh.prototype.setElevation=vh.prototype.ei,vh.prototype.Zl=function(){return this.b},vh.prototype.getElevation=vh.prototype.Zl,vh.prototype.ca=function(){return this.a},vh.prototype.getGeometry=vh.prototype.ca,vh.prototype.$=function(e){if(C(e,P))var o=!1;else C(e,Gi,this.$,0),o=!0;return this.v=o,o=this.a,this.a=e,o!==Hi&&this.pa(lh.SPATIAL),this},vh.prototype.setGeometry=vh.prototype.$,vh.prototype.J=function(){return this.ca().J()},vh.prototype.getBoundingBox=vh.prototype.J,vh.prototype.Id=function(e){var o,m,w,f=this.ca();if(this.v){var k=0;for(w=(f=f.ja).length;k<w;k++)(m=Ii(this,f[k],e,f[k].ld))&&(o||(o=[]),o.push(m))}else(m=this.Ya)===B&&(m=this.v?Ai.NORTH:this.ca().ld),(m=Ii(this,f,e,m))&&(o=[m]);return o},vh.prototype.getGeometriesForTile=vh.prototype.Id,vh.prototype.oa=y,vh.prototype.W=function(){var m,e=vh.l.W.call(this),o=this.ca(),f=this.v?o.ja:[o],w=e.properties,k=e.geometry=o.W();if(w.style=this.ea().W(),w.height=this.f+this.b,w.min_height=this.b,this.J().ub()&&(k.type="MultiPolygon",this.v)){var Y=[];f.forEach(function(_e,_o){m=k.coordinates[_o],_e.J().ub()?Y=Y.concat(m):Y.push(m)}),k.coordinates=Y}return e},vh.prototype.forWorkerMessage=vh.prototype.W,u(Oi,vh),t("H.map.Circle",Oi),Oi.prototype.ig=function(e){(e=og(e)).ga(this.N)||(this.N=e,Pi(this))},Oi.prototype.setCenter=Oi.prototype.ig,Oi.prototype.Za=function(){return this.N},Oi.prototype.getCenter=Oi.prototype.Za,Oi.prototype.oi=function(e){if(E(e=$d(e,0,6371000.79*Od/2)))throw new D(this.oi,0,e);this.V!==e&&(this.V=e,Pi(this))},Oi.prototype.setRadius=Oi.prototype.oi,Oi.prototype.Hm=function(){return this.V},Oi.prototype.getRadius=Oi.prototype.Hm,Oi.prototype.B=60,Oi.prototype.ni=function(e){if(!Ec(e))throw new D(this.ni,0,e);this.B!==(e=$d(zd(e),4,360))&&(this.B=e,Pi(this))},Oi.prototype.setPrecision=Oi.prototype.ni,Oi.prototype.Em=function(){return this.B},Oi.prototype.getPrecision=Oi.prototype.Em,Oi.prototype.$=function(){return this},Oi.prototype.setGeometry=Oi.prototype.$,Oi.prototype.ca=function(){return this.a===Hi&&Oi.l.$.call(this,Qi(this)),this.a},Oi.prototype.getGeometry=Oi.prototype.ca,t("H.map.DomIcon",Ri);var Si=document.createElement("DIV");function Ti(e){Ti.l.constructor.call(this,e)}function Ui(e,o){this.w=+e,this.h=+o}function Vi(e,o){var f,m=e,w=o||[];if(e!==Wi.NONE){if(o=f=w.length,-1===Xi.indexOf(m))throw new D(Vi,0,e);if(!w)throw new D(Vi,1,w);for(;f--;)if(E(w[f]))throw new D(Vi,1,w);if(m===Wi.RECT&&3<o&&(w=[w[0],w[1],w[2],w[1],w[2],w[3],w[0],w[3]],m=Wi.POLYGON),m===Wi.CIRCLE&&2<o&&0<(e=w[2])){m=w[0];var k=w[1],Y=360/(f=xd(2*Bd(e),40));for(w=[];f--;){var _e=Y*f*Td;w.push(m+Hd(_e)*e,k+Jd(_e)*e)}m=Wi.POLYGON}if(m!==Wi.POLYGON||!o||w.length%2)throw new D(Vi,1,w);this.a=w}}Ri.prototype.Lh=null,Ri.prototype.b=null,Ri.prototype.jj=function(e){return mf(this.f,e,this.a)},Ri.prototype.a=!1,u(Ti,hh),t("H.geo.MultiPoint",Ti),Ti.prototype.b=function(e){return ng(e)},Ti.prototype.c=function(e){return C(e,mg)?e:og(e)},Ti.prototype.mb="Multi"+mg.prototype.mb,Ti.prototype.Ab="Multi"+mg.prototype.Ab,t("H.math.Size",Ui),t("H.map.HitArea",Vi);var Wi={NONE:0,RECT:1,CIRCLE:2,POLYGON:3};Vi.ShapeType=Wi;var Xi=[Wi.RECT,Wi.CIRCLE,Wi.POLYGON];function sh(e,o){var f;wc(this,sh),sh.l.constructor.call(this,o),this.$(e),o&&"icon"in o&&(f=o.icon),this.Bc(f||Yi(this))}function Yi(e){var o=e.c;return o||(o=e.constructor.prototype.c=e.b(Zi)),o}Vi.prototype.Gf=function(e,o,f){return this.a?de(e,o,this.a,f,!0):ce.NONE},Vi.prototype.hitTest=Vi.prototype.Gf,u(sh,M),t("H.map.AbstractMarker",sh),sh.prototype.ca=function(){return this.a},sh.prototype.getGeometry=sh.prototype.ca,sh.prototype.$=function(e){var o=this.a;return C(e,mg)||C(e,Ti)?this.a=e:(ng(e,this.$,0),this.a=og(e)),o&&this.pa(lh.SPATIAL),this},sh.prototype.setGeometry=sh.prototype.$,sh.prototype.J=function(){return this.a.J()},sh.prototype.qb=function(){return this.icon},sh.prototype.getIcon=sh.prototype.qb,sh.prototype.Bc=function(e){var o=this.icon,f=!o;if(o!==e){if(!this.Tj(e))throw f?new D(this.constructor,1,e):new D(this.Bc,0,e);this.icon=e,f||this.pa(lh.VISUAL)}return this},sh.prototype.setIcon=sh.prototype.Bc;var Zi={svg:'<svg xmlns="http://www.w3.org/2000/svg" width="38" height="47" viewBox="0 0 38 47"><g fill="none"><path fill="#0F1621" fill-opacity=".4" d="M15 46c0 .317 1.79.574 4 .574s4-.257 4-.574c0-.317-1.79-.574-4-.574s-4 .257-4 .574z"></path><path fill="#01b6b2" d="M33.25 31.652A19.015 19.015 0 0 0 38 19.06C38 8.549 29.478 0 19 0S0 8.55 0 19.059c0 4.823 1.795 9.233 4.75 12.593L18.975 46 33.25 31.652z"></path><path fill="#6A6D74" fill-opacity=".5" d="M26.862 37.5l4.714-4.77c3.822-3.576 5.924-8.411 5.924-13.62C37.5 8.847 29.2.5 19 .5S.5 8.848.5 19.11c0 5.209 2.102 10.044 5.919 13.614l4.719 4.776h15.724zM19 0c10.493 0 19 8.525 19 19.041 0 5.507-2.348 10.454-6.079 13.932L19 46 6.079 32.973C2.348 29.495 0 24.548 0 19.04 0 8.525 8.507 0 19 0z"></path></g></svg>',size:new Ui(38,47),anchor:new G(19,45),hitArea:new Vi(Wi.POLYGON,[19,46,2,27,0,18,5,6,19,0,32,5,38,15,36,27,19,47])};function $i(e,o){$i.l.constructor.call(this,e,o)}function aj(e,o,f){aj.l.constructor.call(this,e),this.oldValue=f,this.newValue=o}function bj(e,o,f,m){bj.l.constructor.call(this,e,o,f),this.modifiers=m}sh.prototype.W=function(){var e=sh.l.W.call(this),o=this.qb(),f=o.rb(),m=o.fd();return e.geometry=this.ca().W(),f&&((o=e.properties.icon={id:o.uid}).size={w:f.w,h:f.h},o.offset=[f.w/2-(m?m.x:0),f.h/2-(m?m.y:0)]),e},sh.prototype.forWorkerMessage=sh.prototype.W,u($i,sh),t("H.map.DomMarker",$i),$i.prototype.type=oh.DOM_MARKER,$i.prototype.da=2,$i.prototype.b=function(e){var o=new Ri(e.svg,e);return o.f.style.margin=-(e=e.anchor).y+"px 0 0 -"+e.x+"px",o},$i.prototype.Tj=function(e){return C(e,Ri)},u(aj,td),t("H.util.ChangeEvent",aj),u(bj,aj),t("H.map.ChangeEvent",bj);var cj={SIZE:1,POSITION:2,HEADING:4,TILT:8,INCLINE:16,ZOOM:32,BOUNDS:64};function dj(){this.a=[],dj.l.constructor.call(this)}function ej(e,o,f){if(e=e.a.length,f)var m=e;else if(E(m=0>(m=+o)?yd(0,e+m):xd(e,m)))throw new me(dj,o,[0,e-1]);return m}function gj(e,o){var f=e.a.splice(o,1)[0];return e.dispatchEvent(new fj(e,e.A.ge,o,null,f,null)),f}function fj(e,o,f,m,w,k){fj.l.constructor.call(this,o,e),this.idx=f,this.added=m,this.removed=w,this.moved=k}function hj(){}function ij(e){return xd(1,yd(0,.5-Dd(Kd(Qd+Pd*e/180))/Od/2))}function jj(e){return 0>=e?90:1<=e?-90:Ud*(2*Ld(Gd(Od*(1-2*e)))-Pd)}bj.Type=cj,bj.prototype.kl=cj.SIZE,bj.prototype.SIZE=bj.prototype.kl,bj.prototype.Ki=cj.POSITION,bj.prototype.POSITION=bj.prototype.Ki,bj.prototype.Ei=cj.HEADING,bj.prototype.HEADING=bj.prototype.Ei,bj.prototype.Mi=cj.TILT,bj.prototype.TILT=bj.prototype.Mi,bj.prototype.Fi=cj.INCLINE,bj.prototype.INCLINE=bj.prototype.Fi,bj.prototype.Ni=cj.ZOOM,bj.prototype.ZOOM=bj.prototype.Ni,bj.prototype.Ci=cj.BOUNDS,bj.prototype.BOUNDS=bj.prototype.Ci,u(dj,F),t("H.util.OList",dj),dj.prototype.add=function(e,o){o=ej(this,o,E(o)),this.a.splice(o,0,e),this.dispatchEvent(new fj(this,this.A.ee,o,e,null,null))},dj.prototype.add=dj.prototype.add,dj.prototype.bc=function(e){return this.get(e),gj(this,e)},dj.prototype.removeAt=dj.prototype.bc,dj.prototype.remove=function(e){return 0<=(e=this.indexOf(e))&&(gj(this,e),!0)},dj.prototype.remove=dj.prototype.remove,dj.prototype.set=function(e,o){if(0!==this.a.length||0!==e){this.get(e),e=ej(this,e,!1);var f=this.a[e]}return this.a[e]=o,this.dispatchEvent(new fj(this,this.A.he,e,o,f,null)),f},dj.prototype.set=dj.prototype.set,dj.prototype.indexOf=function(e){return this.a.indexOf(e)},dj.prototype.indexOf=dj.prototype.indexOf,dj.prototype.get=function(e){var o=ej(this,e,!1),f=this.a;if(o>=f.length)throw new me(this.get,e,[0,f.length-1]);return f[o]},dj.prototype.get=dj.prototype.get,dj.prototype.rm=function(){return this.a.length},dj.prototype.getLength=dj.prototype.rm,dj.prototype.Ha=function(){return this.a.concat()},dj.prototype.asArray=dj.prototype.Ha,dj.prototype.flush=function(){for(var e=this.a.length;e--;)gj(this,e)},dj.prototype.flush=dj.prototype.flush,dj.prototype.o=function(){this.flush(),dj.l.o.call(this)},dj.prototype.A={ee:"add",ge:"remove",he:"set",Fo:"move"},u(fj,td),dj.Event=fj,hj.prototype.Kf=function(e,o,f){return f?(f.x=o/360+.5,f.y=ij(e)):f=new G(o/360+.5,ij(e)),f},hj.prototype.latLngToPoint=hj.prototype.Kf,hj.prototype.Jc=function(e,o){return this.Kf(e.lat,e.lng,o)},hj.prototype.geoToPoint=hj.prototype.Jc,hj.prototype.La=function(e,o,f){return f?(f.lat=jj(o),f.lng=360*(1===e?1:Yd(e,1))-180):f=new mg(jj(o),360*(1===e?1:Yd(e,1))-180),f},hj.prototype.xyToGeo=hj.prototype.La,hj.prototype.Uf=function(e,o){return this.La(e.x,e.y,o)},hj.prototype.pointToGeo=hj.prototype.Uf;var kj=new hj;function lj(e,o){this.projection=e||kj,this.b=0,this.a=this.exp=Dd(o||256)/Nd,mj(this),this.y=this.x=0}t("H.geo.mercator",kj),t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0),t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22),t("H.geo.PixelProjection",lj);var nj=Cd(24)+Cd(-8);function mj(e){e.a>nj&&(e.a=nj),e.w=Fd(2,e.a),e.h=Fd(2,e.a)}function oj(e){e=e||{},oj.l.constructor.call(this),this.min=0,this.max=22,this.xl=this.dark=!!e.dark,e.min&&this.ji(e.min),e.max&&this.hi(e.max),this.pixelProjection=new lj(e.projection,e.minWorldSize),e.provider&&(this.la=e.provider,this.Sa=z(this.Sa,this),this.la.addEventListener(Q.prototype.A.xa,this.Sa,!1,this),this.cb=z(this.cb,this),this.la.addEventListener(Q.prototype.A.fe,this.cb,!1,this))}function pj(e,o,f){var m=e[o],w="min"===o;if(f!==m){if(!(w?f<=e.max:f>=e.min))throw new D(w?e.ji:e.hi,0,"Invalid condition min <= max");e[o]=f,e.Sa(),e.cb(),e.dispatchEvent(new aj(w?e.A.Ji:e.A.Ii,f,m))}return e}function qj(e){var o;if(qj.l.constructor.call(this),this.dispatchEvent=z(this.dispatchEvent,this),e){var f=e.length;for(o=0;o<f;o++)this.add(e[o])}}function rj(e,o){var f=o.getProvider&&o.getProvider();f&&(sj[f.uid]=f),o.ia(e)}function tj(e){var o=e.getProvider&&e.getProvider();o&&delete sj[o.uid],e.ia(null)}lj.prototype.Vf=kj,lj.prototype.projection=lj.prototype.Vf,lj.prototype.x=0,lj.prototype.x=lj.prototype.x,lj.prototype.y=0,lj.prototype.y=lj.prototype.y,lj.prototype.wo=Fd(2,nj),lj.prototype.w=lj.prototype.wo,lj.prototype.bn=Fd(2,nj),lj.prototype.h=lj.prototype.bn,lj.prototype.Ka=function(e){if(E(e))throw new D(this.Ka,0,e);var o=this.x/this.w,f=this.y/this.h;this.b=e,this.a=this.exp+e,mj(this),this.x=o*this.w,this.y=f*this.h},lj.prototype.rescale=lj.prototype.Ka,lj.prototype.Hj=function(){return this.b||0},lj.prototype.getZoomScale=lj.prototype.Hj,lj.prototype.eb=function(e,o){return(e=this.projection.Kf(e.lat,e.lng,o)).x=e.x*this.w-this.x,e.y=e.y*this.h-this.y,e},lj.prototype.geoToPixel=lj.prototype.eb,lj.prototype.Me=function(e,o){return this.projection.La((e.x+this.x)/this.w,(e.y+this.y)/this.h,o)},lj.prototype.pixelToGeo=lj.prototype.Me,lj.prototype.La=function(e,o,f){return this.projection.La((e+this.x)/this.w,(o+this.y)/this.h,f)},lj.prototype.xyToGeo=lj.prototype.La,lj.prototype.qh=function(e,o,f){return(e=this.projection.Kf(e,o,f)).x=e.x*this.w-this.x,e.y=e.y*this.h-this.y,e},lj.prototype.latLngToPixel=lj.prototype.qh,lj.prototype.Xd=function(e){return new G(e.x*this.w-this.x,e.y*this.h-this.y)},lj.prototype.pointToPixel=lj.prototype.Xd,u(oj,F),t("H.map.layer.Layer",oj),oj.prototype.min=0,oj.prototype.min=oj.prototype.min,oj.prototype.max=22,oj.prototype.max=oj.prototype.max,oj.prototype.A={xa:"update",fe:"configchange",Ji:"minchange",Ii:"maxchange"},oj.prototype.ka=function(){return this.la},oj.prototype.getProvider=oj.prototype.ka,oj.prototype.ln=function(e){return this.min<=e&&e<=this.max},oj.prototype.isValid=oj.prototype.ln,oj.prototype.ji=function(e){return pj(this,"min",+e)},oj.prototype.setMin=oj.prototype.ji,oj.prototype.hi=function(e){return pj(this,"max",+e)},oj.prototype.setMax=oj.prototype.hi,oj.prototype.Sa=function(){this.dispatchEvent(this.A.xa)},oj.prototype.cb=function(){this.dispatchEvent(this.A.fe)},oj.prototype.o=function(){oj.l.o.call(this)},oj.prototype.ba=function(){return null},oj.prototype.getCopyrights=oj.prototype.ba,u(qj,dj),t("H.map.DataModel",qj),qj.prototype.add=function(e,o){C(e,oj,this.add,0),rj(this,e),qj.l.add.call(this,e,o)},qj.prototype.add=qj.prototype.add,qj.prototype.set=function(e,o){return C(o,oj,this.set,0),rj(this,o),(e=qj.l.set.call(this,e,o))&&tj(e),e},qj.prototype.set=qj.prototype.set,qj.prototype.bc=function(e){var o;return(o=qj.l.bc.call(this,e))&&tj(o),o},qj.prototype.removeAt=qj.prototype.bc,qj.prototype.remove=function(e){var o;return(o=qj.l.remove.call(this,e))&&tj(e),o},qj.prototype.remove=qj.prototype.remove,qj.prototype.flush=function(){for(var e=this.a.length;e--;)this.bc(e);qj.l.flush.call(this)},qj.prototype.flush=qj.prototype.flush;var sj={};function uj(e,o,f){if(e=sj[e])return C(e[o],Function,uj,1,"invalid method"),e[o].apply(e,f)}function vj(e,o){Da(e)&&(this.j=e),Ec(o)&&(this.b=o)}Hc(sj),qj.invoke=uj,t("H.util.Request",vj),vj.State={PENDING:0,PROCESSING:1,COMPLETE:2,CANCELLED:3,ERROR:4};var wj=[0,1,2,3,4],Cj;function xj(e,o){e.c<e.b&&(vc(o)||(o=2),0===o||1===o||0!==e.a&&1!==e.a||(e.c++,2!==o&&e.i++,e.O(e.c<e.b?1:2)))}function yj(){}function zj(e,o){var f=e.L(),m=f.ownerDocument;zj.l.constructor.call(this),this.a=e,this.P=f=f.appendChild(Aj(m,"DIV","position:absolute;bottom:0;right:0;left:0px;z-index:1;direction:ltr;pointer-events:none;height:40px-webkit-touch-callout: none;-webkit-user-select:none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select:none;",null,"H_imprint")),this.jf=Aj(m,"DIV","margin: 0 0 16px 16px;display:inline-block;",'<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>',"H_logo"),f.appendChild(this.jf),f=f.appendChild(Aj(m,"DIV","right:0;bottom:0;position:absolute;background-color:rgba(255,255,255,.8);color:#0F1621;padding:2px 16px",null,"H_copyright")),this.g=f.appendChild(Aj(m,"A","color:inherit; margin:0px 8px; text-decoration:none; pointer-events:all;","Terms of use")),this.g.target="_blank",this.f=f.appendChild(Aj(m,"SPAN","margin:0px 8px")),this.j=Wa(Bj),this.ki(o),this.c=z(this.c,this),this.b=z(this.b,this),this.a.addEventListener(this.a.A.Hi,this.c),this.a.a.addEventListener("add",this.b),this.a.a.addEventListener("remove",this.b),this.a.a.addEventListener("set",this.b),this.b()}vj.prototype.a=0,vj.prototype.getState=function(){return this.a},vj.prototype.getState=vj.prototype.getState,vj.prototype.O=function(e){if(0>wj.indexOf(e))throw new D(this.O,0,e);(this.a!==e||1===e&&1<this.b)&&(this.a=e,this.j&&this.j(this))},vj.prototype.b=1,vj.prototype.Vm=function(){return this.b},vj.prototype.getTotal=vj.prototype.Vm,vj.prototype.c=0,vj.prototype.Fm=function(){return this.c},vj.prototype.getProcessed=vj.prototype.Fm,vj.prototype.i=0,vj.prototype.dm=function(){return this.i},vj.prototype.getFailed=vj.prototype.dm,vj.prototype.ke=function(){},vj.prototype.cancel=function(){3!==this.a&&(this.ke(),this.O(3))},vj.prototype.cancel=vj.prototype.cancel,t("H.util.ICapturable",yj),yj.prototype.capture=function(){},yj.prototype.capture=yj.prototype.capture,t("H.util.Disposable",od),od.prototype.nb=od.prototype.nb,od.prototype.addOnDisposeCallback=od.prototype.nb,t("H.util.dispose",sd),od.prototype.D=od.prototype.D,od.prototype.dispose=od.prototype.D,od.prototype.o=od.prototype.o,od.prototype.disposeInternal=od.prototype.o,u(zj,od),t("H.map.Imprint",zj);var Bj={font:'11px "Lucida Grande", Arial, Helvetica, sans-serif',href:"https://legal.here.com/{LN}/terms/serviceterms/{CN}",invert:!1,reportHref:"https://wego.here.com/",locale:"en-US"};function Aj(e,o,f,m,w){return e=e.createElement(o),f&&(e.style.cssText=f),m&&(e.innerHTML=m),w&&(e.className=w),e}zj.prototype.ki=function(e){var o,f=this.jf.firstElementChild.firstElementChild.children;e||(this.j=Wa(Bj));var m=this.j;for(o in m)e&&o in e&&(m[o]=e[o]);e=(this.mh=e=m.invert)?Dj:Ej,f[0].style.fill=e.Wk,f[0].style.fillOpacity=""+e.Xk,f[1].style.fill=e.al,f[1].style.fillOpacity=""+e.bl,Fj[e=m.locale]||(m.locale=e="en-US"),this.g.innerHTML=Fj[e],e=e.split("-"),this.g.href=m.href.replace("{LN}",e[0]).replace("{CN}",e[1].toLowerCase()),this.P.style.font=m.font},zj.prototype.setOptions=zj.prototype.ki,zj.prototype.L=function(){return this.P},zj.prototype.c=function(){this.f.innerHTML=this.i+" "+this.ba()},zj.prototype.b=function(){this.c(),setTimeout(this.c,5e3)};var Ej={al:"#0F1621",bl:.3,Wk:"#fff",Xk:.6},Dj={al:"#fff",bl:1,Wk:"#0F1621",Xk:.7},Gj="1987&ndash;"+yd(2015,(new Date).getFullYear())+" HERE";function Hj(e,o,f,m){Ij(z(function(w){w?f(this.mh?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAADNklEQVRYR82XW6hVVRSGv7+rmJfSMKSnSkMEfY7EogcJC7tilGRopBAiSaI+SBARQSCIIqgFISih2YW0oAgLCsKXojA0RB+81VugZEFZv/yHuWTt7d7Hfc4+6+h4OWefNfcc3xlj/v+YS1zjoab5bE8DZgGngB8keSg5GwO0PQ54F3i2BnQIWCLpx14hGwG0fT3wOfBwB5DzwOOSDvQC2RTgM8Ae4D/gaeA3YDdwN5AWvyxp+6gD2r4OmAq8AbwInAMmA/OAT4CbgBWStvYClzUjWkHbrwHLgF8LVHJ8DDxah7P9JHCil7M40oA/A7OBC8ANtSqlrQOVs30/8CWQat8r6cxg1RwRQNvPA88Bk4D7gJzBV4A5teSp5MlS4VuA/ZIeu1Kr+wa0/QTwIRDlRhT5eTswBvi2CKOd42AULilndNAYCcA7gK+BmbVMiyXtsh3Qt4FFBTgW8w6wXtLfV4LrSyS2FwAvAWOBX+JtwF0laUDmS/oun23fDNwJnJb0Ty9g1ZphVdB2qrK2LdFfBbb685/AIxXkUKDqa4cMaDs2kjalRe8Fola57J3qRQSJviGHA3gMuAdYI2lDUfDOArQLWAd8VTuTOW9vjUoFy6TIGYpS9wKfAjuK5wVuSfn91iKcvZJeHy5ci0hsZwzNk5Qh3xIFbLyks7aPAtPLgv+L4VZwDwLvA6uKz6XdfcVAi22PBz4q4+lVSRurXW2vKYKIZfwEHCmmXC35HngAyITYD0ys2t8XWflyBfhmvKm24QCk7aVFCPVc7WMszzKucknI+NoHPCUppt13VICZm2nNwjoksByY0SXL72Vi3FieZ97mgrpyqF432H9xScW2O0H+W6oSE/4D2FYuA9kzlUzVTwO3Ad9IOtx3ydo2aLGZLpABm5KW2Z4AfAbMLfsEcpGkKLqRuMwHu0CukrSpCCrvGlF6hBEVL5MUw24kOhp1B8gc+FTqgxpkFLuzSbjk6jpJOkC2tDPeKCkVbDRkO67fDTTC2VK7vgfyBUlfNEpV2zyAK4HNXRLmZfshScdHC6g9T+WDGU2XpkdZdNXhWs6g7dXAhmsJ7jKR2M77bG4kV7Wt9TZfBLgYEC7PSpcIAAAAAElFTkSuQmCC":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIMSURBVFiFzdZPiE1RGADwXzPTTPIMQoodVpbKgpoUG5qExUi8DSVJQv4slJJsbNjYWFhNETWLUUosRDRLUVLCYhIiojFojHkW997uvefNGIuZc99Xp/fOO6/Or++c75xDi0d7hDlWYQNqeB9hvv+OGq6jUWjPsKZKVBbtuKOMy9p3bKqOlsROCWYc27AWr9PfJnCgKlgbluNqivmGDmzBrxR3sCocnMEw7sqXdEAzboeK9uLTFPVbed8VcesxglFJtqNEHbcxlIL68ChADuCSpEgauBULt11SDI3C5yJJdrLCCNsQumMBl+J5AKinY4slBfNTfsRcxJwYsK0YxD3J0r1RPut6Cv/twgp0xoDBBc3LNhr0RwJktNifAn7gsnLmsuxVinyVTn4i7dcLoH4sU96Tp2Pi2uSVehN75Gdev+QO7pIXztmZnLwTvf+AzU+/v5Rn50+A24gP2IW5M4mbJ7+ejgVjJ/EpHXuCa8p77nGK68FX5eWfsTgfTJoh92qu1vAaa+CtPJuDZuEh3CHZUyHyxSSYrL3DWKE/gStm8aybDDkmKYperJM/BrJMnsJuHMLq2YJNh/wsX7JuPAyQfTFg0yGPFMZreCCv4n2xgTQjxyXP+CxquK8iXBYhMlzOtliQBVg4RVuCG/iSto/YHAuWxWFTHyXDWBkbNFkc1cK4LI5rYVwW57QY7i/pZeJv8QQJRQAAAABJRU5ErkJggg=="):((w=this.jf.cloneNode(!0)).firstChild.setAttribute("style","font:"+o),f(cf(w.innerHTML)))},e),m)}function Ij(e,o){var f="data:image/svg+xml;charset=utf-8,"+encodeURIComponent('<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>'),m=Cj;vc(m)?e(m):new uf("image",f).then(function(w){Ze.drawImage(w,0,0);try{Ze.getImageData(0,0,1,1),m=!1}catch(k){m=18===k.code}finally{Cj=m,e(m)}},o)}zj.prototype.ba=function(){var Y,_e,_o,e=this.a,o=e.kb(),f=e.c.fb().bounds,m=(e=e.a).a.length,w={},k=0,_u=[Gj];if(f)for(;k<m;k++)if(_e=e.get(k).getCopyrights(f.J(),o))for(Y=0;Y<_e.length;Y++)w[_o=_e[Y].label]||(_u.push(_o),w[_o]=1);return _u.join(", ")},zj.prototype.getCopyrights=zj.prototype.ba,zj.prototype.ea=function(){return this.P.style},zj.prototype.i=String.fromCharCode(169),zj.prototype.o=function(){if(this.a.removeEventListener(this.a.A.Hi,this.c),this.a.a.removeEventListener("add",this.b),this.a.a.removeEventListener("remove",this.b),this.a.a.removeEventListener("set",this.b),this.P.parentNode){var e=this.P;e.parentNode.removeChild(e)}},zj.prototype.disposeInternal=zj.prototype.o,zj.prototype.capture=function(e,o,f,m){var _m,w=e.getContext("2d"),k=window.getComputedStyle(this.f.parentElement),Y=2*Cc(k.paddingLeft,10),_e=(this.f.offsetWidth+2*Y)*o,_o=this.f.offsetHeight*o,_u=Dc(k.getPropertyValue("font-size")),pd=this.P.ownerDocument,iy=+e.width,sy=+e.height,gy=16*o,wy=this.jf.childNodes[0].getBoundingClientRect(),Ey=wy.width*o,Py=wy.height*o,Jy=kd;Da(m)&&(Jy=function(){m("capture_error")}),w.fillStyle=k.backgroundColor,w.fillRect(iy-_e,sy-_o,_e,_o),_e=this.i+" "+((_m=Aj(pd,"div",null,_m=this.ba())).textContent||_m.innerText||""),w.font=_u*o+"px "+k.getPropertyValue("font-family"),w.fillStyle=k.getPropertyValue("color"),w.textBaseline="bottom",w.textAlign="right",w.fillText(_e,iy-Y*o,sy),Hj(this,w.font,function(_m){new uf("image",_m).then(function(y0){w.drawImage(y0,gy,sy-(Py+gy),Ey,Py),f(e)},Jy)},Jy)},zj.prototype.capture=zj.prototype.capture,zj.prototype.mh=!1,zj.prototype.ml=function(e,o){Fj[e]=o},zj.prototype.addL11NString=zj.prototype.ml;var Fj={"de-DE":"Nutzungsbedingungen","en-US":"Terms of use","en-GB":"Terms of use","es-ES":"Condiciones de uso","fi-FI":"Palveluehdot","fr-FR":"Conditions d'utilisation","it-IT":"Condizioni di utilizzo","nl-NL":"Dienstvoorwaarden","pl-PL":"Warunki \u015bwiadczenia us\u0142ugi","pt-BR":"Termos de servi\xe7o","pt-PT":"Termos do servi\xe7o","ru-RU":"\u0423\u0441\u043b\u043e\u0432\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f","tr-TR":"Servis Ko\u015fullar\u0131","zh-CN":"\u4f7f\u7528\u6761\u6b3e"};function R(e){var o={};this.f=o.previousSibling=o.nextSibling=o,this.g=new df,R.l.constructor.call(this,e),e&&"objects"in e&&this.Rb(e.objects)}function Jj(e,o,f){e.be(f.la)}function Kj(e){e.Ue()}function Lj(e,o,f){e.pa(f.c)}function Mj(e){this.push(e)}function Nj(e,o){for(var w,k,f=0,m=o.length,Y=[];f<m;f++)k=(w=o[f])instanceof R?{type:"GeometryCollection",geometries:Nj(e,w.Pa())}:w instanceof sh||w instanceof th||w instanceof uh||w instanceof vh?w.ca().Dc():{type:"FeatureCollection",features:jf},Y.push(k);return Y}u(R,M),t("H.map.Group",R),R.prototype.type=oh.GROUP,R.prototype.be=function(e,o){return this.b=!0,e=R.l.be.call(this,e,o),this.b=!1,e&&this.forEach(Jj,!0),e},R.prototype.setProvider=R.prototype.be,R.prototype.contains=function(e){var o=this===e;if(!o&&this.a&&C(e,M))for(;!o&&e;)e===this?o=!0:e=e.Ca;return o},R.prototype.contains=R.prototype.contains,R.prototype.Ue=function(){this.K=B,this.forEach(Kj,!0)},R.prototype.resetZInfo=R.prototype.Ue,R.prototype.b=!1,R.prototype.pa=function(e){var o=R.l.pa.call(this,e);return o&&!this.b&&(this.c=e,this.forEach(Lj,!0),delete this.c),o},R.prototype.invalidate=R.prototype.pa,R.prototype.forEach=function(e,o,f){var m;if(this.a){var w=this.f,k=w.nextSibling;for(m=0;k!==w;){var Y=k.nextSibling;e.call(f,k,m++,this),o&&C(k,R)&&k.forEach(e,o,f),k=Y}}},R.prototype.forEach=R.prototype.forEach,R.prototype.Pa=function(e){var o=[];return this.forEach(Mj,e,o),o},R.prototype.getObjects=R.prototype.Pa,R.prototype.J=function(){var e=null;return this.a&&this.forEach(function(o){o.J&&(o=o.J())&&(e=e?e.Zb(o):o)}),e},R.prototype.getBoundingBox=R.prototype.J,R.prototype.a=0,R.prototype.Ql=function(){return this.a},R.prototype.getChildCount=R.prototype.Ql,R.prototype.aa=function(e){var o=this.f,f=o.previousSibling;if(C(e,M,this.aa,0),e.contains(this))throw new Zc(this.aa,"The new object contains the parent group");var m=e.Ef(!0),w=e.Ca;if(w!==this){if(w){var k=e.nextSibling;(w=e.previousSibling).nextSibling=k,k.previousSibling=w}e.Ca=this,M.l.ia.call(e,this),f.nextSibling=e,e.previousSibling=f,e.nextSibling=o,o.previousSibling=e,this.a++}return e.ti=this.g.next(),e.Ue(),o=e.be(this.la,this.aa),e.Ef(!0)!==m&&e.pa(lh.VOLATILITY),o||e.pa(lh.Z_ORDER),e},R.prototype.addObject=R.prototype.aa,R.prototype.Rb=function(e){var o;Ac(e,this.Rb,0);var f=e.length;for(o=0;o<f;o++)this.aa(e[o])},R.prototype.addObjects=R.prototype.Rb,R.prototype.Da=function(e){if(!e||e.Ca!==this)throw new Zc(this.Da,"object not found");var o=e.previousSibling,f=e.nextSibling;return o.nextSibling=f,f.previousSibling=o,e.Ca=null,M.l.ia.call(e,null),delete e.previousSibling,delete e.nextSibling,C(e.la,N)&&e.be(null,this.Da),this.a--,e},R.prototype.removeObject=R.prototype.Da,R.prototype.od=function(e){var o;Ac(e,this.od,0);var f=e.length;for(o=0;o<f;o++)this.Da(e[o])},R.prototype.removeObjects=R.prototype.od,R.prototype.ma=function(){var e=this.Pa();this.od(e)},R.prototype.removeAll=R.prototype.ma,R.prototype.Dc=function(e){for(var k,Y,_e,o=this.Pa(),f=0,m=o.length,w=[];f<m;f++)(_e=o[f])instanceof R?(Y=rh(this,k=e?e(_e.getData()):_e.getData(),!!e),(k={type:"Feature"}).properties=Y,_e.i&&(k.id=_e.i),k.geometry={},k.geometry.type="GeometryCollection",k.geometry.geometries=Nj(this,_e.Pa()),w.push(k)):w.push(_e.Dc(e));return{type:"FeatureCollection",features:w}},R.prototype.toGeoJSON=R.prototype.Dc,R.prototype.W=function(){var e=R.l.W.call(this);return e.type="Group",e},R.prototype.forWorkerMessage=R.prototype.W;var Oj={PROVIDES_BY_VIEWPORT:1,PROVIDES_RASTERS:2,PROVIDES_SPATIALS:4,PROVIDES_OVERLAYS:8,PROVIDES_MARKERS:16,PROVIDES_DOM_MARKERS:32,PROVIDES_GEOJSON:64,PROVIDES_OMV:128,CROP_LINES_BY_TILE:256,CROP_POLYGONS_BY_TILE:512,HAS_VOLATILE_DATA:1024};function Pj(e,o,f,m,w){switch(o&&(this.g=o),vc(f)&&(this.c=!!f),this.c&&m&&(this.Dg=new Ui(m.w,m.h)),vc(w)&&(this.i={crossOrigin:w}),Qj[zc(e)]){case 2:this.a=e,Rj(this,1);break;case 1:if(of(e)){this.a=e,Sj(this),Rj(this,1);break}e=e.src;case 0:if(e){e=cf(e),this.b=new uf("image",e,B,this.i),this.b.then(z(this.Nn,this),z(this.Mn,this));break}default:throw Rj(this,-1),new D(Pj,0,"No image data")}}function Rj(e,o){e.f=o,delete e.b,e.g&&e.g(o,e)}function Sj(e){if(e.c){var o=e.a,f=Tj(e),m=f&&f.w||+o.width,w=f&&f.h||+o.height,k=Ue();if(C(o,x.HTMLCanvasElement))f=o;else{(f=o.ownerDocument.createElement("canvas")).width=Bd(m*k),f.height=Bd(w*k);var Y=f.getContext("2d");Y.scale(k,k),Y.drawImage(o,0,0,m,w),ad&&(Y.clearRect(0,0,m,w),Y.drawImage(o,0,0,m,w))}e.a=f}}t("H.map.provider.Capabilities",Oj),Oj.PROVIDES_WEBGL_RENDERABLE_OBJECTS=Oj.PROVIDES_SPATIALS|Oj.PROVIDES_OVERLAYS|Oj.PROVIDES_MARKERS,Pj.prototype.f=0,Pj.prototype.getState=function(){return this.f},Pj.prototype.c=!0,Pj.prototype.getData=function(){return this.a||y};var Qj={String:0,HTMLImageElement:1,HTMLCanvasElement:2};function Tj(e){var f,o=e.Dg;if(!o){var m=e.a;if(0===(o=m.naturalWidth||m.width)&&af&&1===Qj[zc(m)]){var w=!0;if(f=m.parentNode)var k=m.nextSibling;document.body.appendChild(m)}e.Dg=o=new Ui(m.naturalWidth||m.width,m.naturalHeight||m.height),w&&(f?f.insertBefore(m,k):document.body.removeChild(m))}return o}function Uj(e,o){var f,m="anonymous";if(this.uid=Vj.next(),Uj.l.constructor.call(this),o){var w="size";if(w in o){var k=o[w];if(!k||isNaN(k.w)||isNaN(k.h))throw new D(Uj,1,w);this.g=new Ui(k.w,k.h)}if((w="anchor")in o){if(!(k=o[w])||isNaN(k.x)||isNaN(k.y))throw new D(Uj,1,w);this.f=new G(k.x,k.y)}(w="hitArea")in o&&(C(k=o[w],Vi,Uj,1),this.c=o[w]),(w="asCanvas")in o&&(f=o[w]),(w="crossOrigin")in o&&(m=o[w]),(k=o.stickHeight)===+k&&0<k&&(this.no=k),k=o[w="stickColor"],w in o&&Bc(k)&&(this.mo=k)}e=new Pj(e,z(this.i,this),f,this.g,m),0!==(o=this.j=e.getState())?this.i(o,e):this.b=e}p=Pj.prototype,p.Dg=y,p.rb=function(){return 1===this.f?Tj(this):y},p.Nn=function(e){this.a=e,Sj(this),Rj(this,1)},p.Mn=function(){Rj(this,-1)},p.cancel=function(){this.b&&this.b.cancel()},u(Uj,F),t("H.map.Icon",Uj);var Vj=new df;function Wj(e,o,f,m,w,k){Wj.l.constructor.call(this,isNaN(e)?15:e,o,f,m,w,k)}function Xj(e,o,f,m,w){var k=o.entries;if(w)if(o.a)k=Yj(e,o,f,m,w);else if(k){var Y=Fg(o,+((k=k[0])[1]>=o[8])|+(k[0]>=o[9])<<1);Y.entries=o.entries,delete o.entries,k.node=Y,Cg(e,Y),k=Yj(e,o,f,m,w)}else Gg(o,k=new Zj(f,m)),Cg(e,o),Ag(e,k,!0);else k||Cg(e,o),Gg(o,k=new Zj(f,m)),Ag(e,k,!0);return k}function Yj(e,o,f,m,w){return Xj(e,Fg(o,+(f>=o[8])|+(m>=o[9])<<1),f,m,w-1)}function Zj(e,o){this.id=Eg++,this[0]=o,this[1]=e}function ak(){this.a=new Wj(10,180,90,0,0,!0)}function bk(e){this.a=e}function ck(e,o,f){this.c=e,this.a=o,this.g=f,this.f=this.c&Oj.PROVIDES_BY_VIEWPORT?"function(){return sources[$source].isInMinMaxRange(feature, $zoom) && feature.ref.effectiveVisibility;}":B,this.b={}}function dk(e,o,f,m){this.a=e,this.b=o,this.c=f,this.ef=m}function ek(e,o,f,m){return e={type:o,uid:e.b,tiled:f,max_zoom:e.c},m&&Ya(e,m),e}function fk(e,o,f,m,w){this.a=e,this.b=o,this.c=f,this.f=m,this.ef=w}function gk(e){if(e.a&Oj.PROVIDES_DOM_MARKERS&&!(e.a&Oj.PROVIDES_MARKERS))return{};var o=new dk(e.a,e.b,e.c,e.ef),f=new bk(e.a);e=new ck(e.a,e.b,e.f);var m={},w=o.b;if(o=o.a&Oj.PROVIDES_BY_VIEWPORT?ek(o,"ObjectSource",!1,{progressiveUpdate:!0,has_volatile_data:!!(o.a&Oj.HAS_VOLATILE_DATA)}):o.a&Oj.PROVIDES_RASTERS?ek(o,"RemoteRasterTileSource",!0,{url:""}):ek(o,"ObjectTileSource",!0,{tile_size:o.ef}),m[w]=o,o={},f.a&Oj.PROVIDES_RASTERS&&(o={"translucent-raster":ni("raster","inlay",1)}),f.a&Oj.PROVIDES_WEBGL_RENDERABLE_OBJECTS){w=!!(f.a&Oj.CROP_LINES_BY_TILE);var k={"translucent-polygons":ni("polygons","inlay",2),"translucent-extruded-polygons":ni("polygons","translucent",3),"translucent-pattern-lines":ni("pattern-lines","translucent",4),"translucent-overlays":ni("overlays","inlay",5),markers:ni("custom_icons","overlay",6,!1)};k["translucent-polygons"].crop_by_tile=!!(f.a&Oj.CROP_POLYGONS_BY_TILE),k["translucent-pattern-lines"].crop_by_tile=w,k.markers.suppress_fade=!0,k.markers.stick=!0,Ya(o,k)}if(e.c&Oj.PROVIDES_RASTERS&&(e.b["tile_layer_"+e.a]=pi(e.a,"_default",{"translucent-raster":{color:[1,1,1,e.g],order:0}})),e.c&Oj.PROVIDES_SPATIALS){f={"translucent-pattern-lines":{color:mi("strokeColor"),width:mi("lineWidth * $meters_per_pixel"),join:mi("lineJoin"),cap:mi("lineCap"),tail_cap:mi("lineTailCap"),head_cap:mi("lineHeadCap"),miter_limit:mi("miterLimit"),order:"function() { return 2 + feature.effectiveZIdx / 2; }",interactive:!0,dash:mi("lineDash"),extrude:!0,dash_phase:mi("lineDashOffset")}},w=e.b,k="polygon_layer_"+e.a;var Y=pi(e.a,"polygons",void 0,e.f);Y.flat={filter:"function(){return !feature.height && !feature.min_height;}",draw:oi(!1)},Y.extruded={filter:"function(){return feature.height || feature.min_height;}",draw:oi(!0)},w[k]=Y,e.b["outline_layer_"+e.a]=pi(e.a,"outlines",f,e.f),e.b["polyline_layer_"+e.a]=pi(e.a,"polylines",f,e.f)}return e.c&Oj.PROVIDES_OVERLAYS&&(e.b["overlay_layer_"+e.a]=pi(e.a,"overlays",{"translucent-overlays":{color:[1,1,1,e.g],order:8190,interactive:!0}})),e.c&Oj.PROVIDES_MARKERS&&(e.b["marker_layer_"+e.a]=pi(e.a,"markers",{markers:{sprite:li("icon.id"),offset:li("icon.offset"),collide:!1,priority:8191,elevate_by_altitude:!0,interactive:!0,stick:{color:li("icon.stick_color"),height:li("icon.stick_height")}}},e.f)),{sources:m,styles:o,layers:e.b}}function Q(e){var f,o=""+ff();if(Q.l.constructor.call(this),this.min=(e=e||{}).min||0,this.max=e.max||22,f=e.uri){if(/_/.test(f))throw new D(Q,0,"uri "+f)}else f=o;if(this.uri=f||o,this.uid=o,e.getCopyrights&&yc(e.getCopyrights,"Function",Q)&&(this.getCopyrights=e.getCopyrights),this.cb=this.cb.bind(this),this.ra=!0,this.c=e.engineType||hk,this.c===ik.HARP&&!H.map.render.harp)throw new D(Q,0,"HARP engine is not supported, module not found")}function jk(e,o){o=$d(o,0,1),E(o)&&(o=1),e.g!==o&&(e.g=o,e.ra&&kk(e),e.cb(),e.Sa())}function kk(e){if(e.c===ik.WEBGL){var o=new fk(e.getCapabilities(),e.uid,e.max,e.g,e.tileSize);e.a=new qi(gk(o))}else e.c===ik.HARP&&H.map.render.harp&&(e.a=new H.map.render.harp.Style({}));e.ra=!0}function mk(e){var o;for(o in wc(this,mk),mk.l.constructor.call(this,e),this.V=e=[],oh)e[oh[o]]=new kh}function N(e){N.l.constructor.call(this,e=e||{}),this.f=e=new R({min:e.min,max:e.max}),e.la=this,e.ia(this),e.pa(lh.ADD),this.u=new Mg,this.i=new Mg,this.m=new ak,this.s=new Mg,this.S=new ak,this.da=new Mg}function nk(e,o,f,m,w,k,Y){if(Y=Y||[],o.Mc())for(e=o!==e.m&&o!==e.s,w=!w,f=(o=o.Hf(f,k,k)).length,k=0;k<f;k++){var _o,_e=o[k].c;if(_o=void 0!==m){for(var _u=Ad(m),pd=_e;(_o=pd.s<=_u&&pd.m>=_u)&&(pd=pd.Ca););_o=!_o}_o||!w&&!_e.pc(!0)||(e||1===_e.qb().getState())&&Y.push(_e)}return Y}function ok(e,o,f,m,w){var k=nk(e,e.m,o,f,m,w);return nk(e,e.s,o,f,m,w,k),k}function pk(e,o,f,m,w){var k=nk(e,e.S,o,f,m,w);return nk(e,e.da,o,f,m,w,k),k}function qk(e,o,f){var w,m=f.ca(),k=rk.bind(null,e);e=sk.bind(null,e),C(f,uh)?w=C(m,L)?k(m):m.ja.some(k):C(f,vh)?w=C(m,P)?e(m):m.ja.some(e):C(f,th)&&(w=e(zi(m))),w&&o.push(f)}function rk(e,o){t:{var f=o.X,m=Ei(e,o);if(!m){o=o.X.length;for(var w=0;w<o;w+=3)if(Ci(e,f[w],f[w+1])){e=!0;break t}}e=m}return e}function sk(e,o){return Fi(e,o)}function tk(e,o,f){for(var m=e.length;m--;){var w=e[m],k=w.ca();if(C(k,Ti)){for(var _e,Y=(k=k.ja).length;Y--;)if(Ci(o,(_e=k[Y]).lat,_e.lng)){f.push(w);break}}else Ci(o,k.lat,k.lng)&&f.push(w)}}Uj.State={ERROR:-1,LOADING:0,READY:1},Uj.prototype.getState=function(){return this.j},Uj.prototype.getState=Uj.prototype.getState,Uj.prototype.i=function(e,o){if(this.a=o.getData(),1===e){var f=this.g;f||(f=this.g=o.rb()),this.f||(this.f=new G(f.w/2|0,f.h))}this.b&&(this.j=e,delete this.b,this.dispatchEvent("statechange"))},Uj.prototype.a=y,Uj.prototype.Kc=function(){return this.a},Uj.prototype.getBitmap=Uj.prototype.Kc,Uj.prototype.rb=function(){return this.g||y},Uj.prototype.getSize=Uj.prototype.rb,Uj.prototype.f=y,Uj.prototype.fd=function(){return this.f},Uj.prototype.getAnchor=Uj.prototype.fd,Uj.prototype.c=y,Uj.prototype.hm=function(){return this.c},Uj.prototype.getHitArea=Uj.prototype.hm,Uj.prototype.o=function(){Uj.l.o.call(this),this.a?(this.a.removeAttribute("src"),delete this.a):(this.b.cancel(),delete this.b)},u(Wj,xg),Wj.prototype.m=function(e){for(var o,f,m=this.head,w=e;w;){if(e=w.entries)if(o=e.length){if(2>o&&(f=w.parent)&&1===f.a){f.removeChild(w),m===w&&(m=f),f.entries=e,w=e[0].node=f;continue}}else if(delete w.entries,(f=w.parent)&&(f.removeChild(w),m===w&&(m=f),1===f.a)){w=f.a?f[0]||f[1]||f[2]||f[3]:null;continue}break}this.head!==m&&(this.head=m,Cg(this))},Wj.prototype.rc=function(e,o){if(Hg(this.a,e,o,e,o))return Xj(this,this.a,e,o,this.c);throw Error("Coordinates out of bounds")},Zj.prototype.a=function(e){return this[e%2]},p=ak.prototype,p.th=0,p.Mc=function(){return this.th},p.Lf=null,p.J=function(){var o,e=this.Lf;return!e&&(o=yg(this.a))&&(this.Lf=e=new K(-o[0],o[3],-o[2],o[1])),e},p.rc=function(e){return++this.th,this.Lf=null,this.a.rc(e.lng,-e.lat)},p.remove=function(e){return(e=this.a.remove(e))&&(--this.th,this.Lf=null),e},p.Hf=function(e,o,f){var m=this.a,w=e.Gb(),k=e.Cb(),Y=-w.lat;w=w.lng;var _e=-k.lat;return k=k.lng,e.ub()?m.Va(-180,Y,k,_e,f,o).concat(m.Va(w,Y,180,_e,f,o)):m.Va(w,Y,k,_e,f,o)},u(Q,F),t("H.map.provider.Provider",Q),p=Q.prototype,p.A={fe:"configchange",xa:"update"},p.Sa=function(e,o){this.dispatchEvent(new ud(this.A.xa,o,e))},p.cb=function(){this.dispatchEvent(this.A.fe)},p.o=function(){F.prototype.o.call(this),this.a&&(this.a.removeEventListener("change",this.cb),delete this.a)},p.ba=function(){return null},Q.prototype.getCopyrights=Q.prototype.ba,Q.prototype.getCapabilities=function(){var e=0;return this.Uh()&&(e|=Oj.PROVIDES_BY_VIEWPORT),this.providesRasters()&&(e|=Oj.PROVIDES_RASTERS),this.providesSpatials()&&(e|=Oj.PROVIDES_SPATIALS),this.providesOverlays()&&(e|=Oj.PROVIDES_OVERLAYS),this.providesMarkers()&&(e|=Oj.PROVIDES_MARKERS),this.providesDomMarkers()&&(e|=Oj.PROVIDES_DOM_MARKERS),this.providesGeoJSON()&&(e|=Oj.PROVIDES_GEOJSON),this.providesOMV()&&(e|=Oj.PROVIDES_OMV),e},Q.prototype.getCapabilities=Q.prototype.getCapabilities,Q.prototype.Uh=hf,Q.prototype.Qe=hf,Q.prototype.providesRasters=Q.prototype.Qe,Q.prototype.vc=hf,Q.prototype.providesSpatials=Q.prototype.vc,Q.prototype.Wh=hf,Q.prototype.providesOverlays=Q.prototype.Wh,Q.prototype.Kb=hf,Q.prototype.providesMarkers=Q.prototype.Kb,Q.prototype.Jb=hf,Q.prototype.providesDomMarkers=Q.prototype.Jb,Q.prototype.Vh=hf,Q.prototype.providesGeoJSON=Q.prototype.Vh,Q.prototype.md=hf,Q.prototype.providesOMV=Q.prototype.md,Q.prototype.am=function(){return this.c},Q.prototype.getEngineType=Q.prototype.am,Q.prototype.Pe=kd,Q.prototype.preprocessData=Q.prototype.Pe,Q.prototype.g=1,Q.prototype.xm=function(){return this.g},Q.prototype.getOpacityInternal=Q.prototype.xm,Q.prototype.Pb=function(e,o){var f=this;if(this.c===ik.WEBGL&&!C(e,qi)||this.c===ik.HARP&&!C(e,H.map.render.harp.Style))throw e=Object.entries(ik).find(function(m){return m[1]===f.c}),new D(this.Pb,0,"Invalid style for engineType "+e);this.a&&(this.a.removeEventListener("change",this.cb),this.a.removeEventListener(Vh,this.cb)),this.a=e,this.a.addEventListener("change",this.cb),this.a.addEventListener(Vh,this.cb),o||this.cb(),this.ra=!1},Q.prototype.setStyleInternal=Q.prototype.Pb,Q.prototype.gb=function(){return this.a||kk(this),this.a},Q.prototype.getStyleInternal=Q.prototype.gb,Q.prototype.yj=function(){var e=this.getCapabilities(),o=lk.FEATURE;return e&Oj.PROVIDES_BY_VIEWPORT?o=lk.SOURCE:e&Oj.PROVIDES_RASTERS?o=null:e&Oj.PROVIDES_WEBGL_RENDERABLE_OBJECTS&&(o=lk.PROVIDER),o},Q.prototype.getPickingMode=Q.prototype.yj,Q.prototype.em=function(){return!1},Q.prototype.getFeatureProxy=Q.prototype.em,u(mk,Q),t("H.map.provider.ObjectProvider",mk),mk.prototype.Uh=gf,mk.prototype.providesByViewport=mk.prototype.Uh,mk.prototype.Eb=function(e){return this.V[e||oh.ANY]},mk.prototype.getInvalidations=mk.prototype.Eb,mk.prototype.Rd=function(e,o){if(o!==lh.NONE){var f=this.V[oh.ANY],m=f.a+1;f.update(m,o),(f=this.V[e.type]).update(m,o),e.Eb().update(m,o),this.Sa(e)}},mk.prototype.invalidateObject=mk.prototype.Rd,mk.prototype.requestOverlays=mk.prototype.pd,mk.prototype.requestSpatials=mk.prototype.ag,mk.prototype.requestSpatialsByTile=mk.prototype.bg,mk.prototype.ua=!1,mk.prototype.requestMarkers=mk.prototype.xc,mk.prototype.requestDomMarkers=mk.prototype.wc,u(N,mk),t("H.map.provider.LocalObjectProvider",N),N.prototype.getCapabilities=function(){return Oj.PROVIDES_BY_VIEWPORT|Oj.PROVIDES_WEBGL_RENDERABLE_OBJECTS|Oj.PROVIDES_DOM_MARKERS|Oj.CROP_LINES_BY_TILE},N.prototype.gb=function(){if(!this.B&&(this.B=N.l.gb.call(this),this.B instanceof qi)){var e=new fk(this.getCapabilities()|Oj.HAS_VOLATILE_DATA,this.uid+"_vol",this.max,this.g,this.tileSize);this.B.Je(gk(e))}return this.B},N.prototype.getStyleInternal=N.prototype.gb,N.prototype.Wb=function(){return this.f},N.prototype.getRootGroup=N.prototype.Wb,N.prototype.Rd=function(e,o){o&lh.SPATIAL&&this.aa(e),N.l.Rd.call(this,e,o)},N.prototype.invalidateObject=N.prototype.Rd,N.prototype.aa=function(e){var o;if(C(e,M,this.aa,0),e.la!==this)throw new Zc(this.aa,"foreign object");this.Da(e);var f=e.type;if(f===oh.MARKER)if((o=e.ca())instanceof mg){var m=!0;f=this.m}else f=this.s;else f===oh.DOM_MARKER?(o=e.ca())instanceof mg?(m=!0,f=this.S):f=this.da:f=f===oh.OVERLAY?this.u:this.i;(m=m?f.rc(o):f.Nj(e.J())).c=e,e.ua=m},N.prototype.Da=function(e){var o;if(e)if(e.la!==this){if(C(e,M))throw new Zc(this.Da,"foreign object")}else if(o=e.ua){var f=e.type;f===oh.MARKER?this.m.remove(o)||this.s.remove(o):f===oh.DOM_MARKER?this.S.remove(o)||this.da.remove(o):f===oh.OVERLAY?this.u.remove(o):this.i.remove(o),delete o.c,delete e.ua}},N.prototype.removeObject=N.prototype.Da,N.prototype.Wh=function(){return 0<this.u.Mc()},N.prototype.providesOverlays=N.prototype.Wh,N.prototype.pd=function(e,o,f){return nk(this,this.u,e,o,f,!1).filter(function(m){return m.Kc()})},N.prototype.requestOverlays=N.prototype.pd,N.prototype.vc=function(){return 0<this.i.Mc()},N.prototype.providesSpatials=N.prototype.vc,N.prototype.ag=function(e,o,f){return nk(this,this.i,e,o,f,!1)},N.prototype.requestSpatials=N.prototype.ag,N.prototype.bg=function(e,o){return nk(this,this.i,e.Af(),e.zL,o,!1)},N.prototype.requestSpatialsByTile=N.prototype.bg,N.prototype.Kb=function(){return 0<this.m.Mc()+this.s.Mc()},N.prototype.providesMarkers=N.prototype.Kb,N.prototype.xc=function(e,o,f){return ok(this,e,o,f,!1)},N.prototype.requestMarkers=N.prototype.xc,N.prototype.Jb=function(){return 0<this.S.Mc()+this.da.Mc()},N.prototype.providesDomMarkers=N.prototype.Jb,N.prototype.wc=function(e,o,f){return pk(this,e,o,f,!1)},N.prototype.requestDomMarkers=N.prototype.wc,N.prototype.Pa=function(e,o,f,m,w){var k=this,Y=e.J(),_e=[],_o=Zb(),_u=1;if(Y)for(;_u&oh.ANY;){if(_u&m)switch(_u){case oh.MARKER:_o=_o.then(function(){return ok(k,Y,f,o,!0)}).then(function(pd){return tk(pd,e,_e)});break;case oh.DOM_MARKER:_o=_o.then(function(){return pk(k,Y,f,o,!0)}).then(function(pd){return tk(pd,e,_e)});break;case oh.SPATIAL:_o=_o.then(function(){return nk(k,k.i,Y,f,o,!0)}).then(function(pd){pd.forEach(qk.bind(null,e,_e))});break;case oh.OVERLAY:_o=_o.then(function(){return nk(k,k.u,Y,f,o,!0)}).then(function(pd){pd.forEach(qk.bind(null,e,_e))})}_u<<=1}_o.then(function(){return w(_e)})},N.prototype.o=function(){N.l.o.call(this),this.f.ma()};var uk={PENDING:0,ACTIVE:1,DONE:2};function vk(e,o){var f;if(o=o||{},!C(e,Element))throw new D(vk,0,e);var m=e.ownerDocument.createElement("div");this.P=e,vk.l.constructor.call(this),this.padding=new wk(0,0,0,0),this.center=new G(0,0),this.margin=0,this.element=m,m.style.zIndex=0,m.style.height=m.style.width="100%",m.style.direction="ltr",m.style.position="relative"===e.style.position?"absolute":"relative",this.resize(),e.appendChild(m),(f=o.padding)!==B&&this.li(f.top,f.right,f.bottom,f.left),this.gi((f=o.margin)!==B?f:0)}function xk(e){var o=e.padding;e.center.set((e.width+o.left-o.right)/2<<0,(e.height+o.top-o.bottom)/2<<0)}function yk(e,o,f,m,w,k){var Y;for(Y=[];m<=w;m++)Y=Y.concat(zk(e,f,m));for(vj.call(this,k,e=Y.length),this.m=f=[],this.g=z(this.g,this),this.f=z(this.f,this),this.O(1);e--;)f.push(Ak(o,(k=Y[e])[0],k[1],k[2],this.g,this.f))}function Bk(e,o){var f=this;if(!Da(o))throw new D(Ck,1,o);if(!Da(e.next||Da(e.cycle)))throw new D(Bk,2,'Argument "mode" must implement H.util.AsyncQueue.Mode');this.b=[],this.c=[],this.g=e,this.i=o,this.j=function(){Dk(f)},this.a=null,this.f=function(){f.a||(f.a=x.setTimeout(f.j,1))}}function Dk(e){var o=e.c,f=0,m=e.g;for(m.a(),e.a=null;f<o.length;){var w=o[f];w.Sj?o.splice(f,1):f++}for(;w=m.next(e.b,e.c);)w.cancelled?w.done(null,"cancelled"):(o.push(w),e.i(w,w.data))}function Fk(){Ek(this,null,null,null)}function Ek(e,o,f,m){return e.data=o,e.cancelled=!1,e.Sj=!1,e.b=f,e.c=m,e.a=null,e}function Gk(){}t("H.map.render.RenderState",uk),u(vk,F),t("H.map.ViewPort",vk),vk.prototype.A={xa:"update",ie:"sync"},vk.prototype.gi=function(e){if(this.margin!==+e){if(E(this.margin=+e))throw new D(this.gi,0,e);xk(this),this.dispatchEvent(this.A.xa)}},vk.prototype.setMargin=vk.prototype.gi,vk.prototype.li=function(e,o,f,m){var w=this.padding;if(w.top!==e||w.right!==o||w.bottom!==f||w.left!==m){if(E(e+o+f+m))throw new D(this.li);w.top=e,w.right=o,w.bottom=f,w.left=m,xk(this),this.dispatchEvent(this.A.xa)}},vk.prototype.setPadding=vk.prototype.li,vk.prototype.resize=function(){var e=this.P.offsetWidth,o=this.P.offsetHeight;(this.width!==e||this.height!==o)&&(this.a=new Ui(this.width,this.height),this.width=e,this.height=o,xk(this),this.dispatchEvent(this.A.xa))},vk.prototype.resize=vk.prototype.resize,vk.prototype.Wa=function(e){this.dispatchEvent(new bj(this.A.ie,this.a,e,cj.SIZE))},vk.prototype.synchronize=vk.prototype.Wa,vk.prototype.o=function(){this.P.removeChild(this.element),delete this.P,delete this.element,vk.l.o.call(this)},vk.prototype.gc=Pc,vk.prototype.startInteraction=vk.prototype.gc,vk.prototype.Xb=Pc,vk.prototype.interaction=vk.prototype.Xb,vk.prototype.pb=Pc,vk.prototype.endInteraction=vk.prototype.pb,u(yk,vj),yk.prototype.g=function(){xj(this,2)},yk.prototype.f=function(){xj(this,4)},yk.prototype.ke=function(){for(var e=this.m,o=e.length;o--;)e[o].cancel();delete this.m},t("H.util.AsyncQueue",Bk),Bk.prototype.push=function(e,o){if(!Da(o))throw new D(this.push,1,o);return e=Ek(new Fk,e,this.f,o),this.b.push(e),this.f(),e},Bk.prototype.push=Bk.prototype.push,Bk.Task=Fk,Fk.prototype.done=function(e,o){this.Sj=!0,this.b(),this.c(this,e,o)},Fk.prototype.done=Fk.prototype.done,Fk.prototype.cancel=function(){this.a&&this.a(),this.cancelled=!0},Fk.prototype.cancel=Fk.prototype.cancel,Fk.prototype.eo=function(e){return this.a=e,this},Fk.prototype.setCancelFn=Fk.prototype.eo,Bk.Mode=Gk,Gk.prototype.next=function(){},Gk.prototype.a=function(){};var Hk,Ik=function(){function e(){}for(var o,f,m,w=tc("o ms moz webkit "),k=5;k--&&!o;)o=(f=x[(o=w[k])+(o?"R":"r")+"equestAnimationFrame"])&&!E(f.call(window,e))&&(m=x[o+(o?"C":"c")+"ancelAnimationFrame"]);return Hk=o?function(Y){return f.call(x,Y)}:function(Y){return x.setTimeout(Y,25)},o?function(Y){return m.call(x,Y)}:function(Y){return x.clearTimeout(Y)}}(),Jk=x.performance&&x.performance.now?function(){return x.performance.now()}:function(){return x.Date.now()};function Kk(e,o){Kk.l.constructor.call(this,new Lk(e),o)}function Lk(e){if(isNaN(e)||0>e)throw new D(Kk,1,'Argument "maxTime" must be a positive number');this.c=e,this.b=Jk()}function Mk(e){if(wc(this,Mk),Mk.l.constructor.call(this,e),e&&"tileSize"in e){var o=Dd(+e.tileSize)/Nd;if(isNaN(o)||o%1||0>o||30<o)throw new D(Mk,0,"tileSize: "+e.tileSize);this.tileSize=+e.tileSize}}function Nk(e,o){return Xd(e)-8-zd(Xd(o))}function Ok(){}function Pk(e,o,f){if(this.g=[],o&&this.Yd(o),f&&!Da(f))throw new D(Pk,2,f);this.b=0,this.filter=f,this.a={},this.f=this.c=null,this.ii(e)}function Rk(e,o){return o&&(e.c=Sk(e,o,e.c)),o}function Tk(e){for(;e.b>e.i&&e.f;)Uk(e,e.f,!0)}function Sk(e,o,f){return f!==o&&((o.$b||o.Uc)&&Uk(e,o,!1),(o.$b=f)&&(o.Uc=f.Uc,f.Uc=o),o.Uc||(e.c=o),o.$b||(e.f=o),e.b+=o.size),o}function Uk(e,o,f){var m=o.Uc,w=o.$b;(m||w||o==e.c&&o==e.f)&&(m?m.$b=w:e.c=w,w?w.Uc=m:e.f=m,e.b-=o.size,f&&(delete e.a[o.id],Qk(e,o))),o.$b=o.Uc=null}function Qk(e,o){for(var f=e.g.length;f--;)e.g[f].call(e,o.id,o.data,o.size)}function Vk(e,o,f,m){this.key="",this.x=e,this.y=o,this.z=f,this.data=m,this.valid=!0}function Wk(e,o,f,m){return(e-=f)*e+(o-=m)*o}function Xk(e,o,f){return Yk(e,o*o,f||0,0,e.length-1)}function Yk(e,o,f,m,w){var k=0,Y=m,_e=e[m].x,_o=e[m].y,_u=e[w].x,pd=e[w].y,iy=m+1,sy=Wk(_e,_o,_u,pd);if(sy)for(;iy<w;){var gy=e[iy++],wy=gy.x,Ey=((wy-_e)*(_u-_e)+((gy=gy.y)-_o)*(pd-_o))/sy;(wy=0>Ey?Wk(wy,gy,_e,_o):1<Ey?Wk(wy,gy,_u,pd):Wk(wy,gy,_e+Ey*(_u-_e),_o+Ey*(pd-_o)))>k&&(k=wy,Y=iy-1)}else for(;iy<w;)(wy=Wk(wy=(gy=e[iy++]).x,gy=gy.y,_e,_o))>k&&(k=wy,Y=iy-1);return k>=o||0<f&&Y-m?(--f,1<Y-m?(m=Yk(e,o,f,m,Y)).splice(m.length-1,1):m=[e[m]],m=m.concat(1<w-Y?Yk(e,o,f,Y,w):e.slice(Y,w+1))):m=[e[m],e[w]],m}function Zk(e,o,f,m,w,k,Y,_e){Zk.l.constructor.call(this,o,f,m,null),this.key=e,this.R=_e,this.a=w,this.g=k,this.i={},this.zL=Y,this.s=Bd(O.MAX_LINE_WIDTH/2*this.g+1)}function $k(e){return e.R.getInvalidations(oh.SPATIAL)}function al(e){var k,o=$k(e),f=o.a,m=e.c,w=m===f;if(!(w||o.Pj(m)||o.oh(m))){w=e.f;var Y=e.i;if(o.Jf(m))for(k=w.length;k--;){var _e=w[k];if(_e.Eb().Jf(m)){w.splice(k,1);var _o=_o||bl(e,_e.$a())}}if(o.ph(m)){for(k=w.length;k--;)if((_e=w[k]).Eb().ph(m)){var _u=1;if((_e=Y[_e.$a()])&&_e.a){_o=1;break}}_u&&w.sort(cl)}if(!_o&&o.Td(m))for(k=w.length;k--;)if(w[k].Eb().Td(m)){var pd=1;break}e.u!==m||pd||(e.u=f,e.b!==m||_o||(e.b=f)),e.c=f,w=!0}return w}function dl(e,o){this.b=e,this.a=o}function bl(e,o){var f=(e=e.i)[o];if(f)return delete e[o],f.a}function el(e){var w,o=$k(e),f=e.c,m=e.f;if(!al(e)){for(w=m.length;w--;){var k=m[w],Y=k.Eb();(Y.Jf(f)||Y.oh(f))&&bl(e,k.$a())}e.f=e.R.requestSpatialsByTile(e,!1,!1).sort(cl),e.c=o.a}}function cl(e,o){return ph(e.Pc(),o.Pc(),!1)}u(Kk,Bk),t("H.util.SequentialQueue",Kk),Lk.prototype.next=function(e){return e.length&&Jk()-this.b<this.c?e=e.shift():null},Lk.prototype.a=function(){this.b=Jk()},u(Mk,Q),t("H.map.provider.TileProvider",Mk),Mk.getZoomLevelOffset=Nk,Mk.prototype.requestTile=Mk.prototype.Qa,Mk.prototype.cancelTile=Mk.prototype.hc,Mk.prototype.cancelTileByKey=Mk.prototype.le,Mk.prototype.createTileInternal=Mk.prototype.Ub,Mk.prototype.hd=function(e,o,f){return this.uri.concat("_",e,"_",o,"_",f)},Mk.prototype.getTileKey=Mk.prototype.hd,Mk.prototype.ef=256,Mk.prototype.tileSize=Mk.prototype.ef,t("H.util.ICache",Ok),Ok.prototype.add=function(){},Ok.prototype.add=Ok.prototype.add,Ok.prototype.get=function(){},Ok.prototype.get=Ok.prototype.get,Ok.prototype.sf=function(){},Ok.prototype.drop=Ok.prototype.sf,Ok.prototype.forEach=function(){},Ok.prototype.forEach=Ok.prototype.forEach,Ok.prototype.ma=function(){},Ok.prototype.removeAll=Ok.prototype.ma,Ok.prototype.Yd=function(){},Ok.prototype.registerOnDrop=Ok.prototype.Yd,Ok.prototype.Mg=function(){},Ok.prototype.deRegisterOnDrop=Ok.prototype.Mg,t("H.util.Cache",Pk),Pk.prototype.add=function(e,o,f){var m,w;if(!Ec(f=+f)||0>f)throw new D(this.add,2,f);return e=String(e),(w=!this.filter||this.filter(e,o,f))&&((m=this.a[e])?(m.data!==o&&Qk(this,m),this.b+=f-m.size,m.size=f,m.data=o,Rk(this,m)):this.a[e]=Sk(this,{id:e,data:o,size:f,$b:null,Uc:null},this.c),Tk(this)),w},Pk.prototype.add=Pk.prototype.add,Pk.prototype.Yd=function(e){if(!Da(e))throw new D(this.Yd,0,e);this.g.push(e)},Pk.prototype.registerOnDrop=Pk.prototype.Yd,Pk.prototype.Mg=function(e){this.g=this.g.filter(function(o){return o!==e})},Pk.prototype.deRegisterOnDrop=Pk.prototype.Mg,Pk.prototype.get=function(e,o){return(e=o?this.a[e]:Rk(this,this.a[e]))&&e.data},Pk.prototype.get=Pk.prototype.get,Pk.prototype.sf=function(e){var o;(o=this.a[e])&&Uk(this,o,!0)},Pk.prototype.drop=Pk.prototype.sf,Pk.prototype.forEach=function(e,o,f){var m;for(m in this.a){var w=this.a[m];(!f||f(m,w.data,w.size))&&e.call(o,m,w.data,w.size)}},Pk.prototype.forEach=Pk.prototype.forEach,Pk.prototype.ma=function(e){var o;for(o in this.a){var f=this.a[o];(!e||e(o,f.data,f.size))&&Uk(this,this.a[o],!0)}},Pk.prototype.removeAll=Pk.prototype.ma,Pk.prototype.ii=function(e){if(!(0<+e))throw new D(Pk.prototype.ii,0,e);return this.i=+e,Tk(this),this},Pk.prototype.setMaxSize=Pk.prototype.ii,Pk.prototype.vm=function(){return this.i},Pk.prototype.getMaxSize=Pk.prototype.vm,Pk.prototype.Wl=function(){return this.b},Pk.prototype.getCurrentSize=Pk.prototype.Wl,t("H.map.provider.Tile",Vk),t("H.math.simplifyDP",Xk),u(Zk,Vk),t("H.map.provider.SpatialTile",Zk),Zk.prototype.c=Wd,Zk.prototype.u=Wd,Zk.prototype.b=Wd,Zk.prototype.Sd=function(){var e=$k(this),o=e.a,f=this.b,m=f===o;return m||(this.R.ua&&!e.Td(f)?m=!0:al(this)&&(m=this.b===o)),m},Zk.prototype.isCanvasValid=Zk.prototype.Sd,Object.defineProperty(Zk.prototype,"valid",{get:function(){return this.Sd()},set:kd,configurable:!0}),Zk.prototype.f=jf,Zk.prototype.Pa=function(){return this.f},Zk.prototype.getObjects=Zk.prototype.Pa,Zk.prototype.Sm=function(){return this.a},Zk.prototype.getTileSize=Zk.prototype.Sm;var fl={};function hl(e,o,f,m,w,k,Y,_e,_o){var _u=e.a,pd=-Y;if(Y=k+Y,_e=_e||0,_o===B&&(_o=_u.length),w&&e===Gh)o.fillRect(0,0,k,k);else if(_o>_e){for(o.beginPath(),k=_e;k<_o;k++){var iy=_u[k],sy=iy.length;if(iy===Nh)o.moveTo(pd,pd),o.lineTo(pd,Y),o.lineTo(Y,Y),o.lineTo(Y,pd);else{var gy=iy[0];for(o.moveTo(gy.x,gy.y),_e=1;_e<sy;_e++)o.lineTo((gy=iy[_e]).x,gy.y)}f&&o.closePath()}f&&w&&o.fill(e.b!==Vd?"evenodd":"nonzero"),m&&o.stroke()}}function gl(e,o,f){var m;e.strokeStyle=o.strokeColor,e.lineWidth=o.lineWidth*f,e.lineCap=o.lineCap,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.setLineDash&&(m=o.lineDash)!==jf&&(e.setLineDash(m),e.lineDashOffset=o.lineDashOffset)}function il(e,o){e.fillStyle=o.fillColor}function jl(e,o,f,m,w,k){var Y=w*m.width/2,_e=(w=w*m.length/2)/2;m=2*w*m.frequency;var _o=Ed(Fd(w,2)+Fd(Y,2));e=new wk(_o,_o,e=e.a-_o,e);var _u,pd,iy,sy,gy,wy,Ey,Py=Od/2;for(k=k||0,_o=(f=f.a).length;_o-- >k;){var Jy=0,_m=f[_o];if(pd=_u=_m.length){var y0=_m;for(pd=y0.length,iy=0;--pd;)iy+=y0[pd].Ta(y0[pd-1]);pd=(y0=iy)>=m}if(pd)for(iy=(pd=y0/((pd=xd(Ad(y0/m),1e3))+1))/2;--_u;){for(sy=(gy=_m[_u]).Ta(wy=_m[_u-1]);iy<=Jy+sy;){var Oy=gy.x+(wy.x-gy.x)*(Ey=(iy-Jy)/sy);e.pf(Oy,Ey=gy.y+(wy.y-gy.y)*Ey)&&(o.save(),o.translate(Oy,Ey),o.rotate(-Ld((wy.y-gy.y)/(gy.x-wy.x))+(gy.x<wy.x?Py:-Py)),o.beginPath(),o.moveTo(-Y,-w),o.lineTo(0,w),o.lineTo(Y,-w),o.lineTo(0,-_e),o.closePath(),o.fill(),o.restore()),iy+=pd}Jy+=sy}}}Zk.prototype.Ge=function(){var e=this.a+"_"+this.g,o=fl[e];if(!o){var f=this.a-(o=-this.s);o=fl[e]=new wk(o,o,f,f)}return o},Zk.prototype.getPxClipRect=Zk.prototype.Ge,Zk.prototype.Af=function(){var e=this.Xa;if(!e){var o=this.Cf();e=0;var f=this.a;this.z&&(f-=e+=this.Ge().top),e=this.Xa=tg(o.Me(new G(e,e)),o.Me(new G(f,f)))}return e},Zk.prototype.getGeoClipRect=Zk.prototype.Af,Zk.prototype.Cf=function(){var e=this.v;if(!e){var o=this.a;(e=this.v=new lj(B,o)).Ka(this.z),e.x=this.x*o,e.y=this.y*o}return e},Zk.prototype.getPxProj=Zk.prototype.Cf,Zk.prototype.Ua=function(){return this.g},Zk.prototype.getPixelRatio=Zk.prototype.Ua,Zk.prototype.Xf=function(){var e=this.data;return e&&(this.data=null,this.b=Wd),e},Zk.prototype.releaseCanvas=Zk.prototype.Xf,Zk.prototype.Yf=function(){this.i={},delete this.f,this.c=Wd},Zk.prototype.releaseData=Zk.prototype.Yf,Zk.prototype.T=function(e){var f,m,w,k,o=e.getContext("2d"),Y=0;if(el(this),this.b<this.c){var _e=this.f;if(f=_e.length){e.width=e.height=this.a,o.clearRect(0,0,this.a,this.a);var _o=this.i;for(m=0;m<f;m++){var _u=_e[m],pd=_u.$a();if(k=(w=_o[pd])?w.b:_u.getGeometriesForTile(this)){if(w)_u.Eb().Td(this.b)&&(w.a=Fh(_u,k)),w=w.a;else{w=Fh(_u,k);for(var iy,sy=k,gy=_u.g?2:0,wy=sy.length;wy--;){var Ey=sy[wy];if(Ey!==Gh){var Py=Ey.a;for(iy=Py.length;iy--;)4<(Ey=Py[iy]).length&&(Py[iy]=Xk(Ey,.6,gy))}}this.i[pd]=new dl(k,w)}if(w){for(o.save(),sy=_u.g?this.B:this.S,pd=0;pd<k.length;pd++)sy.call(this,_u,k[pd],_u.ea(),o);if(k=_u.getLabels(this))for(_u=o,pd=k.length;pd--;)for(_u.font=(sy=(gy=k[pd]).size)+"px "+gy.font,_u.fillStyle=gy.color,_u.textAlign="center",_u.translate(gy.x,gy.y),_u.rotate(gy.angle),sy=gy.lineHeight||1.375*sy,gy=(wy=gy.lines).length;gy--;)_u.fillText(wy[gy],0,gy*sy);o.restore()}Y|=+w}}}this.data=Y?e:null,this.u=this.b=this.c}else this.data&&(Y=1);return 0<Y},Zk.prototype.render=Zk.prototype.T,Zk.prototype.data=null,Zk.prototype.S=function(e,o,f,m){var w;f.b&&(gl(m,f,this.g),hl(o,m,!1,!0,!1,this.a,this.s)),f.a&&(w=e.c)&&w.Hb&&(il(m,w),jl(this,m,o,w,f.lineWidth))},Zk.prototype.B=function(e,o,f,m){var Y,w=f.Hb,k=f.b,_e=this.a,_o=this.s;if(o===Gh)w&&(il(m,f),m.fillRect(0,0,_e,_e));else{if(k&&gl(m,f,this.g),f.a&&(Y=e.c)){var _u=f.lineWidth;Y.Hb||(Y=null)}(e=o.c)===Vd?((k||w)&&(il(m,f),hl(o,m,!0,k,w,_e,this.s)),Y&&(il(m,Y),jl(this,m,o,Y,_u,0))):(w&&(il(m,f),hl(o,m,!0,!1,w,_e,_o,0,e)),k&&hl(o,m,!1,k,!1,_e,_o,e),Y&&(il(m,Y),jl(this,m,o,Y,_u,e)))}};var kl=[];function ll(e,o){var f;ll.l.constructor.call(this,o),this.v=e,this.S=e=o.pixelRatio,this.tileSize=f=1<<zd(Xd((o.tileSize||256)*e)),this.K=Nk(f,e),this.wh=z(this.wh,this),this.Mh=z(this.Mh,this),this.xh=z(this.xh,this),this.vh=z(this.vh,this),this.s=z(this.s,this),this.v.addEventListener(Q.prototype.A.xa,this.s,!1,this),this.f=[],this.i=new Pk(o.tileCacheSize||256,this.wh),this.m=new Pk(o.dataCacheSize||512,this.Mh),this.B=new Kk(20,this.xh),this.b={},this.u=Jk()}function wk(e,o,f,m){this.left=+e,this.top=+o,this.right=+f,this.bottom=+m}function ml(e,o){return new wk(e.x,e.y,o.x,o.y)}function nl(e,o){if(o=o||{},!e)throw new D(nl,0,e);this.tileSize=e.tileSize,this.a={},oj.call(this,{min:void 0!==o.min?o.min:e.min,max:void 0!==o.max?o.max:e.max,minWorldSize:this.tileSize,projection:o.Vf,dark:o.dark,provider:e})}function ol(e,o,f,m,w){m=Ad(m);var k=Fd(2,m),Y=o.left,_e=o.top,_o=o.right;f=_o+(f?k+(_o===o.left?0:1):1);var _u=o.bottom,pd=[];if(w)var iy=Y+(1+_o-Y)/2+w.x/e.tileSize-.5,sy=_e+(1+_u-_e)/2+w.y/e.tileSize-.5;for(;Y<f;){for(_e=o.top;_e<=_u;)pd.push([e=Y%k,_e,m,w?Cd(iy-Y)+Cd(sy-_e):0]),_e++;Y++}return pd}function zk(e,o,f){f=Ad(f),e.pixelProjection.Ka(f),o=e.we(o);var m=e.Qd(o,f);return ol(e,m,o.left>o.right,f)}function pl(e,o){return o[3]-e[3]}function ql(e,o){nl.call(this,e,o)}function rl(e,o){(o=o?Wa(o):{}).tileSize=o.tileSize||256,o.pixelRatio=o.pixelRatio||Ue(),o.max=24,this.a=new ll(e,o),this.b=new ql(this.a),o.minWorldSize=this.a.tileSize,o.provider=e,rl.l.constructor.call(this,o),this.tileSize=this.b.tileSize,this.c=z(this.c,this),this.a.addEventListener(this.a.A.xa,this.c),e.addEventListener(e.A.xa,this.c)}Zk.prototype.Ba=function(e,o,f){for(var k,Y,_e,_o,_u,pd,sy,m=this.f,w=m.length,iy=jf,gy=this.g;w--;)if((Y=m[w]).pc(!0)&&(_e=this.i[Y.$a()])&&(_o=_e.b)){for(pd="none"!==(k=Y.ea()).fillColor&&Y.g,sy="none"===k.strokeColor?0:k.lineWidth*gy,k=_o.length;k--;){var wy;if(_u=_o[k],!(wy=pd&&_u===Gh)&&(wy=pd||sy)){var Ey;wy=e;var Py=o,Jy=pd,_m=sy,y0=_u.b,Oy=_u.c,K0=Oy!==Vd,I0=_u.a,p1=I0.length,N_=0,q1=0,Uw=!1;for(_u=0;_u<p1;_u++){var K_=I0[_u],F_=_u>=Oy,Px=!F_&&_u>=y0;if(K_===Nh&&Jy)Px?N_++:q1++;else{var S1=K_.length;for(kl.length=2*S1,Ey=0;Ey<S1;Ey++){var zE=K_[Ey];kl[2*Ey]=zE.x,kl[2*Ey+1]=zE.y}if(Ey=Jy&&!F_,F_=K0&&!F_?0:_m,Ey||F_){if((F_=de(wy,Py,kl,F_,Ey))===ce.EDGE||F_===ce.VERTEX){Uw=!0;break}if(F_===ce.SURFACE)if(Px)N_++;else if(q1++,y0===Vd)break}}}wy=Uw||0<q1&&!(N_%2)}if(wy){iy===jf&&(iy=[]),iy.push(Y);break}}if(f&&iy.length)break}return iy},u(ll,Mk),ll.prototype.s=function(e){(e=e.target).type===oh.SPATIAL&&this.Sa(e)},ll.prototype.Qa=function(e,o,f,m){var k,w=this.getTileKey(e,o,f);if(k=this.i.get(w,m)){if(m||k.Sd())return k;m||this.i.sf(w)}if((k=this.m.get(w,m))&&(m||al(k)))return e=this.f.pop()||document.createElement("canvas"),k.T(e)||this.f.push(e),this.i.add(w,k,1),k;m||((k=this.b[w])?k.count++:((k=this.B.push([w,e,o,f],this.vh)).count=1,this.b[w]=k))},ll.prototype.requestTile=ll.prototype.Qa,ll.prototype.Ub=function(){},ll.prototype.createTileInternal=ll.prototype.Ub,ll.prototype.hc=function(e,o,f){this.le(this.getTileKey(e,o,f))},ll.prototype.cancelTile=ll.prototype.hc,ll.prototype.le=function(e){var o;(o=this.b[e])&&(o.count--,o.count||(o.cancel(),delete this.b[e]))},ll.prototype.cancelTileByKey=ll.prototype.le,p=ll.prototype,p.xh=function(e,o){var f=o[0],m=o[1],w=o[2],k=o[3];m=(f=this.i.get(f)||new Zk(f,m,w,k,this.tileSize,this.S,k+this.K,this.v)).data||this.f.pop()||document.createElement("canvas"),f.T(m)||this.f.push(m),o.push(f),e.done(f)},p.vh=function(e,o){e=e.data[0],o&&this.i.add(e,o,1),delete this.b[e],this.Sa()},p.wh=function(e,o){o.data&&this.f.push(o.Xf()),this.m.add(e,o,1)},p.Mh=function(e,o){o.Yf()},p.o=function(){for(var e in this.b)this.b[e].cancel();this.i.ma(),this.m.ma(),this.f.length=0,ll.l.o.call(this)},t("H.math.Rect",wk),wk.prototype.set=wk,wk.prototype.set=wk.prototype.set,wk.prototype.Gb=function(){return this.b||(this.b=new G(this.left,this.top))},wk.prototype.getTopLeft=wk.prototype.Gb,wk.prototype.Cb=function(){return this.a||(this.a=new G(this.right,this.bottom))},wk.prototype.getBottomRight=wk.prototype.Cb,wk.prototype.pf=function(e,o){return this.left<=e&&this.right>=e&&this.top<=o&&this.bottom>=o},wk.prototype.containsXY=wk.prototype.pf,wk.fromPoints=ml,wk.prototype.clone=function(){return new wk(this.left,this.top,this.right,this.bottom)},wk.prototype.clone=wk.prototype.clone,u(nl,oj),t("H.map.layer.BaseTileLayer",nl),nl.prototype.we=function(e,o){var f=this.pixelProjection;if(!C(e,K))throw new D(this.we,0,e);if(!E(o)){var m=f.Hj();f.Ka(o)}return e=ml(f.eb(e.Gb()),f.eb(e.Cb())),!E(m)&&f.Ka(m),e},nl.prototype.geoRectToRect=nl.prototype.we,nl.prototype.Qd=function(e,o){var f=Fd(2,Ad(o)),m=this.tileSize;if(!C(e,wk))throw new D(this.Qd,0,e);if(E(o=+o))throw new D(this.Qd,1,o);(o=Ad(e.left/m))===f&&--o;var w=Ad(e.right/m);return w===f&&--w,new wk(o,$d(Ad(e.top/m),0,f-1),w,$d(Ad(e.bottom/m),0,f-1))},nl.prototype.getTileBounds=nl.prototype.Qd,nl.prototype.Qa=function(e,o,f,m){return this.la.requestTile(e,o,f,m)},nl.prototype.requestTile=nl.prototype.Qa,nl.prototype.hc=function(e,o,f){this.la.cancelTile(e,o,f)},nl.prototype.cancelTile=nl.prototype.hc,nl.prototype.ba=function(e,o){return this.la.getCopyrights?this.la.getCopyrights(e,o):null},nl.prototype.getCopyrights=nl.prototype.ba,nl.prototype.Fe=function(e,o,f,m,w,k){var Y,_o,_e=[],_u=this.la;k=k??"__default__";var pd=_u.requestTile;if(!C(e,wk))throw new D(this.Fe,0,e);if(E(f=+f))throw new D(this.Fe,1,f);if(m||(Y={}),e=(o=ol(this,e,o,f,w)).length)for(m||o.sort(pl),f=e;f--;)w=o[f],m||(Y[_u.hd.apply(_u,w)]=!0),w[3]=+m,(_o=pd.apply(_u,w))&&_e.push(_o);if(!m){var iy;for(iy in m=Y,Y=this.a[k]||{})Y.hasOwnProperty(iy)&&Y[iy]&&!m[iy]&&this.la.cancelTileByKey(iy);this.a[k]=m}return{total:e,tiles:_e}},nl.prototype.getProviderTiles=nl.prototype.Fe,u(ql,nl),t("H.map.layer.TileLayer",ql),ql.prototype.qd=function(e,o,f,m,w){if(!C(e,K))throw new D(this.qd,0,e);if(E(o=+o))throw new D(this.qd,1,o);o=Ad(o),this.pixelProjection.Ka(o),e=this.we(e);var k=this.Qd(e,o);return this.Fe(k,e.left>e.right,o,f,m,w)},ql.prototype.requestTiles=ql.prototype.qd,u(rl,oj),t("H.map.layer.ObjectLayer",rl),rl.prototype.c=function(e){e.currentTarget!==this.a&&e.target.type===oh.SPATIAL||this.Sa()};var sl={markers:jf,total:0};rl.prototype.xc=function(e,o,f){var w,m=this.la;return m.providesMarkers()&&(w=m.requestMarkers(e,o,!0,f)).length?{markers:w,total:w.length}:sl},rl.prototype.requestMarkers=rl.prototype.xc,rl.prototype.wc=function(e,o,f){var w,m=this.la;return m.providesDomMarkers()&&(w=m.requestDomMarkers(e,o,!0,f)).length?{markers:w,total:w.length}:sl},rl.prototype.requestDomMarkers=rl.prototype.wc;var tl={tiles:jf,total:0};rl.prototype.qd=function(e,o,f,m){if(this.la.providesSpatials()){var w=this.b.qd(e,o,f,m);f||(f=this.a,33<(w=Jk())-f.u&&(Dk(f.B),f.u=w),w=this.b.qd(e,o,!0,m))}else w=tl;return w},rl.prototype.requestTiles=rl.prototype.qd,rl.prototype.Qa=function(e,o,f,m){return this.b.Qa(e,o,f,m)},rl.prototype.requestTile=rl.prototype.Qa,rl.prototype.hc=function(e,o,f){this.b.hc(e,o,f)},rl.prototype.cancelTile=rl.prototype.hc;var ul={overlays:jf,total:0};function S(e){wc(this,S),S.l.constructor.call(this,e),this.Qb=new vl,this.Sb=z(this.Sb,this),this.S=wl,this.createTileInternal=this.Ub.bind(this)}rl.prototype.pd=function(e,o,f){var m=this.la,w=ul;return m.providesOverlays&&m.providesOverlays()&&(o=(e=m.requestOverlays(e,o,!0,f)).length)&&(w={overlays:e,total:o}),w},rl.prototype.requestOverlays=rl.prototype.pd,rl.prototype.o=function(){this.a.D(),this.b.D(),this.la.dispose(),rl.l.o.call(this)},u(S,Mk),t("H.map.provider.RemoteTileProvider",S),S.prototype.Gd=function(){return 1},S.prototype.getEntryWeight=S.prototype.Gd;var wl=new Pk(65536),xl={},yl={};function Ak(e,o,f,m,w,k){return e.requestInternal(o,f,m=~~m,function(Y,_e){e.f().put(e.hd(o,f,m),{raw:_e&&_e.raw||Y,timestamp:x.Date.now()},w,k)},k,0)}function Al(e){delete xl[e],delete yl[e]}function zl(e){for(var o in xl)e.Sb(o)&&e.cancelTileByKey(o)}S.prototype.Db=function(){return this.S},S.prototype.getCache=S.prototype.Db,S.prototype.s=ca(3),S.prototype.Sb=function(e){var o=this.uri;return!e.indexOf(o)&&"_"===e.charAt(o.length)},S.prototype.cacheFilter=S.prototype.Sb,S.prototype.oa=function(e,o){o.valid=!1},S.prototype.reload=function(e){var o=this.getCache();e?o.ma(this.Sb):o.forEach(this.oa,this,this.Sb),zl(this),this.Sa(this,{isReload:!0})},S.prototype.reload=S.prototype.reload,S.prototype.m=function(){return!1},S.prototype.MAX_STORE_TIME=1/0,S.prototype.f=function(){return this.Qb},S.prototype.da=function(e,o){o(e)},S.prototype.requestInternal=S.prototype.G,S.prototype.Qa=function(e,o,f,m){var w=this,k=this.getCache();if(E(e=+e))throw new D(this.Qa,0,e);if(E(o=+o))throw new D(this.Qa,0,o);if(E(f=+f))throw new D(this.Qa,0,f);var Y=this.getTileKey(e,o,f=~~f);return(k=k.get(Y))&&k.valid||m||xl[Y]||(k=B,this.requestTileAsPromise(e,o,f,m).then(function(_e){w.Sa(_e)},kd)),k},S.prototype.requestTile=S.prototype.Qa,S.prototype.Gk=function(e,o,f,m){var _e,_o,w=this,k=this.getCache(),Y=this.getTileKey(e,o,f),_u=this.f();return yl[Y]?yl[Y]:(yl[Y]=_e=new Qb(function(pd,iy){function sy(gy){var Ey,wy=0,Py=function(Jy,_m){(Ey=w.createTileInternal(e,o,f,Jy,_m)).key=Y,k.add(Y,Ey,w.Gd(Jy)),pd(Ey),Al(Y)};gy&&(wy=x.Date.now()-gy.timestamp),gy&&wy<w.MAX_STORE_TIME?w.da(gy.raw,Py):(0<wy&&_u.remove(Y),(Ey=k.get(Y))&&Ey.valid||m?pd(Ey||null):xl[Y]=w.requestInternal(e,o,f,Py,iy))}_o=_u.get(Y,sy,sy)}),xl[Y]||(xl[Y]=_o),_e.then(function(){Al(Y)},function(){Al(Y)}),_e)},S.prototype.requestTileAsPromise=S.prototype.Gk,S.prototype.Fk=function(e,o){var f=this,m=e.id,w=e.tile.coords;return new Qb(function(k,Y){f.Gk(w.x,w.y,w.z,o).then(function(_e){for(var pd,_o=y,_u=(_e=_e.Pa?_e.Pa():_e.data).length;_u--;)if((pd=_e[_u]).$a()===m){_o=pd;break}k(_o)},Y)})},S.prototype.requestObjectAsPromise=S.prototype.Fk;var Bl={cancel:kd};function vl(){}function Ck(e){if(Ck.l.constructor.call(this,e),e&&(this.v={crossOrigin:e.crossOrigin||"anonymous",headers:e.headers||{}},this.u=e.getURL),!Da(this.u))throw new D(Ck,0,"getURL");if(jk(this,e.opacity),this.b=x.URL||x.webkitURL,!(e="anonymous"===(e=this.v.crossOrigin)||"use-credentials"===e)){e=this.u(0,0,0);var o=window.location,f=document.createElement("a");f.href=e,e=f.hostname===o.hostname&&f.port===o.port&&f.protocol===o.protocol}(this.K=e&&!!vf.arraybuffer&&!!this.b)&&this.Db().Yd(z(this.Y,this))}S.prototype.Ub=function(e,o,f,m){return new Vk(e,o,f,m)},S.prototype.createTileInternal=S.prototype.Ub,S.prototype.le=function(e){var o=xl[e];o&&(o.cancel(),Al(e))},S.prototype.cancelTileByKey=S.prototype.le,S.prototype.hc=function(e,o,f){this.cancelTileByKey(this.getTileKey(e,o,f))},S.prototype.cancelTile=S.prototype.hc,S.prototype.o=function(){S.l.o.call(this),this.getCache().ma(this.Sb),zl(this)},S.NullStorage=vl,vl.prototype.get=function(e,o){return o(),Bl},vl.prototype.get=vl.prototype.get,vl.prototype.put=function(e,o,f){f&&f()},vl.prototype.put=vl.prototype.put,vl.prototype.clear=function(e){e&&e()},vl.prototype.clear=vl.prototype.clear,vl.prototype.remove=function(e,o){o&&o()},vl.prototype.remove=vl.prototype.remove,u(Ck,S),t("H.map.provider.ImageTileProvider",Ck),Ck.prototype.cc=function(e){jk(this,e)},Ck.prototype.setOpacity=Ck.prototype.cc,Ck.prototype.Oc=function(){return this.g},Ck.prototype.getOpacity=Ck.prototype.Oc,Ck.prototype.Qe=gf,Ck.prototype.providesRasters=Ck.prototype.Qe,Ck.prototype.Gd=function(){return this.tileSize},Ck.prototype.getEntryWeight=Ck.prototype.Gd,Ck.prototype.G=function(e,o,f,m,w,k){var _o,Y=this,_e=this.u(e,o,f);if(e=Bl,_e){var _u=x.setTimeout(function(){Y.K?(_o=new uf("arraybuffer",_e,k,Y.v)).then(function(pd){return pd.blob()}).then(function(pd){var iy=new Image;iy.onload=z(m,null,iy,{raw:pd}),iy.onerror=z(w,null,"bad url");try{iy.src=Y.b.createObjectURL(pd)}catch{}},w):(_o=new uf("image",_e,k,Y.v)).then(m,w)},150);e={cancel:function(){_o?_o.cancel():x.clearTimeout(_u)}}}else m(null);return e},Ck.prototype.requestInternal=Ck.prototype.G,Ck.prototype.da=function(e,o){var f=new Image;f.onload=function(){o(this)},f.src=this.b.createObjectURL(e)},Ck.prototype.Y=function(e,o){(e=o.data)&&e instanceof HTMLImageElement&&this.b.revokeObjectURL(e.src)},t("H.util.events.listenOnce",Fe),t("H.util.events.dispatchEvent",function(e,o){return e.dispatchEvent(o)}),t("H.util.events.fireListeners",function(e,o,f,m){return oe(e)?e.ed(o,f,m):Oe(e,o,f,m)}),t("H.util.events.listen",Ee),t("H.util.events.unlisten",Me);var Cl=Pe;function Dl(e,o,f,m){var w=new wk(0,0,0,0);if(Dl.l.constructor.call(this),!e)throw new D(Dl,0,e);if(!o)throw new D(Dl,1,o);if(!f)throw new D(Dl,2,f);if("object"!=typeof m)throw new D(Dl,3,m+" is not an object");if("number"!=typeof m.pixelRatio)throw new D(Dl,3,m.pixelRatio+" is not a number");this.na=m.pixelRatio,this.zoom=0,this.bb=Dd(this.na)/Nd,this.b=new lj,this.ua={1:w.clone(),2:w.clone(),4:w.clone()},this.m=new G(.5,.5),this.f=e,El(this,this.na),this.gc=z(this.gc,this),this.Xb=z(this.Xb,this),this.pb=z(this.pb,this),e.startInteraction=this.gc,e.interaction=this.Xb,e.endInteraction=this.pb,e.addEventListener(e.A.xa,this.da,!1,this),this.getCapabilities=this.getCapabilities,this.capture=this.capture,this.zoomAt=this.ud,this.relaunch=this.fa,this.dispose=this.D,this.screenToGeo=this.Ra,this.geoToScreen=this.Aa,this.screenToLookAtData=this.fg,this.v=o,this.fc=z(this.fc,this),this.control=z(this.control,this),this.ob=z(this.ob,this),o.startControl=this.fc,o.control=this.control,o.endControl=this.ob,o.addEventListener(o.A.xa,this.Eg,!1,this),this.c=f,this.Pf=z(this.Pf,this),this.He=z(this.He,this),this.Ie=z(this.Ie,this),this.Of=z(this.Of,this),f.addEventListener(oj.prototype.A.xa,this.Pf,!1,this),f.addEventListener(f.A.ee,this.He,!1,this),f.addEventListener(f.A.ge,this.Ie,!1,this),f.addEventListener(f.A.he,this.Of,!1,this)}function El(e,o){var f=e.f,m=f.width,w=f.height,k=f.padding,Y=k.top,_e=k.left,_o=k.bottom,_u=-(m+_e-(k=k.right))/2<<0,pd=-(w+Y-_o)/2<<0;(e=e.ua)[1].set((_u-(f=f.margin))*o,(pd-f)*o,((m+=_u)+f)*o,((w+=pd)+f)*o),e[2].set(_u*o,pd*o,m*o,w*o),e[4].set((_u+_e)*o,(pd+Y)*o,(m-k)*o,(w-_o)*o)}function Gl(e,o){e.style.transition="opacity 1.5s",Fe(e,"transitionend",o,!1),e.style.opacity=0}Pe=function(e,o){var f,m,w=!0,k=o[o.currentTarget===o.target?"AT_TARGET":e.capture?"CAPTURING_PHASE":(f=!0,"BUBBLING_PHASE")];return(!f||"pointerenter"!==(m=o.type)&&"pointerleave"!==m)&&(o.eventPhase=k,w=Cl(e,o),f&&e.src&&e.src.Fb&&null===e.src.Fb()&&delete o.eventPhase),w},u(Dl,F),t("H.map.render.RenderEngine",Dl),Dl.prototype.ud=function(){},Dl.prototype.da=function(){El(this,this.na)},Dl.prototype.o=function(){var e=this.f,o=this.v,f=this.c;e.removeEventListener(e.A.xa,this.da,!1,this),e.startInteraction===this.gc&&(e.startInteraction=vk.prototype.gc),e.interaction===this.Xb&&(e.interaction=vk.prototype.Xb),e.endInteraction===this.pb&&(e.endInteraction=vk.prototype.pb),o.removeEventListener(o.A.xa,this.Eg,!1,this),o.startControl===this.fc&&(o.startControl=Fl.prototype.fc),o.control===this.control&&(o.control=Fl.prototype.control),o.endControl===this.ob&&(o.endControl=Fl.prototype.ob),f.removeEventListener(oj.prototype.A.xa,this.Pf,!1,this),f.removeEventListener(f.A.ee,this.He,!1,this),f.removeEventListener(f.A.ge,this.Ie,!1,this),f.removeEventListener(f.A.he,this.Of,!1,this)},Dl.prototype.ci=function(e){this.ug=e},Dl.prototype.setAnimationCallback=Dl.prototype.ci,Dl.prototype.Yh=function(){this.ug=void 0},Dl.prototype.resetAnimationCallback=Dl.prototype.Yh,Dl.prototype.control=function(){},Dl.prototype.capture=function(){return $b(Error("not implemented"))};var Hl={ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16};function Kl(e,o){return o.tilt=Ll(e,o.tilt),o.heading=Ml(e,o.heading),o.incline=e.getCapabilities().lookAt.incline.min,o}function Jl(e,o){var f=e.getCapabilities().lookAt.zoom;return $d(o,yd(f.min,e.wg),xd(f.max,e.vg))}function Ll(e,o){return $d(o,(e=e.getCapabilities().lookAt.tilt).min,e.max)}function Ml(e,o){return $d((o%360+360)%360,(e=e.getCapabilities().lookAt.heading).min,e.max)}function Il(e,o,f){(f=f?o.addEventListener:o.removeEventListener).call(o,o.A.Ji,e.Oh,!1,e),f.call(o,o.A.Ii,e.Oh,!1,e)}Dl.InteractionModifiers=Hl,p=Dl.prototype,p.A={Li:"render"},p.Pf=function(e){this.nk(e),this.fa()},p.He=function(e){this.Ke(e.idx,e.added)},p.Ie=function(e){this.Nh(e.idx,e.removed,e.type===this.c.A.he)},p.Of=function(e){e.removed&&this.Ie(e),this.He(e)},p.nk=kd,p.Ke=function(e,o){this.jh(e,o),0===e&&this.xb(),C(o,oj)&&Il(this,o,!0),this.$d(),this.fa()},p.xb=function(){var e=this.c.Ha();if(0<e.length){var o=e[0].max;this.wg=e[0].min,this.vg=o}else o=(e=this.getCapabilities().lookAt.zoom).max,this.wg=e.min,this.vg=o;(e=Jl(this,this.zoom))!==this.zoom&&(this.zoom=e,this.b.Ka(e),this.Wa())},p.Wa=function(e){this.S=this.fb(),e&&(this.S.position=e),this.S.zoom=this.zoom-this.bb,this.S.position.alt=0},p.dl=0,p.heading=180,p.fb=function(){return Kl(this,{position:this.b.projection.Uf(this.m),zoom:this.zoom,tilt:this.dl,heading:this.heading})},p.jh=kd,p.Nh=kd,p.fo=function(e,o){this.B={before:e,after:o}},Dl.prototype.setOnRenderCallbacks=Dl.prototype.fo;var Nl={P2D:0,WEBGL:1,HARP:2};Dl.EngineType=Nl;var Ol={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:85},incline:{min:0,max:0},heading:{min:0,max:360}},interaction:{ZOOM:Hl.ZOOM,COORD:Hl.COORD},capture:!0};function Pl(e){var o,f=this,m=x.H.gl;Pl.l.constructor.call(this),this.a=o=m.Scene.create(x.URL.createObjectURL(qf(JSON.stringify(Ql))),{viewport:e.viewport,container:e.Tb,disableRenderLoop:!0,devicePixelRatio:e.devicePixelRatio,logLevel:"error"}),e.On&&o.subscribe({load:e.On}),o.subscribe({view_complete:function(){f.$h=!0,e.qk()}});var w=o.requestRedraw;o.requestRedraw=function(){w.apply(o),e.qk()},this.ai=z(this.ai,this),this.$f=z(this.$f,this),this.f=0,this.c={},this.b={}}function Rl(e){var o;for(o in e=e.a.sources){var f=e[o];if(f.hasPendingCommands&&f.hasPendingCommands())return!0}return x.H.gl.Task.hasPendingTasks()}function Sl(e){e.$h=!1,e.a.resetViewComplete()}function Tl(e){return e.a.view}function Ul(e,o){function f(){var _e,_o,_u,iy,sy,w=o.Ha(),k={},Y={},pd=++e.f;for(Xh(Y,Ql),_o=0;_o<w.length;_o++){var gy=w[_o];if(_e=gy.ka()){var wy=_e.gb();if(wy.getState()===Uh.READY){var Ey=wy.Lc();if(!Va(Ey)){for(_u in delete Ey.cameras,delete Ey.camera,k[_o]=Ey=ii(Ey,_o),!C(gy,rl)&&Ey.sources&&ji(Ey,_e.uid),Ey.sources){var Py=Ey.sources[_u];Py.max_zoom=xd(_e.max,Ol.lookAt.zoom.max),Py.max_display_zoom=gy.max,Py.min_display_zoom=gy.min,(sy=_e.tileSize)&&(2<=m&&256<sy&&_e instanceof Ck&&(sy/=2),Py.tile_size=sy)}(iy=wy.Bb())&&ki(Ey,iy),Xh(Y,Ey)}}}}return Xh(Y.layers.skybox.draw.skybox.color,Y.scene.sky),e.a.config=Y,e.a.updateConfig().then(function(){var _m,y0,Jy={};if(pd!==e.f)return!1;for(y0 in e.f=0,k){gy=w[+y0];var Oy=k[y0].sources;for(_m in Oy)(Oy=e.a.sources[_m])&&(Jy[_m]=Oy,Oy.initialize&&gy.getProvider()&&Oy.initialize(gy.getProvider(),e.ai,e.a.getWorkers().length,Oy.tiled?B:e.a.tile_manager.getWorkerForTile(y,Oy)))}for(_m in e.c)!Jy[_m]&&e.c[_m].dispose&&e.c[_m].dispose();return e.c=Jy,!0})}var m=e.a.pixelRatio();e.a.initialized?f():e.a.load(y,{blocking:!1}).then(f)}function Vl(e,o){var f=e.a.tile_manager;f.removeTiles(e.$f),f.updateTilesForView(),o&&f.removeCachedTiles(e.$f),Sl(e),e.b={}}function Wl(e,o,f,m){e.a.getFeatureAt(o,f,m),e.a.update()}function Xl(e){return e.a.screenshot(void 0).then(function(o){return new Qb(function(f,m){new Pj(URL.createObjectURL(o.blob),function(w,k){1===w?f(k.getData()):m()},!1)})})}t("H.map.render.webgl.capabilities",Ol),u(Pl,od),p=Pl.prototype,p.$h=!1,p.T=function(){var e=x.H.gl.Task;return this.a.immediateRedraw(),e.setState({user_moving_view:this.a.view.user_input_active}),e.processAll(),this.$h&&!this.a.dirty&&!this.a.building&&!Rl(this)&&!Object.keys(this.b).length},p.ai=function(e,o,f){var m=this,w=this.a.sources[e],k=f&&f.isReload;o?!0!==this.b[e]&&(this.b[e]||(this.b[e]={cl:{},Ri:[]}),C(o,Vk)?this.b[e].cl[o.x+"/"+o.y+"/"+o.z]=!0:this.b[e].Ri.push(new K((o=o.boundingBox)[0],o[1],o[2],o[3]))):this.b[e]=!0,w&&w.has_volatile_data?Vl(this,k):(x.clearTimeout(this.g),this.g=x.setTimeout(function(){return Vl(m,k)},100))},p.$f=function(e){var o=!1,f=this.b[e.source.name],m=x.H.gl;if(f)if(!0===f)o=!0;else{var w=m.Tile.coord(m.Geo.wrapTile(e.coords));if(!(o=!!f.cl[w.key])){var k=m.Geo.getTileBoundingBox(w,e.source.tile_size,O.MAX_LINE_WIDTH/2);k=tg(k.getTopLeft(),k.getBottomRight()),o=f.Ri.some(function(Y){return Y.jd(k,!0)||k.bd(Y.Za(),!0)})}}return o},p.Lc=function(){return this.a.config},p.Ua=function(){return this.a.pixelRatio()},p.o=function(){var e=this.c;Pl.l.o.call(this),this.a.destroy(),this.b={},e&&Object.keys(e).forEach(function(o){e[o].dispose()}),x.clearTimeout(this.g),delete this.c,delete this.a},Pl.prototype.disposeInternal=Pl.prototype.o;var Ql={scene:{background:{color:"#FFFFFF"},sky:{zenith:"#347BC0",horizon:"#EDF2F9",fog:"#FFFFFF"}},lights:{default_light:{type:"directional",name:"default_light",visible:!0}},camera:{type:"perspective"},styles:{},fonts:{},sources:{skybox:{type:"SkyBox"}},layers:{skybox:{data:{source:"skybox"},draw:{skybox:{color:{}}}}},global:{}},lk={FEATURE:1,SOURCE:2,PROVIDER:3};function Yl(e){return e}function Zl(e){return-e*(e-2)}function $l(e){return 1-Math.sqrt(1-e*e)}function am(e){return Ed(2*e-e*e)}function bm(e){return 1-Math.cos(e*Math.PI/2)}function cm(e){return Math.sin(e*Math.PI/2)}function dm(e,o){this.a={tilt:em(e.tilt,o.tilt),heading:em(e.heading,o.heading),zoom:o.zoom-e.zoom};var f=this.b=og(e.position),m=o.position;e=m.lat*Td;var w=f.lat*Td;f=Hd(m=m.lng*Td-f.lng*Td)*Jd(e),e=Jd(w)*Hd(e)-Hd(w)*Jd(e)*Jd(m),e=Math.atan2(f,e),this.i=(0<=e?e:Rd+e)*Ud,this.c=this.b.Ta(o.position),this.g=0===(o=this.a.zoom)?fm:Object.assign({},fm,{zoom:0>o?am:$l,position:0>o?bm:cm}),this.f=Object.assign({},{tilt:0,heading:0,zoom:0})}function em(e,o){return-180<(e=o-e)&&180>=e?e:180<e?e-360:e+360}t("H.map.provider.PickingMode",lk),t("H.util.animation.ease.LINEAR",Yl),t("H.util.animation.ease.EASE_IN_QUAD",function(e){return e*e}),t("H.util.animation.ease.EASE_OUT_QUAD",Zl),t("H.util.animation.ease.EASE_IN_OUT_QUINT",function(e){return 1>(e*=2)?Fd(e,5)/2:Fd(e-=2,5)/2+1}),t("H.util.animation.ease.EASE_OUT_CIRC",am);var fm={tilt:Yl,heading:Yl,zoom:Yl,position:Yl};function gm(e,o){if(E(this.x=+e))throw new D(gm,0,e);if(E(this.y=+o))throw new D(gm,1,o)}function hm(e){return Ed(e.a(e))}function im(e){this.Xa=vc((e=e||kf).Jn)?e.Jn:3,this.R=vc(e.Hn)?e.Hn:300,this.u=vc(e.vo)?e.vo:3,this.v=vc(e.qo)?e.qo:50,this.c=[],this.clear()}function lm(e,o){e.g^=e.g&o}gm.prototype.add=function(e){return new gm(this.x+e.x,this.y+e.y)},gm.prototype.a=function(e){if(!C(e,gm))throw new D(this.a,0,e);return(e=this.b(e)).x+e.y},gm.prototype.b=function(e){if(!C(e,gm))throw new D(this.b,0,e);return new gm(this.x*e.x,this.y*e.y)},gm.prototype.Ka=function(e){return new gm(this.x*e,this.y*e)},t("H.map.render.InteractionUtils",im),im.prototype.kn=function(){return this.b},im.prototype.isGestureDetected=im.prototype.kn,im.prototype.start=function(e,o){var f=Hl.HEADING,m=Hl.TILT;this.m&&this.clear(),this.g=e,this.j=!!o,this.m=!0,this.b=!(e&(f|m))||e===f||e===m},im.prototype.start=im.prototype.start,im.prototype.store=function(e,o,f,m,w){var k=!1;if(this.m){if(k=(e=new jm(e,o,f,m,w)).c,this.s=this.a,this.a=e,this.f){if(this.i=!0,k){o=this.g;var Y=this.b;if(!Y&&this.i){w=Hl.HEADING;var _e=Hl.TILT;m=Hl.ZOOM;var _o=o&((f=Hl.COORD)|_e)?this.Ld(!0):km,_u=o&m?this.vf(!0):1,pd=o&w?Cd(this.Ug(!0)):0,iy=Cd(_o.x),sy=Cd(_o.y);_o=10<iy||10<sy,iy=10<sy&&sy>3*iy,_u=.8>_u||1.2<_u,pd=7<pd,o&_e&&(pd||_u||_o&&!iy?lm(this,_e):iy&&(lm(this,~_e>>>0),Y=!0)),!Y&&o&w&&o&(f|m)&&(_u||_o?(lm(this,w),Y=!0):pd&&(lm(this,_e),Y=!0)),this.b=Y}}}else this.f=e,k||(this.b=!0);this.j&&this.c.push(e)}return k},im.prototype.store=im.prototype.store,im.prototype.clear=function(){this.c.length=0,this.m=this.j=this.i=this.b=!1,this.f=this.s=this.a=void 0},im.prototype.clear=im.prototype.clear,im.prototype.tc=function(e){return 0<(this.g&e)},im.prototype.isModifierEnabled=im.prototype.tc,im.prototype.qa=function(){return this.m},im.prototype.isRunning=im.prototype.qa;var km=qc(new gm(0,0));function jm(e,o,f,m,w){this.a=new G(e,o),f!==B&&(this.b=new G(f,m),this.c=!0),this.timestamp=w!==B?w:Jk()}function nm(e){var o=e.a;return(e=e.b)?new G(o.x-(o.x-e.x)/2,o.y-(o.y-e.y)/2):B}function pm(e,o){var f=e.a;return(e=e.b)&&e.Ta(o)<f.Ta(o)?e:f}function mm(e,o){var f=e.b,m=o.b;return m&&f?(o=nm(o),e=nm(e)):f?e=pm(e,o=o.a):m?o=pm(o,e=e.a):(o=o.a,e=e.a),new gm(o.x-e.x,o.y-e.y)}function om(e){var o=e.b;return o?e.a.Ta(o):0}function qm(){F.call(this),this.reset()}function sm(e){sm.l.constructor.call(this,qm.prototype.A.tg),this.b=e}function tm(e){return x.Object.create(e.f)}function rm(e,o,f,m,w,k){this.a=e,this.b=o,this.c=f,this.f=m,this.g=w,this.i=k}function um(e,o,f,m){um.l.constructor.call(this),this.Tb=e,this.na=m,this.a=e.appendChild(this.createElement(e.ownerDocument)),this.Ye(o,f)}function vm(e,o,f,m,w,k){var Y=w||"2d";vm.l.constructor.apply(this,arguments),this.b=this.a.getContext(Y,k),this.c="2d"===Y,this.g=Y,this.xn=k}function wm(e){this.ab=e}function xm(e){var o="dom";xm.l.constructor.call(this,e),C(this.ab,ym)&&(o="2d"===e.Fd()?"2d":"webgl"),this.a=o}function zm(e,o,f,m,w){if(!Da(e.ci)||!Da(e.Yh))throw new D(zm,0,e);if(this.b=e,!Da(this.j=o))throw new D(zm,1,o);if(E(this.i=+f))throw new D(zm,2,f);if(!Da(this.g=m)&&null!=m)throw new D(zm,3,m);if(!Da(this.c=w)&&null!=w)throw new D(zm,4,w);this.id=(new df).next(),this.a=!1}function Am(e,o){Am.l.constructor.call(this,e),this.jc=!(!o||!o.jc),this.f={}}im.prototype.lc=function(){var e;if(this.j){var o=this.c,f=o.length,m=0;for(e=new gm(0,0);--f&&m<this.u;)e=e.add(mm(o[f-1],o[f])),m++}else e=this.Ld();return 0!==(f=hm(o=e))?new gm(o.x/f,o.y/f):o},im.prototype.getDirection=im.prototype.lc,im.prototype.sb=function(e){var o,f;if(e=e||Jk(),this.j){var m=this.c,w=this.c.length,k=this.c[w-1];for(f=o=0;--w&&o<this.u;)f+=hm(mm(m[w],m[w-1])),o++;m=f/o}else k=this.a,m=hm(this.Ld());return m>=this.Xa&&e-k.timestamp<=this.v?m>this.R?this.R:m:0},im.prototype.getSpeed=im.prototype.sb,im.prototype.uf=function(){return this.a?nm(this.a):B},im.prototype.getBifocalCenter=im.prototype.uf,im.prototype.Ld=function(e){return(e=e?this.f:this.s)?mm(e,this.a):new gm(0,0)},im.prototype.getMoveVector=im.prototype.Ld,im.prototype.vf=function(e){var o=1;if(this.i){var f=this.a;(e=om(e=e?this.f:this.s))&&(f=om(f))&&(o=f/e)}return o},im.prototype.getBifocalScaling=im.prototype.vf,im.prototype.Ug=function(e){if(this.i){var o=e?this.f:this.s,f=this.a,m=f.b,w=0;(e=o.b)&&m&&(o=o.a,w-=Md(m.y-(f=f.a).y,m.x-f.x)*Ud-Md(e.y-o.y,e.x-o.x)*Ud),e=w}else e=0;return e},im.prototype.getBifocalRotation=im.prototype.Ug,jm.prototype.c=!1,u(qm,F),qm.prototype.start=function(e,o){this.c&&this.reset(),E(e-o)||(this.a=+e,this.b=+o),this.c=!0},qm.prototype.reset=function(){this.c=!1,this.a=this.b=B,this.f=new rm(0,0,0,0,0,0)},qm.prototype.qa=function(){return this.c},qm.prototype.A={tg:"animationupdate"},u(sm,td),qm.prototype.set=function(e,o,f,m,w,k){var Y=this.f;this.c&&(e=new rm(e/1e3,o/1e3,f/1e3,m/1e3,w/1e3,k/1e3),Y.ga(e)||(this.f=e,this.dispatchEvent(new sm(tm(this)))))},qm.prototype.sb=function(){return tm(this).sb()},qm.prototype.lc=function(){var e=tm(this),o=this.sb()||1;return new rm(e.a/o,e.b/o,e.c/o,e.f,e.g,e.i)},qm.prototype.o=function(){this.reset(),qm.l.o.call(this)},rm.prototype.sb=function(){return Ed(this.a*this.a+this.b*this.b+this.c*this.c)},rm.prototype.lc=function(){var e=this.sb()||1;return new rm(this.a/e,this.b/e,this.c/e,this.f,this.g,this.i)},rm.prototype.ga=function(e){var o=e===this;return!o&&(o=C(e,rm))&&(o=this.a===e.a&&this.b===e.b&&this.c===e.c&&this.f===e.f&&this.g===e.g&&this.i===e.i),o},u(um,od),um.prototype.L=function(){return this.a},um.prototype.Ye=function(e,o){this.size?(this.size.w=e,this.size.h=o):this.size=new Ui(e,o),this.Uk(this.a,this.a.style,e,o,this.na)},um.prototype.setSize=um.prototype.Ye,p=um.prototype,p.rb=function(){return this.size},p.Ua=function(){return this.na},p.Uj=!0,p.lb=function(e){e!==this.Uj&&(this.a.style.display=e?"block":"none",this.Uj=e)},p.yh=1,p.cc=function(e){this.yh!==e&&(this.Yj(e),this.yh=e)},p.Oc=function(){return this.yh},p.ce=function(e){this.a.style.zIndex=e},um.prototype.setZIndex=um.prototype.ce,um.prototype.Gj=function(){return+this.a.style.zIndex},um.prototype.Ic=function(){},um.prototype.clear=function(){},um.prototype.o=function(){this.clear(),this.Tb.removeChild(this.a),this.Ye(0,0),delete this.a,delete this.Tb,um.l.o.call(this)},um.prototype.disposeInternal=um.prototype.o,um.prototype.f=0,um.prototype.eg=function(){++this.f},um.prototype.release=function(){--this.f||this.D()},u(vm,um),p=vm.prototype,p.createElement=function(e){var o=(e=e.createElement("canvas")).style;return o.position="absolute",o.top=o.left="0",e},p.Uk=function(e,o,f,m,w){e.width=yd(f,1),e.height=yd(m,1),o.width=zd(f/w)+"px",o.height=zd(m/w)+"px"},p.Yj=function(e){this.b.globalAlpha=e},p.Ic=function(e,o,f,m,w){this.c&&this.b.drawImage(e,o,f,m,w)},p.Fd=function(){return this.g},p.clear=function(e){var o,f;this.c&&(e?this.b.clearRect(o=e.left,f=e.top,e.right-o,e.bottom-f):this.a.width=this.size.w)},p.o=function(){var e=this.a;e.width=e.height=0,delete this.b,vm.l.o.call(this)},vm.prototype.disposeInternal=vm.prototype.o,u(wm,od),wm.prototype.jb=function(){return this.ab},wm.prototype.getLayer=wm.prototype.jb,wm.prototype.Qm=function(){return this.ib},wm.prototype.getSurface=wm.prototype.Qm,wm.prototype.Wc=function(e){var o=this.ib;e!==o&&(this.ib=e,e.eg(),o&&o.release())},wm.prototype.setSurface=wm.prototype.Wc,wm.prototype.o=function(){this.ib.release()},wm.prototype.disposeInternal=wm.prototype.o,wm.prototype.Pd=function(){},wm.prototype.render=wm.prototype.T,u(xm,wm),xm.prototype.T=function(e,o,f,m,w,k,Y,_e){Y=this.ab;var _o=this.ib,_u=!(C(_o,vm)&&"2d"===_o.Fd());return m>=Y.min&&m<=Y.max?(_u&&_o.lb(!0),Y.T(_o.L(),{boundingBox:e,zoom:m,screenCenter:o,priorityCenter:k,projection:f,cacheOnly:w,size:_o.rb(),pixelRatio:_o.Ua(),cameraMatrix:_e})):(_u&&_o.lb(!1),uk.DONE)},xm.prototype.Pd=function(){return this.a},t("H.util.animation.Animation",zm),zm.prototype.start=function(){var e=this;this.f=Jk(),this.a=!0;var o=this.f;this.b.ci(function(){if(e.a){var f=Jk(),m=f-e.f,w=m/e.i,k=!1;1<=w&&(w=1,k=!0),e.j(e.c?e.c(w):w,m,f-o,f),o=f,k&&e.stop()}else e.stop()})},zm.prototype.start=zm.prototype.start,zm.prototype.stop=function(e){this.a=!1,this.b.Yh(),e||this.g&&this.g(this)},zm.prototype.stop=zm.prototype.stop,zm.prototype.qa=function(){return this.a},zm.prototype.isRunning=zm.prototype.qa,u(Am,wm),Am.prototype.Wc=function(e){Am.l.Wc.call(this,e),this.j=e.Tb.ownerDocument},Am.prototype.setSurface=Am.prototype.Wc;var Bm=function(e,o){return C(o=o.ca(),hh)?o.ja:(e[0]=o,e)}.bind(null,[]);function Cm(e,o){var f=e[1].Pc(),m=o[1].Pc();return ph(f,m,!0)||e[5]-o[5]||ph(f,m,!1)}function Dm(e,o){Dm.l.constructor.apply(this,arguments),this.c=0,this.a=[],this.b=z(this.b,this)}Am.prototype.T=function(e,o,f,m,w,k,Y){var _o,_u,pd,iy,_e=this.ab;if(this.m=o=this.f,this.f=f={},m>=_e.min&&m<=_e.max){var sy=this.hj(e,m,w,k),gy=sy.markers;if(e=gy.length){for(m=[],w=this.ib,k=0;k<e;k++){var wy=Bm(_e=gy[k]);for(_o=wy.length;_o--;)(_u=Y(wy[_o]))&&((iy=o[pd=_e.$a()+"_"+_o])?delete o[pd]:iy={ik:_e},f[pd]=iy,m.push([iy,_e,_e.qb(),w,_u.x,_u.y]))}for(m.sort(Cm),e=m.length,k=0;k<e;k++)this.Ek.apply(this,m[k])}}return!sy||sy.requested&&sy.requested===sy.total||!sy.requested&&gy.length===sy.total?uk.DONE:uk.PENDING},Am.prototype.render=Am.prototype.T,Am.prototype.Ba=function(){},Am.prototype.getObjectsAt=Am.prototype.Ba,u(Dm,Am),t("H.map.render.dom.MarkerRenderer",Dm),Dm.prototype.hj=function(){return this.ab.wc.apply(this.ab,arguments)},Dm.prototype.T=function(e,o,f,m,w,k,Y){this.b(),this.i=0;var pd,_e=Dm.l.T.apply(this,arguments),_o=this.ib,_u=this.m;for(pd in _u)Em(this,_o,_u[pd]);return 0===this.a.length&&_e?uk.DONE:uk.PENDING},Dm.prototype.render=Dm.prototype.T,Dm.prototype.Wc=function(e){Dm.l.Wc.call(this,e),this.g=e.Ua()},Dm.prototype.setSurface=Dm.prototype.Wc,Dm.prototype.b=function(){for(var o,f,m,e=this.a.length;e--;)(f=(o=(m=this.a[e]).rg).qb()).Lh(m,f,o);this.a.length=0},Dm.prototype.Ek=function(e,o,f,m,w,k){var Y,_e=m.Ua(),_o=o.Eb();w*=_e,k*=_e,this.jc||(w=zd(w),k=zd(k)),e.detail&&(_o.Td(e.gn)?Em(this,m,e):Y=e.detail),Y||(e.detail=Y=f.jj(this.j),this.c++,Da(f.Lh)&&this.a.push(Y)),e.gn=_o.a,Y.style.zIndex=this.i++,Y.rg=o,m.Ic(Y,w,k,0,0)};var Fm,Gm="pointer-events",Hm,Im;function Em(e,o,f){o.clear(o=f.detail),delete o.rg,e.c--,(f=(e=f.ik).qb()).b&&f.b(o,f,e)}function ym(e,o){var f=o||{},m=f.contextType;if(f=f.contextAttributes,ym.l.constructor.call(this,o),yc(e,"Function",ym,0,"invalid render callback"),m){if(-1===Jm.indexOf(m))throw new D(ym,1,"invalid context type");this.b=m}f&&(this.c=f),this.f=e}af&&(af&&$c!==y&&($c=(Im=/(MSIE\s+|rv:)([^\);]+)(\)|;)/.exec(navigator.userAgent))?+Im[2]:y),Hm=$c,9===Hm?Gm="display":10===Hm&&(Gm="visibility")),Fm=Gm,Dm.prototype.Ba=function(e,o,f){var k,Y,_e,_o,_u,m=this.g,w=jf;if(this.c){e/=m,o/=m;var pd=(m=this.ib.Tb.getRootNode()).documentElement,iy=this.ib.L(),sy=iy.getBoundingClientRect();for(e+=sy.left,o+=sy.top;(Y=_e=m.elementFromPoint(e,o))&&Y!==iy&&Y!==pd&&Y!==m.host&&_e!==gy;){for(;(_o=Y.parentNode)&&(!Da(_o.contains)||!_o.contains(iy));)Y=_o;if(_o===iy&&(Y!==_e||"svg"!==Y.nodeName)&&0>w.indexOf(_u=Y.rg)&&(w===jf&&(w=[]),w.push(_u),f))break;k||(k=[]);var gy=Y.style;k.push({Wi:gy.getPropertyValue(Fm),fn:gy.getPropertyPriority(Fm),style:gy}),gy.setProperty(Fm,"visibility"===Fm?"hidden":"none","important"),gy=_e}if(k)for(o=k.length;o--;)(e=k[o]).style.removeProperty(Fm),Bc(e.Wi)&&e.style.setProperty(Fm,e.Wi,e.fn)}return w},Dm.prototype.getObjectsAt=Dm.prototype.Ba,Dm.prototype.Pd=function(){return"dom"},Dm.prototype.o=function(){this.a.length=0;var f,e=this.ib,o=this.f;for(f in o)Em(this,e,o[f]);this.ib.D(),Dm.l.o.call(this)},Dm.prototype.disposeInternal=Dm.prototype.o,u(ym,oj),t("H.map.layer.CanvasLayer",ym);var Jm=["2d","webgl","webgl2","experimental-webgl"];function Km(e,o){Km.l.constructor.call(this,o),yc(e,"Function",Km,0,"invalid render callback"),this.a=e}function Lm(e,o){if(E(this.b=+e))throw new D(Lm,0,e);this.a=0,o&&this.Qk(o)}function Mm(e,o,f,m){Mm.l.constructor.apply(this,arguments)}function Nm(e,o){this.a=e,this.b=o}function Om(e,o,f){var m=[],w={Tb:e.a,width:o.w,height:o.h,na:e.b};for(e=0;e<f.length;e++){var k=(o=f[e]).Pd(),Y={};Ya(Y,w);var _e=o.ib;switch(k){case"2d":if(C(o.jb(),ym)&&(Y.Jg=o.jb().c),k=pd&&"2d"===pd.Fd()){var _o=pd.xn;k=!(_o!==(k=Y.Jg)&&(_o&&!k?_o.alpha||_o.willReadFrequently:k&&!_o?k.alpha||k.willReadFrequently:!k.alpha!=!k.alpha||!_o.willReadFrequently!=!k.willReadFrequently))}if(k)var _u=!1;else if(_e&&!_u){var pd=_e;_u=!1}else pd=new vm(Y.Tb,Y.width,Y.height,Y.na,"2d",Y.Jg),_u=!0;break;case"dom":pd=_e||new Mm(Y.Tb,Y.width,Y.height,Y.na),_u=!_e;break;default:pd=_e||new vm(Y.Tb,Y.width,Y.height,Y.na,o.jb().Fd(),Y.Jg),_u=!_e}m[m.length-1]!==pd&&(pd.ce(m.length),m.push(pd)),o.Wc(pd)}return m}function Fl(){Fl.l.constructor.call(this),this.b={},this.a={position:new mg(0,0),zoom:0,heading:180,incline:0,tilt:0,bounds:new P(dh([90,-180,90,0,90,180,-90,180,-90,-180]))}}ym.prototype.b="2d",ym.prototype.Fd=function(){return this.b},ym.prototype.T=function(e,o){return this.a&&this.a.canvas===e||(this.a=e.getContext(this.b,this.c)),this.f(this.a,o)},ym.prototype.o=function(){ym.l.o.call(this),delete this.a},u(Km,oj),t("H.map.layer.DomLayer",Km),Km.prototype.T=function(e,o){return this.a(e,o)},t("H.util.kinetics.KineticMove",Lm),Lm.prototype.Qk=function(e){return this.a=e,this},Lm.prototype.setInitialSpeed=Lm.prototype.Qk,Lm.prototype.Yl=function(){return Math.abs(this.a/this.b)},Lm.prototype.getDuration=Lm.prototype.Yl,Lm.prototype.ze=function(e){return this.a+this.b*e},Lm.prototype.getCurrentSpeed=Lm.prototype.ze,Lm.prototype.Vl=function(e){return this.a*e+this.b*e*e/2},Lm.prototype.getCurrentPath=Lm.prototype.Vl,u(Mm,um),t("H.map.render.dom.Surface",Mm),p=Mm.prototype,p.Fd=function(){return"dom"},p.createElement=function(e){return(e=e.createElement("DIV")).style.position="absolute",e.style.pointerEvents="none",e},p.Uk=function(e,o,f,m){o.width=f+"px",o.height=m+"px"},p.Yj=function(e){this.a.style.opacity=e},p.Ic=function(e,o,f){var m=this.na,w=e.style;w[Bf("transform")]="matrix(1,0,0,1,"+o/m+","+f/m+")",e.parentNode!==this.a&&(w.position="absolute",this.a.appendChild(e),this.a.style.pointerEvents="auto","auto"===getComputedStyle(e).pointerEvents&&(e.style.pointerEvents="all"),this.a.style.pointerEvents="none")},p.clear=function(e){e?this.a.removeChild(e):this.a.innerHTML=""},u(Fl,F),t("H.map.ViewModel",Fl),Fl.prototype.A={xa:"update",ie:"sync"},Fl.prototype.Ob=function(e,o){if(!e)throw new D(this.Ob,0,e);var f=e[Pm];if(vc(f)&&!ng(f))throw new D(this.Ob,0,Pm);if(vc(f=e[Qm])&&E(+f))throw new D(this.Ob,0,Qm);if(vc(f=e[Rm])&&!C(f,lg))throw new D(this.Ob,0,Rm);return f=Sm(e=x.Object.assign({},e),this.b,this.a),Tm(this,this.b,e),this.dispatchEvent(new Um(this.b,f,o)),this},Fl.prototype.setLookAtData=Fl.prototype.Ob,Fl.prototype.fb=function(){var e={};return e[Pm]=og(this.a[Pm]),Tm(this,e,this.a,!0),e},Fl.prototype.getLookAtData=Fl.prototype.fb;var Pm="position",Qm="zoom",Rm="bounds",Vm={Ki:Pm,Ni:Qm,Ei:"heading",Mi:"tilt",Fi:"incline",Ci:Rm},Wm=Object.keys(Vm).map(function(e){return Vm[e]});function Tm(e,o,f,m){e.g={},e.f={},e.c=[];for(var _e,_o,_u,w=e.j,k=e.i,Y=Wm.length;Y--;)if(_u=f[_e=Wm[Y]],null==(_o=o[_e])||!m)if(null!=_u){vc(w)&&w.call(e,_e,_o,_u);var iy,pd=_e;if((iy="position"!==_e)||(iy=!(!(iy=_u)||E(iy.lat)||E(iy.lng))),o[pd]=iy?_u:og(_u),vc(k)){switch(_e){case"position":_o=_u&&_o&&(_u.lat!==_o.lat||_u.lng!==_o.lng);break;case"bounds":_o=_u&&_o&&!_u.ga(_o);break;default:_o=_u!==_o}_o&&k.call(e,_e)}}else delete o[_e]}Fl.prototype.j=function(e,o,f){this.g[e]=o,this.f[e]=f},Fl.prototype.i=function(e){this.c.push(Xm[e])};var Xm=Wm.reduce(function(e,o){return e[o]=cj[o.toUpperCase()],e},{});function Sm(e,o,f){var m=0;return["tilt","incline","heading",Qm].forEach(function(w){if(E(e[w])){var k=E(o[w])?f[w]:o[w];e[w]=k}else m|=Xm[w]}),[Pm,Rm].forEach(function(w){e[w]?m|=Xm[w]:e[w]=o[w]||f[w]}),m}function Ym(e,o){return e|o}function Um(e,o,f){Um.l.constructor.call(this,Fl.prototype.A.xa,e,null,o),this.b=this.animate=!!f}function T(e,o,f,m){if(T.l.constructor.call(this,e,o,f,m),this.ya=new Pk(100),this.N=new G(0,0),this.tf=!!m.enableSubpixelRendering,this.Qb=Zm,this.s=new im,this.g=m=new qm,this.Fc=z(this.Fc,this),m.addEventListener(m.A.tg,this.Fc),this.K=e=(m=e.element).ownerDocument.createElement("div"),e.style.position="absolute",e.style.width=e.style.height="100%",e.style.zIndex=0,m.insertBefore(e,m.firstChild),this.yd=new Nm(this.K,this.na),this.oa=o.fb().position,!(o=x.H.gl))throw new Zc(T,'"H-webgl" module is missing');for(this.a=new Pl({viewport:this.f,Tb:this.K,devicePixelRatio:this.na,qk:z(this.fa,this)}),o.WorkerBroker.addTarget("model",qj),e=0,m=(o=this.c.Ha()).length,this.j={Hc:[],ha:[]},this.Ya=o;e<m;e++){var w=o[e];this.Ke(e,w),Il(this,w,!0)}this.xb(),this.Zc=z(this.Zc,this),this.Ah=z(this.Ah,this),this.Aa=z(this.Aa,this),f.addEventListener(oj.prototype.A.fe,this.Zc),this.Y=$m,this.zoom=Jl(this,this.v.kb()),this.xb(),this.da()}Fl.prototype.Wa=function(e){var o={},f={};Tm(this,this.a,e),this.b={},o.lookAt=this.f,f.lookAt=this.g,e=(e=this.c).length?e.reduce(Ym):0,this.dispatchEvent(new bj(this.A.ie,o,f,e))},Fl.prototype.synchronize=Fl.prototype.Wa,Fl.prototype.Ze=function(e,o){if(E(e=+e))throw new D(this.Ze,0,Qm);this.Ob({zoom:e},o)},Fl.prototype.kb=function(){return this.a.zoom},Fl.prototype.fc=Pc,Fl.prototype.startControl=Fl.prototype.fc,Fl.prototype.control=Pc,Fl.prototype.control=Fl.prototype.control,Fl.prototype.ob=Pc,Fl.prototype.endControl=Fl.prototype.ob,u(Um,bj),u(T,Dl),t("H.map.render.webgl.RenderEngine",T),T.prototype.fb=function(){var e=this.oa;return Kl(this,{position:{qn:e.qn,un:e.un},zoom:this.zoom,tilt:this.dl,heading:this.heading})},T.prototype.Zc=function(e){((e=(e=e.target.ka())&&e.gb())&&e.getState())===Uh.INIT?e.load():(Sl(this.a),Ul(this.a,this.c),this.fa())},T.prototype.type=Nl.WEBGL;var $m=2;function an(e,o,f){return(o=f-o)<(e=Fd(2,8+e.zoom))/2?o:o-e*f/Cd(f)}function bn(e,o,f){function m(_e){return w[_e]+em(w[_e],o[_e])/2}if(!(f&cj.POSITION||f&cj.BOUNDS))return null;var w=Tl(e.a).getLookAtData();f=w.position;var k=o.position,Y=o.bounds;return Ci(w.bounds,k.lat,k.lng,!1)||Y&&Ci(Y,f.lat,f.lng,!1)?null:((f=cn(e,{tilt:m("tilt"),heading:m("heading"),incline:0,bounds:ug([f,k])})).zoom=Jl(e,f.zoom-.5),delete f.bounds,f)}function dn(e,o,f,m){return e=(e=e.getCapabilities().lookAt[m]).max-e.min,Cd("zoom"===m?f[m]-o[m]:em(o[m],f[m]))/e||0}function en(e,o,f){return $d(3e3*(e=yd(8*dn(e,o,f,"zoom"),dn(e,o,f,"heading"),dn(e,o,f,"tilt")/2)),300,4e3)}function cn(e,o){return jn(o),Tl(e.a).getBestLookAtData(o)}function jn(e){var o=e.bounds;!o||o instanceof P||(e.bounds=zi(o.J()))}function ln(e,o,f){Tl(e.a).setLookAtData(o),Sl(e.a),kn(e),e.fa(),f&&setTimeout(f,0)}function hn(e,o,f,m){var w=Tl(e.a).getLookAtData(),k=new dm(w,o);k.a.tilt+k.a.heading+k.a.zoom+k.c!==0?mn(e,function(Y){for(var _e in k.a)if(0!==k.a[_e]){var _o=k.g[_e](Y);w[_e]+=k.a[_e]*(_o-k.f[_e]),k.f[_e]=_o}return 0!==k.c&&(w.position=k.b.qg(k.i,k.c*k.g.position(Y),!0)),ln(e,w)},f,function(){return ln(e,o,m)}):ln(e,o,m)}function nn(e,o){e.ya.ma(function(f,m){return m.Fb()===o})}function on(e){return!(C(e,Km)||C(e,ym))}function gn(e,o){var f=o.position;return Kl(e,{zoom:Jl(e,o.zoom),position:new mg(f.lat,f.lng),tilt:o.tilt,heading:o.heading,bounds:o.bounds})}function kn(e){var o=Tl(e.a).getLookAtData();e.zoom=o.zoom,e.oa=o.position}function qn(e,o){return new G((e=Tl(e.a).geoToMeters(o)).x/40075016.68557849+.5,1-(e.y/40075016.68557849+.5))}function rn(e,o){return o.sub(qn(e,e.oa)).scale(Fd(2,8+e.zoom))}function sn(e,o,f,m,w,k,Y,_e){var _o,_u,iy,pd=0,sy=function(){0==--pd&&k(w)};if(_e&&_e.features)for(pd=_u=_e.features.length,iy=0;iy<_u;iy++){var gy=_e.features[iy],wy=gy.id;if(_o=e.a.a.sources[gy.source_name]){var Ey=_o.provider,Py=Ey.yj();if(Py===lk.SOURCE){var Jy=gy.source_layer;if("overlays"===Jy)tn(e,o,f,m,w,_o,gy.properties.overlays_config);else if(_o=_o.getMapObjectById(wy))if("markers"!==Jy)w.push(_o);else if(un(e,o,f,_o))w.push(_o);else if(m&&!Y){var _m=!0;Wl(e.a,{x:o,y:f},{radius:3.5,top_most_only:!1},function(y0){sn(e,o,f,m,w,k,!0,y0)})}pd--}else Py===lk.FEATURE?(_m=Ey.getFeatureProxy(gy.properties,Jy=gy.tile.coords,function(y0){y0&&(y0.Tk(Ey),w.push(y0)),sy()}))||((_o=e.ya.get(wy))||((_o=new mh(gy)).ia(Ey),e.ya.add(wy,_o,1)),w.push(_o),pd--):Py===lk.PROVIDER&&(_m=!0,Ey.Fk(gy,!1).then(function(y0){y0&&(y0 instanceof sh?un(this,o,f,y0):1)&&w.push(y0),sy()},function(){sy()},e))}}Py&&(_m||0!==pd)||k(w)}function tn(e,o,f,m,w,k,Y){var _e;for(e=e.Ra(o,f),o=Y.length;o--&&(!(_e=k.getMapObjectById(Y[o].id))||0<=w.indexOf(_e)||!_e.ca().bd(e)||(w.push(_e),!m)););}function un(e,o,f,m){var Y,w=m.qb(),k=w.c,_e=!k;if(k)if(o+=(w=w.fd()).x,f+=w.y,C(w=m.ca(),Ti))for(Y=(m=w.ja).length;Y--&&!_e;)w=e.Aa(m[Y]),_e=k.Gf(o-w.x,f-w.y,0)!==ce.NONE;else w=e.Aa(w),_e=k.Gf(o-w.x,f-w.y,0)!==ce.NONE;return _e}function vn(e,o,f,m,w){for(var Y,k=o.length;k--&&!((Y=o[k])&&Y.Ba&&(e=e.concat(Y.Ba(f,m,w)),e.length&&w)););return e}function pn(e){return{w:(e=e.ua[2]).right-e.left,h:e.bottom-e.top}}function wn(e){e.i&&e.i.qa()||(Rl(e.a)||Jk()-e.ue<e.Qb)&&!e.ra?e.Mf||(e.Mf=Hk(e.Ah)):(e.ra&&(e.$d(),xn(e)),e.Y=$m)}function xn(e,o){e.ad||setTimeout(z(e.dispatchEvent,e,{type:e.A.Li,target:o||e}),1)}function zn(e,o,f){Tl(e.a).applyPxOffset([o,f]),kn(e),e.N.set(0,0),Sl(e.a),e.fa()}function An(e,o,f,m){Tl(e.a).setLookAtData({zoom:o},Ec(f)&&Ec(f)?[f,m]:B),kn(e),Sl(e.a),e.fa()}function fn(e){yn(e),e.g.qa()&&e.ob(!0),e.s.qa()&&e.pb(!0)}function Bn(e,o){if(o){var f={};f.Oe=o.power,f.re=o.ease,f.duration=o.duration,e.u=f}}function Dn(e,o){var f=rn(e,qn(e,o.position)),m=f.y;f=f.x;var w=o.zoom,k=rn(e,qn(e,e.oa));o=k.y;var Y=k.x;k=e.zoom;var _e=e.g.sb(),_o=e.g.a,_u=e.g.b,pd=0;if(f=an(e,Y,f),o=Ed((f-=Y)*f+(m-=o)*m+(k=w-k)*k),0!==_e&&0!==o){var iy=f/o,sy=m/o,gy=k/o,wy=_e*_e/(2*o);mn(e,function(Ey,Py){var Jy;1!==Ey?((Jy=gy*(Py=(Ey=_e*Py-wy*Py*Py/2)-pd))&&(Jy=Jl(e,e.zoom+Jy),An(e,Jy,_o,_u)),zn(e,zd(iy*Py),zd(sy*Py)),pd=Ey):(An(e,Jl(e,w),_o,_u),e.fa())},2*o/_e)}}function Cn(e,o,f){f=f||0;var m=e.g,w=Tl(e.a),k=w.getLookAtData();o.c&&An(e,Jl(e,k.zoom+o.c*f),m.a,m.b),w.setLookAtData({heading:Ml(e,k.heading+o.g*f),tilt:Ll(e,k.tilt+o.f*f)}),kn(e),zn(e,o.a*f,o.b*f)}function mn(e,o,f,m,w){e.i&&e.i.qa()&&e.i.stop(!0),e.i=new zm(e,o,f,m,w),e.i.start()}function yn(e){e.i&&e.i.qa()&&e.i.stop(!0)}T.prototype.getState=function(){return this.Y},T.prototype.getState=T.prototype.getState,T.prototype.ad=!1,T.prototype.Eg=function(e){var o=this,f=e.newValue,m=e.modifiers,w=Tl(this.a);fn(this),this.N.set(0,0);var k=gn(this,f);if(Wm.forEach(function(_u){m&e[_u.toUpperCase()]||delete k[_u]}),e.b){w=Tl(this.a).getLookAtData();var Y=cn(this,k);f=bn(this,Y,m);var _e=function(){return o.ad=!1};if(delete Y.bounds,this.ad=!0,f){w=en(this,w,f);var _o=en(this,f,Y);hn(this,f,w,function(){return hn(o,Y,_o,_e)})}else f=en(this,w,Y),hn(this,Y,f,_e)}else jn(k),w.setLookAtData(k);kn(this),Sl(this.a),this.fa()},T.prototype.gg=function(){},T.prototype.setAnimationDuration=T.prototype.gg,T.prototype.Sg=function(){},T.prototype.getAnimationDuration=T.prototype.Sg,T.prototype.hg=function(){},T.prototype.setAnimationEase=T.prototype.hg,T.prototype.Tg=function(){},T.prototype.getAnimationEase=T.prototype.Tg,T.prototype.cg=function(){},T.prototype.resetAnimationDefaults=T.prototype.cg,p=T.prototype,p.nk=function(e){nn(this,e.target.ka()),Sl(this.a),this.fa()},p.Ke=function(e,o){T.l.Ke.call(this,e,o),on(o)&&(Sl(this.a),(e=(e=o.ka())&&e.gb())&&e.getState()===Uh.INIT&&e.load())},p.Nh=function(e,o,f){var m;if(this.ue=Jk(),nn(this,o.ka()),o.requestDomMarkers||C(o,ym)||C(o,Km)){var w=this.j.ha;for(m=w.length;m--;){var k=w[m];if(k.jb()===o){w.splice(m,1),k.D();break}}}on(o)&&Ul(this.a,this.c),this.Ya=this.c.Ha(),0===e&&(Il(this,o,!1),this.xb()),Om(this.yd,pn(this),this.j.ha.filter(vc)),this.$d(),f||this.fa()},p.Oh=function(){this.xb()},p.xb=function(){T.l.xb.call(this);var e=this.getCapabilities().lookAt.zoom;Tl(this.a).setZoomConstraints(yd(e.min,this.wg),xd(e.max,this.vg))},p.jh=function(e,o){var f;if(o){if(e={jc:this.tf,bb:this.bb},o.T?(C(o,ym)||C(o,Km))&&(f=new xm(o)):o.requestDomMarkers&&(f=new Dm(o,e)),f){this.j.ha.push(f);var m=this.c.Ha();this.j.ha.sort(function(w,k){return m.indexOf(w.ab)-m.indexOf(k.ab)}),Om(this.yd,pn(this),this.j.ha.filter(vc))}on(o)&&Ul(this.a,this.c)}this.Ya=this.c.Ha()},p.Aa=function(e){return Tl(this.a).geoToPixel(e)},T.prototype.geoToScreen=T.prototype.Aa,T.prototype.Ra=function(e,o){return Tl(this.a).xyToGeo(e,o)},T.prototype.screenToGeo=T.prototype.Ra,T.prototype.fg=function(e,o){return e=this.Ra(e,o),(o=this.v.fb()).position=e,o},T.prototype.Ba=function(e,o,f,m){var w=this,k=[];k=vn(k,this.j.ha,e*this.na,o*this.na,f),f&&k.length?m(k):this.a.a.initialized?Wl(this.a,{x:e,y:o},{radius:3.5,top_most_only:f},function(Y){sn(w,e,o,f,k,m,!1,Y)}):m(k)},T.prototype.getObjectsAt=T.prototype.Ba,T.prototype.V=y,T.prototype.da=function(){var e=this.j.ha.length;El(this,this.na),this.N.set(0,0);var o=pn(this),f=o.w,m=o.h;for(this.a.a.handleViewportUpdate();e--;){var w=(o=this.j.ha[e].ib).rb();w.w===f&&w.h===m||o.Ye(f,m)}this.V=new Ui(f,m),Sl(this.a),this.fa()},T.prototype.getCapabilities=function(){return Ol},T.prototype.getCapabilities=T.prototype.getCapabilities,p=T.prototype,p.Mf=0,p.$d=function(){this.j.Hc.length=0},p.Ah=function(){this.Mf=0,this.B&&this.B.before();var e=Tl(this.a),o=e.getLookAtData(!1),f=e.getLookAtData(!0);e=this.f.center.clone(),f=f.bounds.J();var m=this.zoom,w=this.N,k=this.Ya,Y=k.length;for(this.Qb=Zm;Y--;){var _e=k[Y];C(_e,oj)&&_e.ka()&&_e.ka().Pe(f,m)}this.ra=this.a.T(),this.v.Wa(o),k=(o=this.j).ha.length;var _u,_o=!0;for(_u=0;_u<k;_u++){var pd=o.Hc;(Y=o.ha[_u])&&((_e=Y.T(f,e,void 0,m,!1,w,this.Aa,this.a.a.getCameraMatrix()))===uk.ACTIVE&&(this.Qb=1/0),_e!==uk.DONE||pd[_u]||(xn(this,Y.jb()),pd[_u]=!0),pd[_u]||(_o=!1))}this.ra=_o&&this.ra,this.V&&(this.f.Wa(this.V),this.V=y),this.i&&this.i.qa()&&this.ug(),this.B&&this.B.after(),wn(this)},p.o=function(){var e=this.c.Ha()[0],o=this.f;Ik(this.Mf),yn(this),e&&Il(this,e,!1),this.j.ha.filter(vc).forEach(function(f){f.D()}),o.element&&o.element.removeChild(this.K),delete this.K,this.Y=3,this.a.D(),T.l.o.call(this)},p.fa=function(){this.ue=Jk(),this.Y===$m&&(this.ra=!1,this.Y=1,wn(this))},p.ud=function(e,o,f){An(this,e=Jl(this,Jl(this,e)),o,f)},T.prototype.zoomAt=T.prototype.ud,T.prototype.gc=function(e,o){var f=!!(o||e&(Hl.HEADING|Hl.TILT));fn(this),Bn(this,o),this.s.start(e,f),Tl(this.a).setPanning(!0)},T.prototype.startInteraction=T.prototype.gc,T.prototype.Xb=function(e,o,f,m,w){var k=this.s,Y=!1;if(k.qa()){var _e=Tl(this.a),_o=_e.getLookAtData(),_u=this.f.center;_u=[_u.x,_u.y],o=k.store(e,o,f,m,w),f=k.uf(),e=k.Ld(),w=this.s.vf(),m=this.s.Ug(),k.b&&(k.tc(Hl.TILT)&&(_e.setLookAtData({tilt:Ll(this,_o.tilt+e.y/this.f.height*-180)},_u),Y=!0),o&&1!==w&&k.tc(Hl.ZOOM)&&(Y=k.uf(),An(this,Jl(this,w=Dd(Fd(2,this.zoom)*w)/Nd),Y.x,Y.y),Y=!0),k.tc(Hl.COORD)&&0<hm(e)&&(zn(this,-e.x,-e.y),Y=!0),k.tc(Hl.HEADING)&&(o?_e.setLookAtData({heading:_o.heading+Ml(this,m)},[f.x,f.y]):e.x&&_e.setLookAtData({heading:Ml(this,_o.heading+e.x/this.f.width*360)},_u),Y=!0),Y&&(Sl(this.a),this.fa()))}},T.prototype.interaction=T.prototype.Xb,T.prototype.pb=function(e){var o=this;if(this.s.qa()&&!e){if(this.u){e=this.s.sb();var f=this.s.lc(),m=this.u.duration,w=(this.u.Oe||1)*e,k=new Lm(-w/(0<m?m:1),w);!E(f.x)&&!E(f.y)&&0<w&&o.s.tc(Hl.COORD)&&mn(this,function(Y){w=k.ze(Y*m),E(w)||zn(o,zd(-f.x*w),zd(-f.y*w))},m,void 0,this.u.re)}delete this.u,this.s.clear()}Tl(this.a).setPanning(!1),this.fa()},T.prototype.endInteraction=T.prototype.pb,T.prototype.fc=function(e,o,f){fn(this),this.g.start(o,f),Bn(this,e),Tl(this.a).setPanning(!0)},T.prototype.startControl=T.prototype.fc,T.prototype.control=function(e,o,f,m,w,k){for(var _e,Y=0;Y<arguments.length;Y++)if((_e=+arguments[Y])!=_e)throw new D(this.control,Y,_e);this.g.qa()&&this.g.set(e,o,f,m,w,k)},T.prototype.control=T.prototype.control,T.prototype.ob=function(e,o){var m,f=this;if(this.g.qa()){yn(this);var w=Jk(),k=w-this.Cd;if(1<=k&&Cn(this,tm(this.g),k),!this.u||e||o)"function"==typeof o&&(o(e=(e=Tl(this.a)).getLookAtData()),Dn(this,e));else{o=this.g.sb();var _e=this.g.lc(),_o=this.u.duration,_u=(this.u.Oe||1)*o,pd=new Lm(-_u/(0<_o?_o:1),_u);!E(_e.a)&&!E(_e.b)&&0<_u&&mn(this,function(iy,sy,gy,wy){w&&(gy=wy-w,w=0),_u=pd.ze(iy*_o)*gy,E(_u)||((m=_e.c*_u)&&An(f,Jl(f,f.zoom+m),f.g.a,f.g.b),zn(f,zd(_e.a*_u),zd(_e.b*_u)))},_o,void 0,this.u.re)}this.g.reset(),Tl(this.a).setPanning(!1),this.fa()}},T.prototype.endControl=T.prototype.ob,T.prototype.Fc=function(e){var o=this,f=e.b;this.N.set(0,0),f.a||f.b||f.c||f.f||f.g||f.i?(this.Cd=Jk(),mn(this,function(m,w,k,Y){o.Cd=Y,Cn(o,f,k)},Vd),this.fa()):yn(this)},T.prototype.Og=function(){},T.prototype.enter=T.prototype.Og,T.prototype.Pg=function(e){Gl(this.K,e)},T.prototype.exit=T.prototype.Pg,T.prototype.capture=function(e,o,f,m){var w=this;return Xl(w.a).then(function(k){var Y=w.K.ownerDocument.createElement("canvas"),_e=w.na,_o=Y.getContext("2d"),_u=w.a.Ua()/_e,pd=(f-e)*_e;return _e*=m-o,Y.width=pd,Y.height=_e,_o.drawImage(k,e*_u,o*_u,pd*_u,_e*_u,0,0,pd,_e),Y})},T.prototype.Hl=function(e){return Tl(this.a).geoToMeters(e)},T.prototype.geoToMeters=T.prototype.Hl,T.prototype.In=function(e){return Tl(this.a).metersToGeo(e)},T.prototype.metersToGeo=T.prototype.In;var Zm=5e3;function U(e,o,f){var m={};if(!(e instanceof HTMLElement))throw new D(U,0);if(U.l.constructor.call(this),this.i=En(f,U),this.c=f=new Fl,this.B=!1,f.addEventListener(f.A.ie,this.N,!1,this),!C(e,Element))throw new D(U,0,e);var w=(f=this.P=e.ownerDocument.createElement("div")).style;if(w.position="relative",w.height=f.style.width="100%",w.overflow="hidden",w.webkitTapHighlightColor="transparent","transparent"!==w.webkitTapHighlightColor&&(w.webkitTapHighlightColor="rgba(0,0,0,0)"),e.appendChild(f),this.b=new vk(this.P,this.i),this.b.addEventListener(this.b.A.ie,this.N,!1,this),(e=this.a=new qj(this.i.layers)).addEventListener(e.A.he,this.S,!1,this),e.addEventListener(e.A.ee,this.S,!1,this),e.addEventListener(e.A.ge,this.S,!1,this),!this.j&&Fn(this),this.g=null,this.a.add(o,0),this.f=this.u(null!=this.i.engineType?this.i.engineType:hk,this.i),this.v=z(this.v,this),(o=this.i.imprint)!==B&&"object"!=typeof o)throw new D(U,1,"imprint");this.m=null===o?o:new zj(this,o),this.K=(o=this.i.autoColor)===B||!!o,Gn(this),(o=this.i.zoom)&&(m.zoom=o),(o=this.i.bounds)&&(m.bounds=o),(o=this.i.center)&&(m.position=o),this.c.Ob(m)}function En(e,o){if(e){var f=e.pixelRatio;if(f===B)e.pixelRatio=Ue();else if(!(0<f))throw new D(o,0,"pixelRatio: "+f)}else(e={}).pixelRatio=Ue();return e.renderBaseBackground||(e.renderBaseBackground={lower:3,higher:2}),e}function Gn(e){e.m&&e.K&&e.m.ki({invert:e.g&&e.g.xl})}function Hn(e,o,f){e.dispatchEvent(f?new bj(e.A.Gi,f.newValue,f.oldValue,f.modifiers):e.A.Gi+o)}function In(e){vj.call(this,e)}function Fn(e){e.s=new N({max:24,engineType:e.i.engineType}),e.j=new rl(e.s,e.i),e.a.add(e.j)}u(U,F),t("H.Map",U),U.prototype.draggable=!1,U.prototype.o=function(){this.K=!1,this.m&&this.m.D(),this.f.dispose(),this.c.D(),this.b.D(),this.j.D(),this.s.D(),this.a.D();var e=this.P;e.parentNode.removeChild(e),delete this.P,F.prototype.o.call(this)},U.prototype.L=function(){return this.P},U.prototype.getElement=U.prototype.L,U.prototype.Ua=function(){return this.i.pixelRatio},U.prototype.getPixelRatio=U.prototype.Ua,U.prototype.S=function(e){var o=e.added,f=e.removed;o&&o.ka()&&o.ka().ia(this),f&&f.ka()&&f.ka().ia(null),f===this.j&&(delete this.j,delete this.s),f===this.g&&(this.g=null),0===e.idx&&(this.dispatchEvent(new aj(this.A.ff,this.g=e.type!==this.a.A.ge?o:0<this.a.a.length?this.a.get(0):y,e.type!==this.a.A.ee?f:1<this.a.a.length?this.a.get(1):y)),Gn(this))},U.prototype.N=function(e){e.modifiers&&(this.B||(Hn(this,"start"),this.B=!0),Hn(this,"",e),this.da&&x.clearTimeout(this.da),this.da=x.setTimeout(this.v,333))},U.prototype.v=function(){Hn(this,"end"),this.B=!1},U.prototype.ig=function(e,o){return this.f.getCapabilities().lookAt&&this.c.Ob({position:e},!!o),this},U.prototype.setCenter=U.prototype.ig,U.prototype.Za=function(){var e=this.c.fb();return e?e.position:y},U.prototype.getCenter=U.prototype.Za,U.prototype.Ze=function(e,o){return this.c.Ze(e,!!o),this},U.prototype.setZoom=U.prototype.Ze,U.prototype.kb=function(){return this.c.kb()},U.prototype.getZoom=U.prototype.kb,U.prototype.ud=function(e,o,f){this.f.zoomAt(e,o,f)},U.prototype.zoomAt=U.prototype.ud,U.prototype.$m=function(){return this.b},U.prototype.getViewPort=U.prototype.$m,U.prototype.Zm=function(){return this.c},U.prototype.getViewModel=U.prototype.Zm,U.prototype.pm=function(){return this.a},U.prototype.getLayers=U.prototype.pm,U.prototype.km=function(){return this.m},U.prototype.getImprint=U.prototype.km,U.prototype.capture=function(e,o,f,m,w,k){function Y(_m,y0){sy?_m.cancel():(Ey.save(),y0.capture(wy,pd,function(Oy){Ey.restore(),_m.done(Oy)},function(Oy){_m.done(null,Oy),_e(null)}))}function _e(_m){sy||(sy=!0,e(_m))}var wy,Ey,_o=this.f,_u=_o.getCapabilities(),pd=this.i.pixelRatio,iy=this.b,sy=!1,gy=this;if(!Da(e))throw new D(this.capture,0,e);m=m||0,k=k||iy.height;var Py=yd(0,xd(f=f||0,w=w||iy.width)),Jy=yd(0,xd(m,k));f=xd(iy.width,yd(f,w)),m=xd(iy.height,yd(m,k)),_u.capture?_o.capture(Py,Jy,f,m).then(function(_m){var y0=gy.m,Oy=o||[];Ey=(wy=_m).getContext("2d"),wy.style.width=wy.width/pd+"px",wy.style.height=wy.height/pd+"px";var K0=new Kk(10,Y);(Oy=Oy.concat(y0).filter(function(I0){return Da(I0&&I0.capture)})).length?(_m=Oy.pop(),Oy.forEach(function(I0){K0.push(I0,kd)}),K0.push(_m,z(_e,gy,wy)),Dk(K0)):_e(wy)},function(){_e(y)}):e(null)},U.prototype.capture=U.prototype.capture,U.prototype.$l=function(){return this.f},U.prototype.getEngine=U.prototype.$l,U.prototype.u=function(e,o){if(o=o?En(o,this.u):this.i,Gn(this),e===ik.P2D)return new x.H.map.render.p2d.RenderEngine(this.b,this.c,this.a,o);if(e===ik.WEBGL)return new T(this.b,this.c,this.a,o);if(e===ik.HARP)return new x.H.map.render.harp.RenderEngine(this.b,this.c,this.a,o);throw new D(this.u,0,e)},U.prototype.bf=function(e,o,f,m,w){if(o=vc(o)?C(o,K,this.bf,1,o)&&o:this.c.fb().bounds.J(),!C(w=w||this.g,nl))throw new D(this.bf,4);var k=w.ka(),Y=this.Ua(),_e=w.tileSize;if(2<=Y&&256<_e&&k instanceof Ck&&(_e/=2),Y=this.kb(),_e=Math.log2(_e)-8,!((f=vc(f)?+f:Y)<=(m=vc(m)?+m:Y)))throw new D(this.bf,B,"!(min <= max)");Y=k.min;var _o=k.max,_u=this.f.type===ik.WEBGL?Ad:zd;if(f=$d(_u(f)-_e,Y,_o),m=$d(_u(m)-_e,Y,_o),!(k&&C(k,S)&&nd()&&k.m()))throw new Zc(this.bf,"Storing is not supported");return new yk(w,k,o,f,m,e)},U.prototype.storeContent=U.prototype.bf,u(In,vj),In.prototype.g=function(){xj(this,2)},In.prototype.f=function(){xj(this,4)},U.prototype.wl=function(e){return e=new In(e),md().clear(z(e.g,e),z(e.f,e)),e},U.prototype.clearContent=U.prototype.wl,U.prototype.Ag=function(e,o){var f=this.a,m=f.indexOf(e),w=o!==+o;return o=w?f.a.length-1:o,0>m?f.add(e,o):m-o&&(f.bc(m),f.add(e,w?o-1:o)),this},U.prototype.addLayer=U.prototype.Ag,U.prototype.Se=function(e){var o=this.a.indexOf(e);return e!==this.g&&e!==this.j&&-1!==o&&this.a.bc(o),this},U.prototype.removeLayer=U.prototype.Se,U.prototype.rd=function(e){return this.g!==e&&(this.a.a.length&&this.a.get(0)!==this.j?this.a.set(0,e):this.a.add(e,0),this.g=e),this},U.prototype.setBaseLayer=U.prototype.rd,U.prototype.Nl=function(){return this.g},U.prototype.getBaseLayer=U.prototype.Nl,U.prototype.Aa=function(e){if(!ng(e))throw new D(this.Aa,0,e);return(e=this.f.geoToScreen(e))?Af(e):y},U.prototype.geoToScreen=U.prototype.Aa,U.prototype.Ra=function(e,o){var f;if(f=+E(e)||2*+E(o))throw new D(this.Ra,f-1,arguments[f-1]);return(f=this.f.screenToGeo(e,o))?og(f):y},U.prototype.screenToGeo=U.prototype.Ra,U.prototype.fg=function(e,o){return this.f.screenToLookAtData(e,o)},U.prototype.screenToLookAtData=U.prototype.fg,U.prototype.aa=function(e){if(!C(e,M))throw new D(this.aa,0,e);return!this.j&&Fn(this),this.s.Wb().aa(e),e},U.prototype.addObject=U.prototype.aa,U.prototype.Da=function(e){if(!C(e,M))throw new D(this.Da,0,e);return!this.j&&Fn(this),this.s.Wb().Da(e),e},U.prototype.removeObject=U.prototype.Da,U.prototype.Pa=function(e){return!this.j&&Fn(this),this.s.Wb().Pa(e)},U.prototype.getObjects=U.prototype.Pa,U.prototype.Rb=function(e){var o;Ac(e,this.Rb,0,e),!this.j&&Fn(this);var f=e.length;for(o=0;o<f;o++)this.aa(e[o]);return this},U.prototype.addObjects=U.prototype.Rb,U.prototype.od=function(e){var o;Ac(e,this.od,0,e),!this.j&&Fn(this);var f=e.length;for(o=0;o<f;o++)this.Da(e[o]);return this},U.prototype.removeObjects=U.prototype.od,U.prototype.Md=function(e,o,f){var m;if(m=+E(e)||2*+E(o))throw new D(this.Md,m-1,arguments[m-1]);this.f.getObjectsAt(e,o,!0,function(w){f(w[0])})},U.prototype.getObjectAt=U.prototype.Md,U.prototype.Ba=function(e,o,f,m){var w;if(w=+E(e)||2*+E(o))throw new D(this.Md,w-1,arguments[w-1]);this.f.getObjectsAt(e,o,!1,f,!!m)},U.prototype.getObjectsAt=U.prototype.Ba,U.prototype.ah=function(e,o,f){var m=f||kf;f=m.visiblesOnly;var w=m.zoom;m=m.types;var k=oh.ANY;C(e,P,this.ah,0,"area"),yc(o,"Function",this.ah,1,"callback"),this.s.Pa(e,!vc(f)||!!f,vc(w)?+w:this.c.kb(),vc(m)?m&k:k,o)},U.prototype.getObjectsWithin=U.prototype.ah;var ik={P2D:Nl.P2D,WEBGL:Nl.WEBGL,HARP:Nl.HARP};function Jn(e,o){Jn.l.constructor.call(this,e,o)}function th(e,o,f){var m="anonymous",w=1;this.c=z(this.c,this),M.call(this,f),this.$(e),f&&((e="crossOrigin")in f&&(m=f[e]),(e="opacity")in f&&(w=f[e])),this.Ok(o,m),this.cc(w)}function Kn(e,o){Kn.l.constructor.call(this,e,o)}U.EngineType=ik,U.prototype.A={Eo:"mapviewchangestart",Gi:"mapviewchange",Hi:"mapviewchangeend",ff:"baselayerchange"},u(Jn,sh),t("H.map.Marker",Jn),Jn.prototype.type=oh.MARKER,Jn.prototype.da=1,Jn.prototype.pa=function(e){if(e!==lh.VISUAL||1===this.zk||1===this.icon.getState())var o=Jn.l.pa.call(this,e);return o||!1},Jn.prototype.invalidate=Jn.prototype.pa,p=Jn.prototype,p.zk=0,p.Tj=function(e){return C(e,Uj)},p.nh=!1,p.mk=function(){this.pa(lh.VISUAL)},p.Bc=function(e){var o=this.icon;return this.nh&&(o.removeEventListener("statechange",this.mk,!1,this),delete this.nh),o&&(this.zk=o.getState()),Jn.l.Bc.call(this,e),0===e.getState()&&(this.nh=!0,Fe(e,"statechange",this.mk,!1,this)),this},Jn.prototype.setIcon=Jn.prototype.Bc,Jn.prototype.b=function(e){return new Uj(e.svg,e)},Jn.prototype.W=function(){var e=this.getIcon(),o=e.no||0,f=Jn.l.forWorkerMessage.call(this),m=f.properties.icon;return m&&0<o&&Ya(m,{stick_color:e.mo,stick_height:o}),f},Jn.prototype.forWorkerMessage=Jn.prototype.W,u(th,M),t("H.map.Overlay",th),th.prototype.type=oh.OVERLAY,th.prototype.J=function(){return this.a},th.prototype.getBoundingBox=th.prototype.J,th.prototype.ae=function(e){return C(e,K,this.ae,0,e),this.$(e)},th.prototype.setBoundingBox=th.prototype.ae,th.prototype.ca=function(){return this.a},th.prototype.getGeometry=th.prototype.ca,th.prototype.$=function(e){var o=this.a,f=!o;return C(e,K,this.$,0,e),(f||!o.ga(e))&&(this.a=e,f||this.pa(lh.SPATIAL)),this},th.prototype.setGeometry=th.prototype.$,th.prototype.Kc=function(){return this.b.getData()},th.prototype.getBitmap=th.prototype.Kc,th.prototype.Ok=function(e,o){var f=this.b;return f&&1!==f.getState()&&f.cancel(),this.b=new Pj(e,this.c,!0,B,o),this},th.prototype.setBitmap=th.prototype.Ok,th.prototype.c=function(e,o){this.b=o,1===e&&this.pa(lh.VISUAL)},th.prototype.Oc=function(){return this.f},th.prototype.getOpacity=th.prototype.Oc,th.prototype.cc=function(e){var o=this.f,f=2>o;if(!(0<=e&&1>=e))throw new D(this.cc,0);return e!==o&&(this.f=e,f&&this.pa(lh.VISUAL)),this},th.prototype.setOpacity=th.prototype.cc,th.prototype.W=function(){var e=th.l.W.call(this);return e.geometry=zi(this.a).W(),e.properties.overlay=!0,e},th.prototype.forWorkerMessage=th.prototype.W,u(Kn,nl),t("H.map.layer.MarkerTileLayer",Kn);var Ln={markers:[],total:0,requested:0};function Mn(e,o,f,m,w){var Y,k=Ad(f);for(e.pixelProjection.Ka(k),o=e.Qd(e.we(o),k),f=e.Fe(o,o.left>o.right,~~f,m,w),e=f.tiles,f=f.total,m=e.length,w=[],Y=0;Y<m;Y++)for(k=(o=e[Y]).data.length;k--;)w.push(o.data[k]);return{markers:w,total:e.length,requested:f}}function Nn(e,o,f){var m,w=6;if(o){for(m=' expected close to: "'+o;w--;)-1!==(o=e.a.next())&&(m+=String.fromCharCode(o));m+='"'}throw new D(On,0,"- Malformed WKT: "+(m?f+m:"unexpected end of stream"))}function Pn(e,o){var f=e.next();f!==(o=o?")":"(")&&Nn(e,f,'"'+o+'"')}function Qn(e){return","===Rn(e)&&(e.next(),!0)}function Sn(e,o,f,m,w){var k,Y,_e=2+o+f;for(Y=1;Y<=_e;Y++)(f=e.next())?(k=+f)!==k?Nn(e,f,"number"):1===Y?m[w+1]=k:2===Y?m[w]=k:3===Y&&(m[w+2]=k):Nn(e,f);o||(m[w+2]=0)}Kn.prototype.xc=function(e,o,f,m){return this.la.providesDomMarkers()?Ln:Mn(this,e,o,f,m)},Kn.prototype.requestMarkers=Kn.prototype.xc,Kn.prototype.wc=function(e,o,f,m){return this.la.providesDomMarkers()?Mn(this,e,o,f,m):Ln},Kn.prototype.requestDomMarkers=Kn.prototype.wc;var Tn=[];function Un(e,o,f,m){return m||Pn(e,0),Sn(e,o,f,Tn,0),m||Pn(e,1),new mg(Tn[0],Tn[1],o?Tn[2]:B)}function Vn(e,o,f){var m=[];Pn(e,0);do{Sn(e,o,f,m,m.length)}while(Qn(e));return Pn(e,1),new L(m)}function Wn(e,o,f){Pn(e,0);var m=Vn(e,o,f);if(Qn(e)){var w=[];do{w.push(Vn(e,o,f))}while(Qn(e))}return Pn(e,1),new P(m,w)}var Xn=[],Yn=[Wn],Zn=[Un],$n={POINT:Zn,LINESTRING:[Vn],POLYGON:Yn,MULTIPOINT:[Un,Ti],MULTILINESTRING:[Vn,jh],MULTIPOLYGON:[Wn,Gi],GEOMETRY:Xn,GEOMETRYCOLLECTION:Xn,CIRCULARSTRING:Xn,COMPOUNDCURVE:Xn,CURVEPOLYGON:Xn,MULTICURVE:Xn,MULTISURFACE:Xn,CURVE:Xn,SURFACE:Xn,POLYHEDRALSURFACE:Xn,TIN:Xn,TRIANGLE:Xn},ao={Z:1,M:2,ZM:3};function On(e){var o,f=(e=new bo(e)).next();if((o=$n[f.toUpperCase()])||Nn(e,f,"type name"),o!==Xn){f=Rn(e);var m=1&(f=ao[f.toUpperCase()]),w=f>>1;if(m|w&&e.next(),"EMPTY"===(f=Rn(e)))if(e.next(),m=o[1])var k=new m([]);else o!==Zn&&(k=new L([]),o===Yn&&(k=new P(k)));else if("("===f){if(k=o[0],o=o[1]){var Y=[];if(Pn(e,0),k===Un){var _e="("!==Rn(e);do{Y.push(k(e,m,w,_e))}while(Qn(e))}else do{Y.push(k(e,m,w))}while(Qn(e));Pn(e,1),m=new o(Y)}else m=k(e,m,w);k=m}else Nn(e,f,'"Z", "M", "ZM", "(" or "EMPTY"');e.next()&&Nn(e,f,"end of stream")}return k||y}function bo(e){this.a=e}function Rn(e){var o=e.b;if(o===B){for(o=e.a;o.Ib()===co;)o.next();if(eo[o.Ib()])o=(o=o.next())===fo?"":String.fromCharCode(o);else{o.de();do{o.next()}while(!eo[o.Ib()]);o=String.fromCharCode.apply(null,o.Dd())}e.b=o}return o}bo.prototype.next=function(){var e=Rn(this);return""!==e&&delete this.b,e};var co=32,fo=-1,go={Io:co,Co:40,Ho:41,zo:44,Ao:fo},eo=Object.keys(go).reduce(function(e,o){return e[go[o]]=!0,e},oc());function ho(){}function io(e){this.c=String(e),this.f=0,this.a=[],this.b=!1}function jo(e,o){jo.l.constructor.call(this,Hi,o),this.ae(e)}function ko(){return If("H-core","1.37.1","8e9b6d2",{region:"row"})}t("H.util.ICharStream",ho),ho.prototype.next=function(){},ho.prototype.de=function(){},ho.prototype.Dd=function(){},ho.prototype.Ib=function(){},t("H.util.CharStream",io),io.prototype.next=function(){var e=this.c.charCodeAt(this.f++);return e=isNaN(e)?-1:e,this.b&&this.a.push(e),e},io.prototype.de=function(){this.b=!0,this.a=[]},io.prototype.Dd=function(){var e=this.a.slice();return this.b=!1,this.a=[],e},io.prototype.Ib=function(){var e=this.c.charCodeAt(this.f);return isNaN(e)?-1:e},t("H.util.wkt.toGeometry",function(e){return On(new io(e))}),u(jo,vh),t("H.map.Rect",jo),jo.prototype.ae=function(e){if(!C(e,K))throw new D(this.ae,0,e);e.ga(this.oa)||(this.oa=this.B=e,this.a!==y&&jo.l.$.call(this,zi(e)))},jo.prototype.setBoundingBox=jo.prototype.ae,jo.prototype.J=function(){return this.B},jo.prototype.getBoundingBox=jo.prototype.J,jo.prototype.$=function(){return this},jo.prototype.setGeometry=jo.prototype.$,jo.prototype.ca=function(){return this.a===Hi&&jo.l.$.call(this,zi(this.oa)),this.a},jo.prototype.getGeometry=jo.prototype.ca,t("H.buildInfo",ko);var lo="cn"===ko().region,hk=ik[lo?"HARP":"WEBGL"],mo,no="maps".concat("js-"),oo,po,qo,ro,so;if(oo=x.document.querySelector('script[src*="'+no+'"]'),!oo)for(po=x.document.getElementsByTagName("script"),ro=new RegExp("^.*"+no),so=0,qo=po.length;so<qo;so++)if(ro.test(po[so].src)){oo=po[so];break}function to(){var e=decodeURIComponent(mo);if(e){e="/"===e[e.length-1]?e.substring(0,e.length-1):e;var o=x.document,f="";o?((o=o.createElement("a")).href=e,f=o.href):/[\w]+:\/\//.test(e)&&(f=e),(e=new URL(f)).pathname+="/"===e.pathname[e.pathname.length-1]?"styles":"/styles",e=e.toString()}else e="https://js.api.here.com/v3/3.1.37.1/styles";return e}function uo(e){var o=e.ownerDocument;o=o.documentElement||o.body.parentNode||o.body;try{var f=e.getBoundingClientRect()}catch{f={top:0,right:0,bottom:0,left:0,height:0,width:0}}return{x:f.left+("number"==typeof window.pageXOffset?window.pageXOffset:o.scrollLeft),y:f.top+("number"==typeof window.pageYOffset?window.pageYOffset:o.scrollTop)}}mo=oo?oo.src.replace(/\/[^\/]*$/,"/"):"",t("H.getScriptPath",function(){return mo}),t("H.getStylePath",to);var vo=function(){return this}.apply(null);function wo(e,o,f,m,w,k){if(isNaN(e))throw Error("x needs to be a number");if(isNaN(o))throw Error("y needs to be a number");if(isNaN(f))throw Error("pointer must have an id");this.viewportX=e,this.viewportY=o,this.target=null,this.id=f,this.type=m,this.dragTarget=null,this.button=vc(w)?w:-1,this.buttons=vc(k)?k:0,this.a=this.button}function xo(e,o,f){if(isNaN(o))throw Error("x needs to be a number");if(isNaN(f))throw Error("y needs to be a number");e.viewportX=o,e.viewportY=f}function yo(e,o){e.a=o,e.buttons|=zo[+o]||0}function Ao(e,o){e.a=o,e.buttons&=~(zo[+o]||0)}t("H.mapevents.Pointer",wo),wo.prototype.nm=function(){return this.a},wo.prototype.getLastChangedButton=wo.prototype.nm;var zo=[1,4,2],Bo={NONE:-1,LEFT:0,MIDDLE:1,RIGHT:2};function Co(e,o,f,m,w,k,Y){Co.l.constructor.call(this,e),this.pointers=o,this.changedPointers=f,this.targetPointers=m,this.currentPointer=w,this.originalEvent=Y,this.target=k}function Do(e){this.a=e instanceof Array?e.slice(0):[]}function Eo(e,o){return-1!==(o=e.indexOf(o))?e.a[o]:null}function Fo(e,o){for(var f=e.a.length,m=[];f--;)e.a[f].type!==o&&m.push(e.a[f]);e.a=m}function Go(e,o){for(var f=e.a.length;f--;)if(e.a[f].dragTarget===o)return!0;return!1}function Ho(e,o,f){if(f=f||{},!(e instanceof U))throw Error("events: map instance required");if(!(o instanceof Array))throw Error("events: map array required");od.call(this),this.Lg=f.Lg||300,this.Xi=f.Xi||50,this.Zk=f.Zk||50,this.$k=f.$k||500,this.sh=f.sh||900,this.rh=f.rh||8,this.map=e,this.s=this.map.b,this.f=this.s.element,this.B=o,this.a=new Do,this.b=new Do,this.j={},this.c=null,this.u=!0,this.R={},this.g={},this.m=null,this.pe=z(this.pe,this),this.S={pointerdown:this.Al,pointermove:this.Bl,pointerup:this.Cl,pointercancel:this.zl},Io(this)}function Io(e,o){var f,m=e.B.length;for(f=0;f<m;f++){var w=e.B[f],k=w.listener;"function"==typeof k&&(o?(w.target||e.f).removeEventListener(w.Na,k):(w.target||e.f).addEventListener(w.Na,k))}}function Jo(e,o,f){var m;if("function"==typeof e.S[o]){"pointermove"!==o&&(e.u=!0);var w=0;for(m=e.b.length();w<m;w++){var k=e.b.a[w]||null;e.f.contains(f.composedPath()[0])?Ko(e,k,e.dj.bind(e,f,o,k)):e.dj(f,o,k,null)}}e.b.clear()}function Ko(e,o,f){if(e.c===o)f(o.target);else{var m=e.s,w=o.viewportX;if(o=o.viewportY,0>w||0>o||w>=m.width||o>=m.height)f(y);else{var k=e.map;k.Md(w,o,function(Y){f(Y||k)})}}}function Mo(e,o,f){o===e.c&&(No(e,o.dragTarget,"dragend",f,o),e.c=null,Lo(o.id,e.R)),o.dragTarget=null}function Lo(e,o){o[e]&&(o[e].timeout?clearTimeout(o[e].timeout):clearTimeout(o[e]),delete o[e])}function Oo(e,o,f){var m=o.target,w=new G(o.viewportX,o.viewportY),k=o.id;Lo(k,e.g);var Y=setTimeout(function(){m&&m===o.target&&w.Ta({x:o.viewportX,y:o.viewportY})<e.rh&&(No(e,m,"longpress",f,o),delete e.j[o.id])},e.sh);e.g[k]={timeout:Y,Ne:w}}function No(e,o,f,m,w){if(o&&"function"==typeof o.dispatchEvent){var _o,k=Co,Y=e.a.Ha(),_e=e.b.Ha(),_u=(e=e.a).a.length,pd=[];for(_o=0;_o<_u;_o++)e.a[_o].target===o&&pd.push(e.a[_o]);k=new k(f,Y,_e,pd,w,o,m),w.button=/^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(f)?w.a:Bo.NONE,o.dispatchEvent(k)}return k}function Po(e){this.i=z(this.i,this),Ho.call(this,e,[{Na:"touchstart",listener:this.i},{Na:"touchmove",listener:this.i},{Na:"touchend",listener:this.i},{Na:"touchcancel",listener:this.i}]),this.K={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},this.v=(e=(e=e.m)?e.L():null)?Array.prototype.slice.call(e.querySelectorAll("a"),0):[]}function Qo(e){var o=Ro(this);(window.PointerEvent||window.MSPointerEvent)&&o.push({Na:"MSHoldVisual",listener:"prevent"}),Ho.call(this,e,o)}function Ro(e){var f,o=!!window.PointerEvent,w=[];return e.i=z(e.i,e),"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach(function(k){f=k.toLowerCase().replace(/ms/g,""),w.push({Na:o?f:k,listener:e.i,target:/^pointer(up|move)$/.test(f)?window:null})}),w}wo.Button=Bo,u(Co,td),t("H.mapevents.Event",Co),p=Do.prototype,p.clear=function(){this.a.splice(0,this.a.length)},p.length=function(){return this.a.length},p.indexOf=function(e){for(var o=this.a.length;o--;)if(this.a[o].id===e)return o;return-1},p.remove=function(e){return-1!==(e=this.indexOf(e))?this.a.splice(e,1)[0]:null},p.push=function(e){if(e instanceof wo)return this.a.push(e);throw Error("list needs a pointer")},p.Ha=function(){return this.a},p.clone=function(){return new Do(this.a)},u(Ho,od),p=Ho.prototype,p.dj=function(e,o,f,m){Lo(f.id,this.R),this.S[o].call(this,f,m,e)},p.Cl=function(e,o,f){var m=e.id;e.target=o,Mo(this,e,f),No(this,o,"pointerup",f,e),"mouse"!==e.type&&No(this,o,"pointerleave",f,e);var k=f.timeStamp,Y=e.target,_e=this.m;(o=this.j[e.id])&&o.target===Y&&o.Ne.Ta({x:e.viewportX,y:e.viewportY})<this.Zk&&k-o.xi<this.$k?(No(this,Y,"tap",f,e),_e&&_e.target===Y&&k-_e.xi<this.Lg?_e.Ne.Ta({x:e.viewportX,y:e.viewportY})<this.Xi&&(No(this,Y,"dbltap",f,e),this.m=null):this.m={target:Y,Ne:new G(e.viewportX,e.viewportY),xi:f.timeStamp}):this.m=null,this.j={},Lo(m,this.g)},p.pe=function(e,o){var f=this;No(this,e.dragTarget,"drag",o,e),Lo(e.id,this.R),this.R[e.id]=setTimeout(function(){f.pe(e,o)},150)},p.Bl=function(e,o,f){var m=e.dragTarget,w=e.id,k=e.target;e.target=o,k!==o&&(No(this,k,"pointerleave",f,e),No(this,o,"pointerenter",f,e)),m?this.c?(this.pe(e,f),this.g[w]&&this.g[w].Ne.Ta({x:e.viewportX,y:e.viewportY})>this.rh&&Lo(w,this.g)):this.u?this.u=!1:(this.c=e,No(this,m,"dragstart",f,e),this.pe(e,f),delete this.j[w],this.u=!0):(!this.c||this.c&&this.c.dragTarget!==o&&this.c.dragTarget!==this.map)&&No(this,o,"pointermove",f,e)},p.Al=function(e,o,f){var m=!(/^(?:mouse|pen)$/.test(e.type)&&0!==f.button);if(o){e.target=o,this.j[e.id]={Ne:new G(e.viewportX,e.viewportY),target:e.target,xi:f.timeStamp},"mouse"!==e.type&&No(this,o,"pointerenter",f,e);var w=No(this,o,"pointerdown",f,e);!this.c&&m&&(o.draggable&&!Go(this.a,o)?e.dragTarget=o:!this.map.draggable||w.defaultPrevented||Go(this.a,this.map)||(e.dragTarget=this.map)),Oo(this,e,f)}},p.zl=function(e,o,f){var m=e.id;e.target=null,o?(No(this,o,"pointerleave",f,e),No(this,o,"pointercancel",f,e)):No(this,this.map,"pointercancel",f,e),Mo(this,e,f),this.j={},Lo(m,this.g)},p.o=function(){Io(this,!0),this.a.clear(),this.b.clear();var o,e=this.R;for(o in e)Lo(o,e);for(var f in e=this.g)Lo(f,e);delete this.f,delete this.B,delete this.a,delete this.b,delete this.map,this.m=null,delete this.j,this.c=null,od.prototype.o.call(this)},u(Po,Ho),Po.prototype.i=function(e){var m,o=e.touches,f=this.a.length();if("touchstart"===e.type&&f>=o.length){for(f=this.a.clone(),m=o.length;m--;)f.remove(o[m].identifier);for(m=f.length();m--;)this.a.remove((f.a[m]||null).id);this.b=f,Jo(this,"pointercancel",e),this.b.clear()}if(this.K[e.type]){o=uo(this.s.element),f=e.type;var k,w=(m=e.changedTouches).length;for(this.b.clear(),k=0;k<w;k++){var Y=m[k],_e=Eo(this.a,Y.identifier),_o=Y.pageX-o.x,_u=Y.pageY-o.y;if(_e)if("touchmove"===f){Y=Math.abs(_e.viewportX-_o);var pd=Math.abs(_e.viewportY-_u);(1<Y||1<pd||1===Y&&1===pd)&&(xo(_e,_o,_u),this.b.push(_e))}else"touchend"===f&&(this.a.remove(_e.id),this.b.push(_e),Ao(_e,Bo.LEFT));else _e=new wo(_o,_u,Y.identifier,"touch",Bo.LEFT,1),this.a.push(_e),this.b.push(_e)}Jo(this,this.K[e.type],e),-1===this.v.indexOf(e.target)&&e.preventDefault()}},Po.prototype.o=function(){this.v=null,Ho.prototype.o.call(this)},u(Qo,Ho);var So={2:"touch",3:"pen",4:"mouse"};function To(e,o,f,m){To.l.constructor.call(this,"contextmenu"),this.items=[],this.viewportX=e,this.viewportY=o,this.target=f,this.originalEvent=m}function Uo(e){this.fh=z(this.fh,this),this.hh=z(this.hh,this),this.gh=z(this.gh,this),this.v=!1,this.i=-1,this.K=0,Uo.l.constructor.call(this,e,[{Na:"contextmenu",listener:this.fh},{target:e,Na:"longpress",listener:this.hh},{target:e,Na:"dbltap",listener:this.gh}])}function Vo(e,o,f,m,w){var k=e.map,Y=Date.now()-e.K;w?!e.v&&Y>e.sh&&(e.v=!0,w.dispatchEvent(new To(o,f,w,m)),Fe(k.L(),Wo,e.cj,!1,e)):k.Md(o,f,e.yn.bind(e,o,f,m))}Qo.prototype.i=function(e){var o=window.PointerEvent?e.type:e.type.toLowerCase().replace(/ms/g,""),f=uo(this.f),m=Eo(this.a,e.pointerId),w=e.pageX-f.x;f=e.pageY-f.y;var k=So[e.pointerType]||e.pointerType;if(ad&&"rtl"===x.getComputedStyle(this.s.element).direction&&(w-=(x.devicePixelRatio-1)*this.s.width),!(m||/^pointer(up|out|cancel)$/.test(o)||"touch"===k&&"pointerdown"!==o)){var Y=e.pointerType;"number"==typeof Y&&(Y=So[Y]),m=new wo((m={x:w,y:f}).x,m.y,e.pointerId,Y,e.button,e.buttons),this.a.push(m)}m&&(/^pointer(up|cancel)$/.test(o)?("touch"===k&&this.a.remove(m.id),Ao(m,e.button)):"pointerdown"===o&&("touch"===e.pointerType&&(Fo(this.a,"mouse"),Fo(this.a,"pen")),yo(m,e.button)),this.b.push(m),"pointermove"!==o?(xo(m,w,f),Jo(this,/^pointer(over|out)$/.test(o)?"pointermove":o,e)):(m.viewportX!==w||m.viewportY!==f)&&(xo(m,w,f),Jo(this,o,e))),this.b.clear()},u(To,td),t("H.mapevents.ContextMenuEvent",To),u(Uo,Ho),p=Uo.prototype,p.hh=function(e){var o=e.currentPointer;"touch"===o.type&&1===e.pointers.length&&Vo(this,o.viewportX,o.viewportY,e.originalEvent,e.target)},p.gh=function(e){"touch"===e.currentPointer.type&&(this.K=Date.now())},p.fh=function(e){var o=this;-1===this.i?this.i=setTimeout(function(){var f=uo(o.f),m=e.pageX-f.x;f=e.pageY-f.y,o.i=-1,Vo(o,m,f,e)},this.Lg):(clearInterval(this.i),this.i=-1),e.preventDefault()},p.yn=function(e,o,f,m){Vo(this,e,o,f,m=m&&Da(m.dispatchEvent)?m:this.map)},p.cj=function(){this.v&&(this.v=!1,this.map.dispatchEvent(new td("contextmenuclose",this.map)))},p.o=function(){var e=this.map.L();clearInterval(this.i),e&&Me(e,Wo,this.cj,!1,this),Ho.prototype.o.call(this)};var Wo=["mousedown","touchstart","pointerdown","wheel"];function Xo(e,o,f,m,w){Xo.l.constructor.call(this,"wheel"),this.delta=e,this.viewportX=o,this.viewportY=f,this.target=m,this.originalEvent=w}function Yo(e){var o="onwheel"in document;this.da=o,this.K=(o?"d":"wheelD")+"elta",this.i=z(this.i,this),Yo.l.constructor.call(this,e,[{Na:(o?"":"mouse")+"wheel",listener:this.i}]),this.v=this.map.b}function Zo(e){this.i=z(this.i,this),Ho.call(this,e,[{Na:"mousedown",listener:this.i},{Na:"mousemove",listener:this.i,target:window},{Na:"mouseup",listener:this.i,target:window},{Na:"mouseover",listener:this.i},{Na:"mouseout",listener:this.i},{Na:"dragstart",listener:this.v}])}function $o(e){var o=e.b.element.style;if(-1!==ap.indexOf(e))throw Error("InvalidArgument: map is already in use");this.a=e,ap.push(e),o.msTouchAction=o.touchAction="none",bd||!window.PointerEvent&&!window.MSPointerEvent?(this.c=new Po(this.a),this.b=new Zo(this.a)):this.c=new Qo(this.a),this.g=new Yo(this.a),this.f=new Uo(this.a),this.a.nb(this.D,this),od.call(this)}u(Xo,td),t("H.mapevents.WheelEvent",Xo),u(Yo,Ho),Yo.prototype.i=function(e){if(!e.jl){var o=uo(this.f),f=e.pageX-o.x;o=e.pageY-o.y;var k,m=this.K,w=e[m+(m+"Y"in e?"Y":"")];if(ad&&"rtl"===x.getComputedStyle(this.v.element).direction&&(f-=(x.devicePixelRatio-1)*this.v.width),w){var Y=Math.abs,_e=Y(w);w=(!(k=e[m+"X"])||3<=_e/Y(k))&&(!(k=e[m+"Z"])||3<=_e/Y(k))?(+(0<w)-+(0>w))*(this.da?1:-1):0}(f=new Xo(w,f,o,null,e)).delta&&(e.stopImmediatePropagation(),e.preventDefault(),this.map.Md(f.viewportX,f.viewportY,this.N.bind(this,f)))}},Yo.prototype.N=function(e,o){var m,w,f=e.target=o||this.map;setTimeout(function(){f.dispatchEvent(e),e.c||((w=new x.WheelEvent("wheel",m=e.originalEvent)).jl=!0,m.target.dispatchEvent(w))},0)},u(Zo,Ho),Zo.prototype.i=function(e){var m,o=e.type,f=uo(this.f);f={x:e.pageX-f.x,y:e.pageY-f.y},(m=this.a.a[0]||null)||(m=new wo(f.x,f.y,1,"mouse"),this.a.push(m)),this.b.push(m),xo(m,f.x,f.y),/^mouse(?:move|over|out)$/.test(o)?Jo(this,"pointermove",e):(/^mouse(down|up)$/.test(o)&&(f=e.which-1,"up"===vo.RegExp.$1?Ao(m,f):yo(m,f)),Jo(this,o.replace("mouse","pointer"),e)),this.b.clear()},Zo.prototype.v=function(e){e.preventDefault()},u($o,od),t("H.mapevents.MapEvents",$o);var ap=[];function bp(e,o){var f;if(o=void 0===o?{}:o,bp.l.constructor.call(this),-1!==cp.indexOf(e))throw new D(bp,0,"events are already used");this.b=f=e.a,this.j=e,cp.push(e),f.draggable=!0,this.i=o.kinetics||{duration:600,ease:Zl},this.m=o.modifierKey||"Alt",this.enable(o.enabled),this.c=f.b,this.f=this.c.element,this.g=0,f.addEventListener("dragstart",this.Ch,!1,this),f.addEventListener("drag",this.bk,!1,this),f.addEventListener("dragend",this.Bh,!0,this),f.addEventListener("wheel",this.rk,!1,this),f.addEventListener("dbltap",this.lk,!1,this),f.addEventListener("pointermove",this.ck,!1,this),Ee(this.f,"contextmenu",this.ak,!1,this),e.nb(this.D,this)}Hc(ap),$o.prototype.D=function(){delete this.a,this.c.D(),this.g.D(),this.f.D(),this.b&&this.b.D(),ap.splice(ap.indexOf(this.a),1),od.prototype.D.call(this)},$o.prototype.dispose=$o.prototype.D,$o.prototype.Ml=function(){return this.a},$o.prototype.getAttachedMap=$o.prototype.Ml,u(bp,od),t("H.mapevents.Behavior",bp);var cp=[];Hc(cp),bp.prototype.a=0;var dp={PANNING:1,PINCH_ZOOM:2,WHEEL_ZOOM:4,DBL_TAP_ZOOM:8,FRACTIONAL_ZOOM:16,TILT:32,HEADING:64};bp.Feature=dp;var ep=dp.PANNING,fp=dp.PINCH_ZOOM,gp=dp.WHEEL_ZOOM,hp=dp.DBL_TAP_ZOOM,ip=dp.FRACTIONAL_ZOOM,jp=dp.TILT,kp=dp.HEADING,lp=ep|fp|gp|hp|ip|jp|kp;function mp(e,o){if(e!==+e||e%1||0>e||2147483647<e)throw new D(o,0,"integer in range [0...0x7FFFFFFF] required")}function np(e,o,f){var k,m="touch"===o.currentPointer.type,w=0;if(k=!m){k=e.m;var Y,_e=o.originalEvent;Y=_e.getModifierState?_e.getModifierState(k):!!_e[k.replace(/^Control$/,"ctrl").toLowerCase()+"Key"],k=Y}return k?w|=jp|kp:(w|=ep,m&&2===(o=o.pointers).length&&(w|=fp|kp,f?55>Cd(o[0].viewportY-o[1].viewportY)&&(w|=jp):e.kh&Hl.TILT&&(w|=jp))),((w&=e.a)&jp?Hl.TILT:0)|(w&kp?Hl.HEADING:0)|(w&fp?Hl.ZOOM:0)|(w&ep?Hl.COORD:0)}function op(e){var o=e.pointers;return e=[(e=o[0]).viewportX,e.viewportY],(o=o[1])&&e.push(o.viewportX,o.viewportY),e}function pp(e,o,f,m,w){var k=+f-+o;if(e=e.b.c,isNaN(+o))throw Error("start zoom needs to be a number");if(isNaN(+f))throw Error("to zoom needs to be a number");0!==k&&(e.startControl(null,m,w),e.control(0,0,6,0,0,0),e.endControl(!0,function(Y){Y.zoom=f}))}function qp(e,o){return Ya.apply(null,arguments),e}function rp(e,o){var f=x.console;f&&f.warn&&(e=xc(e)+" is deprecated and will be removed soon. ",o&&(e+=o),f.warn(e))}bp.DRAGGING=ep,bp.WHEELZOOM=gp,bp.DBLTAPZOOM=hp,bp.FRACTIONALZOOM=ip,bp.prototype.disable=function(e){var o=this.a;e!==B?(mp(e,this.disable),o^=o&e):o=0,this.c.endInteraction(!0),this.a=o,this.b.draggable=0<(o&(ep|jp|kp|fp))},bp.prototype.disable=bp.prototype.disable,bp.prototype.enable=function(e){var o=this.a;e!==B?(mp(e,this.enable),o|=e&lp):o=lp,this.a=o,this.b.draggable=0<(o&(ep|jp|kp|fp))},bp.prototype.enable=bp.prototype.enable,bp.prototype.isEnabled=function(e){return mp(e,this.isEnabled),e===(this.a&e)},bp.prototype.isEnabled=bp.prototype.isEnabled,p=bp.prototype,p.kh=0,p.Ch=function(e){var o=np(this,e,!0);if(this.kh=o){var f=this.c;if(e=op(e),f.startInteraction(o,this.i),f.interaction.apply(f,e),this.a&gp&&!(this.a&ip)&&(o=e[0],f=e[1],this.g)){e=this.b.kb();var m=(0>this.g?Bd:Ad)(e);e!==m&&(this.g=0,pp(this,e,m,o,f))}}},p.bk=function(e){var o=np(this,e,!1);if(o!==this.kh)"pointerout"!==e.originalEvent.type&&"pointerover"!==e.originalEvent.type&&(this.Bh(e),this.Ch(e));else if(o){o=this.c;var f=op(e);o.interaction.apply(o,f),e.originalEvent.preventDefault()}},p.Bh=function(e){np(this,e,!1)&&this.c.endInteraction(!this.i)},p.rk=function(e){if(!e.defaultPrevented&&this.a&gp){var o=e.delta,f=this.b.kb(),m=this.b,w=m.f.type;m=this.a&ip?f-o:(0>-o?Bd:Ad)(f)-o,(w===ik.P2D||w===ik.WEBGL||w===ik.HARP)&&(pp(this,f,m,e.viewportX,e.viewportY),this.g=o),e.preventDefault()}},p.ck=function(){},p.lk=function(e){var o=e.currentPointer,f=this.b.kb(),w=this.b.f.type;(w===ik.P2D||w===ik.WEBGL||w===ik.HARP)&&this.a&hp&&(e="mouse"===e.currentPointer.type?0===e.originalEvent.button?-1:1:0<e.pointers.length?1:-1,pp(this,f,e=this.a&ip?f-e:(0>-e?Bd:Ad)(f)-e,o.viewportX,o.viewportY))},p.ak=function(e){return!(this.a&hp&&(e.preventDefault(),1))},p.D=function(){var e=this.b;e&&(e.draggable=!1,e.removeEventListener("dragstart",this.Ch,!1,this),e.removeEventListener("drag",this.bk,!1,this),e.removeEventListener("dragend",this.Bh,!0,this),e.removeEventListener("wheel",this.rk,!1,this),e.removeEventListener("dbltap",this.lk,!1,this),e.removeEventListener("pointermove",this.ck,!1,this),delete this.b),this.f&&(this.f.style.msTouchAction="",Me(this.f,"contextmenu",this.ak,!1,this),delete this.f),delete this.c,delete this.i,cp.splice(cp.indexOf(this.j),1),delete this.j,od.prototype.D.call(this)},bp.prototype.dispose=bp.prototype.D,t("H.mapevents.buildInfo",function(){return If("H-mapevents","1.37.1","8e9b6d2",{region:"row"})}),S.prototype.s=da(3,function(e){var o=this.getCache(),f=this;if(e!==y){C(e,Pk,S.prototype.s,0);var m=e}else m=wl;m!==o&&o.ma(function(w,k,Y){return!!f.Sb(w)&&(m.add(w,k,Y),!0)}),this.S=m}),qi.prototype.b=da(2,function(e){this.g=e,(e=this.getState())!==Uh.INIT&&e!==Uh.LOADING&&xi(this)});var sp=globalThis;function tp(){}tc("monospace serif"),tp.prototype.pop=function(e){return this[e]||(this[e]=[]),this[e].pop()||document.createElement("canvas")},tp.prototype.push=function(e,o){this[o]||(this[o]=[]),this[o].push(e)};var up=new tp;function V(e,o,f,m,w,k){if(!e||!o)throw new D(V,B,'Parameters "scheme" and "host" must be specified');this.ri(e),this.Xe(o),this.td(f),this.mi(w),this.Lk(k),this.kg(m)}function vp(e,o){var m,_o,_u,f=x.document,w="";if(f){if(w=f.createElement("a"),o){var k=(m=f.getElementsByTagName("base")[0])&&m.href,Y=f.head,_e=m||Y.appendChild(f.createElement("base"));_e.href=o}w.href=e,w=w.href,o&&(m?m.href=k:Y.removeChild(_e))}else/[\w]+:\/\//.test(e)&&(w=e);if(e=(k=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(w))[1],Y=k[4],o=k[5],_e=k[6],f=k[7],m=k[8],!k[2]&&Y&&/@/.test(Y)&&(Y=Y.split("@")[1]),k=V,_e=_e&&0<_e.length?_e.substr(1):"",w={},f)for(_o=/([?&]?([^=&+]+))(=([^&]+))?/g;_u=_o.exec(f);)w[decodeURIComponent(_u[2])]=_u[4]?decodeURIComponent(_u[4]):void 0;return new k(e,Y,_e,w,isNaN(+o)?void 0:+o,m&&0<m.length?m.substr(1):"")}function yp(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(o){return"%"+o.charCodeAt(0).toString(16)})}function xp(e){var w,o=[],f=e.a,m={};for(w in f){if(f.hasOwnProperty(w)&&"function"!=typeof f[w]){var k=e.a[w];m.vd=yp(w),C(k,zp)?k.a.forEach(function(Y){return function(_e){o.push(Y.vd+"="+yp(_e))}}(m)):C(k,Ap)?o.push(m.vd+"="+k.b.map(function(Y){return yp(Y)}).join(k.a)):o.push(void 0===k?m.vd:m.vd+"="+yp(k))}m={vd:m.vd}}return 0<o.length?"?"+o.join("&"):""}function Bp(e){var o=If("H-service","1.37.1","8e9b6d2",{region:"row"});return e.a.xnlp="CL_JSMv3."+o.version,e}function wp(e){var o,f=0;for(o in e.a)if(e.a.hasOwnProperty(o)&&"function"!=typeof e.a[o]&&0<++f)break;return!f}function Cp(e,o){if(Ac(e))for(var f=0;f<e.length;f++){var m=e[f];if(!Bc(m)&&!Ec(m)){var w="The Array does not contain only strings and numbers";break}}else w="Not an Array";if(w)throw new D(o,0,e);return e}function zp(e){this.a=Cp(e,zp)}function Ap(e,o){if(this.b=Cp(e,Ap),!/^[!\$\(\)\*\+,;]$/.test(o))throw new D(Ap,1,'Invalid delimiter "'+o+'"');this.a=o}function W(e){var o=(e=qp({},this.c,e)).apikey||e.apiKey,f=e.baseUrl;if(f=o?f?0:"baseUrl":"apikey")throw new D(W,0,'"'+f+'" must be specified');this.Nk(e.baseUrl),this.b=o,this.a.I({apikey:o}),this.f=e.headers||{},this.g=Wa(e.servicesConfig||{})}function Dp(e){if(!e||!Da(e.requestData))throw new D(Dp,0,"options.requestData");Dp.l.constructor.call(this,e),this.K=e.requestData,this.B=!!e.providesDomMarkers}function Ep(){this.a={}}t("H.service.util.eval",function(a){return eval(a)}),t("H.service.Url",V),V.parse=vp,V.prototype.clone=function(){var o,e={};for(o in this.a)e[o]=this.a[o];return new V(this.i,this.g,this.b,e,this.f,this.c)},V.prototype.clone=V.prototype.clone,V.prototype.ri=function(e){if(!e||"string"!=typeof e)throw new D(this.ri,0,'The "scheme" parameter must be a non-empty string.');return this.i=e,this},V.prototype.setScheme=V.prototype.ri,V.prototype.Nm=function(){return this.i},V.prototype.getScheme=V.prototype.Nm,V.prototype.Xe=function(e){if(!e||"string"!=typeof e||"-"===e.charAt(0)||"."===e.charAt(0)||"."===e.charAt(e.length-1))throw new D(this.Xe,0,'The "host" parameter is not a valid host name.');return this.g=e,this},V.prototype.setHost=V.prototype.Xe,V.prototype.im=function(){return this.g},V.prototype.getHost=V.prototype.im,V.prototype.td=function(e){return this.b=e||void 0,this},V.prototype.setPath=V.prototype.td,V.prototype.Am=function(){return this.b},V.prototype.getPath=V.prototype.Am,V.prototype.kg=function(e){if(e){if("object"!=typeof e)throw new D(this.kg,0,'Parameter "params" must be an object.');this.a=e}else this.a={};return this},V.prototype.setQuery=V.prototype.kg,V.prototype.Kj=function(){return!wp(this)},V.prototype.hasQuery=V.prototype.Kj,V.prototype.getQuery=function(){return this.a},V.prototype.getQuery=V.prototype.getQuery,V.prototype.mi=function(e){if(void 0===e)this.f=e;else{var o=$d(+e<<0,0,65535);if(o!=e)throw new D(this.mi,0,'Parameter "port" must be an integer in range [0...65535]');this.f=o}return this},V.prototype.setPort=V.prototype.mi,V.prototype.Dm=function(){return this.f},V.prototype.getPort=V.prototype.Dm,V.prototype.Lk=function(e){return this.c=e||void 0,this},V.prototype.setAnchor=V.prototype.Lk,V.prototype.fd=function(){return this.c},V.prototype.getAnchor=V.prototype.fd,V.prototype.I=function(e){if("object"!=typeof e)throw new D(this.I,0,'Parameter "other" must be an object.');var f,o=this.a;for(f in e)e.hasOwnProperty(f)&&"function"!=typeof e[f]&&(o[f]=e[f]);return this},V.prototype.mergeQuery=V.prototype.I,V.prototype.za=function(e){if(!e||"string"!=typeof e)throw new D(this.za,0,'Parameter "subDomain" must be a non-empty string');return"."===e.substr(e.length-1)&&(e=e.substr(0,e.length-1)),this.Xe(e+"."+this.g)},V.prototype.addSubDomain=V.prototype.za,V.prototype.F=function(e){if(!e||"string"!=typeof e)throw new D(this.F,0,'Parameter "subPath" must be a non-empty string');return this.td((this.b?this.b+"/":"")+e)},V.prototype.addSubPath=V.prototype.F,V.prototype.toString=function(){return[this.i+"://",this.g,this.f?":"+this.f:"",this.b||!wp(this)||this.c?"/":"",this.b?encodeURI(this.b):"",xp(this),this.c?"#"+encodeURIComponent(this.c):""].join("")},V.prototype.toString=V.prototype.toString,V.MultiValueQueryParameter=zp,zp.prototype.Ym=function(){return this.a},zp.prototype.getValues=zp.prototype.Ym,V.DelimitedQuerySubValues=Ap,t("H.service.Platform",W),W.prototype.c={apikey:null,baseUrl:new V("https","hereapi"+(lo?".cn":".com"))},W.prototype.Nk=function(e){this.a=Bp(e.clone()),this.b=e=this.b,this.a.I({apikey:e})},W.prototype.setBaseUrl=W.prototype.Nk,W.prototype.Bb=function(){return this.a},W.prototype.getBaseUrl=W.prototype.Bb,W.prototype.Ma=function(e,o){try{return e.Rj=!0,new e(qp({platformBaseUrl:this.Bb(),headers:this.f},this.g[e.CONFIG_KEY]||{},o||{}))}finally{e.Rj=!1}},W.prototype.createService=W.prototype.Ma,W.prototype.qf=function(e,o,f,m,w,k){function Y(gy,wy,Ey,Py,Jy){return gy.ic(wy,Ey,pd,Py,iy,1,Jy,_o)}var _e=hk,_o={crossOrigin:"anonymous"};if(Ea(e)){var _u=e;"crossOrigin"in _u&&(_o.crossOrigin=_u.crossOrigin),e=_u.tileSize,o=_u.ppi,f=_u.lg,m=_u.lg2,w=_u.style,k=_u.pois,_u.engineType&&(_o.engineType=_e=_u.engineType)}var pd=e||512,iy={};if(0>[72,250,320,500].indexOf(+o)){if(o!==B)throw new D(this.qf,1,o)}else iy.ppi=+o;if(f&&(iy.lg=f),m&&(iy.lg2=m),w&&(iy.style=w),k&&(iy.pois=!!k),_e===ik.HARP&&!H.map.render.harp)throw new D(this.qf,0,"HARP engine is not supported, module not found");if(e=this.xj(),w=_e===ik.WEBGL?new qi(to()+"/omv/miami/normal.day.yaml"):new H.map.render.harp.Style(to()+"/harp/oslo/normal.day.json"),o={engineType:_e},_u&&_u.politicalView&&(o.politicalView=_u.politicalView),f&&(o.lg=f),m&&(o.lg2=m),k&&(o.pois=k),f=e.cd(w,o),m={},lo)qp(m,{vector:{normal:{map:f}}});else{k=this.$g(),_u=this.$g({type:"aerial"}),w=this.Dj();var sy=_e===ik.WEBGL?new qi(to()+"/omv/miami/truck.day.yaml"):new H.map.render.harp.Style(to()+"/harp/oslo/normal.day.json");e=e.cd(sy,o),o=w.Vi(iy.lg?{lg:iy.lg,i18n:!0,engineType:_e}:{engineType:_e}),qp(m,{vector:{normal:{map:f,truck:e,traffic:w.Ui(void 0,_e),trafficincidents:o}},raster:{normal:{xbase:Y(k,"xbasetile","normal.day","png8",!1),xbasenight:Y(k,"xbasetile","normal.night","png8",!0),base:Y(k,"basetile","normal.day","png8",!1),basenight:Y(k,"basetile","normal.night","png8",!0),map:Y(k,"maptile","normal.day","png8",!1),mapnight:Y(k,"maptile","normal.night","png8",!0),trafficincidents:o,transit:Y(k,"maptile","normal.day.transit","png8",!1),labels:Y(k,"labeltile","normal.day","png",!1)},satellite:{xbase:Y(_u,"xbasetile","hybrid.day","jpg",!0),base:Y(_u,"basetile","hybrid.day","jpg",!0),map:Y(_u,"maptile","hybrid.day","jpg",!0),labels:Y(_u,"labeltile","hybrid.day","png",!0)},terrain:{xbase:Y(_u,"xbasetile","terrain.day","jpg",!1),base:Y(_u,"basetile","terrain.day","jpg",!1),map:Y(_u,"maptile","terrain.day","jpg",!1),labels:Y(_u,"labeltile","terrain.day","png",!1)}}})}return m},W.prototype.createDefaultLayers=W.prototype.qf,u(Dp,S),t("H.map.provider.MarkerTileProvider",Dp),Dp.prototype.Gd=function(e){return e?e.length+1:1},Dp.prototype.getEntryWeight=Dp.prototype.Gd,Dp.prototype.G=function(e,o,f,m,w){var k=this;return this.K(e,o,f,function(Y){for(var _o,_u,_e=[],pd=Y.length;pd--;)(_u=Y[pd]).po=k.getTileKey(e,o,f),_u.ia(k),_o=_u.qb(),(C(_u,$i)||1===_o.getState())&&_e.push(Y[pd]);m(_e)},w)},Dp.prototype.requestInternal=Dp.prototype.G,Dp.prototype.Rd=function(e,o){o===lh.VISUAL&&(e=this.Db().get(e.po))&&(e.valid=!1,this.Sa(e))},Dp.prototype.invalidateObject=Dp.prototype.Rd,Dp.prototype.Jb=function(){return this.B},Dp.prototype.providesDomMarkers=Dp.prototype.Jb,Dp.prototype.Kb=gf,Dp.prototype.providesMarkers=Dp.prototype.Kb,Ep.prototype.qb=function(e,o){var m,f=e+o;return(m=this.a[f])?m:(e=(e=Fp.MARKER.replace("{{icon}}",Gp[e]||Gp.OTHER)).replace("{{color}}",Hp[o]||Hp.BLOCKING),o={size:{w:26,h:33},anchor:{x:13,y:30},hitArea:new Vi(Wi.POLYGON,Ip.MARKER)},this.a[f]=m=new Uj(e,o))};var Fp={MARKER:'<svg width="26" height="33" enable-background="new 0 0 26 33" viewBox="0 0 26 33" xmlns="http://www.w3.org/2000/svg"><path d="m26 33h-26v-33h26z" fill="#8c8c8c" opacity="0"/><path d="m17 29.566c0 1.116-1.791 2.022-4 2.022s-4-.906-4-2.022c0-1.118 1.791-2.026 4-2.026s4 .908 4 2.026" fill="#878787" opacity=".6"/><path d="m1.795 17.971c-1.562-1.555-1.574-3.828-.028-5.655l8.343-10.021c.769-.895 1.795-1.384 2.894-1.384 1.117 0 2.197.521 2.889 1.394l8.338 10.014c1.588 1.854 1.578 4.022-.029 5.65l-11.202 11.202z" fill="{{color}}"/>{{icon}}</svg>'},Gp={CONGESTION:'<path style="fill:#FFFFFF;" d="M12.966,1.177c0.965,0,1.894,0.442,2.496,1.204l8.378,10.258c1.362,1.592,1.482,3.477,0,4.979L12.994,28.464L2.143,17.618c-1.381-1.375-1.38-3.348,0-4.979l8.314-10.258C11.174,1.547,12.085,1.177,12.966,1.177 M12.967,0.177L12.967,0.177c-1.247,0-2.408,0.551-3.269,1.552l-8.332,10.28c-1.711,2.022-1.688,4.567,0.07,6.317l10.85,10.845l0.707,0.707l0.707-0.707l10.847-10.846c1.784-1.807,1.803-4.292,0.053-6.337L16.237,1.748C15.462,0.769,14.236,0.177,12.967,0.177L12.967,0.177z M16.645,10.405l-2.025-2.22c-0.48-0.51-1.15-0.8-1.84-0.8H9.53c-0.69,0-1.36,0.29-1.84,0.8l-1.94,2.22c-0.39,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.44l0.255-0.539c0.204-0.431,0.456-0.837,0.753-1.21l0.962-1.211l0.83-0.9c0.32-0.35,0.72-0.63,1.15-0.82H8.23c-0.28,0-0.55-0.07-0.79-0.22l-0.28-0.17l1.27-1.45c0.28-0.31,0.68-0.48,1.1-0.48h3.25c0.42,0,0.82,0.17,1.1,0.48l1.354,1.54H16.645z M18.31,12.205c-0.35-0.37-0.81-0.63-1.3-0.74c-0.18-0.04-0.36-0.06-0.54-0.06h-3.24c-0.7,0-1.37,0.29-1.84,0.8l-1.13,1.22l-0.82,1c-0.38,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.75v-1h5.99v1h1.75c0.69,0,1.25-0.56,1.25-1.25v-1.64c0-0.74-0.2-1.46-0.59-2.09L18.31,12.205z M12.1,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C12.35,16.993,12.238,17.105,12.1,17.105z M18.59,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C18.84,16.993,18.728,17.105,18.59,17.105z M18.56,14.505c-0.24,0.15-0.51,0.22-0.79,0.22h-5.85c-0.28,0-0.55-0.07-0.78-0.22l-0.29-0.17l1.27-1.45c0.15-0.16,0.33-0.28,0.53-0.37c0.18-0.07,0.38-0.11,0.58-0.11h3.24c0.24,0,0.48,0.06,0.68,0.16c0.16,0.08,0.3,0.19,0.42,0.32l1.27,1.45L18.56,14.505z M8.42,13.03h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C8.67,12.918,8.559,13.03,8.42,13.03z"/>',ROADWORKS:'<path d="m13.004 1.411c.964 0 1.894.441 2.496 1.204l8.346 10.023c1.363 1.592 1.482 3.477 0 4.979l-10.846 10.847-10.852-10.846c-1.381-1.375-1.379-3.348 0-4.979l8.346-10.023c.717-.835 1.628-1.205 2.51-1.205m0-1c-1.248 0-2.408.551-3.268 1.552l-8.356 10.035c-1.718 2.033-1.695 4.578.064 6.328l10.85 10.845.706.707.707-.707 10.846-10.846c1.784-1.808 1.803-4.293.053-6.337l-8.337-10.012c-.769-.973-1.996-1.565-3.265-1.565zm-.575 15.264c.018-.332-.13-.651-.394-.851l-2.945-2.235-.21.36c-.22.39-.41.78-.58 1.19l-.677 2.129-1.364 3.051h1.314l2.109-4.672 1.317 1.212.138 3.46h1.092zm6.16-1.327c-.401-.54-1.209-.539-1.609.001l-1.17 1.58-2.29-1.74-.139-4.054c-.011-.276-.134-.535-.342-.716l-.7-.61c-.185-.161-.422-.25-.667-.25h-1.885c-.335 0-.648.168-.833.447l-1.144 1.723 7.58 5.76-1.86 2.51c-.098.132-.004.32.161.32h6.648l1.142-1.077zm-8.79-2.989-.876-.665.841-1.018.965.043zm1.63 1.24.969-1.781.118 2.61zm2.76-5.79c-.64 0-1.16.52-1.16 1.16 0 .65.52 1.17 1.16 1.17s1.16-.52 1.16-1.17c0-.64-.52-1.16-1.16-1.16z" fill="#fff"/>',ACCIDENT:'<path style="fill:#FFFFFF;" d="M12.998,1.091c0.964,0,1.894,0.442,2.496,1.204l8.346,10.344c1.363,1.592,1.482,3.477,0,4.979L12.994,28.465L2.143,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.344C11.205,1.462,12.115,1.091,12.998,1.091 M12.998,0.091L12.998,0.091c-1.248,0-2.408,0.551-3.269,1.552L1.364,12.011c-1.708,2.021-1.685,4.566,0.073,6.316l10.85,10.845l0.707,0.707l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337l-8.327-10.32C15.494,0.684,14.268,0.091,12.998,0.091L12.998,0.091z M7.83,18.982l-3.309-1.855l0.945,1.855H7.83z M16.111,19h3.942l1.596-2L16.111,19z M10.512,20.064l1.021-1.021l1.632,0.076c0.329,0.018,0.651-0.022,0.963-0.123c0.626-0.206,1.122-0.76,1.288-1.44l0.264-1.089l2.066-0.93c0.373-0.17,0.673-0.42,0.861-0.731c0.275-0.449,0.405-0.97,0.369-1.498L18.9,11.676l1.021-1.021l-0.724-0.724l-0.427,0.427l-0.121-0.364c-0.201-0.603-0.54-1.151-0.989-1.6l-1.159-1.159c-0.5-0.5-1.31-0.5-1.809,0l-1.267,1.267l0.724,0.724l-5.066,5.066l-0.724-0.724l-1.267,1.267c-0.5,0.5-0.5,1.31,0,1.809l1.159,1.159c0.449,0.449,0.997,0.788,1.6,0.989l0.364,0.121l-0.427,0.427L10.512,20.064z M14.901,10.349l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0l-0.732-0.732C14.803,10.604,14.803,10.446,14.901,10.349z M9.472,15.777l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0L9.472,16.13C9.375,16.033,9.375,15.874,9.472,15.777z M11.391,17.615c0.069-0.271,0.206-0.518,0.405-0.717l4.961-4.961c0.195-0.195,0.445-0.337,0.717-0.405l0.344-0.083l0.137,1.925c0.022,0.318-0.058,0.63-0.221,0.901c-0.101,0.166-0.279,0.271-0.409,0.329L14.8,15.74l-0.38,1.574c-0.083,0.344-0.318,0.615-0.612,0.713c-0.188,0.058-0.38,0.083-0.579,0.072l-1.925-0.138L11.391,17.615z"/>',OTHER:'<path style="fill:#FFFFFF;" d="M13.004,1.411c0.964,0,1.894,0.441,2.496,1.204l8.346,10.023c1.363,1.592,1.482,3.477,0,4.979L13,28.465L2.148,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.023C11.211,1.781,12.122,1.411,13.004,1.411 M13.004,0.411L13.004,0.411c-1.248,0-2.408,0.551-3.268,1.552L1.38,11.998c-1.718,2.033-1.694,4.579,0.064,6.328l10.85,10.845L13,29.878l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337L16.269,1.976C15.5,1.003,14.273,0.411,13.004,0.411L13.004,0.411z M14.716,20.139c0,0.947-0.758,1.724-1.724,1.724c-0.947,0-1.704-0.777-1.704-1.724c0-0.928,0.757-1.704,1.704-1.704C13.958,18.435,14.716,19.211,14.716,20.139z M14.204,16.33H11.78l-0.537-8.533h3.5L14.204,16.33z"/>'},Hp={BLOCKING:"#323232",VERYHIGH:"#d5232f",HIGH:"#ffa100"},Ip={MARKER:[24.1,17.8,14.2,28.42,16.8,29.4,12.8,31.4,8.79,29.4,11.23,28.42,1.7,17.8,1.7,12.1,10,1.9,12.9,.498,15.8,1.9,24.1,12.1,24.1,17.8]};function Jp(e,o,f){(f=f||{}).criticality||(f.criticality="major,critical"),C(e,Kp,Jp,0),Dp.call(this,{max:20,min:8,requestData:z(this.N,this),engineType:f.engineType}),this.b=new Ep,this.v=e,this.i=f,this.reload=z(this.reload,this),this.u=setInterval(this.reload,o||18e4)}u(Jp,Dp),t("H.service.traffic.incidents.Provider",Jp);var Lp={minor:"HIGH","low impact":"HIGH",major:"VERYHIGH",critical:"BLOCKING"};Jp.prototype.N=function(e,o,f,m,w){var k=this,Y=this.b;return this.v.requestIncidentsByTile(e,o,f,function(_e){var _u,_o=[];if(_e=_e.TRAFFIC_ITEMS)for(_u=(_e=_e.TRAFFIC_ITEM).length;_u--;){var pd=_e[_u],iy=pd.TRAFFIC_ITEM_TYPE_DESC;switch(iy){case"ACCIDENT":case"CONGESTION":var sy=iy;break;case"CONSTRUCTION":sy="ROADWORKS";break;default:sy="OTHER"}sy=Y.qb(sy,Lp[pd.CRITICALITY.DESCRIPTION]),(iy=new Jn({lat:(iy=pd.LOCATION.GEOLOC.ORIGIN).LATITUDE,lng:iy.LONGITUDE},{provider:k,icon:sy})).setData(pd),_o.push(iy)}m(_o)},w,this.i)},Jp.prototype.D=function(){Dp.prototype.D.call(this),clearInterval(this.u)},Jp.prototype.dispose=Jp.prototype.D;var Mp="A21 A22 F01 F02 F08 F04 F05 F07 F03 F06 A2F F13 A25 A2C F12 D1B F1B A27 E12 A3A A24 A3D A3F F1F F25 F2C E32 A33 F29 D26 D36 F26 D0F F0F F2B E0C D3A A45 D23 D11 F2E F19 F14 F39 A4A A4B A5C D38 F2A F1A D0A F1C A48 D25 D1D F32 A46 A3E D24 E1C E32 A5F D2E D22 D0A".split(" ");function Np(e,o,f,m){Np.l.constructor.call(this,{min:10,max:21,engineType:m}),C(e,Kp,Np,0),this.u=e,this.b=f||Op,this.b.responseattributes="sh,fc",this.i=setInterval(z(this.reload,this),o||18e4),this.c===ik.WEBGL?this.Pb(new qi(to()+"/traffic/flow.yaml"),!0):this.Pb(new H.map.render.harp.Style({styles:[{when:["==",["geometry-type"],"LineString"],technique:"solid-line",renderOrder:10002,attr:{color:["case",[">=",["get","JF"],10],"black",[">=",["get","JF"],8],"red",[">=",["get","JF"],4],"yellow","green"],lineWidth:3,metricUnit:"Pixel"}}]}))}u(Np,S),t("H.service.traffic.flow.Provider",Np),Np.prototype.Vh=gf,Np.prototype.providesGeoJSON=Np.prototype.Vh,Np.prototype.ea=function(){return this.gb()},Np.prototype.getStyle=Np.prototype.ea,Np.prototype.dc=function(e){e.b&&e.b("GeoJSONTileSource"),this.Pb(e)},Np.prototype.setStyle=Np.prototype.dc;var Op={locationreferences:"tmc,shp"};Np.prototype.o=function(){Np.l.o.call(this),clearInterval(this.i)},Np.prototype.G=function(e,o,f,m,w){return this.u.requestFlowByTile(e,o,f,function(k){k.type&&-1!==k.type.indexOf("Error")?w(k.Details):m(k)},w,this.b)},Np.prototype.requestInternal=Np.prototype.G,Np.prototype.Ub=function(e,o,f,m,w){var k,Y,_e,_o,pd,_u={type:"FeatureCollection",features:[]},iy=m.RWS.length;for(k=0;k<iy;k++){var sy=m.RWS[k],gy=sy.RW,wy=gy.length,Ey=-1!==Mp.indexOf(sy.EXTENDED_COUNTRY_CODE+sy.EBU_COUNTRY_CODE);for(sy=0;sy<wy;sy++){var Py=gy[sy].FIS,Jy=Py.length;for(Py=0;Py<Jy;Py++){var _m=gy[sy].FIS[Py].FI,y0=_m.length;for(Y=0;Y<y0;Y++){var Oy=_m[Y],K0=[],I0=Oy.CF[0],p1=!!I0.SSS,N_={type:"Feature",properties:I0,geometry:{type:"MultiLineString",coordinates:K0}};for(N_.properties.LHT=Ey,Oy.SHP.length&&(N_.properties.FC=Oy.SHP[0].FC),p1&&(pd=[]),I0=0;I0<Oy.SHP.length;I0++){var q1=Oy.SHP[I0].value,Uw=q1.length;for(_e=0;_e<Uw;_e++){var K_=p1?pd:void 0,F_=new io(q1[_e].trim()),Px=[],S1={};for(F_.de();-1!==(_o=F_.Ib());)_o===Pp?(S1.lat=+String.fromCharCode.apply(Np,F_.Dd()),F_.next(),F_.de()):_o===Qp?(S1.lng=+String.fromCharCode.apply(Np,F_.Dd()),Px.push([S1.lng,S1.lat]),K_&&K_.push(og(S1)),S1=[],F_.next(),F_.de()):F_.next();S1.lng=+String.fromCharCode.apply(Np,F_.Dd()),Px.push([S1.lng,S1.lat]),K_&&K_.push(og(S1)),K0.push(_o=Px)}}_u.features.push(N_)}}}}return Np.l.Ub.call(this,e,o,f,_u,w)},Np.prototype.createTileInternal=Np.prototype.Ub;var Qp=32,Pp=44;function Rp(e,o){if(o=void 0===o?{}:o,!e.Rj)throw new Zc(e);Rp.l.constructor.call(this);var f=Sp(this,o);if(!f.baseUrl&&!f.platformBaseUrl)throw new D(e,0,'either "baseUrl" or "platformBaseUrl" must be specified');this.i=(f.baseUrl?f.baseUrl:f.platformBaseUrl).clone(),(e=f.baseUrl?o:f).host&&this.i.Xe(e.host),e.subDomain&&this.i.za(e.subDomain),e.path&&this.i.td(e.path),Bp(this.i),this.g=f.headers||{}}function Sp(e,o){return e=e.Ia(),o?qp({},e,o):e}function Tp(e,o,f){return function(m){return"function"!=typeof m.json?Promise.reject(f(Up(o,m))):m.json().then(function(w){return f(e.a(w))},function(){return f(Up(o,m))})}}function Up(e,o){return Error((o.statusText?"["+o.statusText+"] ":"")+e+" request failed")}function Vp(e){function o(pd){m.contains(w)&&m.removeChild(w),_u&&clearTimeout(_u),delete Vp.a[k],pd&&e.fj&&e.fj.call(_o,pd)}if(!e.url||!e.Gg)throw Error('Parameter "options" must specify at least a URL and a callback.');if("function"!=typeof e.Gg)throw Error("Parameters options.callback must be a function");var f=e.Lo||document,m=f.getElementsByTagName("head")[0],w=f.createElement("script");f=e.url instanceof V?e.url:vp(e.url,e.Ko);var k=Vp.b++,Y=e.ul||"callback",_e=e.Gg,_o={},_u=null;return _o.id=k,_o.cancel=function(){o("cancelled")},0!==e.timeout&&(_u=x.setTimeout(function(){o("timeout")},e.timeout||3e4)),Vp.a[k]=function(pd){o(),_e.call(_o,pd)},w.type="text/javascript",w.src=f.toString()+(f.Kj()?"&":"?")+Y+"="+(e.Mo?"H.service.jsonp.handleResponse("+k+")":encodeURI("H.service.jsonp.handleResponse("+k+")")),m.appendChild(w),_o}function Kp(e){Kp.l.constructor.call(this,Kp,e),this.b=Sp(this,e).callbackKey}function Wp(e,o,f,m){return Vp({url:o,Gg:f,fj:function(w){m(Error("["+w+"] "+o+" request failed"))},ul:e.b})}function Xp(e){Xp.l.constructor.call(this,Xp,e),this.b=Sp(this,e).reverseSubDomain}function Yp(e){Yp.l.constructor.call(this,Yp,e)}function Zp(e,o,f,m,w){return o=e.C().clone().F(o).I(f||{}),e.G(o,m,w)}function $p(){this.a={}}function aq(e,o){for(var f in o)if(o.hasOwnProperty(f)){var m,w=o[f],k=e.a[f]||(e.a[f]=[]),Y=w.length;for(m=0;m<Y;m++)k.push(new bq(w[m]))}}function cq(e,o,f,m){var w=(e=e.a[o])?e.length:0,k=[];for(o=0;o<w;o++)e[o].jd(f,m)&&k.push(e[o]);return k}function bq(e){var o,f=e.boxes;if(this.label=e.label,this.min=e.minLevel,this.max=e.maxLevel,this.b=[],f&&(o=f.length)){var m=f[0],w=new K(m[0],m[1],m[2],m[3]);for(this.b.push(w),this.a=new K(m[0],m[1],m[2],m[3]),e=1;e<o;e++)w=new K((m=f[e])[0],m[1],m[2],m[3]),this.b.push(w),this.a.Zb(w,!1,this.a)}}function dq(e,o,f){var _e,m=this,w=f||{},k=+w.min,Y=+w.max;w.tileSize=w.tileSize||512,w.min=k?$d(k,1,17):1,w.min+=Nk(w.tileSize,1),w.max=Y?$d(Y,1,17):17,dq.l.constructor.call(this,w),C(e,eq,dq,0),C(o,Th,dq,1),this.j=e,o.b&&o.b("OMV"),this.Pb(o,!0),this.b=!1,f&&(f.politicalView&&(this.i=f.politicalView),fq(this,f.lg,f.lg2),this.b=!!f.pois),this.N=function(){gq(m),m.reload(!1)},e.addEventListener("versionupdate",this.N),gq(this),dq.prototype.V=(_e=/^v2\/vectortiles\/(.+)\/mc$/.exec(e.C().b))?_e[1]:B+""}function gq(e){var o=e.hd("_#-;,:","_#-;,:","_#-;,:");e.Y=new RegExp("^"+o.replace(/[.*+?^${}()|[\]\\\/]/g,"\\$&").replace(/_#-;,:/g,"\\d+")+"$")}function fq(e,o,f){var m=Bc(o),w=Bc(f);m&&(e.K=o),w&&(e.B=f),(m||w)&&(e.v=[],(o=(m=/^([a-zA-Z]{2})(-|$)/).exec(o))&&e.v.push(o[1]),(o=m.exec(f))&&e.v.push(o[1]),e.u=!0)}u(Rp,F),t("H.service.Service",Rp),Rp.prototype.Ia=function(){return{}},Rp.prototype.C=function(){return this.i},Rp.prototype.getUrl=Rp.prototype.C,Rp.prototype.G=function(e,o,f,m){return(m=new uf(void 0===m?"application/json":m,e.toString(),ie,{headers:this.g})).then(o,Tp(this,e,f)),m},Rp.prototype.a=function(e){return Error(e.message)},t("H.service.jsonp",Vp),Vp.cn=function(e){return(e=Vp.a[e])?e:function(){}},Vp.handleResponse=Vp.cn,Vp.b=0,Vp.a={},u(Kp,Rp),t("H.service.traffic.Service",Kp),Kp.prototype.Ia=function(){return{subDomain:"traffic.ls",path:"traffic/6.1",callbackKey:"jsoncallback"}},Kp.CONFIG_KEY="traffic",Kp.prototype.Ui=function(e,o){return new ql(new Np(this,void 0,e,o),{max:22})},Kp.prototype.createFlowLayer=Kp.prototype.Ui,Kp.prototype.Vi=function(e){return new Kn(new Jp(this,void 0,e))},Kp.prototype.createIncidentsLayer=Kp.prototype.Vi,Kp.prototype.ao=function(e,o,f){return Wp(this,e=this.C().clone().F("incidents.json").I(e),o,f)},Kp.prototype.requestIncidents=Kp.prototype.ao,Kp.prototype.$n=function(e,o,f,m,w,k){return Wp(this,e=this.C().clone().F(["flow/json",f,e,o].join("/")).I(k||{}),m,w)},Kp.prototype.requestFlowByTile=Kp.prototype.$n,Kp.prototype.bo=function(e,o,f,m,w,k){return Wp(this,e=this.C().clone().F(["incidents/json",f,e,o].join("/")).I(k||{}),m,w)},Kp.prototype.requestIncidentsByTile=Kp.prototype.bo,W.prototype.Dj=function(e){return this.Ma(Kp,e)},W.prototype.getTrafficService=W.prototype.Dj,u(Xp,Rp),t("H.service.GeocodingService",Xp),Xp.prototype.Ia=function(){return{subDomain:"geocoder.ls",reverseSubDomain:"reverse",path:"6.2"}},Xp.CONFIG_KEY="geocoding",Xp.prototype.a=function(e){return Error(e.Details||e.message||e.error)},Xp.prototype.Rg=function(e,o,f){return e=this.C().clone().F("geocode.json").I(e),this.G(e,o,f)},Xp.prototype.geocode=Xp.prototype.Rg,Xp.prototype.Zh=function(e,o,f){return e=this.C().clone().F("reversegeocode.json").I(e),this.b&&e.za(this.b),this.G(e,o,f)},Xp.prototype.reverseGeocode=Xp.prototype.Zh,Xp.prototype.search=function(e,o,f){return e=this.C().clone().F("search.json").I(e),this.G(e,o,f)},Xp.prototype.search=Xp.prototype.search,W.prototype.qj=function(e){return rp(W.prototype.qj,"Use H.service.Platform#getSearchService instead"),this.Ma(Xp,e)},W.prototype.getGeocodingService=W.prototype.qj,u(Yp,Rp),t("H.service.PlacesService",Yp),Yp.prototype.Ia=function(){return{subDomain:"places.ls",path:"places/v1"}},Yp.CONFIG_KEY="places",Yp.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"},Yp.prototype.request=function(e,o,f,m){return Zp(this,e,o,f,m)},Yp.prototype.request=Yp.prototype.request,Yp.prototype.search=function(e,o,f){return Zp(this,"discover/search",e,o,f)},Yp.prototype.search=Yp.prototype.search,Yp.prototype.oo=function(e,o,f){return Zp(this,"suggest",e,o,f)},Yp.prototype.suggest=Yp.prototype.oo,Yp.prototype.El=function(e,o,f){return Zp(this,"discover/explore",e,o,f)},Yp.prototype.explore=Yp.prototype.El,Yp.prototype.ql=function(e,o,f){return Zp(this,"discover/around",e,o,f)},Yp.prototype.around=Yp.prototype.ql,Yp.prototype.en=function(e,o,f){return Zp(this,"discover/here",e,o,f)},Yp.prototype.here=Yp.prototype.en,Yp.prototype.vl=function(e,o,f){return Zp(this,"categories/places",e,o,f)},Yp.prototype.categories=Yp.prototype.vl,Yp.prototype.Fl=function(e,o,f,m){return e=vp(e).I(this.C().getQuery()).I(m||{}),this.G(e,o,f)},Yp.prototype.follow=Yp.prototype.Fl,W.prototype.zj=function(e){return rp(W.prototype.zj,"Use H.service.Platform#getSearchService instead"),this.Ma(Yp,e)},W.prototype.getPlacesService=W.prototype.zj,bq.prototype.jd=function(e,o){if(e>=this.min&&e<=this.max){if(!(e=this.b.length)||!this.a)return!0;if(this.a.jd(o))for(;e--;)if(this.b[e].jd(o))return!0}return!1},u(dq,S),t("H.service.omv.Provider",dq),dq.prototype.md=gf,dq.prototype.providesOMV=dq.prototype.md,dq.prototype.Sb=function(e){return this.Y.test(e)},dq.prototype.cacheFilter=dq.prototype.Sb,dq.prototype.hd=function(e,o,f){return hq(this.j,e,o,f).toString()},dq.prototype.getTileKey=dq.prototype.hd,dq.prototype.Db=function(){return this.ua},dq.prototype.getCache=dq.prototype.Db,dq.prototype.Cm=function(){return this.i},dq.prototype.getPoliticalView=dq.prototype.Cm,dq.prototype.ho=function(e){var o=this.i;this.i=e,this.dispatchEvent(new aj("politicalviewchange",this.i,o))},dq.prototype.setPoliticalView=dq.prototype.ho,dq.prototype.MAX_STORE_TIME=2592e6,dq.prototype.m=function(){return nd()},dq.prototype.f=function(){return nd()?md():dq.l.f.call(this)},dq.prototype.G=function(e,o,f,m,w){return this.j.Qa(e,o,f,m,w)},dq.prototype.requestInternal=dq.prototype.G,dq.prototype.dc=function(e){e.b&&e.b("OMV"),this.Pb(e)},dq.prototype.setStyle=dq.prototype.dc,dq.prototype.ea=function(){return dq.l.gb.apply(this)},dq.prototype.getStyle=dq.prototype.ea,dq.prototype.gb=function(){var e=dq.l.gb.apply(this),o=e.getState()===Uh.READY,f=e.Lc();return o?f&&f.global&&(this.u&&(this.K&&(f.global.ux_language=this.K),this.B&&(f.global.ux_language_fallback=this.B)),this.b&&f.global.poi&&f.global.poi.default&&(f.global.poi.default.visible=this.b),this.u||this.b)&&(e=new qi(f,e.Bb())):e.load(),e},dq.prototype.getStyleInternal=dq.prototype.gb,dq.prototype.u=!1;var iq=["en"];function eq(e){eq.l.constructor.call(this,eq,e),e=Sp(this,e).mapVersion,this.b=vc(e)?e:jq[this.C().toString()],vc(this.b)||kq(this)}dq.prototype.Zg=function(){return this.v||iq},dq.prototype.getLanguages=dq.prototype.Zg,dq.prototype.o=function(){dq.l.o.call(this),this.j.removeEventListener("versionupdate",this.N)},dq.prototype.ua=new Pk(256),dq.prototype.ba=function(e,o){return cq(this.j.ba(),this.V,o,e)},dq.prototype.getCopyrights=dq.prototype.ba,u(eq,Rp),t("H.service.omv.Service",eq),eq.prototype.Ia=function(){return{subDomain:"vector",path:"v2/vectortiles/base/mc"}},eq.CONFIG_KEY="omv";var jq={};function kq(e){e.G(e.C().clone().F("../../info"),function(o){o=o.mapVersion;var f=e.C().toString();e.b=o,o!==jq[f]&&(jq[f]=o,e.dispatchEvent("versionupdate"))},function(){})}function hq(e,o,f,m){return o=e.C().clone().F(m+"/"+o+"/"+f+"/omv"),vc(e.b)&&o.I({mv:e.b}),o}function lq(e){lq.l.constructor.call(this,lq,e),this.b=e.getToken}function vq(e,o,f,m){return e.C().clone().F(o+"/layers/"+f+"/features").I(m||{})}function sq(e,o,f,m,w){return vq(e,f,m,o=Object.assign({},w,{id:new zp(o)}))}function qq(e,o,f,m,w){return e.C().clone().F(f+"/layers/"+m+"/features/"+o).I(w||{})}function oq(e,o,f,m,w,k,Y){return Y=void 0===Y?"application/json":Y,f={method:f,headers:Object.assign({},k?{"Content-Type":"application/geo+json"}:void 0,"function"==typeof e.b?{Authorization:"Bearer "+e.b()}:void 0,e.g)},k&&(f.data=JSON.stringify(k)),(k=new uf(Y,o.toString(),ie,f)).then(m,Tp(e,o,w)),k}function mq(e,o,f,m){yc(f,"String",e,o,"must be a string"),yc(m,"String",e,o+1,"must be a string")}function pq(e,o){yc(o,"String",e,0,"must be a string")}function rq(e,o){if(!Array.isArray(o)||0===o.length||o.some(function(f){return"string"!=typeof f}))throw new D(e,0,"must be a non-empty array of strings")}function uq(e,o,f){if(!Ea(f))throw new D(e,o,"must be a GeoJSON object")}function nq(e,o,f,m){if(!Da(f))throw new D(e,o,"must be a function");if(!Da(m))throw new D(e,o+1,"must be a function")}function wq(e,o,f,m){if(wq.l.constructor.call(this,m?{min:m.min,max:m.max,engineType:m.engineType}:void 0),C(e,lq,wq,0),!Bc(o))throw new D(wq,1,'"catalogHrn" must be a string');if(!Bc(f))throw new D(wq,2,'"layerId" must be a string');this.v=e,this.b=o,this.i=f,this.u=Ea(m)&&Ea(m.parameters)?m.parameters:{},this.Pb(this.c===ik.WEBGL?new qi({sources:{iml:{type:"MVT"}},layers:{iml:{data:{source:"iml",layer:this.b+":"+this.i},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#0258AE",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.b+":"+this.i,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.b+":"+this.i,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.b+":"+this.i,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.b+":"+this.i,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#0258AE",lineWidth:"2px",renderOrder:203}]}))}function xq(e){xq.l.constructor.call(this,xq,e=void 0===e?{}:e),this.b={dg:e.resource||"base",Vf:e.projection||"mc",format:e.format||"png"},this.f=e.queryParams||{}}function yq(e,o){C(e,xq,yq,0);var f={};Object.assign(f,o),f.min=f.min||0,f.max=f.max||20,f.tileSize=f.tileSize||512,f.getURL=function(m,w,k){return e.C().clone().F(e.b.dg+"/"+e.b.Vf+"/"+k+"/"+m+"/"+w+"/"+e.b.format).I(e.f).clone().I({size:f.tileSize})},Ck.call(this,f),this.i=e}function zq(e,o,f,m,w,k,Y){var _e=this;Y=Y||{},k=k||{};var _o=e.C().clone().F(o+"/"+e.oc()+"/"+f).I(k),_u=e.c;this.B=e,this.N=_o,Ck.call(this,{tileSize:m,max:512===m?19:20,min:512===m?2:0,getURL:function(pd,iy,sy){var gy=_e.N.clone();return _u&&gy.za(_u[(sy+iy+pd)%_u.length]),gy.F(sy+"/"+pd+"/"+iy+"/"+m+"/"+w),gy.toString()},crossOrigin:Y.crossOrigin,headers:Y.headers,uri:_o.toString().replace(/_/g,"")+m,engineType:Y.engineType}),this.Ya=o,this.ya=f,this.ua=k,this.V=f.split(".")[0],this.i=z(this.i,this),this.getCopyrights=this.ba,e.addEventListener("versionupdate",this.i)}function Aq(e){Aq.l.constructor.call(this,Aq,e),e=Sp(this,e),this.c=e.shards,(this.f=e.ignoreTypes?null:e.type)&&this.C().za(this.f),this.b=e.version,this.m=new $p,this.s={},this.j=0,"newest"===this.b&&Bq(this)}function Cq(e,o){for(var f={},m=e[o+"s"][o],w=m.length;w--;)f[m[w].id]=m[w];e[o+"s"]=f}function Bq(e){var o=e.C().clone().F("info").I({output:"json"});e.c&&o.za(e.c[0]),e.G(o,function(f){var m;if(Cq(f=f.response,"map"),Cq(f,"scheme"),Cq(f,"tiletype"),Cq(f,"format"),Cq(f,"resolution"),Cq(f,"language"),"newest"===e.b&&"traffic"!==e.f)for(m in f.maps)f.maps[m].hash&&f.maps[m].newest&&(e.b=f.maps[m].hash,e.dispatchEvent("versionupdate"));e.u=f,e.dispatchEvent("infoupdate")},function(f){throw f})}function Dq(e){var o=e.C().clone().F("copyright").F(e.oc()).I({output:"json"});e.c&&o.za(e.c[0]),e.j=1,e.G(o,function(f){e.j=2,aq(e.m,f),e.dispatchEvent("copyrightupdate")},function(f){throw e.j=-1,f})}function Eq(e){Eq.l.constructor.call(this,Eq,e)}function Fq(e){Fq.l.constructor.call(this,Fq,e),rp(Fq,"Use HERE Routing API v8 instead.")}function Gq(e){Gq.l.constructor.call(this,Gq,e)}function Hq(){}function Iq(){}function Jq(e,o){this.a=e,this.b=o}function Kq(){}function Lq(e,o){this.b=e,this.a=o}function Mq(e,o,f){var m;if(o=o||(e&&e.length?Object.keys(e[0]):B),this.vb=e,o)for(this.Ad=o,this.Hg=e=oc(),m=o.length;m--;)e[o[m]]=!0;f!==B&&(this.Ih=f)}function Nq(e,o){return e.vb?e.vb.push(o):e.vb=[o],e.vb.length-1}function Oq(e){var o=Pq;if(!e||!Bc(bf(e.layerId,e.layer))||!Ec(e.level)||vc(e.rowFilter)&&!Da(e.rowFilter)||vc(e.rowFilterContext)&&!Ea(e.rowFilterContext))throw new D(o,1,vc("invalid layer config")?"invalid layer config":e)}function Qq(e,o,f,m){m=m||Rq,this.a={},m.provider=e,this.invalidate=hf,Qq.l.constructor.call(this,o,m),delete this.invalidate,f&&(this.b=f),this.pa(lh.ADD)}Hc(jq),eq.prototype.tm=function(){return this.b},eq.prototype.getMapVersion=eq.prototype.tm,eq.prototype.cd=function(e,o){o=o||{};var f={min:0,max:22};return lo&&(o.min=f.min=4),new ql(new dq(this,e,o),f)},eq.prototype.createLayer=eq.prototype.cd,eq.prototype.Qa=function(e,o,f,m,w){return this.G(hq(this,e,o,f),function(k){return k.arrayBuffer().then(m,w)},w,"arraybuffer")},eq.prototype.Ee=function(e,o){if(!Da(e))throw new D(this.Ee,0,'"onResult" must be a function');if(!Da(o))throw new D(this.Ee,1,'"onError" must be a function');return this.G(this.C().clone().td("v2/vectortiles/pviews"),e,o)},eq.prototype.getPoliticalViews=eq.prototype.Ee,W.prototype.xj=function(e){return this.Ma(eq,e)},W.prototype.getOMVService=W.prototype.xj,eq.prototype.f=function(e){aq(this.c,e),this.dispatchEvent("copyrightupdate")},eq.prototype.ba=function(){return this.c||(this.c=new $p,this.G(this.C().clone().F("../../copyrights"),z(this.f,this),kd)),this.c},eq.prototype.getCopyrights=eq.prototype.ba,u(lq,Rp),t("H.service.iml.Service",lq),lq.prototype.Ia=function(){return{host:"interactive.data.api.platform.here.com",path:"interactive/v1/catalogs"}},lq.prototype.a=function(e){var f=[{keys:["code","title","cause","action"],format:function(){return e.code+": "+e.title+"; cause: "+e.cause+"; action: "+e.action}},{keys:["error","error_description"],format:function(){return e.error+": "+e.error_description}},{keys:["error","errorMessage"],format:function(){return e.error+": "+e.errorMessage}}];return Error(Ea(e)?function o(){for(var m=fa(f),w=m.next();!w.done;w=m.next()){var k=(w=w.value).format;if(w.keys.every(function(Y){return e[Y]}))return k()}return JSON.stringify(e)}():e)},lq.prototype.Od=function(e,o,f,m,w){var k=this.Od;return mq(k,0,e,o),nq(k,2,f,m),oq(this,e=this.C().clone().F(e+"/layers/"+o+"/statistics").I(w||{}),"GET",f,m)},lq.prototype.getStatistics=lq.prototype.Od,lq.prototype.yf=function(e,o,f,m,w,k,Y,_e,_o){var _u=_o?"":".mvtf";return oq(this,e=this.C().clone().F(m+"/layers/"+w+"/tile/web/"+f+"_"+e+"_"+o+_u).I(Object.assign({clip:!0},_e)),"GET",_o?k:function(pd){return pd.arrayBuffer().then(k)},Y,void 0,_o?"application/json":"arraybuffer")},lq.prototype.getFeaturesByTile=lq.prototype.yf,lq.prototype.nj=function(e,o,f,m,w,k){var Y=this.nj;return pq(Y,e),mq(Y,1,o,f),nq(Y,3,m,w),oq(this,e=qq(this,e,o,f,k),"GET",m,w)},lq.prototype.getFeatureById=lq.prototype.nj,lq.prototype.Nc=function(e,o,f,m,w,k){var Y=this.Nc;return rq(Y,e),mq(Y,1,o,f),nq(Y,3,m,w),oq(this,e=sq(this,e,o,f,k),"GET",m,w)},lq.prototype.getFeaturesById=lq.prototype.Nc,lq.prototype.Hd=function(e,o,f,m,w){var k=this.Hd;if(!Ea(e)||!(e.bbox||e.north&&e.east&&e.south&&e.west))throw new D(k,0,'must be an object with either "bbox" or a full set of "north", "east", "south" and "west"');return mq(k,1,o,f),nq(k,3,m,w),oq(this,e=this.C().clone().F(o+"/layers/"+f+"/bbox").I(e),"GET",m,w)},lq.prototype.getFeaturesByBoundingBox=lq.prototype.Hd,lq.prototype.pj=function(e,o,f,m,w){var k=this.pj;if(!(Ea(e)&&e.radius&&(e.lat&&(e.lng||e.lon)||e.refCatalogHrn&&e.refLayerId&&e.refFeatureId)))throw new D(k,0,'must be an object with "radius" and a combination of either "lat"+"lng" or "refCatalogHrn"+"refLayerId"+"refFeatureId"');return mq(k,1,o,f),nq(k,3,m,w),oq(this,e=this.C().clone().F(o+"/layers/"+f+"/spatial").I(e),"GET",m,w)},lq.prototype.getFeaturesByPointAndRadius=lq.prototype.pj,lq.prototype.oj=function(e,o,f,m,w,k){var Y=this.oj;if(!Ea(e)||!e.radius)throw new D(Y,0,'must be an object with "radius"');return uq(Y,1,o),mq(Y,2,f,m),nq(Y,4,w,k),oq(this,e=this.C().clone().F(f+"/layers/"+m+"/spatial").I(e),"POST",w,k,o)},lq.prototype.getFeaturesByGeometryAndRadius=lq.prototype.oj,lq.prototype.Jk=function(e,o,f,m,w){var k=this.Jk;return mq(k,0,e,o),nq(k,2,f,m),oq(this,e=this.C().clone().F(e+"/layers/"+o+"/search").I(w||{}),"GET",f,m)},lq.prototype.searchFeatures=lq.prototype.Jk,lq.prototype.Vj=function(e,o,f,m,w){var k=this.Vj;return mq(k,0,e,o),nq(k,2,f,m),oq(this,e=this.C().clone().F(e+"/layers/"+o+"/iterate").I(w||{}),"GET",f,m)},lq.prototype.iterateFeatures=lq.prototype.Vj,lq.prototype.Vc=function(e,o,f,m,w,k){var Y=this.Vc;return uq(Y,0,e),mq(Y,1,o,f),nq(Y,3,m,w),oq(this,o=vq(this,o,f,k),"PUT",m,w,e)},lq.prototype.putFeatures=lq.prototype.Vc,lq.prototype.Tc=function(e,o,f,m,w,k){var Y=this.Tc;return uq(Y,0,e),mq(Y,1,o,f),nq(Y,3,m,w),oq(this,o=vq(this,o,f,k),"POST",m,w,e)},lq.prototype.postFeatures=lq.prototype.Tc,lq.prototype.dd=function(e,o,f,m,w){var k=this.dd;return rq(k,e),mq(k,1,o,f),nq(k,3,m,w),oq(this,e=sq(this,e,o,f),"DELETE",m,w)},lq.prototype.deleteFeatures=lq.prototype.dd,lq.prototype.Ck=function(e,o,f,m,w,k,Y){var _e=this.Ck;return pq(_e,e),uq(_e,1,o),mq(_e,2,f,m),nq(_e,4,w,k),oq(this,e=qq(this,e,f,m,Y),"PUT",w,k,o)},lq.prototype.putFeature=lq.prototype.Ck,lq.prototype.wk=function(e,o,f,m,w,k,Y){var _e=this.wk;return pq(_e,e),uq(_e,1,o),mq(_e,2,f,m),nq(_e,4,w,k),oq(this,e=qq(this,e,f,m,Y),"PATCH",w,k,o)},lq.prototype.patchFeature=lq.prototype.wk,lq.prototype.Zi=function(e,o,f,m,w){var k=this.Zi;return pq(k,e),mq(k,1,o,f),nq(k,3,m,w),oq(this,e=qq(this,e,o,f),"DELETE",m,w,void 0,"text/plain")},lq.prototype.deleteFeature=lq.prototype.Zi,lq.CONFIG_KEY="iml",W.prototype.jm=function(e){return this.Ma(lq,e)},W.prototype.getIMLService=W.prototype.jm,u(wq,S),t("H.service.iml.Provider",wq),wq.prototype.G=function(e,o,f,m,w){return this.v.yf(e,o,f,this.b,this.i,m,w,this.u)},wq.prototype.requestInternal=wq.prototype.G,wq.prototype.md=gf,wq.prototype.providesOMV=wq.prototype.md,wq.prototype.ea=function(){return this.gb()},wq.prototype.getStyle=wq.prototype.ea,wq.prototype.dc=function(e){C(e,qi)&&e.b("MVT"),this.Pb(e)},wq.prototype.setStyle=wq.prototype.dc,u(xq,Rp),t("H.service.rasterTile.Service",xq),p=xq.prototype,p.ea=function(){return this.f.style||"explore.day"},p.Ia=function(){return{subDomain:"maps",path:"v3"}},p.ba=function(){return this.c||(this.c=new $p,this.G(this.C().clone().F("copyright"),z(this.zn,this),kd)),this.c},p.zn=function(e){var o=e.copyrights;e=e.resources;var f={},m=this.b.dg+"."+this.ea();f[m]=[],e[this.b.dg].styles[this.ea()].forEach(function(w){o[w].forEach(function(k){var Y=[];k.boundingBoxes.forEach(function(_e){Y.push([_e.north,_e.west,_e.south,_e.east])}),f[m].push({boxes:Y,label:k.label,alt:k.alt,minLevel:k.minLevel,maxLevel:k.maxLevel})})}),aq(this.c,f)},p.Be=function(e,o){return this.G(this.C().clone().F("info"),e,o)},xq.prototype.getInfo=xq.prototype.Be,xq.prototype.Ee=function(e,o){return this.G(this.C().clone().F("politicalViews"),e,o)},xq.prototype.getPoliticalViews=xq.prototype.Ee,xq.prototype.fm=function(e,o){return this.G(this.C().clone().F("features"),e,o)},xq.prototype.getFeatures=xq.prototype.fm,xq.prototype.Zg=function(e,o){return this.G(this.C().clone().F("languages"),e,o)},xq.prototype.getLanguages=xq.prototype.Zg,xq.CONFIG_KEY="rasterTile",W.prototype.Im=function(e){return this.Ma(xq,e)},W.prototype.getRasterTileService=W.prototype.Im,u(yq,Ck),t("H.service.rasterTile.Provider",yq),yq.prototype.ba=function(e,o){var f=this.i;return cq(f.ba(),f.b.dg+"."+f.ea(),o,e)},yq.prototype.getCopyrights=yq.prototype.ba,yq.prototype.m=function(){return nd()},yq.prototype.f=function(){return nd()?md():yq.l.f.call(this)},u(zq,Ck),zq.prototype.MAX_STORE_TIME=2592e6,zq.prototype.o=function(){Ck.prototype.o.call(this),this.B.removeEventListener("versionupdate",this.i)},zq.prototype.ba=function(e,o){return cq(this.B.ba(),this.V,o,e)},zq.prototype.getCopyrights=zq.prototype.ba,zq.prototype.i=function(){var e=this.B;this.N=e.C().clone().F(this.Ya+"/"+e.oc()+"/"+this.ya).I(this.ua),this.reload(!1)},zq.prototype.m=function(){return nd()},zq.prototype.f=function(){return nd()?md():zq.l.f.call(this)},u(Aq,Rp),t("H.service.MapTileService",Aq),Aq.prototype.Ia=function(){return{subDomain:"maps.ls",path:"maptile/2.1",type:"base",version:"newest",shards:["1","2","3","4"]}},Aq.CONFIG_KEY="maptile",Aq.prototype.Ej=function(){return this.f},Aq.prototype.getType=Aq.prototype.Ej,Aq.prototype.oc=function(){return this.b},Aq.prototype.getVersion=Aq.prototype.oc,Aq.prototype.ba=function(){return this.j||(this.b&&"newest"!==this.b||"traffic"===this.f)&&Dq(this),this.m},Aq.prototype.getCopyrights=Aq.prototype.ba,Aq.prototype.Be=function(){return this.u},Aq.prototype.getInfo=Aq.prototype.Be,Aq.prototype.qe=function(e,o,f,m,w,k){var _o,Y=this.C().clone().F(e+"/"+this.oc()+"/"+o+"/"+f+"/"+m).I(w||{}).toString(),_e=0,_u=Y.length;if(0!==_u)for(_o=0;_o<_u;_o++)_e=(_e<<5)-_e+Y.charCodeAt(_o),_e|=0;return(_e=this.s[Y=_e])||(_e=new zq(this,e,o,f,m,w,qp({headers:this.g},k||{})),this.s[Y]=_e),_e},Aq.prototype.createTileProvider=Aq.prototype.qe,Aq.prototype.ic=function(e,o,f,m,w,k,Y,_e){return new ql(e=this.qe(e,o,f,m,w,_e),{opacity:k,dark:!!Y})},Aq.prototype.createTileLayer=Aq.prototype.ic,W.prototype.$g=function(e){return this.Ma(Aq,e)},W.prototype.getMapTileService=W.prototype.$g,u(Eq,Rp),t("H.service.publicTransit.Service",Eq),Eq.prototype.Ia=function(){return{subDomain:"transit.router",path:"v8"}},Eq.CONFIG_KEY="publicTransit",Eq.prototype.Lm=function(e,o,f){return e=this.C().clone().F("routes").I(e),this.G(e,o,f)},Eq.prototype.getRoutes=Eq.prototype.Lm,Eq.prototype.Xl=function(e,o,f){return e=this.C().clone().F("departures").I(e),this.G(e,o,f)},Eq.prototype.getDepartures=Eq.prototype.Xl,Eq.prototype.Pm=function(e,o,f){return e=this.C().clone().F("stations").I(e),this.G(e,o,f)},Eq.prototype.getStations=Eq.prototype.Pm,Eq.prototype.a=function(e){return Error(JSON.stringify(e))},W.prototype.Gm=function(e){return this.Ma(Eq,e)},W.prototype.getPublicTransitService=W.prototype.Gm,u(Fq,Rp),t("H.service.RoutingService",Fq),Fq.prototype.Ia=function(){return{subDomain:"route.ls",path:"routing/7.2"}},Fq.prototype.a=function(e){return Error(e.details)},Fq.CONFIG_KEY="routing",Fq.prototype.zd=function(e,o,f){return e=this.C().clone().F("calculateroute.json").I(e),this.G(e,o,f)},Fq.prototype.calculateRoute=Fq.prototype.zd,Fq.prototype.Fg=function(e,o,f){return e=this.C().clone().za("isoline").F("calculateisoline.json").I(e),this.G(e,o,f)},Fq.prototype.calculateIsoline=Fq.prototype.Fg,u(Gq,Rp),t("H.service.RoutingService8",Gq),Gq.CONFIG_KEY="routing_v8",Gq.prototype.Ia=function(){return{subDomain:"router",path:"v8/routes"}},Gq.prototype.a=function(e){return Error(e.error)},Gq.prototype.zd=function(e,o,f){return e=this.C().clone().I(e),this.G(e,o,f)},Gq.prototype.calculateRoute=Gq.prototype.zd,Gq.prototype.Fg=function(e,o,f){return e=this.C().clone().za("isoline").td("v8/isolines").I(e),this.G(e,o,f)},Gq.prototype.calculateIsoline=Gq.prototype.Fg,W.prototype.Bj=function(e,o){if(7===(o=lo?8:+o||7))o=Fq;else{if(8!==o)throw new D(this.Bj,1,"allowed values are 7 and 8");o=Gq}return this.Ma(o,e)},W.prototype.getRoutingService=W.prototype.Bj,t("H.service.extension.dataView.ITable",Hq),Hq.prototype.Kd=function(){},Hq.prototype.getMeta=Hq.prototype.Kd,Hq.prototype.Nd=function(){},Hq.prototype.getRowCount=Hq.prototype.Nd,Hq.prototype.nc=function(){},Hq.prototype.getRow=Hq.prototype.nc,Hq.prototype.Oa=function(){},Hq.prototype.getColumnNames=Hq.prototype.Oa,Hq.prototype.xe=function(){},Hq.prototype.getColumn=Hq.prototype.xe,Hq.prototype.sa=function(){},Hq.prototype.getCell=Hq.prototype.sa,Hq.prototype.concat=function(){},Hq.prototype.concat=Hq.prototype.concat,t("H.service.extension.dataView.IRow",Iq),Iq.prototype.Oa=function(){},Iq.prototype.getColumnNames=Iq.prototype.Oa,Iq.prototype.sa=function(){},Iq.prototype.getCell=Iq.prototype.sa,Iq.prototype.gd=function(){},Iq.prototype.getTable=Iq.prototype.gd,t("H.service.extension.dataView.ObjRow",Jq),Jq.prototype.Oa=function(){return this.a.Oa()},Jq.prototype.getColumnNames=Jq.prototype.Oa,Jq.prototype.sa=function(e){return this.a.sa(this.b,e)},Jq.prototype.getCell=Jq.prototype.sa,Jq.prototype.gd=function(){return this.a},Jq.prototype.getTable=Jq.prototype.gd,t("H.service.extension.dataView.IColumn",Kq),Kq.prototype.sa=function(){},Kq.prototype.getCell=Kq.prototype.sa,t("H.service.extension.dataView.ObjColumn",Lq),Lq.prototype.sa=function(e){return this.b.sa(e,this.a)},Lq.prototype.getCell=Lq.prototype.sa,t("H.service.extension.dataView.ObjTable",Mq),p=Mq.prototype,p.Ih=B,p.vb=B,p.Ad=B,p.Hg=B,p.Kd=function(){return this.Ih},Mq.prototype.getMeta=Mq.prototype.Kd,Mq.prototype.Nd=function(){return this.vb?this.vb.length:0},Mq.prototype.getRowCount=Mq.prototype.Nd,Mq.prototype.nc=function(e){var o=this.vb;return o&&o[e]?new Jq(this,e):B},Mq.prototype.getRow=Mq.prototype.nc,Mq.prototype.Oa=function(){return this.Ad||jf},Mq.prototype.getColumnNames=Mq.prototype.Oa,Mq.prototype.xe=function(e){return this.Hg[e]?new Lq(this,e):B},Mq.prototype.getColumn=Mq.prototype.xe,Mq.prototype.sa=function(e,o){var f=this.vb;return(e=f&&this.Hg[o]&&f[e])&&e[o]},Mq.prototype.getCell=Mq.prototype.sa,Mq.prototype.concat=function(){var o,e=arguments.length,f=this.Ad,m=""+this.Ad,w=(this.vb||[]).slice();for(o=0;o<e;o++){var k=arguments[o];if(!(k instanceof Mq))throw new D(this.concat,o);if(k.vb){if(f&&""+k.Ad!==m)throw new D(this.concat,o,"Incompatible columns!");w=w.concat(k.vb)}}return new Mq(w,this.Ad,this.Ih)},Mq.prototype.concat=Mq.prototype.concat,u(Qq,Eh),t("H.service.remote.Spatial",Qq);var Rq={};function Sq(e,o){this.a=e,o&&(this.b=o)}Qq.prototype.$a=function(){return this.b||Eh.prototype.$a.call(this)},Qq.prototype.getId=Qq.prototype.$a,Qq.prototype.eg=kd,Qq.prototype.retain=Qq.prototype.eg,Qq.prototype.release=gf,Qq.prototype.release=Qq.prototype.release;var Tq=new Sq(jf);function Uq(e,o,f){e.a[o.key]=new Sq(f,void 0)}function Vq(e,o,f,m){if(!Da(f))throw new D(e,o,"has invalid type");if(!Da(m))throw new D(e,o+1,"has invalid type")}function Wq(e,o,f){var m=8===e;this.b=o,this.c=f||kd,(this.a=4===e||m)?this.j=m:this.g=1===e,this.f=this.a?"$HProjGeometry":"geometry"}function Xq(e,o,f,m,w){var k=[],Y=w.paths,_e=Y.length,_o=0,_u=e.b&&e.b(m);for(e=new Qq(o,e.j,B,{style:_u||e.i,data:m});_o!==_e;)k.push(Zq(Y[_o++]));return Uq(e,f,[new Mh(k,w.interiorsIndex,w.outlinesIndex)]),e}function Yq(e,o,f,m){m=new mg(m[0],m[1]);var w=e.b&&e.b(f);return e=e.g?new Jn(m,e={icon:w,data:f,provider:o}):new $i(m,e={icon:w,data:f,provider:o})}function Zq(e){for(var o=0,f=e.length,m=[];o<f;)m.push(new G(e[o++],e[o++]));return m}function $q(e,o){var f={};this.b=e,Ya(f,o||f),mk.call(this,f),this.Zf={},(e=this.Eb(oh.SPATIAL)).update(e.a+1,lh.ADD)}function ar(e){return e.pc(!0)}function br(e,o,f){var w,m=o.j&&o.j[f];return!m&&(w=o.m)&&(delete o.m,(o.j=e=e.b.parse(e,o,w))&&(m=e[f])),m||jf}Qq.prototype.Id=function(e){return(this.a[e.key]||Tq).a},Qq.prototype.getGeometriesForTile=Qq.prototype.Id,Qq.prototype.Yg=function(e){return(this.a[e.key]||Tq).b},Qq.prototype.getLabels=Qq.prototype.Yg,Wq.prototype.parse=function(e,o,f){var m,w,_e,_o,k={},Y=[],_u=0;for(_e=f.length;_u<_e;_u++){var pd=f[_u],iy=pd.Rows;if(pd=iy.length){var sy=Object.keys(iy[0]).filter(function(wy){return"geometry"!==wy&&"$HProjGeometry"!==wy});for(sy=new Mq(iy,sy),_o=0;_o<pd;_o++){var gy=iy[_o];if(w=gy[this.f]){if(delete gy[this.f],gy=sy.nc(_o))try{(m=this.a?Xq(this,e,o,gy,w):Yq(this,e,gy,w.path)).ia(e),Y.push(m)}catch(wy){this.c(wy.message)}}else this.c("Layer must contain geometries")}}}return k[this.a?"spatials":this.g?"markers":"domMarkers"]=Y,k},u($q,mk),t("H.service.remote.ObjectProvider",$q),$q.prototype.D=function(){mk.prototype.D.call(this)},$q.prototype.dispose=$q.prototype.D,$q.prototype.xc=function(){return jf},$q.prototype.requestMarkers=$q.prototype.xc,$q.prototype.wc=function(){return jf},$q.prototype.requestDomMarkers=$q.prototype.wc,$q.prototype.pd=function(){return jf},$q.prototype.requestOverlays=$q.prototype.pd,$q.prototype.Kb=gf,$q.prototype.providesMarkers=$q.prototype.Kb,$q.prototype.Jb=gf,$q.prototype.providesDomMarkers=$q.prototype.Jb,$q.prototype.vc=gf,$q.prototype.providesSpatials=$q.prototype.vc,$q.prototype.ag=function(){return jf},$q.prototype.requestSpatials=$q.prototype.ag,$q.prototype.bg=function(e,o){return e=br(this,e,cr),o&&(e=e.filter(ar)),e},$q.prototype.requestSpatialsByTile=$q.prototype.bg,$q.prototype.aa=function(e){var o=e.$a();if(this.Zf[o])throw new Zc(this.aa,"Remote object "+o+" already added");return this.Zf[o]=e},$q.prototype.Da=function(e){delete this.Zf[e.$a()]};var cr="spatials";function dr(e){var o=(e=e||{}).tileCacheSize||1024,f=e.resultType,m=e.styleCallback;if(vc(e.min)||(e.min=12),dr.l.constructor.call(this,e),-1===er.indexOf(f))throw new D(dr,2,"invalid resultType");if(this.b=f,m&&!Da(m))throw new D(dr,2,"invalid style callback");this.V=m,this.Y=e.pixelRatio||Ue(),this.zb=z(this.zb,this),this.s(new Pk(o,z(this.Ya,this))),this.createTileInternal=z(4===f||8===f?this.N:this.K,this)}function fr(e){var o=e.ua;return o||(e.v||(e.v=e.u(e.b,e.V,e.zb)),(o=e.ua=new $q(e.v)).ia(e),o.addEventListener(e.A.xa,z(e.ya,e)),o.ua=!0),o}u(dr,S),t("H.service.extension.TileProvider",dr),dr.prototype.i=!1,dr.prototype.getCapabilities=function(){return dr.l.getCapabilities.call(this)|Oj.CROP_LINES_BY_TILE|Oj.CROP_POLYGONS_BY_TILE},dr.prototype.Qa=function(e,o,f,m){return this.i?dr.l.Qa.call(this,e,o,f,m):B},dr.prototype.requestTile=dr.prototype.Qa,dr.prototype.zb=function(e){this.dispatchEvent(new vd("error",Bc(e)?e:e+"",this))},dr.prototype.Kb=function(){return 1===this.b},dr.prototype.providesMarkers=dr.prototype.Kb,dr.prototype.Jb=function(){return 2===this.b},dr.prototype.providesDomMarkers=dr.prototype.Jb,dr.prototype.vc=function(){return 4===this.b||8===this.b},dr.prototype.providesSpatials=dr.prototype.vc,dr.prototype.K=function(e,o,f,m){var w=this.getTileKey(e,o,f);w=this.Db().get(w);var k=2==this.b,Y=[],_e=fr(this);for(w?w.valid=!0:(delete(e=w=new Vk(e,o,f,y)).j,e.m=m),o=(m=br(_e,w,k?"domMarkers":"markers")).length;o--;)(e=m[o]).yi=w,(k||1===e.qb().getState())&&Y.push(e);return w.data=Y,w},dr.prototype.ya=function(e){(e=e.target.yi)&&(e.valid=!1)},dr.prototype.jo=function(e){this.B=!!e},dr.prototype.setTileCanvasRendering=dr.prototype.jo,dr.prototype.B=!0,dr.prototype.N=function(e,o,f,m){var w=fr(this),k=this.getTileKey(e,o,f),Y=this.tileSize,_e=this.Db().get(k);return _e||(delete(e=_e=new Zk(k,e,o,f,Y,this.Y,f,w)).j,e.m=m),this.B?(m=up.pop(Y),_e.T(m)||up.push(m,Y)):el(_e),_e},dr.prototype.Ya=function(e,o){var f;if(4===this.b||8===this.b){for(f=(e=o.Pa()).length;f--;)delete e[f].a[o.key];(e=o.Xf())&&(up.push(e,this.tileSize),o.Yf())}else for(f=(e=o.data).length;f--;)delete e[f].yi},dr.prototype.o=function(){dr.l.o.call(this),fr(this).D()};var gr={MARKER:1,DOM_MARKER:2,POLYLINE:4,POLYGON:8};dr.ResultType=gr;var er=[1,2,4,8];function Pq(e,o,f){var m=this,w=o&&o.rowFilter,k=f.resultType;Pq.l.constructor.call(this,f),C(e,hr,Pq,0),Oq(o),w?(f=Wa(o)).rowFilter=w.toString():f=Wa(o),delete f.layer,f.layerId=bf(o.layerId,o.layer),(new Qf).a("pde","H.service.extension.worker.processor"),e=e.C().clone().F(ir+"."+jr).I({meta:1}),new Tf("pde",{message:[this.uid,0,{tileSize:this.tileSize,projected:!0,onlyOutline:4===k,serverUrl:e.toString(),layerConfigs:[f],horizontalMargin:1}]}).then(function(){m.i=!0,m.Sa()},this.zb)}u(Pq,dr),t("H.service.extension.platformData.TileProvider",Pq),Pq.prototype.u=function(e,o,f){return(e=new Wq(e,o,f)).i=kr,e};var kr=new O({strokeColor:"transparent",fillColor:"transparent",lineWidth:0,lineJoin:"round",lineCap:"round"});function lr(e,o,f,m,w,k){Vq(lr,1,o,f),Vq(lr,2,m,w),(this.f=e.length)?(this.R=e,this.s=o,this.i=f,this.b=0,this.c=z(this.c,this),this.m=m,this.j=w,this.a=oc(),Ya(this.a,mr,k||{}),this.g={},x.setTimeout(this.c,0)):o(jf,!0)}Pq.prototype.G=function(e,o,f,m,w){var _e,k=this,Y=this.getTileKey(e,o,f);Y=this.Db().get(Y);var _o={cancel:kd},_u=!0,pd=this.b;if(Y&&(4===pd||8===pd?Y.Sd()||(m(up.pop(this.tileSize),null),_u=!1):(m(y),_u=!1)),_u){var iy=sp.setTimeout(function(){(_e=new Tf("pde",{message:[k.uid,1,[e,o,f]]})).then(m,w)},500);_o.cancel=function(){_e?_e.cancel():sp.clearTimeout(iy)}}return _o},Pq.prototype.requestInternal=Pq.prototype.G,Pq.prototype.o=function(){Pq.l.o.call(this),new Tf("pde",{message:[this.uid,3]})},Pq.ResultType=gr;var mr={duration:100,Jl:"geometry",Il:"WKT",co:"searchAttributes",Yi:B};function nr(e){this.a=e}function hr(e){hr.l.constructor.call(this,hr,e)}lr.prototype.c=function(){for(var m,e=[],o=!1,f=Jk();this.b<this.f;){var w=this.R[this.b];if(o=w.attributes,m=w.layerId||this.a.Yi,w.distance&&(o[this.a.co]={nearest:new mg(w.nearestLat,w.nearestLon),distance:w.distance}),w=w[this.a.Jl]){try{var k=On(new io(w))}catch(Y){this.i(new x.Error(Y.message)),o=!0;break}o[this.a.Il]=k}if((w=this.g[m])||(w=this.g[m]=this.m({layerId:m,columnNames:Object.keys(o)})),o=this.j(w,o),e.push(o),this.b++,(o=this.b===this.f)||Jk()-f>=this.a.duration){this.s(e,o);break}}o?this.g={}:this.u=x.setTimeout(this.c,0)},lr.prototype.cancel=function(){x.clearTimeout(this.u),this.b<this.f&&this.i(new x.Error("parsing canceled"))},lr.prototype.cancel=lr.prototype.cancel,nr.prototype.cancel=function(){for(var e=this.a,o=e.length;o--;)e[o].cancel();e.length=0},nr.prototype.cancel=nr.prototype.cancel,u(hr,Rp),t("H.service.extension.platformData.Service",hr),hr.prototype.Ia=function(){return{subDomain:"s.fleet.ls",path:"1"}},hr.CONFIG_KEY="platformData",hr.prototype.request=function(e,o,f,m,w){var k="text/plain";if(!e)throw new D(this.request,0,e);if(!o)throw new D(this.request,1,o);if(!m)throw new D(this.request,3,m);if(!w)throw new D(this.request,4,w);return e=this.C().clone().F(e+"."+o).I(f),o===or.JSON&&(k="application/json"),this.G(e,m,w,k)},hr.prototype.request=hr.prototype.request;var ir="tiles";hr.EntryPoint={DOC_ATTRIBUTES:"doc/attributes",DOC_LAYER:"doc/layer",DOC_LAYERS:"doc/layers",DOC_MAPS:"doc/maps",DOC_INDEXES:"doc/indexes",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SERVICE_CONFIGURATION:"serviceconfiguration",STATIC:"static",TILE:"tile",TILES:ir,FILE:"file",INDEX:"index"};var jr="json",or={TXT:"txt",JSON:jr,HTML:"html",BIN:"bin"};function pr(e,o,f,m,w){var Y,k=[],_e=f.layer_id||f.layer_ids;return e=e.request(o,jr,f,function(_o){Y=new lr(_o.geometries,m,w,function(_u){return new Mq([],_u.columnNames,_u)},function(_u,pd){return _u.nc(Nq(_u,pd))},{Yi:_e}),k.push(Y)},function(_o){w(new x.Error(_o))}),k.push(e),new nr(k)}function qr(e,o,f){if(!Ac(e))throw new D(f,0,"has invalid type");if(!Ac(o))throw new D(f,1,"has invalid type");if(e.length!==o.length||!e.length)throw new D(f,1,"specify one key attribute for each given layer id in the same order")}function rr(e){rr.l.constructor.call(this,rr,e)}function sr(e){var o=tr;if(!e||!Bc(e.layerId)||vc(e.rowFilter)&&!Da(e.rowFilter)||vc(e.rowFilterContext)&&!Ea(e.rowFilterContext))throw new D(o,1,vc("invalid layer config")?"invalid layer config":e)}function ur(e){return Bc(e)&&/^[A-Z][A-Z0-9_]*$/.test(e)}function vr(e){for(var o=e&&e.length,f=2<=o&&"WKT"===e[--o]&&"GEOMETRY_ID"===e[--o];f&&o--;)f=ur(e[o]);return f}function wr(e,o){var f="",m=[];if(o){var w=e.geometries;if(w&&w.length){var k=Object.keys(w[0].attributes);for(f=f+"Meta:\t"+o+"\n"+k.join("\t"),f+="\tWKT\n",e=0;e<w.length;e++){var Y=w[e].attributes,_e=w[e].geometry;for(o=0;o<k.length;o++)m.push(Y[k[o]]);f+=m.join("\t"),f+="\t"+_e+"\n",m=[]}}}else{if(_e={},m=[],e.geometries)for(w=0;w<e.geometries.length;w++)_e[(o=e.geometries[w]).layerId]||(_e[o.layerId]=[]),_e[o.layerId].push(o);for(k in _e)m.push({layerId:k,geometries:_e[k]});for(e=0;e<m.length;e++)f+=wr(m[e],m[e].layerId)}return f}function tr(e,o,f){var k,m=this,w=o&&o.rowFilter;tr.l.constructor.call(this,f),C(e,xr,tr,0);var Y=f.resultType;if(sr(o),w){var _e=Wa(o);_e.rowFilter=w.toString()}else _e=o;(new Qf).a("cle","H.service.extension.worker.processor");var _o=o.layerId;e.request(yr,zr,{detail_level:"all",layer_id:_o},function(_u){var pd;for(_u=_u.layers,pd=0;pd<_u.length;pd++)if(_u[pd].layerId===_o){_e.level=_u[pd].level;break}k=e.C().clone().F(Ar+"."+zr).I({meta:1}),new Tf("cle",{message:[m.uid,0,{tileSize:m.tileSize,projected:!0,onlyOutline:4===Y,serverUrl:k.toString(),layerConfigs:[_e],batchTiles:!1,horizontalMargin:1}]}).then(function(){m.i=!0,m.Sa()},m.zb)},function(_u){m.zb(_u.message)})}function Br(){if(Cr)throw new Zc(Br)}hr.EntryPointType=or,hr.prototype.ic=function(e,o){var f=o&&o.resultType;return e=new Pq(this,e,o),1==f||2===f?new Kn(e):new ql(e)},hr.prototype.createTileLayer=hr.prototype.ic,hr.prototype.yc=function(e,o,f,m,w,k){function Y(_u,pd){pd&&_e--,m(_u,!_e)}var _e,_o=[];for(qr(e,o,this.yc),Vq(this.yc,3,m,w),C(f,K,this.yc,2),f={bbox:f.c+","+f.a+";"+f.f+","+f.b},k&&Ya(f,k),k=0,_e=(e=f.layer_id?[f.layer_id]:e).length;k<_e;k++)f.layer_id=e[k],f.key_attribute=o[k],_o.push(pr(this,"search/bbox",f,Y,w));return new nr(_o)},hr.prototype.searchByBoundingBox=hr.prototype.yc,hr.prototype.Mb=function(e,o,f,m,w,k,Y){if(qr(e,o,this.Mb),C(f,mg,this.Mb,2,"has invalid type"),!Ec(m))throw new D(this.Mb,3,"has invalid type");return Vq(this.Mb,4,w,k),e={layer_ids:e.join(","),key_attributes:o.join(","),proximity:f.lat+","+f.lng+","+m},Y&&Ya(e,Y),pr(this,"search/proximity",e,w,k)},hr.prototype.searchByProximity=hr.prototype.Mb,hr.prototype.Lb=function(e,o,f,m,w,k,Y){var _e="";if(qr(e,o,this.Lb),!Bc(f)&&!C(f,L))throw new D(this.Lb,1,"has invalid type");if(!Ec(m))throw new D(this.Lb,2,"has invalid type");if(Vq(this.Lb,4,w,k),e={layer_ids:e.join(","),key_attributes:o.join(","),radius:m},Bc(f))e.route_id=f;else{for(m=f.X,f=0,o=m.length;f<o;f+=3)_e+=m[f]+","+m[f+1],f<o-3&&(_e+=";");e.corridor=_e}return Y&&Ya(e,Y),pr(this,"search/corridor",e,w,k)},hr.prototype.searchByCorridor=hr.prototype.Lb,W.prototype.Aj=function(e){return rp(W.prototype.Aj),this.Ma(hr,e)},W.prototype.getPlatformDataService=W.prototype.Aj,u(rr,Rp),t("H.service.extension.geofencing.Service",rr),rr.prototype.Ia=function(){return{subDomain:"fleet.ls",path:"2"}},rr.CONFIG_KEY="geofencing",rr.prototype.request=function(e,o,f,m){if(!e)throw new D(this.request,0,e);if(!Da(f))throw new TypeError("onResult must be a function");if(!Da(m))throw new TypeError("onError must be a function");return e=this.C().clone().F(e+".json").I(o),this.G(e,f,m)},rr.prototype.request=rr.prototype.request,rr.prototype.a=function(e){return Error(e.issues&&e.issues.length?e.issues.map(function(o){return o.message}).join(". "):e.message||e.response_code)},rr.EntryPoint={SEARCH_PROXIMITY:"search/proximity"},W.prototype.rj=function(e){return rp(W.prototype.rj),this.Ma(rr,e)},W.prototype.getGeofencingService=W.prototype.rj,t("H.service.extension.customLocation.Permission",{READ:"read",WRITE:"write",EXPORT:"export"}),t("H.service.extension.customLocation.Storage",{READONLY:"readonly",UPDATABLE:"updatable"}),u(tr,dr),t("H.service.extension.customLocation.TileProvider",tr),tr.prototype.u=function(e,o,f){return new Wq(e,o,f)},tr.prototype.G=function(e,o,f,m,w){var _e,k=this,Y=this.getTileKey(e,o,f);Y=this.Db().get(Y);var _o={cancel:kd},_u=!0,pd=this.b;if(Y&&(4===pd||8===pd?Y.Sd()||(m(up.pop(this.tileSize),null),_u=!1):(m(y),_u=!1)),_u){var iy=sp.setTimeout(function(){(_e=new Tf("cle",{message:[k.uid,1,[e,o,f]]})).then(m,w)},500);_o.cancel=function(){_e?_e.cancel():sp.clearTimeout(iy)}}return _o},tr.prototype.requestInternal=tr.prototype.G,tr.prototype.o=function(){tr.l.o.call(this),new Tf("cle",{message:[this.uid,3]})},t("H.service.extension.customLocation.Table",Br);var Cr=!0;function Dr(e,o){var f;Cr=!1;var m=new Br;Cr=!0,m.c=rc(x.JSON.parse(x.JSON.stringify(e))),e=e.columnNames;var w=oc();for(f=e.length;f--;)w[e[f]]=f;if(m.f=w,m.b=e.length,o){if(o.length%e.length)throw new D(Dr,1,"Invalid number of cells")}else o=[];return m.a=o,m}Br.prototype.Kd=function(){return this.c},Br.prototype.getMeta=Br.prototype.Kd,Br.prototype.Nd=function(){return this.a.length/this.b},Br.prototype.getRowCount=Br.prototype.Nd,Br.prototype.nc=function(e){return e<this.a.length/this.b?new Er(this,e):B},Br.prototype.getRow=Br.prototype.nc,Br.prototype.Mm=function(){var o,e=this.a.length/this.b,f=new x.Array(e);for(o=0;o<e;o++)f[o]=new Er(this,o);return f},Br.prototype.getRows=Br.prototype.Mm,Br.prototype.zg=function(e){var f=this.a,m=f.length/this.b;if(!e||e.length%this.b)throw new D(this.zg,0,"Invalid number of cells");return this.a=f.concat(e),m},Br.prototype.addCells=Br.prototype.zg,Br.prototype.nl=function(){for(var e=this.b,o=this.a,f=this.a.length/this.b;e--;)o.push(y);return this.nc(f)},Br.prototype.addRow=Br.prototype.nl,Br.prototype.Oa=function(){return this.c.columnNames},Br.prototype.getColumnNames=Br.prototype.Oa,Br.prototype.xe=function(e){return this.f[e]===B?B:new Fr(this,e)},Br.prototype.getColumn=Br.prototype.xe,Br.prototype.sa=function(e,o){return this.a[e*this.b+this.f[o]]},Br.prototype.getCell=Br.prototype.sa,Br.prototype.zc=function(e,o,f){if(o=this.f[o],e>=this.a.length/this.b)throw new D(this.zc,0,"Row index out of bounds");if(o===B)throw new D(this.zc,0,"Column unknown");this.a[e*this.b+o]=f},Br.prototype.setCell=Br.prototype.zc,Br.prototype.concat=function(e){var f,o=arguments.length,m=""+this.Oa(),w=this.a?this.a.slice():[];for(f=0;f<o;f++){var k=arguments[f];if(!(k instanceof Br))throw new D(this.concat,f);if(""+k.Oa()!==m)throw new D(this.concat,f,"Incompatible columns!");k.a&&(w=w.concat(k.a))}return Dr(this.c,w)},Br.prototype.concat=Br.prototype.concat;var Gr=/(\n|\t|\r|")/;function Hr(e,o,f,m,w,k,Y,_e){var _o;for(_o=0;_o<Y;_o++){_o&&o.push("\t");var _u=f[m*w+k[_o]];if(_o!==_e){if(_u!==y){if(_u=String(_u),Gr.test(_u))throw new D(e.wi,0,'Invalid character (\\n, \\r, \\t, or ") in row '+m+" column "+e.c.columnNames[k[_o]]);o.push(_u)}}else o.push(_u)}}function Fr(e,o){this.b=e,this.a=o}function Er(e,o){this.a=e,this.Dh=o}function Ir(e){if(e===B)e="\t";else if(!/^[^"\r\n]$/.test(e))throw new D(Ir,0);this.c=String(e).charCodeAt(0),this.Eh=z(this.Eh,this),this.a=Jr}Br.prototype.wi=function(e,o){var f,m=this.b,w=this.Oa(),k=[],Y=[],_e=this.a,_o=-1;for(f=0;f<m;f++)(!e||e.test(w[f]))&&("WKT"===w[f]&&(_o=k.length),k.push(f));if(!(e=k.length))throw new D(this.wi,1,"No columns filtered");if(Hr(this,Y,w,0,m,k,e,_o),o){var _u=o.length;for(f=0;f<_u;f++)Y.push("\n"),Hr(this,Y,_e,w=o[f],m,k,e,_o)}else for(_u=this.Nd(),w=0;w<_u;w++)Y.push("\n"),Hr(this,Y,_e,w,m,k,e,_o);return Y.join("")},Br.Column=Fr,Fr.prototype.sa=function(e){return this.b.sa(e,this.a)},Fr.prototype.getCell=Fr.prototype.sa,Fr.prototype.zc=function(e,o){this.b.zc(e,this.a,o)},Fr.prototype.setCell=Fr.prototype.zc,Br.Row=Er,Er.prototype.Oa=function(){return this.a.Oa()},Er.prototype.getColumnNames=Er.prototype.Oa,Er.prototype.sa=function(e){return this.a.sa(this.Dh,e)},Er.prototype.getCell=Er.prototype.sa,Er.prototype.zc=function(e,o){this.a.zc(this.Dh,e,o)},Er.prototype.setCell=Er.prototype.zc,Er.prototype.gd=function(){return this.a},Er.prototype.getTable=Er.prototype.gd;var Jr=0;function Kr(e,o,f){var m=e.a;if(m!==o)throw 1===m&&(e.a=Jr),new Zc(f,"Requires state: "+["READY","PARSE","PAUSE"][o]+" but found "+["READY","PARSE","PAUSE"][m])}function Lr(e,o){var f=[];return e.parse(o,function(m,w,k){return 1>m&&(f[w]=k),0<m}),e.a=Jr,f}function Mr(e,o,f){this.c=new io(e),this.m=o,this.g=!0,this.mf=this.j=this.b=0,Nr(this),this.a=f,this.f=[],this.i=!1}function Nr(e){var o=e.c.Ib();e.s=!1,(e.R=34===o)&&e.c.next()}function Or(e,o){var f=e.c;switch(e.s=!0,o){case e.m:e.b++;break;case 13:f.next(),10!==f.Ib()&&e.a("CR without LF");case 10:e.b=0,e.j++;break;case-1:e.g=!1;break;default:e.a("End of field expected")}return f.next(),-1}function Pr(e,o,f,m){if(m=m||{},!o)throw new D(Pr,1,"has to be a function");if(!f)throw new D(Pr,2,"has to be a function");for(this.m=o,this.u=f,this.a=[],this.g={},this.f=[],this.b={},this.i={},this.j={},this.s={},this.R=m.duration||100,this.c=z(this.c,this),e=e.split("Meta:\t").slice(1),o=0;o<e.length;o++){f=(m=e[o].split("\n"))[0].split("\t")[0],m=m.slice(1).join("\n"),this.b[f]=new Ir,this.g[f]=Lr(this.b[f],m);var w={layerId:f,columnNames:this.g[f]};this.f.push(f),this.s[f]=Dr(w),this.i[f]=Jk(),Qr(this,m,f),this.c(f)}}function Qr(e,o,f){var m=[],w=e.g[f].length-1,k=e.s[f];try{e.b[f].parse(o,function(Y,_e,_o){var _u=!1;return 0<Y&&(m[_e]=_o,_e===w&&(e.a.push(k.nc(k.zg(m))),Jk()-e.i[f]>e.R&&(_u=!0))),_u},function(Y,_e,_o){if(0<Y&&_e===w)return On(_o)})}catch(Y){e.u(Y)}}function xr(e){xr.l.constructor.call(this,xr,e)}function Rr(e,o,f,m){var w,k=o[e=e===Sr?"changes":"file"],Y=Bc(k),_e=!Y&&C(k,Blob);if(!Y&&!_e)throw new D(m,0,"Invalid "+e+" parameter");if(Tr)w=_e?k:qf(k,"text/plain"),(m=new x.FormData).append(e,w,w.name||e+".wkt"),f.method="POST",f.data=m,delete o[e];else if(_e)throw new D(m,0,"Sending Blob data is not supported by the browser")}p=Ir.prototype,p.getState=function(){return this.a},p.abort=function(){Kr(this,2,Ir.prototype.abort),this.a=Jr},p.Eh=function(e){throw this.a=Jr,new D(Ir.prototype.parse,0,"Malformed DSV at row "+this.b.j+" column "+this.b.b+": "+e)},p.parse=function(e,o,f){Kr(this,Jr,Ir.prototype.parse),e=e.trim(),this.b=new Mr(e,this.c,this.Eh),this.f=o,this.kk=f||hf,this.a=2,this.Fh()},p.kk=hf,p.Fh=function(){var e=this.b,o=[];Kr(this,2,Ir.prototype.Fh),this.a=1;do{if(!e.g){this.a=Jr;break}if(w>e.b){if(void 0!==f&&f!==w)return void this.b.a("The number of columns must be the same for all rows");var f=w}var m=e.j,w=e.b,k=e.mf,Y=this.kk(m,w,e);if(e.mf>k)for(;-1!==e.next(););else{for(;-1!==(k=e.next());)o.push(k);Y=String.fromCharCode.apply(y,o),o.length=0}Nr(e),this.f(m,w,Y)&&(this.a=e.g?2:Jr)}while(1===this.a);2!=this.a&&void 0!==f&&0<w&&f!==w&&this.b.a("The number of columns must be the same for all rows")},p=Mr.prototype,p.mf=0,p.Ib=function(){if(this.s)var e=-1;else{var o=this.c;if(e=o.Ib(),this.R)switch(e){case 34:o.next(),34!==(e=o.Ib())&&(e=Or(this,e));break;case-1:this.a("Closing quotation mark expected")}else switch(e){case 34:this.a("Unexpected quotation mark");case this.m:case 13:case 10:case-1:e=Or(this,e)}}return e},p.de=function(){this.i=!0,this.f=[]},p.Dd=function(){var e=this.f.slice();return this.i=!1,this.f=[],e},p.next=function(){var e=this.Ib();return-1!==e&&this.c.next(),this.i&&this.f.push(e),this.mf++,e},Pr.prototype.cancel=function(){for(var e in this.j)x.clearTimeout(this.j[e])},Pr.prototype.cancel=Pr.prototype.cancel,Pr.prototype.c=function(e){var f,m,o=this;this.j[e]=x.setTimeout(function(){if(2===o.b[e].getState())o.i[e]=Jk(),o.m(o.a,!1),o.a=[],o.b[e].Fh(),o.c(e);else{for(f=!0,m=0;m<o.f.length;m++)if(o.b[o.f[m]].getState()!==Jr){f=!1;break}f&&(0<o.a.length&&o.m(o.a,!0),o.a=[])}},0)},u(xr,Rp),t("H.service.extension.customLocation.Service",xr),xr.prototype.Ia=function(){return{subDomain:"fleet.ls",path:"2"}},xr.CONFIG_KEY="customLocation",xr.prototype.ic=function(e,o){var f=o&&o.resultType;return e=new tr(this,e,o),1===f||2===f?new Kn(e):new ql(e)},xr.prototype.createTileLayer=xr.prototype.ic;var Tr=x.FormData&&!!x.FormData.prototype.append;function Ur(e,o,f,m,w,k){var Y="text/plain",_e=o===Vr.LAYERS_UPLOAD||o===Vr.LAYERS_MODIFY||o===Vr.LAYERS_IMPORT,_o=m,_u={data:B,method:"GET",headers:e.g};if(!o)throw new D(e.request,0,o);if(!f)throw new D(e.request,1,f);Vq(e.request,3,w,k),_e&&(C(m,Object,e.request,2,"Invalid request parameters"),Rr(o,_o=Wa(m),_u,e.request));var pd=e.C().clone().F(o+"."+f).I(_o);return f===Wr.JSON&&(Y="application/json"),(e=new uf(Y,pd.toString(),ie,_u)).then(function(iy){var sy=iy.issues;sy&&iy.error_id&&iy.response_code?k(Error(sy[0].message)):w(iy)},function(iy){"error"===iy.type||404===iy.status?k(Error(iy.statusText||"Unable to load data")):iy.json().then(function(sy){k(Error("["+sy.issues[0].message+"] "+pd+" request failed"))},function(){k(Error("["+iy.statusText+"] "+pd+" request failed"))})}),e}xr.prototype.request=function(e,o,f,m,w){return Ur(this,e,o,f,m,w)},xr.prototype.request=xr.prototype.request;var yr="layers/list",Sr="layers/modify",Ar="tiled/tile",Vr={LAYERS_DELETE:"layers/delete",LAYERS_GRANT:"layers/access/grant",LAYERS_LIST:yr,LAYERS_MODIFY:Sr,LAYERS_UPLOAD:"layers/upload",LAYERS_IMPORT:"layers/import",SEARCH_ALL:"search/all",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SEARCH_TILE:Ar};xr.EntryPoint=Vr;var zr="json",Wr={TXT:"txt",JSON:zr};function Xr(e,o,f,m,w){var Y,k=[];return e=e.request(o,zr,f,function(_e){_e.geometries.length?(_e=wr(_e,f.layer_id),Y=new Pr(_e,m,w),k.push(Y)):m(jf,!0)},w),k.push(e),new nr(k)}xr.EntryPointType=Wr,xr.prototype.jb=function(e,o,f){var m=this;return this.request("search/all","txt",{filter:'WKT==""',layer_id:e},function(w){var k=String(w).replace(/[\r\n]+$/g,"").split("\t");m.request(yr,zr,{layer_id:e,detail_level:"all"},function(Y){(Y=Y.layers[0]).columnNames=k,o(Dr(Y))},f)},f)},xr.prototype.getLayer=xr.prototype.jb,xr.prototype.Ij=function(e,o,f,m){var k=o&&o.length,Y=-1,_e=this;return function w(){return++Y<k?_e.request("layers/access/grant",zr,{layer_id:e,granted_app_id:o[Y].grantedAppId,permissions:o[Y].permissions.join(",")},w,m):_e.jb(e,f,m)}()},xr.prototype.grantAccess=xr.prototype.Ij,xr.prototype.$i=function(e,o,f){return this.request("layers/delete",zr,{layer_ids:e},o,f)},xr.prototype.deleteLayer=xr.prototype.$i,xr.prototype.cd=function(e,o,f){function m(){setTimeout(function(){_o.jb(Y,function(sy){setTimeout(w.bind(null,sy),pd)},function(){64e3>_u?(_u+=pd,m()):f(x.Error("Timeout"))})},pd),pd*=2}function w(sy){var gy=JSON.stringify(sy.Oa()),wy=e.grants;if(gy!==JSON.stringify(_e)){var Ey="Results into different column names on the backend: "+gy;setTimeout(function(){_o.$i(Y,function(){f(x.Error(Ey))},function(Py){f(x.Error(Ey+". "+Py.message))})},pd)}else wy&&wy.length?_o.Ij(Y,wy,o,f):o(sy)}var k,Y,_e,_o=this,_u=0,pd=1e3,iy=!e||!ur(Y=e.layerId)&&(k="layerId")||!vr(_e=e.columnNames)&&(k="columnNames")?0:Da(o)?Da(f)?-1:2:1;if(0<=iy)throw new D(_o.cd,iy,k||arguments[iy]);return _o.jb(Y,function(){f(x.Error("Layer exists already"))},function(){var sy={layer_id:Y,file:_e.join("\t")},gy=e.level,wy=e.storage;gy!==B&&(sy.level=gy),wy!==B&&(sy.storage=wy),_o.request("layers/upload",zr,sy,m,f)})},xr.prototype.createLayer=xr.prototype.cd,xr.prototype.Mb=function(e,o,f,m,w,k){if(!Ac(e))throw new D(this.Mb,0,"has invalid type");if(C(o,mg,this.Mb,1,"has invalid type"),!Ec(f))throw new D(this.Mb,2,"has invalid type");return Vq(this.Mb,3,m,w),e={layer_ids:e.join(","),proximity:o.lat+","+o.lng+","+f},k&&Ya(e,k),Xr(this,"search/proximity",e,m,w)},xr.prototype.searchByProximity=xr.prototype.Mb,xr.prototype.Lb=function(e,o,f,m,w,k){var Y="";if(!Ac(e))throw new D(this.Lb,0,"has invalid type");if(!Bc(o)&&!C(o,L))throw new D(this.Lb,1,"has invalid type");if(!Ec(f))throw new D(this.Lb,2,"has invalid type");if(Vq(this.Lb,3,m,w),e={layer_ids:e.join(","),radius:f},Bc(o))e.route_id=o;else{var _e=o.X;for(o=0,f=_e.length;o<f;o+=3)Y+=_e[o]+","+_e[o+1],o<f-3&&(Y+=",");e.corridor=Y}return k&&Ya(e,k),Xr(this,"search/corridor",e,m,w)},xr.prototype.searchByCorridor=xr.prototype.Lb,xr.prototype.yc=function(e,o,f,m,w){function k(_o,_u){_u&&_e--,f(_o,!_e)}var _e,Y=[];if(!Ac(e))throw new D(this.yc,0,"has invalid type");for(C(o,K,this.yc,1,"has invalid type"),Vq(this.yc,2,f,m),o={bbox:o.c+","+o.a+";"+o.f+","+o.b},w&&Ya(o,w),w=0,_e=(e=o.layer_id?[o.layer_id]:e).length;w<_e;w++)o.layer_id=e[w],Y.push(Xr(this,"search/bbox",o,k,m));return new nr(Y)},xr.prototype.searchByBoundingBox=xr.prototype.yc,xr.prototype.bi=function(e,o,f,m){var w,k=[];if(!Bc(e))throw new D(this.bi,0,"has invalid type");Vq(this.bi,1,o,f);var Y={layer_id:e};return m&&Ya(Y,m),m=this.request("search/all",zr,Y,function(_e){_e.geometries.length?(_e=wr(_e,e),w=new Pr(_e,o,f),k.push(w)):o(jf,!0)},f),k.push(m),new nr(k)},xr.prototype.searchAll=xr.prototype.bi;var Yr={delete:/^GEOMETRY_ID$/,append:/^(?!GEOMETRY_ID$)/};function Zr(e,o,f,m,w,k){function Y(){wy++,m(this,wy===sy)}function _e(y0){wy++,w(y0,this,wy===sy)}var _u,_o="append"!==o,pd={},iy=oc(),sy=0,gy=[],wy=0;if(!Ac(f))throw new D(k,0,f);for(Vq(k,1,m,w),_u=f.length;_u--;){var Ey=f[_u];if(C(Ey,Er)){var Py=Ey.gd().Kd().layerId,Jy=Ey.sa("GEOMETRY_ID");if(_o){if(Jy===y||""===String(Jy))var _m='GEOMETRY_ID must not be null or ""';pd[Jy=Py+"_"+Jy]&&(_m="same GEOMETRY_ID for multiple rows"),pd[Jy]=Ey}else Jy!==y&&""!==String(Jy)&&(_m='GEOMETRY_ID must be null or ""')}else _m="Invalid type";if(_m)throw new D(k,0,"- Invalid row at index "+_u+", "+_m);(Jy=iy[Py])||(Jy=iy[Py]=[],sy++),Jy.push(Ey)}for(Py in iy){for(f=[],_u=(Jy=iy[Py]).length;_u--;)f.push(Jy[_u].Dh);gy.push(e.request(Sr,zr,{layer_id:Py,action:o,changes:Jy[0].gd().wi(Yr[o]||null,f)},z(Y,Jy),z(_e,Jy)))}return new nr(gy)}function $r(e){Yp.l.constructor.call(this,$r,e)}function as(e){as.l.constructor.call(this,as,e)}function bs(e){if(this.c=!!e.toBypassToken,!this.c&&!e.token)throw new D(bs,0,'"token" must be specified');bs.l.constructor.call(this,bs,e),this.j=e.token,this.f={},this.b={}}function gs(e,o,f,m,w,k,Y){return w={method:w,headers:Object.assign(e.c?{}:{authorization:"Bearer "+e.j},{"Content-Type":"application/geo+json"},e.g)},k&&(w.data=JSON.stringify(k)),(k=new uf("application/json",(o=ds(e.C().clone().F(o+"/features").I(Y||{}))).toString(),ie,w)).then(f,Tp(e,o,m)),k}function fs(e,o){e.b[o]=hs,e.Df(o,function(f){e.b[o]=is,e.f[o]=f.copyright,e.dispatchEvent("copyrightupdate")},function(f){throw e.b[o]=js,f})}function es(e,o){return e.c?o:ds(o).I({access_token:e.j})}function ds(e){var o=Object.assign({},e.getQuery());return delete o.apikey,e.kg(o)}xr.prototype.Qi=function(e,o,f){return Zr(this,"append",e,o,f,this.Qi)},xr.prototype.appendRows=xr.prototype.Qi,xr.prototype.hl=function(e,o,f){return Zr(this,"update",e,o,f,this.hl)},xr.prototype.updateRows=xr.prototype.hl,xr.prototype.aj=function(e,o,f){return Zr(this,"delete",e,o,f,this.aj)},xr.prototype.deleteRows=xr.prototype.aj,W.prototype.lj=function(e){return rp(W.prototype.lj),this.Ma(xr,e)},W.prototype.getCustomLocationService=W.prototype.lj,u($r,Rp),t("H.service.extension.customRoute.Service",$r),$r.prototype.Ia=function(){return{subDomain:"s.fleet.ls",path:"2"}},$r.CONFIG_KEY="customRoute",$r.prototype.a=function(e){return Error(e.issues&&e.issues.length?e.issues.map(function(o){return o.message}).join(". "):e)},$r.prototype.zd=function(e,o,f){return Vq(this.zd,1,o,f),e=this.C().clone().F("calculateroute.json").I(e),this.G(e,o,f)},$r.prototype.calculateRoute=$r.prototype.zd,W.prototype.mj=function(e){return rp(W.prototype.mj),this.Ma($r,e)},W.prototype.getCustomRoutingService=W.prototype.mj,u(as,Rp),t("H.service.SearchService",as),as.CONFIG_KEY="search",as.prototype.Ia=function(){return{subDomain:"search",path:"v1"}},as.prototype.a=function(e){return e=[e.title,e.action,e.cause].filter(function(o){return o}),Error(e.join(". "))},as.prototype.Rg=function(e,o,f){return e=this.C().clone().za("geocode").F("geocode").I(e),this.G(e,o,f)},as.prototype.geocode=as.prototype.Rg,as.prototype.Zh=function(e,o,f){return e=this.C().clone().za("revgeocode").F("revgeocode").I(e),this.G(e,o,f)},as.prototype.reverseGeocode=as.prototype.Zh,as.prototype.rl=function(e,o,f){return e=this.C().clone().za("autosuggest").F("autosuggest").I(e),this.G(e,o,f)},as.prototype.autosuggest=as.prototype.rl,as.prototype.yl=function(e,o,f){return e=this.C().clone().za("discover").F("discover").I(e),this.G(e,o,f)},as.prototype.discover=as.prototype.yl,as.prototype.vn=function(e,o,f){return e=this.C().clone().za("lookup").F("lookup").I(e),this.G(e,o,f)},as.prototype.lookup=as.prototype.vn,as.prototype.tl=function(e,o,f){return e=this.C().clone().za("browse").F("browse").I(e),this.G(e,o,f)},as.prototype.browse=as.prototype.tl,W.prototype.Om=function(e){return this.Ma(as,e)},W.prototype.getSearchService=W.prototype.Om,u(bs,Rp),t("H.service.xyz.Service",bs),bs.prototype.Ia=function(){return{host:"xyz.api.here.com",path:"hub/spaces"}},bs.prototype.a=function(e){return Error(e.errorMessage||e.message)},bs.prototype.bh=function(e,o,f){return yc(e,"String",this.bh,0,'"projectId" must be a string'),cs(this.bh,1,o,f),e=ds(this.C().clone().td("project-api/projects/"+e)),this.G(e,o,f)},bs.prototype.getProject=bs.prototype.bh,bs.prototype.Cj=function(e,o,f){return cs(this.Cj,0,e,o),f=es(this,this.C().clone().I(f||{})),this.G(f,e,o)},bs.prototype.getSpaces=bs.prototype.Cj,bs.prototype.Df=function(e,o,f){return yc(e,"String",this.Df,0,'"spaceId" must be a string'),cs(this.Df,1,o,f),e=es(this,this.C().clone().F(e)),this.G(e,o,f)},bs.prototype.getSpace=bs.prototype.Df,bs.prototype.Od=function(e,o,f){return yc(e,"String",this.Od,0,'"spaceId" must be a string'),cs(this.Od,1,o,f),e=es(this,this.C().clone().F(e+"/statistics")),this.G(e,o,f)},bs.prototype.getStatistics=bs.prototype.Od,bs.prototype.yf=function(e,o,f,m,w,k,Y){return e=es(this,this.C().clone().F(m+"/tile/web/"+f+"_"+e+"_"+o+".mvtf").I(Object.assign({clip:!0},Y))),this.G(e,function(_e){return _e.arrayBuffer().then(w)},k,"arraybuffer")},bs.prototype.search=function(e,o,f,m){return yc(e,"String",this.search,0,'"spaceId" must be a string'),cs(this.search,1,o,f),e=es(this,this.C().clone().F(e+"/search").I(m||{})),this.G(e,o,f)},bs.prototype.search=bs.prototype.search,bs.prototype.Nc=function(e,o,f,m){if(yc(e,"String",this.Nc,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.Nc,1,'"params" must be an object');return cs(this.Nc,2,f,m),e=es(this,this.C().clone().F(e+"/features").I(o)),this.G(e,f,m)},bs.prototype.getFeaturesById=bs.prototype.Nc,bs.prototype.Hd=function(e,o,f,m){if(yc(e,"String",this.Hd,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.Nc,1,'"params" must be an object');return cs(this.Hd,2,f,m),e=es(this,this.C().clone().F(e+"/bbox").I(o)),this.G(e,f,m)},bs.prototype.getFeaturesByBoundingBox=bs.prototype.Hd,bs.prototype.ba=function(e){return this.f[e]||(this.b[e]||fs(this,e),null)},bs.prototype.Vc=function(e,o,f,m,w){if(yc(e,"String",this.Vc,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.Vc,1,'"geojsonObject" must be an object');if(cs(this.Vc,2,f,m),w&&!Ea(w))throw new D(this.Vc,4,'"opt_params" must be an object');return gs(this,e,f,m,"PUT",o,w)},bs.prototype.putFeatures=bs.prototype.Vc,bs.prototype.Tc=function(e,o,f,m,w){if(yc(e,"String",this.Tc,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.Tc,1,'"featureCollection" must be an object');if(cs(this.Tc,2,f,m),w&&!Ea(w))throw new D(this.Tc,4,'"opt_params" must be an object');return gs(this,e,f,m,"POST",o,w)},bs.prototype.postFeatures=bs.prototype.Tc,bs.prototype.dd=function(e,o,f,m){if(yc(e,"String",this.dd,0,'"spaceId" must be a string'),!Ea(o))throw new D(this.dd,1,'"params" must be an object');return cs(this.dd,2,f,m),gs(this,e,f,m,"DELETE",B,o)},bs.prototype.deleteFeatures=bs.prototype.dd,bs.CONFIG_KEY="xyz";var hs=1,is=2,js=-1;function cs(e,o,f,m){if(!Da(f))throw new D(e,o,'"onResult" must be a function');if(!Da(m))throw new D(e,o+1,'"onError" must be a function')}function ks(e,o,f){var m;if(ks.l.constructor.call(this,f?{min:f.min,max:f.max,engineType:f.engineType}:void 0),C(e,bs,ks,0),!Bc(o))throw new D(ks,1,'"spaceId" must be a string');if(this.u=e,this.b=o,this.i={},f&&(["limit","simplificationLevel","tags"].forEach(function(w){w in f&&(this.i[w]=f[w])},this),e=f.parameters))for(m in e)this.i[m]=e[m];this.Pb(this.c===ik.WEBGL?new qi({sources:{xyz:{type:"MVT"}},layers:{xyz:{data:{source:"xyz",layer:this.b},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#000000",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.b,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.b,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.b,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.b,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#000000",lineWidth:"2px",renderOrder:203}]}))}function ls(e,o,f,m,w){1&w&&ms(e,e,o,f,m,0),2&w&&ms(e,e,o,f,m,1),4&w&&ms(e,e,o,f,m,2),8&w&&ms(e,e,o,f,m,3)}function ms(e,o,f,m,w,k){for(var _e,pd,Ey,Py,Y=(f+1)*(f+1),_o=4*m,_u=f+1,iy=[{r:0,Gl:0,sl:0,xg:0,next:null}],sy=1,gy=["r","g","b","a"][k],wy=2*f+1;sy<wy;sy++)iy[sy]={r:0,Gl:0,sl:0,xg:0,next:null},iy[sy-1].next=iy[sy];iy[2*f].next=iy[0];var Jy=4*(m-1);for(_e=0;_e<w;_e++){var _m=_e*_o,y0=e[_m+k],Oy=y0*_u*(f+2)/2;for(wy=y0*_u,sy=0;sy<=f;sy++)iy[sy][gy]=y0;var K0=0;for(sy=1;sy<=f;sy++){var I0=sy<m?_m+4*sy:_m+Jy;Oy+=(I0=e[I0+k])*(_u-sy),K0+=I0,iy[f+sy][gy]=I0}I0=iy[0],Ey=iy[_u],sy=_m,Py=4*_u;var p1=_m+Jy;for(y0=0;y0<m;y0++){o[sy+k]=Oy/Y,Oy-=wy;var N_=y0+_u<m?sy+Py:p1;if(Oy+=K0+=N_=e[N_+k],wy-=I0[gy],wy+=Ey[gy],K0-=Ey[gy],I0[gy]=N_,I0=I0.next,Ey=Ey.next,sy+=4,!Oy)for(;(pd=4*(y0+_u))<_o&&0===e[_m+k+pd];)y0++,sy+=4}}for(_m=(w-1)*_o,y0=0;y0<m;y0++){for(Oy=(_e=o[(e=4*y0)+k])*_u*(f+2)/2,wy=_e*_u,sy=0;sy<=f;sy++)iy[sy][gy]=_e;for(K0=0,sy=1;sy<=f;sy++)Oy+=(I0=o[(I0=sy<w?e+sy*_o:e+_m)+k])*(f-sy+1),K0+=I0,iy[f+sy][gy]=I0;for(I0=iy[0],Ey=iy[_u],sy=e,p1=_u*_o,Jy=e+_m,_e=0;_e<w;_e++)if(o[sy+k]=Oy/Y,Oy-=wy,Oy+=K0+=N_=o[(N_=_e+_u<w?sy+p1:Jy)+k],wy-=I0[gy],wy+=Ey[gy],K0-=Ey[gy],I0[gy]=N_,I0=I0.next,Ey=Ey.next,sy+=_o,!Oy)for(;(pd=_e+_u)<w&&0===o[pd*_o+k+e];)_e++,sy+=_o}}function ns(e,o,f){this.f=o=e>>o,this.j=Math.log(o)*Math.LOG2E,this.i=e=document.createElement("CANVAS"),this.a=e.getContext("2d"),this.b=e.width=e.height=3*o;var m=document.createElement("canvas");e=f.a;var k,w=f.b;for(Y in o=[],m.width=256,m.height=1,m=m.getContext("2d"),w)w.hasOwnProperty(Y)&&o.push({stop:parseFloat(Y),value:w[Y]});w=o.length,o.sort(this.m),0<o[0].stop&&o.unshift({stop:0,value:o[0].value}),1>o[w-1].stop&&o.push({stop:1,value:o[w-1].value}),w=o.length;var Y=m.createLinearGradient(0,0,256,0);for(k=0;k<w;k++){if(!e&&_o){var _e=_o.stop+(o[k].stop-_o.stop)/2;Y.addColorStop(_e,_o.value),Y.addColorStop(_e,o[k].value)}Y.addColorStop(o[k].stop,o[k].value);var _o=o[k]}m.fillStyle=Y,m.fillRect(0,0,256,1),this.c=m.getImageData(0,0,256,1).data,this.g=f.a}function os(e,o){this.a=e,this.size=o}function ps(e,o){var f,m=0;if(!Ea(e)||Va(e))throw new D(ps,0,e);for(f in e){var w=+f;if(m++,!(Ec(w)&&0<=w&&1>=w&&Bc(e[f])))throw new D(ps,0,e)}if(2>m)throw new D(ps,0,"Specify at least 2 stops");this.b=e,this.a=!!o}W.prototype.Fj=function(e){return rp(W.prototype.Fj,"Use HERE IML service instead."),this.Ma(bs,e)},W.prototype.getXYZService=W.prototype.Fj,u(ks,S),t("H.service.xyz.Provider",ks),ks.prototype.G=function(e,o,f,m,w){return this.u.yf(e,o,f,this.b,m,w,this.i)},ks.prototype.requestInternal=ks.prototype.G,ks.prototype.ba=function(){return this.u.ba(this.b)},ks.prototype.getCopyrights=ks.prototype.ba,ks.prototype.md=gf,ks.prototype.providesOMV=ks.prototype.md,ks.prototype.ea=function(){return this.gb()},ks.prototype.getStyle=ks.prototype.ea,ks.prototype.dc=function(e){C(e,qi)&&e.b("MVT"),this.Pb(e)},ks.prototype.setStyle=ks.prototype.dc,t("H.service.buildInfo",function(){return If("H-service","1.37.1","8e9b6d2",{region:"row"})}),ns.prototype.m=function(e,o){return e.stop-o.stop},t("H.data.heatmap.Colors",ps);var qs=new ps({0:"#008",.2:"#0b0",.5:"#ff0",.7:"#f00"},!0);function rs(e,o,f){this.a=e=$d(e,0,30),this.u=o,this.i=f,this.m=[],this.b=[];do{this.b[e]=[],this.m[e]=new ss}while(e--);o===ts?(this.s=us,this.j=vs):(this.s=ws,this.j=xs),this.c=1/0,this.f=-1/0}ps.DEFAULT=qs;var ys=Math.log(.5);function vs(e){return this.g?Math.round((e-this.c)/this.g*255):127}function xs(e){return void 0===this.R?127:Math.round(255*Math.pow(e,this.R))}function zs(e,o,f,m,w){var Y,_e,k=1<<o;return m=Zd(m,k),!(k=0<=f&&f<k&&(Y=e.b[o])&&(_e=Y[f])&&(k=_e[m])||null)&&w&&0<=o&&(k=zs(e,o-1,f>>1,m>>1,w)),k}function As(e,o,f,m,w,k){for(var Y,_e=[];f<=m;f++)for(Y=w;Y<=k;Y++)_e.push(zs(e,o,f,Y,!1));return _e}function Bs(e,o){var k,f=0,m=0,w=zs(e,0,0,0,!1);return o.f||(o.z===e.a?o.c=o.a:(Cs(e,o,function(Y){var _e=Ds(e,Y),_o=4-_e.length;if(Y.z!==e.a){for(k=0;k<_e.length;k++)f+=_e[k].a,m++;f+=_o*w.a,m+=_o}}),o.c=f/m),o.f=!0),o.c}function Cs(e,o,f){o=[o];for(var m,w;0<o.length;)m=Ds(e,w=o.shift()),f(w),o.push.apply(o,m)}function Ds(e,o){var m,w,k,f=[];for(w=0;1>=w;w++)for(k=0;1>=k;k++)(m=zs(e,o.z+1,2*o.x+w,2*o.y+k,!1))&&f.push(m);return f}function ws(e,o,f){this.x=e,this.y=o,this.z=f,this.a=this.b=this.g=0,this.f=!1,this.c=0}function us(e,o,f){this.x=e,this.y=o,this.z=f,this.a=this.b=this.g=0,this.f=!1,this.c=0}function ss(){this.f=this.c=1/0,this.a=this.b=-1/0}function Es(e){var o=e||{},f=+o.sampleDepth,m=o.pointSize;e=+o.coarseness;var w=o.colors,k={min:o.min,max:o.max,engineType:o.engineType},_e=+o.dataMax;if(o.tileSize&&(k.tileSize=o.tileSize),S.call(this,k),jk(this,o.opacity),this.i="value"===o.type?ts:Fs,this.sampleDepth_=Ec(f)?$d(Math.round(f),1,8):4,this.K=this.i===Fs?Ec(m)?$d(Math.round(7-m),0,6):2:1,this.B=!!o.assumeValues,o=this.max,this.N=Ec(_e)?$d(Math.round(_e),this.min,o+this.sampleDepth_):o,e=Ec(e)?$d(Math.round(e),0,3):1,w&&!C(w,ps))throw new D(Es,0,"colors");this.b=new rs(o+this.sampleDepth_+this.K,this.i,this.N),this.V=new ns(this.tileSize,e,w||qs),this.v=z(this.v,this),this.u=z(this.u,this),this.Y=new Kk(20,this.v)}function Gs(e,o,f,m){var w=document.createElement("canvas"),k=e.tileSize,Y=w.getContext("2d");w.width=w.height=k;var wy,Ey,_e=e.V,_o=e.b,_u=e.B,pd=e.i,iy=e.K,sy=_e.f,gy=_e.a,Py=pd===Fs?void 0===iy?2:iy:1;iy=Py,e=Math.min(e.sampleDepth_+Py,_e.j),Py=_e.b;var Jy=_o.a;if(_u&&pd===ts){for(Ey=-1;1>=Ey;Ey++)for(_u=-1;1>=_u;_u++){var _m=(_m=zs(_o,m,f+Ey,o+_u,!0))?_o.j(Bs(_o,_m)):128;gy.fillStyle="rgba("+_m+",128,0,1)",gy.fillRect((_u+1)*sy,(Ey+1)*sy,sy,sy)}_u=sy-Math.floor(sy/10),Ey=3,ls((_m=gy.getImageData(0,0,Py,Py)).data,_u,Py,Py,Ey),gy.putImageData(_m,0,0)}else gy.fillStyle=_u?"#080":"#000",gy.fillRect(0,0,Py,Py);for(;iy<=e&&m+iy<=Jy;iy++){Ey=sy-(_u=sy>>iy);var y0=pd===Fs?127+Math.floor(128/(1<<e-iy)):255;_m=2+(1<<iy);var Oy=1<<iy,K0=o<<iy,I0=f<<iy;for(K0=(Oy=As(_o,m+iy,I0-1,I0+Oy,K0-1,K0+Oy)).length;K0--;){I0=K0%_m;var p1=K0/_m<<0;(wy=Oy[K0])&&(wy=_o.j(wy.a),gy.fillStyle="rgba("+wy+","+y0+",0,1)",gy.fillRect(I0*_u+Ey,p1*_u+Ey,_u,_u))}_m=gy,y0=_u,I0=I0=3,ls((p1=gy.getImageData(Oy=Ey,Ey,K0=sy+2*_u,_u=sy+2*_u)).data,y0,K0,_u,I0),_m.putImageData(p1,Oy,Ey)}for(o=gy.getImageData(0,0,Py,Py),f=_e.c,m=_e.g,e=0,Py=(_o=o.data).length;e<Py;e+=4)pd=_o[e],iy=_o[e+1],4===f.length&&(pd=0),_o[e]=f[4*pd],_o[e+1]=f[4*pd+1],_o[e+2]=f[4*pd+2],_o[e+3]=f[4*pd+3]*(m?iy/255:10>iy?0:1);return gy.putImageData(o,0,0),_e=new os(_e.i,sy),Y.drawImage(_e.a,sy=_e.size,sy,sy,sy,0,0,k,k),w}rs.prototype.wb=function(e){var o,f,m=e.value;void 0===m&&(m=1),m>this.f&&(this.f=m,this.g=this.f-this.c),m<this.c&&(this.c=m,this.g=this.f-this.c);var w=kj.Jc(e).scale(1073741823).floor(),k=w.x>>30-(m=this.a);for(w=w.y>>30-m,f=this.s;-1<m;){this.b[m][w]||(this.b[m][w]=[]),(o=this.b[m][w][k])||(o=this.b[m][w][k]=new f(k,w,m)),o.wb(e,m);var Y=this.m[m];Y.f>o.b&&(Y.f=o.b),Y.a<o.b&&(Y.a=o.b),Y.c>o.a&&(Y.c=o.a),Y.b<o.a&&(Y.b=o.a),m--,k>>=1,w>>=1}},rs.prototype.clear=function(){rs.call(this,this.a,this.u,this.i)},ws.prototype.wb=function(e,o){this.g++,this.b+=e.value||1,this.a=this.b/Math.pow(2,2*(30-o))},us.prototype.wb=function(e){this.b+=void 0!==(e=e.value)?e:1,this.a=this.b/++this.g,this.f=!1},u(Es,S),t("H.data.heatmap.Provider",Es),Es.prototype.cc=function(e){jk(this,e)},Es.prototype.setOpacity=Es.prototype.cc,Es.prototype.Oc=function(){return this.g},Es.prototype.getOpacity=Es.prototype.Oc,Es.prototype.Qe=gf,Es.prototype.providesRasters=Es.prototype.Qe,Es.prototype.G=function(e,o,f,m,w){var Y,_e,k=this.B;if(zs(this.b,0,0,0,!1)){if(!k){var _o=As(this.b,f,o-1,o+1,e-1,e+1);for(Y=_o.length;Y--&&!k;)if(null!==_o[Y]){k=!0;break}}k&&(_e=this.Y.push([e,o,f,m,w],this.u))}return k||m(null),_e||Bl},Es.prototype.requestInternal=Es.prototype.G,Es.prototype.v=function(e,o){e.done(Gs(this,o[0],o[1],o[2]))},Es.prototype.u=function(e,o,f){var m=e.data;e=m[3],m=m[4],f?m():e(o)},Es.prototype.Pi=function(e,o){var f;if(!Ac(e))throw new D(this.Pi,0,e);if(f=e.length){for(;f--;)this.b.wb(e[f]);var m;f=(e=this.b).m;var w=e.a,k=0;if(e.u===Fs){var Y=f[e.a].a;for(m=e.a;0<=m&&f[m].a===Y;m--)k=m;for(Y=f[0].a,m=0;m<=k&&Y===f[m].a;m++)w=m;k>e.i&&(k=e.i),Y=Math.round(w+(k-w)/2),e.R=ys/Math.log(f[Y].b)}this.reload(!!o)}},Es.prototype.addData=Es.prototype.Pi,Es.prototype.clear=function(){this.b.clear(),this.reload(!0)},Es.prototype.clear=Es.prototype.clear;var Fs=0,ts=1;function Hs(){}function Is(e){for(var o,f=(e=e.attributes).length;f--;)switch(o=e[f],o.name){case"x":this.x=parseFloat(o.value);break;case"y":this.y=parseFloat(o.value);break;case"xunits":this.Qc="fraction"===Hs.prototype.Ja(o);break;case"yunits":this.sc="fraction"===Hs.prototype.Ja(o)}}function Js(e){var o=e.childNodes,f=new Hs;for(e=o.length;e--;){var m=o[e];"href"===m.nodeName&&(this.href=f.Ja(m))}}function Ks(e){var o;if(e){var f=(e=e.childNodes).length;for(o=new Hs;f--;){var m=e[f];switch(m.nodeName){case"scale":this.scale=o.zf(m);break;case"Icon":this.icon=m=new Js(m);break;case"hotSpot":this.a=m=new Is(m)}}}}function Ls(){this.a={4:function(e){return["#",e.charAt(1),e.charAt(1),e.charAt(2),e.charAt(2),e.charAt(3),e.charAt(3),"ff"].join("")},5:function(e){return["#",e.charAt(1),e.charAt(1),e.charAt(2),e.charAt(2),e.charAt(3),e.charAt(3),e.charAt(4),e.charAt(4)].join("")},7:function(e){return e+"ff"},9:function(e){return e}},this.b={4:function(e){return[Ms(e.charAt(1)),Ms(e.charAt(2)),Ms(e.charAt(3)),255]},5:function(e){return[Ms(e.charAt(1)),Ms(e.charAt(2)),Ms(e.charAt(3)),Ms(e.charAt(4))]},7:function(e){return[(e=parseInt(e.substring(1),16))>>16&255,e>>8&255,255&e,255]},9:function(e){return[(e=parseInt(e.substring(1),16))>>24&255,e>>16&255,e>>8&255,255&e]}}}function Ms(e){return((e=parseInt(e,16))<<4)+e}function Ns(e){return 16>e?"0"+Math.round(e).toString(16):Math.round(e).toString(16)}function Os(e,o,f){return/^(#|rgb).*/.test(o)?(f||(f="","#"===o.charAt(0)?f=e.a[o.length]?o:"":"rgb"===o.substr(0,3)&&(f=2<(f=(o=o.match(/\d+(\.\d+)?/g)).length)&&5>f?["#",Ns(+o[0]),Ns(+o[1]),Ns(+o[2]),3<f?Ns(255*+o[3]):"ff"].join(""):""),o=f),(e=e.b[o.length](o))[3]=Math.round(e[3]/255*100)/100,e):[0,0,0,255]}function Ps(e){for(var o,f=(e=e.childNodes).length,m=new Hs,w=new Ls;f--;)switch(o=e[f],o.nodeName){case"color":this.a=m.xf(o);break;case"colorMode":this.b=m.Ja(o)}"random"===this.b&&(this.a="#"+w.el(this.a,!1))}function Qs(e){var o=e.childNodes,f=o.length,m=new Hs;for(this.a=this.fill=!0,this.b=new Ps(e);f--;)switch(e=o[f],e.nodeName){case"fill":this.fill=m.Ed(e);break;case"outline":this.a=m.Ed(e)}}function Rs(e){var o=e.childNodes,f=o.length,m=new Hs;for(this.a=new Ps(e);f--;)"width"===(e=o[f]).nodeName&&(this.width=m.zf(e))}function Ss(e){for(var o,f=(e=e.childNodes).length,m=new Hs;f--;)switch(o=e[f],o.nodeName){case"bgColor":this.bgColor=m.xf(o);break;case"textColor":this.textColor=m.xf(o);break;case"text":this.text=m.Ja(o);break;case"displayMode":this.displayMode=m.Ja(o)}}function Ts(e){var o=e.childNodes,f=o.length;for(this.id=e.getAttribute("id");f--;)switch(e=o[f],e.nodeName){case"IconStyle":this.Mj=e=new Ks(e);break;case"LineStyle":this.Ud=e=new Rs(e);break;case"PolyStyle":this.yk=e=new Qs(e);break;case"BalloonStyle":this.hf=e=new Ss(e)}}function Us(e,o){var f=(e=e.childNodes).length,m=new Hs;for(this.b=o;f--;)switch(o=e[f],o.nodeName){case"key":this.key=m.Ja(o);break;case"styleUrl":this.a=m.Ja(o)}}function Vs(e,o){var f=e.childNodes,m=f.length;for(this.b=o,this.id=e.getAttribute("id"),this.a=[];m--;)"Pair"===(e=f[m]).nodeName&&(e=new Us(e,this.b),this.a.push(e))}function Ws(){this.a={}}function Xs(e){for(var o,f=(e=e.childNodes).length,m=null,w=new Hs;f--;)"coordinates"===(o=e[f]).nodeName&&(m=w.Ja(o));this.a=null,m&&(this.a=w.Qh(m)||null)}function Ys(e,o){var f=e&&e.childNodes||[],m=new Hs;if(!e||!o)throw Error("Node or stylesContainer is not defined");for(this.visibility=!0,this.g=e,e=f.length;e--;){var w=f[e];switch(w.nodeName){case"name":this.name=m.Ja(w);break;case"description":this.b=m.Ja(w);break;case"visibility":this.visibility=m.Ed(w);break;case"open":this.open=m.Ed(w);break;case"styleUrl":(this.c=m.Ja(w))&&(w=this.c.substr(1),this.f=o.eh(w,!1));break;case"Style":this.a=w=new Ts(w)}}}function Zs(e){for(var o,f=(e=e.childNodes).length,m=new Hs;f--;)if("coordinates"===(o=e[f]).nodeName){var w=[],k=new Hs;try{w=k.vk(m.Ja(o))}catch{w=[]}this.a=2>w.length?[]:w}}function $s(e){for(var o=new L,f=e.a?e.a.length:0;f--;)o.nd(e.a[f]);return o}function at(){}function bt(e){var o=e.childNodes,f=o.length;for(this.a=new L,this.c=[];f--;){var m=o[f],w=m.nodeName;if("outerBoundaryIs"===w||"innerBoundaryIs"===w){var k=m.childNodes;for(m=k.length;m--;){var Y=k[m];if("LinearRing"===Y.nodeName){var _e=new Zs(Y);if("outerBoundaryIs"===w){this.a=$s(_e);var _o=void 0,_u=e,pd=_e.a;_e=new Hs;var iy=_u.querySelector("altitudeMode");if(iy&&iy.parentNode===_u&&!/^\s*clampTo/.test(_e.Ja(iy))&&pd){iy=pd.length;for(var sy=0;sy<iy&&0!==_o;sy++){var gy=pd[sy].alt;gy?_o?gy!==_o&&(_o=0):_o=gy:_o=0}(pd=_u.querySelector("*|altitudeOffset"))&&pd.parentNode===Y&&"http://www.google.com/kml/ext/2.2"===pd.namespaceURI&&(Y=_e.zf(pd))&&(_o+=Y),_o&&(_o=xd(2047,_o),(Y=_u.querySelector("extrude"))&&Y.parentNode===_u&&_e.Ed(Y)?this.b=_o:this.f=_o)}}else this.c.push($s(_e))}}}}}function ct(e,o){var f=document.createElement("CANVAS");f.width=1,f.height=1,this.i=e,this.b={},this.c={},this.f=new Uj(f),this.g=o||""}function dt(e,o,f){for(var w,Y,m=(o=o.childNodes).length,k={};m--;){var _e=o[m];switch(_e.nodeName){case"Point":_e=new Xs(_e),Y=et(e,"Marker"),(_e=_e.a)&&(w=new Jn(_e,Y),Y.Rh&&Fe(Y.Rh,"statechange",z(e.j,e,Y.Rh,w,Y),!1));break;case"LineString":case"LinearRing":_e=new Zs(_e),Y=et(e,"Polyline"),w=new uh($s(_e),Y);break;case"Polygon":_e=new bt(_e),(Y=et(e,"Polygon")).elevation=_e.f,Y.extrusion=_e.b,w=new vh(new P(_e.a,_e.c),Y);break;case"MultiGeometry":w=dt(e,_e,new R)}w&&(e.a.name&&(k.name=e.a.name),e.a.b&&(k.description=e.a.b),Y&&Y.hf&&(k.balloonStyle=Y.hf),k.kmlNode=e.a.g,w.setData(k),f&&f.aa(w))}return f||w}function et(e,o){var f=e.a,m={visibility:f.visibility},w=new Ls,k=1,Y={x:0,y:0,Qc:!1,sc:!1},_e=ft(e,f.f);switch(f.a&&(_e=ft(e,f.a,_e)),o){case"Marker":if(_e&&_e.Mj){if((w=_e.Mj).scale&&(k=w.scale),w.a){var _o=w.a;Y={x:_o.x,y:_o.y,Qc:_o.Qc,sc:_o.sc}}w.icon&&w.icon.href?(gt.test(o=w.icon.href)||(o=e.g+o),(_o=e.b[w=k+"_"+Y.x+Y.y+Y.Qc+Y.sc+"_"+o]||e.c[w])||(_o=new Uj(o),e.c[w]=_o),0===_o.getState()?(m.icon=e.f,m.Rh=_o,m.href=o,m.anchor=Y,m.scale=k):1===_o.getState()&&(m.icon=_o)):1!==k&&(_o||(Y={x:14,y:4,Qc:!1,sc:!1}),k={size:new Ui((e={w:28*k,h:36*k}).w,e.h),anchor:new G(Y.Qc?e.w*Y.x:Y.x*k,Y.sc?e.h*(1-Y.y):e.h-Y.y*k),hitArea:new Vi(Wi.POLYGON,[0*k,16*k,0*k,7*k,8*k,0*k,18*k,0*k,26*k,7*k,26*k,16*k,18*k,34*k,8*k,34*k])},m.icon=new Uj('<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>',k))}break;case"Polyline":m.style={},_e&&_e.Ud&&(m.style.strokeColor="rgba("+Os(w,(k=_e.Ud).a.a,!0)+")",0<=k.width&&(m.style.lineWidth=k.width));break;case"Polygon":m.style={},_e&&(_e.Ud&&(m.style.strokeColor="rgba("+Os(w,(k=_e.Ud).a.a,!0)+")",0<=k.width&&(m.style.lineWidth=k.width)),_e.yk&&(m.style.fillColor=(k=_e.yk).fill?"rgba("+Os(w,k.b.a,!0)+")":"rgba(0,0,0,0)",k.a||(m.style.lineWidth=0)))}return m.hf=_e.hf,m}function ft(e,o,f){for(var m in f=f||{},o)o.hasOwnProperty(m)&&(f[m]="object"==typeof o[m]?ft(e,o[m],f[m]):o[m]);return f}t("H.data.utils.Dom",Hs),Hs.prototype.Ed=function(e){return!!e&&/^\s*(1|true)\s*$/i.test(this.Ja(e))},Hs.prototype.getBoolean=Hs.prototype.Ed,Hs.prototype.Ja=function(e){var o;try{if(e.nodeType===Node.ATTRIBUTE_NODE)return e.value;var f="",m=0,w=e.childNodes;for(o=w.length;m<o;m++)w[m].nodeType!==Node.COMMENT_NODE&&(f+=w[m].nodeValue.replace(/^\s+|\s+$/g,""))}catch{}return f||""},Hs.prototype.getString=Hs.prototype.Ja,Hs.prototype.zf=function(e){return parseFloat(this.Ja(e))||0},Hs.prototype.getFloat=Hs.prototype.zf,Hs.prototype.vk=function(e){var Y,o=e.split(/\s+/),f=o.length,m=!(o&&1==f),w=m?1:3,k=[];for(m||(f=(o=e.split(",")).length),Y=0;Y<f;Y+=w){if(!(e=this.Qh(m?o[Y]:Y+3>o.length?null:o.slice(Y,Y+3))))return[];k.push(e)}return k},Hs.prototype.parseCoords=Hs.prototype.vk,Hs.prototype.Qh=function(e){if(!e)return null;var o=e instanceof Array&&0<e.length&&4>e.length?e:e.split(",");e=parseFloat(o[0]);var f=parseFloat(o[1]);return o=parseFloat(o[2]),isNaN(f)||isNaN(e)?null:new mg(f,e,isNaN(o)?void 0:o)},Hs.prototype.parseCoord=Hs.prototype.Qh,Hs.prototype.xf=function(e){return e=this.Ja(e),/^[0-9a-fA-F]{8}$/.test(e)?"#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2):"#000000ff"},Hs.prototype.getColor=Hs.prototype.xf,t("H.data.kml.HotSpot",Is),t("H.data.kml.Icon",Js),t("H.data.kml.IconStyle",Ks),t("H.data.utils.ColorHelper",Ls),Ls.prototype.el=function(e,o){var f="";if(!/^(#|rgb).*/.test(e)){var m;for(f="",m=0;6>m;m++)f+="ABCDEF0123456789".charAt(Math.floor(16*Math.random()));return f+"ff"}for(e=Os(this,e,o),o=0;4>o;o++)f+=Ns(m=3>o?Math.floor(Math.random()*(e[o]+1)):255*e[o]);return f},Ls.prototype.toRandomRGBA=Ls.prototype.el,t("H.data.kml.ColorStyle",Ps),t("H.data.kml.PolyStyle",Qs),t("H.data.kml.LineStyle",Rs),t("H.data.kml.BalloonStyle",Ss),t("H.data.kml.Style",Ts),t("H.data.kml.Pair",Us),Us.prototype.ea=function(){if(this.a){var e="highlight"===this.key;e=this.b.eh(this.a.substr(1),e)}return e},Us.prototype.getStyle=Us.prototype.ea,t("H.data.kml.StyleMap",Vs),Vs.prototype.ea=function(e){var o=null;e=e?"highlight":"normal";for(var f=this.a.length;f--;)this.a[f].key===e&&(o=this.a[f].ea());return o},Vs.prototype.getStyle=Vs.prototype.ea,t("H.data.kml.StyleContainer",Ws),Ws.prototype.Bg=function(e){e&&e.id&&(this.a["style_"+e.id]=e)},Ws.prototype.addStyle=Ws.prototype.Bg,Ws.prototype.eh=function(e,o){return(e=this.a["style_"+e])instanceof Vs&&(e=e.ea(o)),e},Ws.prototype.getStyleById=Ws.prototype.eh,t("H.data.kml.Point",Xs),t("H.data.kml.Feature",Ys),t("H.data.kml.Line",Zs),at.prototype.f=0,at.prototype.b=0,u(bt,at),t("H.data.kml.Polygon",bt),ct.prototype.create=function(e){return this.a=new Ys(e,this.i),dt(this,e)},ct.prototype.j=function(e,o,f){var m=f.anchor,w=f.scale;f=w+"_"+m.x+m.y+m.Qc+m.sc+"_"+f.href;var k={};if(1===e.getState()){var Y=this.b[f];if(!Y){var _e=m.x,_o=m.y;(Y=e.rb())&&(k.size=Y={w:Y.w*w,h:Y.h*w}),k.anchor={x:_e=m.Qc&&Y?Y.w*_e:_e*w,y:_o=m.sc&&Y?Y.h*(1-_o):!m.sc&&Y?Y.h-_o*w:_o*w},Y=new Uj(e.Kc(),k),this.b[f]=Y}o.Bc(Y)}delete this.c[f]};var gt=/^[^:\/]+:/;function ht(e){wc(this,ht),this.url=e,this.b=[],this.a=y,this.c=z(this.c,this),F.call(this)}u(ht,F),t("H.data.AbstractReader",ht);var it={ERROR:-1,LOADING:0,VISIT:1,READY:2};function jt(e,o,f,m){jt.l.constructor.call(this,o,e),this.state=f,this.message=m}function kt(e){var o=e?e.lastIndexOf("/"):-1;this.g=[],ht.call(this,e),0<=o&&(this.i=e.substr(0,o)+"/")}function mt(e,o,f){f?f.aa(o):(e.a&&e.a.Wb().aa(o),e.b.push(o),e.O(it.VISIT,o))}function lt(e,o){for(var m,f=e.length,w=[];f--;)(m=e[f]).nodeName===o&&w.push(m);return w}function nt(e,o){this.b=e,this.a=o}function ot(e){return new mg(e[1],e[0])}function qt(e){for(var m,o=pt(e[0]),f=[],w=1,k=e.length;w<k;w++)m=pt(e[w]),f.push(m);return new P(o,f)}function pt(e){for(var o=0,f=e.length,m=new L;o<f;o++)m.nd(ot(e[o]));return m}function rt(e,o){this.i=(o=o||{}).style||this.Bd,(this.g=!!o.disableLegacyMode)||window.console.warn("H.data.geojson.Reader: Legacy parser is enabled in GeoJSON Reader. Features like Multi-Geometries, Polygon interiors and GeoJSON feature properties might not work as expected. To maximise compatibility with the remote services it is recommended to set the `disableLegacyMode` flag to true."),ht.call(this,e)}function tt(e){var o={};if(e.geometry){var f=e.geometry;o.type=f.type,o.properties=e.properties,f.coordinates&&(o.coordinates=f.coordinates),f.geometries&&(o.geometries=f.geometries),e.id&&(o.id=e.id)}return o}function st(e,o){e.a&&e.a.Wb().aa(o),e.b.push(o),e.O(it.VISIT,o)}function ut(e,o){this.a=e,this.b=o}function vt(e,o,f){this.g=this.b=f,this.Sh=[],this.a=0,this.f=tg(e,o,!0)}function wt(e){var o;od.call(this),this.a=[],e?Ya(o={},xt,e):o=xt,this.g=o,od.call(this)}ht.State=it,ht.prototype.f=it.READY,ht.prototype.A={ll:"statechange"},ht.prototype.jb=function(){return this.a||(this.a=new N,this.a.Wb().Rb(this.b)),new rl(this.a)},ht.prototype.getLayer=ht.prototype.jb,ht.prototype.zm=function(){return this.b.concat([])},ht.prototype.getParsedObjects=ht.prototype.zm,ht.prototype.C=function(){return this.url},ht.prototype.getUrl=ht.prototype.C,ht.prototype.ko=function(e){if(this.f===it.LOADING||this.f===it.VISIT)throw Error("InvalidState: state "+this.f);return this.b=[],this.a=y,this.url=e,this},ht.prototype.setUrl=ht.prototype.ko,ht.prototype.getState=function(){return this.f},ht.prototype.getState=ht.prototype.getState,ht.prototype.O=function(e,o,f){this.f=e,this.dispatchEvent(new jt(o||this,this.A.ll,e,f||""))},ht.prototype.parse=function(){var e=this;vc(this.url)?(this.O(it.LOADING),new uf("text/plain",this.url).then(function(o){try{e.c(o)}catch(f){e.O(it.ERROR,y,f.message)}},function(){e.O(it.ERROR,y,"Error loading file")})):e.O(it.ERROR,y,"File url was not set")},ht.prototype.parse=ht.prototype.parse,u(jt,td),ht.Event=jt,u(kt,ht),t("H.data.kml.Reader",kt),kt.prototype.c=function(e){var o,f=null;if(Bc(e)&&""!=e.trim()){try{var m=(new DOMParser).parseFromString(e,"text/xml")}catch{return void this.O(it.ERROR,y,"Error parsing KML document")}if(m.getElementsByTagName("parsererror").length)this.O(it.ERROR,y,"Error parsing KML document");else if((e=m.childNodes&&"kml"===m.childNodes[0].nodeName?m.childNodes[0]:void 0)&&(o=lt(e.childNodes,"Document")[0]),o=o||e){m=new Ws;for(var w=lt(o.childNodes,"Style"),k=lt(o.childNodes,"StyleMap"),Y=w.length;Y--;)e=new Ts(w[Y]),m.Bg(e);for(Y=k.length;Y--;)e=new Vs(k[Y],m),m.Bg(e);for(this.j=new ct(m,this.i),o=(e=o.childNodes).length;o--;)m=f,"Placemark"===(w=e[o]).nodeName?(w=this.j.create(w))&&mt(this,w,m):"Folder"===w.nodeName&&(mt(this,(w={group:new R,node:w}).group,m),this.g.push(w)),!o&&(m=this.g.shift())&&(f=m.group,o=(e=m.node.childNodes).length);this.O(it.READY)}else this.O(it.ERROR,y,"Invalid KML document")}else this.O(it.ERROR,y,"Unable to create objects from the empty data")},nt.prototype.create=function(e,o){var f=e.coordinates;switch(e.type){case"Point":var m=new Jn(ot(f));break;case"LineString":m=new uh(pt(f));break;case"Polygon":m=new vh(qt(f));break;case"MultiPoint":var w=0,k=f.length;if(m=[],this.a){for(;w<k;w++)m.push(ot(f[w]));f=new Jn(new Ti(m))}else{for(;w<k;w++)m.push(new Jn(ot(f[w])));(f=new R).Rb(m)}m=f,k="multiPoint";break;case"MultiLineString":if(w=0,k=f.length,m=[],this.a){for(;w<k;w++)m.push(pt(f[w]));f=new uh(new jh(m))}else{for(;w<k;w++)m.push(new uh(pt(f[w])));(f=new R).Rb(m)}m=f,k="multiLineString";break;case"MultiPolygon":if(m=[],w=0,k=f.length,this.a){for(;w<k;w++)m.push(qt(f[w]));f=new vh(new Gi(m))}else{for(;w<k;w++)m.push(new vh(qt(f[w])));(f=new R).Rb(m)}m=f,k="multiPolygon";break;case"GeometryCollection":f=m=new R,k=0;for(var Y=(w=e.geometries).length;k<Y;k++)this.create(w[k],f);k="geometryCollection"}return m&&(f=m,w=e.properties,e=e.id,Y={},w&&(this.a?Y=w:Y.properties=w),k&&!this.a&&(Y[k]=!0),e&&f.pi(e),f.setData(Y),this.b(m)),o&&m&&o.aa(m),m},nt.prototype.create=nt.prototype.create,u(rt,ht),t("H.data.geojson.Reader",rt),rt.prototype.c=function(e){var o,f;try{var m="string"==typeof e?JSON.parse(e):e;if("object"==typeof m){var w=new nt(this.i,this.g);switch(m.type){case"FeatureCollection":if(o=m.features){var k=new R;for(st(this,k),f=0;f<o.length;f++){var Y=tt(o[f]);(Y=w.create(Y))&&k.aa(Y)}}break;case"Feature":Y=tt(m),(Y=w.create(Y))&&st(this,Y);break;default:(Y=w.create(m))&&st(this,Y)}this.O(it.READY)}else this.O(it.ERROR,y,"Invalid syntax")}catch(_e){this.O(it.ERROR,y,"Parse error. "+_e.message)}},rt.prototype.Un=function(e){this.O(it.LOADING),this.c(e)},rt.prototype.parseData=rt.prototype.Un,rt.prototype.Bd=function(){},t("H.data.buildInfo",function(){return If("H-data","1.37.1","8e9b6d2",{region:"row"})}),xg.prototype.Ec=da(1,function(e,o){this.a.Ec(e,Ec(o)?o:this.c)}),Bg.prototype.Ec=da(0,function(e,o){var m,f=0;if(!e(this)&&o--)for(;3>=f;f++)(m=this[f])&&m.Ec(e,o)}),t("H.clustering.grid.NoisePoint",ut),ut.prototype.wa=function(){return og(this.a)},ut.prototype.getPosition=ut.prototype.wa,ut.prototype.qc=function(){return this.a.wt},ut.prototype.getWeight=ut.prototype.qc,ut.prototype.kd=hf,ut.prototype.isCluster=ut.prototype.kd,ut.prototype.mc=function(){return this.b},ut.prototype.getMinZoom=ut.prototype.mc,ut.prototype.getData=function(){return this.a.data},ut.prototype.getData=ut.prototype.getData,t("H.clustering.grid.Cluster",vt),vt.prototype.je=function(e){this.c||(this.c=og(e)),this.a+=e.wt||1,this.Sh.push(e)},vt.prototype.wa=function(){return this.c},vt.prototype.getPosition=vt.prototype.wa,vt.prototype.qc=function(){return this.a},vt.prototype.getWeight=vt.prototype.qc,vt.prototype.kd=gf,vt.prototype.isCluster=vt.prototype.kd,vt.prototype.mc=function(){return this.b},vt.prototype.getMinZoom=vt.prototype.mc,vt.prototype.Bf=function(){return this.g},vt.prototype.getMaxZoom=vt.prototype.Bf,vt.prototype.J=function(){return this.f},vt.prototype.getBoundingBox=vt.prototype.J,vt.prototype.Qg=function(e){this.ve(e)},vt.prototype.forEachEntry=vt.prototype.Qg,vt.prototype.ve=function(e){var o=this;if(!Da(e))throw new D(this.ve,0,e);this.Sh.forEach(function(f){e(new ut(f,o.b+1))})},vt.prototype.forEachDataPoint=vt.prototype.ve,u(wt,od);var yt={clusters:[],noisePoints:[]},xt={projection:kj,min:0,max:22,eps:32,minWeight:2};function zt(e){wt.call(this,e)}function At(e){this.a=e;var o=(e=document.createElement("canvas")).getContext("2d"),f=this.a,m=14*f;e.width=m,e.height=m,o.scale(f,f),o.beginPath(),o.strokeStyle="#FFFFFF",o.fillStyle="#1080DD",o.arc(7,7,6,0,2*Math.PI,!1),o.fill(),o.lineWidth=1,o.stroke(),this.f=new Uj(e,{size:{w:14,h:14},anchor:{x:7,y:7}}),this.b={},this.c={}}function Bt(e,o,f){var m,w=document.createElement("canvas"),k=w.getContext("2d"),Y=e.a,_e=o*Y;return w.width=_e,w.height=_e,k.scale(Y,Y),(m=e.b[Y=o+":"+f])?k.putImageData(m,0,0):(o/=2,k.beginPath(),k.strokeStyle="rgba("+f+",0.2)",k.fillStyle="rgba("+f+",1)",k.arc(o,o,o/5*3,0,2*Math.PI,!1),k.fill(),k.lineWidth=o/5*4,k.stroke(),e.b[Y]=k.getImageData(0,0,_e,_e)),w}function Ct(e){if(wt.call(this,e),(e=this.g).projection!==kj)throw new D(Ct,0,"Other projection than mercator not supported yet");this.m=e.projection,this.f=e.eps,this.B=e.minWeight,this.s=new lj(this.m),(new Qf).a("cluster","H.clustering.dynamicgrid.worker"),this.i=z(this.i,this),this.j=z(this.j,this)}p=wt.prototype,p.Ac=function(e){this.a=e,this.b=!0},p.wb=function(e){this.a.push(e),this.b=!0},p.gf=function(e){this.a=this.a.concat(e),this.b=!0},p.Re=function(e){this.a=this.a.filter(function(o){return o!==e}),this.b=!0},p.o=function(){wt.l.o.call(this),delete this.a},wt.prototype.disposeInternal=wt.prototype.o,wt.prototype.R=kd,u(zt,wt),zt.prototype.ui=function(e){var Y,o=this.g,f=o.min,m=o.max,w=[],k=[];if(this.b){for(Y=this.a;f<=m;f++){for(var _e,_u,pd,iy,sy,gy,wy,Ey,_o=void 0,Py=f,Jy=Y,_m=w,y0=k,Oy=o.eps,K0=o.projection,I0=o.minWeight,p1=Jy.length,N_=Math.pow(2,Py+8),q1=[];Ey=Jy[--p1];)if(!Ey.Ai){for(wy=N_,gy=(pd=K0.Jc(Ey).scale(N_).floor()).x,sy=pd.y,_u=q1.length;_u--;)iy=(_e=q1[_u]).wa(),_e.zi||(_e.zi=K0.Jc(iy).scale(N_).floor()),(iy=(iy=_e.zi).Ta(pd))<wy&&(wy=iy,_o=_e);_o&&_o.J().bd(Ey)||(_o=new vt(K0.Uf({x:(gy-Oy)/N_,y:(sy-Oy)/N_}),K0.Uf({x:(gy+Oy)/N_,y:(sy+Oy)/N_}),Py),q1.push(_o)),_o.je(Ey),_o=null}for(p1=q1.length;p1--;)if((_u=(_e=q1[p1]).qc())<I0)for(_u=(_e=_e.Sh).length;Ey=_e[--_u];)y0.push(new ut(Ey,Py)),Ey.Ai=!0;else _m.push(_e)}for(f=0,m=Y.length;f<m;f++)delete Y[f].Ai;this.b=!1,e({clusters:w,noisePoints:k})}},t("H.clustering.theme.Circular",At),At.prototype.Rl=function(e){var o=e.qc(),f=this.c[o];if(!f){if(10>o){f=Bt(this,28,"118,209,0");var m={x:11,y:18}}else 25>o?(f=Bt(this,38,"255,105,0"),m={x:13,y:23}):50>o?(f=Bt(this,38,"240,60,0"),m={x:13,y:23}):100>o?(f=Bt(this,38,"181,0,21"),m={x:13,y:23}):1e3>o?(f=Bt(this,48,"181,0,21"),m={x:15,y:28}):(f=Bt(this,66,"181,0,21"),m={x:20,y:38});var w=f.getContext("2d");w.fillStyle="#FFFFFF",w.font="bold 11px Arial",w.fillText(String(o),m.x,m.y),f=new Uj(f,{size:{w:m=f.width/this.a,h:m},anchor:{x:m/2,y:m/2}}),this.c[o]=f}return(o=new Jn(e.wa(),{icon:f,min:e.mc(),max:e.Bf()})).setData(e),o},At.prototype.getClusterPresentation=At.prototype.Rl,At.prototype.wm=function(e){var o=new Jn(e.wa(),{icon:this.f,min:e.mc()});return o.setData(e),o},At.prototype.getNoisePresentation=At.prototype.wm,u(Ct,wt),Ct.prototype.R=function(e,o){this.u=e,this.v=Ad(o)},Ct.prototype.ui=function(e,o){var f=this.c,m=this.u,w=this.v||0,k=!f||!(f.zoom===w&&f.b.ga(m));if(m&&(this.b||k)){if(f&&3>f.Wd&&f.cancel(),this.b=!1,(f=this.f)>=128*Fd(2,w))var Y=Dt;else{(k=this.s).Ka(w);var _e=k.eb(m.Gb());Y=k.eb(m.Cb()),_e.y-=f,Y.y+=f,_e=k.Me(_e);var _o=k.Me(Y);Y=new K(_e.lat,_e.lng,_o.lat,_o.lng),f=k.La(f,0).lng+180,Y=Y.uc(_e.lat,_e.lng-f,_o.lat,_e.lng).uc(_e.lat,_o.lng,_o.lat,_o.lng+f)}for(f=Y,Y=[],k=(_e=this.a).length;k--;)f.bd(_e[k])&&Y.push(_e[k]);0<Y.length?(this.c=new Et(m,w,Y,this.f,this.B,this.m!==kj,e,o),this.c.then(this.i,this.j)):e(yt)}},Ct.prototype.i=function(e){Ca(e)||(e=new x.Uint32Array(e)),this.c.g(Ft(this,e))},Ct.prototype.j=function(e){Bc(e)&&this.c.f(e)};var Dt=new K(90,-180,-90,180);function Ft(e,o){for(var f=0,m=o[f++],w=Array(m),k=0,Y=[],_e=o.length,_o=e.c.a,_u=e.c.zoom;m--;)w[k++]=new ut(_o[o[f++]],_u);for(;f<_e;){m=o[f++],k=_o[o[f]];var pd=e.s,iy=e.f;pd.Ka(e.c.zoom);var sy=pd.eb(k);for(k=pd.La(sy.x-iy,sy.y-iy),pd=pd.La(sy.x+iy,sy.y+iy),k=new vt((k=new K(k.lat,k.lng,pd.lat,pd.lng)).Gb(),k.Cb(),_u);m--;)k.je(_o[o[f++]]);Y.push(k)}return{clusters:Y,noisePoints:w}}function Et(e,o,f,m,w,k,Y,_e){this.b=e,this.zoom=o,this.a=f,this.g=Y,this.f=_e,Y=3*(e=f.length),_e=new(x.Float64Array||Array)(Y);for(var _o;e--;)_e[--Y]=(_o=f[e]).lat,_e[--Y]=_o.lng,_e[--Y]=_o.wt;he.call(this,"cluster",{message:[_e,m,w,o,k]},void 0)}function Gt(e,o,f){this.b=e,this.a=o,this.f=f}function Ht(e,o,f,m){this.b=e,this.a=o,this.j=f,this.R=m,this.f=Ka(this.f,this),this.c=Ka(this.c,this)}function It(e,o,f,m,w,k){this.g=o,e&&(this.parent=e,1&o?(f=e[8],w=e[5]):(f=e[7],w=e[8]),2&o?(m=e[9],k=e[6]):(m=e[4],k=e[9])),this[7]=f,this[5]=w,this[8]=(f+w)/2,this[4]=m,this[6]=k,this[9]=(m+k)/2}function Jt(e,o){return e[o]||(++e.Vd,e[o]=new It(e,o))}function Kt(e,o,f,m){var w,k;if(!o(e,m)&&f--)for(++m,w=0;4>w;w++)(k=e[w])&&Kt(k,o,f,m)}function Lt(e){this.b=e||10,Mt(this)}function Mt(e){e.head=e.a=new It(null,NaN,0,0,4294967296,4294967296)}function Nt(e,o){var f,m;for(f=0;4>f;f++)(m=o[f])&&(Nt(e,m),delete o[f]);delete o.parent,delete o.entries}function Ot(e,o){var m,f=e.head;if(o){var w=o;if(w!==f)for(f=w;w=w.parent;)(w.entries||1<w.Vd)&&(f=w)}else for(;!f.entries&&2>(m=f.Vd)&&m;)f=w;e.head=f}function Pt(e,o,f,m,w,k,Y){var _e=o.entries;return k?o.Vd?_e=Pt(e,Jt(o,+(f>=o[8])|+(m>=o[9])<<1),f,m,w,k-1,Y):_e?((_e=Jt(o,+((_e=_e[0])[1]>=o[8])|+(_e[0]>=o[9])<<1)).entries=o.entries,_e.me=o.me,_e.ne=o.ne,_e.yb=o.yb,_e.a=o.a,_e.f=o.f,_e.b=o.b,_e.c=o.c,delete o.entries,Ot(e,_e),_e=Pt(e,Jt(o,+(f>=o[8])|+(m>=o[9])<<1),f,m,w,k-1,Y)):(k=_e=new Qt(f,m,w,Y),(o.entries||(o.entries=[])).push(k),Ot(e,o)):(_e||Ot(e,o),e=_e=new Qt(f,m,w,Y),(o.entries||(o.entries=[])).push(e)),o.me+=f*w,o.ne+=m*w,o.yb+=w,o.a===B?(o.a=o.b=f,o.f=o.c=m):(f<o.a?o.a=f:f>o.b&&(o.b=f),m<o.f?o.f=m:m>o.c&&(o.c=m)),_e}function Qt(e,o,f,m){this[0]=o,this[1]=e,this.a=f,this.data=m}function Rt(e){wt.call(this,e),this.j=(e=this.g).projection,this.s=e.min,this.f=e.max,this.m=e.minWeight,this.c=7-zd(Dd(yd(1,e.eps))/Nd),this.i=new Lt(yd(this.s,this.f+this.c))}function St(e,o,f,m,w,k,Y){var _o,_e=o.yb;if(Y&&(Y.node.yb!==_e?(k.clusters.push(new Ht(e,Y.node,Y.depth,f-1)),Y=null):w++),Y||(_e>=e.m?(Y={node:o,depth:f},w=f):Tt(e,o,w+1,k)),o.Vd&&m--)for(f++,_e=0;4>_e;_e++)(_o=o[_e])&&(St(e,_o,f,m,w,k,Y),Y=null);Y&&k.clusters.push(new Ht(e,Y.node,Y.depth,e.f+e.c))}function Tt(e,o,f,m){var w;if(o=o.entries){var k=o.length;for(m=m.noisePoints,w=0;w<k;w++)m.push(new Gt(e,o[w],f))}else for(w=0;4>w;w++)(k=e[w])&&Tt(e,k,f,m)}function Ut(e,o){var f={},m=(o=o||{}).min||0,w=yd(m,o.max||22);switch(Ut.l.constructor.call(this,m={min:m,max:w}),this.ya=o.pixelRatio||Ue(),Ya(f,xt,m,o.clusteringOptions||{}),f.minWeight=yd(xt.minWeight,f.minWeight),f.strategy){case Vt.DYNAMICGRID:if(f.projection!==kj)throw new D(Ut,1,"Unsupported projection");this.b=new Ct(f);break;case Vt.GRID:this.b=new zt(f);break;default:this.b=new Rt(f)}this.b.Ac(e),this.v=o.theme||new At(this.ya),this.N=z(this.N,this),this.oa=z(this.oa,this),Wt(this)}Ct.prototype.o=function(){Ct.l.o.call(this)},Ct.prototype.disposeInternal=Ct.prototype.o,u(Et,Tf),t("H.clustering.fastgrid.NoisePoint",Gt),Gt.prototype.wa=function(){return this.c||(this.c=this.b.La(this.a[1],this.a[0],1)),this.c},Gt.prototype.getPosition=Gt.prototype.wa,Gt.prototype.qc=function(){return this.a.a},Gt.prototype.getWeight=Gt.prototype.qc,Gt.prototype.kd=hf,Gt.prototype.isCluster=Gt.prototype.kd,Gt.prototype.mc=function(){return this.f-this.b.c},Gt.prototype.getMinZoom=Gt.prototype.mc,Gt.prototype.getData=function(){return this.a.data},Gt.prototype.getData=Gt.prototype.getData,t("H.clustering.fastgrid.Cluster",Ht),Ht.prototype.wa=function(){return this.m||(this.m=this.b.La(this.a.me,this.a.ne,this.a.yb)),this.m},Ht.prototype.getPosition=Ht.prototype.wa,Ht.prototype.qc=function(){return this.a.yb},Ht.prototype.getWeight=Ht.prototype.qc,Ht.prototype.kd=gf,Ht.prototype.isCluster=Ht.prototype.kd,Ht.prototype.mc=function(){return this.j?this.j-this.b.c:-1/0},Ht.prototype.getMinZoom=Ht.prototype.mc,Ht.prototype.Bf=function(){return this.R-this.b.c},Ht.prototype.getMaxZoom=Ht.prototype.Bf,Ht.prototype.J=function(){return this.i||(this.i=tg(this.b.La(this.a.a,this.a.f,1),this.b.La(this.a.b,this.a.c,1),!0)),this.i},Ht.prototype.getBoundingBox=Ht.prototype.J,Ht.prototype.Qg=function(e){this.g=e,this.a.Ec(this.f,Vd)},Ht.prototype.forEachEntry=Ht.prototype.Qg,Ht.prototype.f=function(e,o){var m,w,f=!1;if(e.yb>=this.b.m&&e!==this.a&&e.yb!==this.a.yb&&(this.g(new Ht(this.b,e,0,o)),f=!0),!f&&(m=e.entries))for(e=m.length,w=0;w<e;w++)this.g(new Gt(this.b,m[w],o));return f},Ht.prototype.ve=function(e){this.s=e,this.a.Ec(this.c,Vd)},Ht.prototype.forEachDataPoint=Ht.prototype.ve,Ht.prototype.c=function(e,o){var f;if(e=e.entries){var m=e.length;for(f=0;f<m;f++)this.s(new Gt(this.b,e[f],o))}return!1},p=It.prototype,p.Vd=0,p.removeChild=function(e){var o=e.g;this[o]===e&&(delete this[o],delete e.parent,--this.Vd)},p.Ec=function(e,o){for(var f=0,m=this;m=m.parent;)++f;Kt(this,e,o,f)},p.me=0,p.ne=0,p.yb=0,Lt.prototype.rc=function(e,o,f,m){var w=this.a;if(!(e>=w[7]&&o>=w[4]&&e<=w[5]&&o<=w[6]))throw Error("Coordinates out of bounds");return Pt(this,this.a,e,o,f,this.b,m)},Lt.prototype.Ec=function(e,o){Kt(this.a,e,o===+o?o:this.b,0)},u(Rt,wt),p=Rt.prototype,p.Ac=function(e){var m,o=0,f=e.length,w=new G(0,0),k=this.j,Y=this.i;for(Rt.l.Ac.call(this,e),Nt(Y,Y.a),Mt(Y);o<f;o++)k.Jc(m=e[o],w).scale(4294967296).floor(),Y.rc(w.x,w.y,m.wt,m.data);this.b=!0},p.wb=function(e){Rt.l.wb.call(this,e),this.Ac(this.a)},p.gf=function(e){for(var o=e.length,f=Rt.l.wb;o--;)f.call(this,e[o]);this.Ac(this.a)},p.Re=function(e){Rt.l.Re.call(this,e),this.Ac(this.a)},p.La=function(e,o,f,m){return this.j.La(e/f/4294967296,o/f/4294967296,m)},p.ui=function(e){if(this.b){var o={clusters:[],noisePoints:[]};St(this,this.i.a,0,this.f+this.c,-1/0,o,null),this.b=!1,e(o)}},p.o=function(){Rt.l.o.call(this),this.i=null},Rt.prototype.disposeInternal=Rt.prototype.o,t("H.clustering.DataPoint",function(e,o,f,m){this.lat=e,this.lng=o,this.wt=f===+f?f:1,this.data=m}),u(Ut,N),t("H.clustering.Provider",Ut),Ut.prototype.o=function(){Ut.l.o.call(this),this.f.ma(),this.b.D(),delete this.b,delete this.K,delete this.v,x.clearTimeout(this.Y)};var Vt={FASTGRID:0,GRID:1,DYNAMICGRID:2};function Wt(e,o,f){e.Y&&x.clearTimeout(e.Y),o&&e.b.R(o,f),e.Y=x.setTimeout(e.N,150)}function Xt(e){var o=e.K.clusters,f=e.K.noisePoints,m=o.length,w=f.length,k=0<m+w;for(e.f.ma();w--;)e.f.aa(e.v.getNoisePresentation(f[w]));for(;m--;)e.f.aa(e.v.getClusterPresentation(f=o[m]));k&&e.Sa()}function Yt(e,o){t:{for(var f=e.length,m="string"==typeof e?e.split(""):e,w=0;w<f;w++)if(w in m&&o.call(void 0,m[w],w,e)){o=w;break t}o=-1}return 0>o?null:"string"==typeof e?e.charAt(o):e[o]}Ut.Strategy=Vt,Ut.prototype.N=function(){this.dispatchEvent("start"),this.b.ui(this.oa,kd)},Ut.prototype.oa=function(e){this.dispatchEvent("end"),this.K=e,Xt(this)},Ut.prototype.Ac=function(e){this.b.Ac(e),Wt(this)},Ut.prototype.setDataPoints=Ut.prototype.Ac,Ut.prototype.wb=function(e){this.b.wb(e),Wt(this)},Ut.prototype.addDataPoint=Ut.prototype.wb,Ut.prototype.gf=function(e){this.b.gf(e),Wt(this)},Ut.prototype.addDataPoints=Ut.prototype.gf,Ut.prototype.Re=function(e){this.b.Re(e),Wt(this)},Ut.prototype.removeDataPoint=Ut.prototype.Re,Ut.prototype.Rm=function(){return this.v},Ut.prototype.getTheme=Ut.prototype.Rm,Ut.prototype.io=function(e){this.v=e,this.K&&(this.f.ma(),Xt(this))},Ut.prototype.setTheme=Ut.prototype.io,Ut.prototype.Jb=function(){return!0},Ut.prototype.providesDomMarkers=Ut.prototype.Jb,Ut.prototype.Kb=function(){return!0},Ut.prototype.providesMarkers=Ut.prototype.Kb,Ut.prototype.vc=function(){return!0},Ut.prototype.providesSpatials=Ut.prototype.vc,Ut.prototype.Pe=function(e,o){Wt(this,e,o)},Ut.prototype.preprocessData=Ut.prototype.Pe,t("H.clustering.buildInfo",function(){return If("H-clustering","1.37.1","8e9b6d2",{region:"row"})});var Zt={};function $t(e){var o=e.ownerDocument,f=o.documentElement;o=o.defaultView;var m=e.getBoundingClientRect();return e=m.left,m=m.top,isNaN(o.pageXOffset)?(e+=f.scrollLeft,m+=f.scrollTop):(e+=o.pageXOffset,m+=o.pageYOffset),new G(e,m)}function au(e,o,f){o=Ec(o)?o+"px":o,f=Ec(f)?f+"px":f,e.style[Bf("transform")]="translate("+o+","+f+")"}var bu,cu=navigator.userAgent,du=-1<cu.indexOf("Android")&&-1<cu.indexOf("Mozilla/5.0")&&-1<cu.indexOf("AppleWebKit"),eu=/AppleWebKit\/([\d.]+)/,fu=null===eu.exec(cu)?null:parseFloat(eu.exec(cu)[1]);bu=du&&null!==fu&&537>fu;var gu=globalThis,hu=document.createElement("T");function iu(){this.a=this.bj()}iu.prototype.bj=function(){var e=navigator,o=[];return e&&(e.msPointerEnabled?o.push(ju):e.pointerEnabled&&o.push(ku)),1>o.length&&("TouchEvent"in gu&&o.push(lu),o.push(mu)),o},iu.prototype.detectEventSets=iu.prototype.bj,iu.prototype.addEventListener=function(e,o,f,m){for(var k,w=this.a,Y=w.length,_e=!1;Y--;)(k=w[Y][o])&&(_e=!0,e.addEventListener(k,f,m||!1));_e||e.addEventListener(o,f,m||!1)},iu.prototype.removeEventListener=function(e,o,f,m){for(var k,w=this.a,Y=w.length,_e=!1;Y--;)(k=w[Y][o])&&(_e=!0,e.removeEventListener(k,f,m||!1));_e||e.removeEventListener(o,f,m||!1)};var ku={start:"pointerdown",end:"pointerup",move:"pointermove",cancel:"pointercancel",over:"pointerover",out:"pointerout",hover:"pointerhover"},ju={start:"MSPointerDown",end:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel",over:"MSPointerOver",out:"MSPointerOut",hover:"MSPointerHover"},lu={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},mu={start:"mousedown",end:"mouseup",move:"mousemove",over:"mouseover",out:"mouseout",hover:"mousehover"};function nu(e,o,f,m){return e=e.createElement(o),f&&(e.className=f),m&&(e.innerHTML=m),e}function ou(e,o){for(var f=1,m=arguments.length;f<m;f++)e.appendChild(arguments[f])}var pu=new iu;function qu(e,o,f){pu.addEventListener(e,o,f,void 0)}function ru(e,o,f){pu.removeEventListener(e,o,f,void 0)}function X(e,o){F.call(this),this.ya=e||"div",this.c=o?o.split(" "):[],this.S=!1,this.c.push("H_el")}function su(e){(e=e.L())&&e.parentNode&&e.parentNode.removeChild(e)}function tu(e){e=e||{},X.call(this,"div","H_btn"),this.Cc(e.label||" "),this.ec(e.tooltip||""),this.setData(e.data),this.ta(!!e.disabled),this.O(uu.UP,!0),e.onStateChange&&this.addEventListener("statechange",e.onStateChange),this.b=z(this.b,this),this.a=z(this.a,this)}u(X,F),t("H.ui.base.Element",X),X.prototype.T=function(e){if(!e)throw Error("Wrong document object");return this.P=nu(e,this.ya,this.c.join(" ")),this.renderInternal(this.P,e),this.ta(this.Yb(),!0),this.ec(this.ra),this.lb(this.da),this.P},X.prototype.Y=function(){},X.prototype.K=function(){},X.prototype.U=function(){},X.prototype.renderInternal=X.prototype.U,X.prototype.Yb=function(){return this.S},X.prototype.isDisabled=X.prototype.Yb,X.prototype.ta=function(e,o){return((e=!!e)!==this.S||o)&&((this.S=e)?this.Ga("H_disabled"):this.hb("H_disabled")),this},X.prototype.setDisabled=X.prototype.ta,X.prototype.v=null,X.prototype.getData=function(){return this.v},X.prototype.getData=X.prototype.getData,X.prototype.setData=function(e){this.v=e},X.prototype.setData=X.prototype.setData,X.prototype.ec=function(e){var o=this.L();this.ra=e,o&&(e?o.setAttribute("title",e):o.removeAttribute("title"))},X.prototype.setTooltip=X.prototype.ec,X.prototype.P=null,X.prototype.L=function(){return this.P},X.prototype.getElement=X.prototype.L,X.prototype.da=!0,X.prototype.lb=function(e){var o=this.L();this.da=e,o&&(o.style.display=e?"":"none")},X.prototype.setVisibility=X.prototype.lb,X.prototype.pc=function(){return this.da},X.prototype.getVisibility=X.prototype.pc,X.prototype.Ga=function(e){var o=this.L();return 0>this.c.indexOf(e)&&this.c.push(e),o&&(o.className=this.c.join(" ")),this},X.prototype.addClass=X.prototype.Ga,X.prototype.hb=function(e){e=this.c.indexOf(e);var o=this.L();return-1<e&&this.c.splice(e,1),o&&(o.className=this.c.join(" ")),this},X.prototype.removeClass=X.prototype.hb,X.prototype.o=function(){X.l.o.call(this),su(this),this.v=this.P=null,delete this.ra},u(tu,X),t("H.ui.base.Button",tu),tu.prototype.ta=function(e,o){return e&&this.hb("H_active"),tu.l.ta.call(this,e,o)},tu.prototype.setDisabled=tu.prototype.ta,tu.prototype.U=function(e){qu(e,"start",this.b),qu(e,"end",this.a),qu(e,"out",this.a),this.Cc(this.Ce(),!0)},tu.prototype.renderInternal=tu.prototype.U,tu.prototype.getState=function(){return this.g},tu.prototype.getState=tu.prototype.getState,tu.prototype.O=function(e,o){return e!==this.g&&(this.g=e,e===uu.DOWN?this.Ga("H_active"):this.hb("H_active"),o||this.dispatchEvent("statechange")),this},tu.prototype.setState=tu.prototype.O,tu.prototype.Ce=function(){return this.f},tu.prototype.getLabel=tu.prototype.Ce,tu.prototype.Cc=function(e,o){return(o||e!==this.f)&&(this.f=e,(o=this.L())&&(o.innerHTML=e)),this},tu.prototype.setLabel=tu.prototype.Cc,tu.prototype.b=function(e){this.Yb()||this.O(uu.DOWN),e.preventDefault()},tu.prototype.a=function(e){this.Yb()||this.O(uu.UP),e.preventDefault()},tu.prototype.o=function(){var e=this.L();e&&(ru(e,"start",this.b),ru(e,"end",this.a),ru(e,"out",this.a)),X.prototype.o.call(this)};var uu={UP:"up",DOWN:"down"};tu.State=uu;var vu={in:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g><path d="m5 10.6h5.6v-5.6h2.8v5.6h5.6v2.8h-5.6v5.6h-2.8v-5.6h-5.6v-2.8z"></path></g></svg>',out:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="m5 10.6h14v2.8h-14z"/></svg>'};function wu(e){var o;this.b=!!(e=e||{}).vertical,this.oa=e.length||"16em",this.a=Ec(o=e.min)?o:0,this.i=yd(this.a,Ec(o=e.max)?o:100),this.V=E(o=e.step)?1:o,this.j=xu(this,Ec(o=e.value)?o:(this.a+this.i)/2),this.Rf=z(this.Rf,this),this.Nf=z(this.Nf,this),this.Tf=z(this.Tf,this),this.Sf=z(this.Sf,this),this.m=e.pointerArea,X.call(this,"div","H_slider"+(this.b?"":" H_l_horizontal"))}function yu(e){if(!e.s){qu(e.L(),"start",e.Rf);var o=e.m;qu(o,"move",e.Nf),qu(o,"end",e.Tf),qu(o,"out",e.Sf),e.s=!0}}function zu(e){if(e.s){ru(e.L(),"start",e.Rf);var o=e.m;ru(o,"move",e.Nf),ru(o,"end",e.Tf),ru(o,"out",e.Sf),e.s=!1}}function xu(e,o){var f=e.V;return o=$d(o,e.a,e.i),f?e.a+zd((o-e.a)/f)*f:o}function Au(e,o){var f=e.B,m=e.b;e.u||(e.u=f["offset"+(m?"Height":"Width")]),0>(o-=$t(f)[m?"y":"x"])&&(o=0),o=(e.i-e.a)*o/e.u,o=xu(e,m?e.i-o:e.a+o),e.j!==o&&(e.ng(o,!0),e.dispatchEvent(new aj(e.A.$c,o,e.j)))}function Bu(e,o){return(o.touches?o.targetTouches[0]:o)["page"+(e.b?"Y":"X")]}function Cu(e){var o=!1,f=e.type;return-1!==f.indexOf("pointer")||-1!==f.indexOf("touch")?o=!0:C(e,MouseEvent)&&(o=1===e.which||1===e.buttons),o}function Du(e){var o=e.touches;return o&&1===o.length||C(e,MouseEvent)}u(wu,X),t("H.ui.base.Slider",wu),wu.prototype.ng=function(e,o){var f=this.b,m=f?"top":"left";return(!this.f||o)&&(e=$d(e,this.a,this.i),this.g&&(this.g.style[m]=(f=(f?-1:1)*(o=100*(e-this.a)/(this.i-this.a)))+"%",this.ua.style[m]=100+f+"%"),this.j=xu(this,e)),this.j},wu.prototype.setValue=wu.prototype.ng,wu.prototype.Xm=function(){return this.j},wu.prototype.getValue=wu.prototype.Xm,p=wu.prototype,p.Rf=function(e){var o=this.b;if(Cu(e)&&Du(e)){var f=Bu(this,e),m=e.target;m===this.g||m.parentElement===this.g?(this.N=f-$t(this.g)[o?"y":"x"]-this.g.offsetWidth/2,this.L().className="H_slider H_slider_active"+(this.b?"":" H_l_horizontal"),this.f=!0):Au(this,f),e.preventDefault()}},p.Tf=function(){this.f&&(this.L().className="H_slider "+(this.b?"":" H_l_horizontal"),this.f=!1)},p.Sf=function(e){this.f&&e.target===this.m&&(this.f=!1)},p.Nf=function(e){this.f&&Du(e)&&(Cu(e)?(Au(this,Bu(this,e)-this.N),e.preventDefault()):this.f=!1)},p.A={$c:"change"},p.U=function(e,o){var f=nu(o,"div","H_slider_cont"),m=nu(o,"div","H_slider_knob_cont"),w=nu(o,"div","H_slider_knob"),k=nu(o,"div","H_slider_knob_halo"),Y=nu(o,"div","H_slider_track");o=nu(o,"div","H_slider_track H_slider_track_active"),e.appendChild(f),f.appendChild(Y),Y.appendChild(o),f.appendChild(m),m.appendChild(w),m.appendChild(k),this.B=Y,this.ua=o,this.g=m,this.m||(this.m=e.ownerDocument.body),f.style[this.b?"height":"width"]=this.oa,this.ng(this.j),yu(this)},wu.prototype.renderInternal=wu.prototype.U,wu.prototype.o=function(){zu(this)},wu.prototype.ta=function(e,o){return e?zu(this):this.B&&yu(this),X.prototype.ta.call(this,e,o)},wu.prototype.setDisabled=wu.prototype.ta;var Eu={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};function Fu(e,o,f){X.call(this,e,o),this.a=f?f.concat():[]}function Gu(){Fu.call(this,"div","H_ctl"),this.map=null,this.Gc="top-left"}function Hu(e){var o=(e=e||{}).slider;Gu.call(this),this.m=z(this.m,this),this.g=z(this.g,this),this.b=z(this.b,this),o&&(this.u=z(this.u,this),this.B=o,this.Ya=e.sliderSnaps,this.Ga("H_zoom_slider")),this.i=new tu({label:vu.in,onStateChange:this.m}),this.s=new tu({label:vu.out,onStateChange:this.m}),this.Ga("H_zoom"),this.Ga("H_grp"),this.V=!1!==e.fractionalZoom,this.setZoomSpeed(e.zoomSpeed||4),this.Nb(e.alignment||"right-middle")}function Iu(e){e.removeChild(e.f),e.f=null,e.j&&(e.j.removeEventListener("minchange",e.b),e.j.removeEventListener("maxchange",e.b),e.j=null)}function Ju(e,o){var f={},m={};f["top-left"]=nu(o,"div",[Ku,Lu].join(" ")),f["top-center"]=nu(o,"div",[Ku,Mu,Nu,Lu].join(" ")),f["top-right"]=nu(o,"div",[Ku,Lu].join(" ")),f["left-top"]=nu(o,"div",[Ku,Ou].join(" ")),f["left-middle"]=nu(o,"div",[Ku,Pu,Qu,Ou].join(" ")),f["left-bottom"]=nu(o,"div",[Ku,Ou].join(" ")),f["right-top"]=nu(o,"div",[Ku,Ou].join(" ")),f["right-middle"]=nu(o,"div",[Ku,Ru,Qu,Ou].join(" ")),f["right-bottom"]=nu(o,"div",[Ku,Ou].join(" ")),f["bottom-left"]=nu(o,"div",[Ku,Lu].join(" ")),f["bottom-center"]=nu(o,"div",[Ku,Su,Nu,Lu].join(" ")),f["bottom-right"]=nu(o,"div",[Ku,Lu].join(" ")),m["top-left"]=nu(o,"div",[Mu,Pu].join(" ")),m["top-right"]=nu(o,"div",[Mu,Ru].join(" ")),m["bottom-left"]=nu(o,"div",[Su,Pu].join(" ")),m["bottom-right"]=nu(o,"div",[Su,Ru].join(" ")),ou(m["top-left"],f["top-left"],f["left-top"]),ou(m["top-right"],f["top-right"],f["right-top"]),ou(m["bottom-left"],f["left-bottom"],f["bottom-left"]),ou(m["bottom-right"],f["right-bottom"],f["bottom-right"]),ou(e,m["top-left"],m["top-right"],m["bottom-left"],m["bottom-right"],f["top-center"],f["left-middle"],f["right-middle"],f["bottom-center"]),this.a=f}t("H.ui.LayoutAlignment",Eu),u(Fu,X),t("H.ui.base.Container",Fu),Fu.prototype.ta=function(e,o){var f=this.a?this.a.length:0;for(X.prototype.ta.call(this,e,o);f--;)this.a[f].ta(e,o);return this},Fu.prototype.setDisabled=Fu.prototype.ta,Fu.prototype.Fa=function(e){var o=this.L();return this.a.push(e),o&&(e.T(o.ownerDocument),o.appendChild(e.L())),this},Fu.prototype.addChild=Fu.prototype.Fa,Fu.prototype.Vg=function(){return this.a.concat()},Fu.prototype.getChildren=Fu.prototype.Vg,Fu.prototype.removeChild=function(e){var o=this.a.indexOf(e),f=this.L();0<=o&&(this.a.splice(o,1),f&&f.removeChild(e.L()))},Fu.prototype.removeChild=Fu.prototype.removeChild,Fu.prototype.ma=function(){var e=this.L();e&&this.a.forEach(function(o){e.removeChild(o.L())}),this.a=[]},Fu.prototype.U=function(e,o){for(var f=0,m=this.a.length;f<m;f++)e.appendChild(this.a[f].T(o))},Fu.prototype.renderInternal=Fu.prototype.U,Fu.prototype.o=function(){this.ma(),this.a.forEach(this.oa,this),X.prototype.o.call(this)},Fu.prototype.oa=function(e){e.D()},u(Gu,Fu),t("H.ui.Control",Gu),Gu.prototype.Ea=function(e){this.map=e},Gu.prototype.T=function(e){return Fu.prototype.T.call(this,e)},Gu.prototype.U=function(e,o){Fu.prototype.renderInternal.call(this,e,o),this.Nb(this.Gc)},Gu.prototype.renderInternal=Gu.prototype.U,Gu.prototype.Le=function(){},Gu.prototype.onUnitSystemChange=Gu.prototype.Le,Gu.prototype.Vb=function(){return this.map},Gu.prototype.getMap=Gu.prototype.Vb,Gu.prototype.va=function(){return this.ua},Gu.prototype.getLocalization=Gu.prototype.va,Gu.prototype.Kl=function(){return this.Gc},Gu.prototype.getAlignment=Gu.prototype.Kl,Gu.prototype.Nb=function(e){return"string"==typeof e&&Eu[e.replace("-","_").toUpperCase()]===e&&(this.Gc=e,this.dispatchEvent("alignmentchange")),this},Gu.prototype.setAlignment=Gu.prototype.Nb,u(Hu,Gu),t("H.ui.ZoomControl",Hu),Hu.prototype.an=function(){return this.N},Hu.prototype.getZoomSpeed=Hu.prototype.an,Hu.prototype.lo=function(e){this.N=e},Hu.prototype.setZoomSpeed=Hu.prototype.lo,Hu.prototype.Ea=function(e){this.map!==e&&(this.map&&this.map.removeEventListener("mapviewchange",this.g),Iu(this)),Gu.prototype.Ea.apply(this,arguments),this.map&&(this.b(),e.addEventListener("mapviewchange",this.g),e.addEventListener("baselayerchange",this.b))},Hu.prototype.setMap=Hu.prototype.Ea,Hu.prototype.o=function(){Gu.prototype.o.apply(this,arguments),this.map.removeEventListener("baselayerchange",this.b),Iu(this)},Hu.prototype.U=function(e,o){Gu.prototype.renderInternal.call(this,e,o),this.i.ec(this.va().translate("zoom.in")),this.s.ec(this.va().translate("zoom.out"))},Hu.prototype.renderInternal=Hu.prototype.U,Hu.prototype.Nb=function(e){var o=this.Gc;return Gu.prototype.Nb.call(this,e),o!==e&&this.b(),this},Hu.prototype.setAlignment=Hu.prototype.Nb,Hu.prototype.g=function(){var e=this.map,o=e.kb(),f=e.Ua()-1;e=e.g||e.f.getCapabilities().lookAt.zoom,this.B&&this.f.ng(o),this.Yb()||(this.i.ta(o+f>=e.max),this.s.ta(o<=e.min))},Hu.prototype.ta=function(e,o){return Hu.l.ta.call(this,e,o),this.g(),this},Hu.prototype.setDisabled=Hu.prototype.ta,Hu.prototype.m=function(e){var w,o=(e=e.target)===this.i?1:-1,f=0<o?Math.ceil:Math.floor,m=this.map,k=this;m&&("down"===e.getState()?(m.c.startControl(),m.c.control(0,0,o*this.N,0,0,0)):m.c.endControl(!0,function(Y){w=k.V?Y.zoom:f(Y.zoom),Y.zoom=w}))},Hu.prototype.u=function(e){this.map&&this.map.Ze(e.newValue)},Hu.prototype.b=function(){var e=this.Gc,o=this.Vb();if(/^top/g.test(e)||/^bottom/g.test(e)){var f=this.s;e=this.i;var m=!1}else f=this.i,e=this.s,m=!0;if(this.removeChild(f),this.removeChild(e),this.Fa(f),this.B&&o){Iu(this),o=m;var w=(m=(f=this.map)&&f.g)||f.f.getCapabilities().lookAt.zoom;(this.j=m)&&(m.addEventListener("minchange",this.b),m.addEventListener("maxchange",this.b)),this.f=new wu({step:this.Ya?1:0,vertical:o,min:w.min,max:w.max,value:f.kb(),pointerArea:f.L()}),this.f.addEventListener(this.f.A.$c,this.u),this.Fa(this.f)}this.Fa(e)};var Mu="H_l_top",Su="H_l_bottom",Pu="H_l_left",Ru="H_l_right",Nu="H_l_center",Qu="H_l_middle",Lu="H_l_horizontal",Ou="H_l_vertical",Ku="H_l_anchor";function Tu(e,o){o?(o=e.offsetWidth,e.style.marginLeft=-Math.round(.5*o)+"px"):(o=e.offsetHeight,e.style.marginTop=-Math.round(.5*o)+"px")}Ju.prototype.update=function(){var e=this.a;Tu(e["top-center"],!0),Tu(e["bottom-center"],!0),Tu(e["left-middle"],!1),Tu(e["right-middle"],!1)},Ju.prototype.put=function(e,o){e=e?e.L():null;var f=o?this.a[o]:null;e&&f&&(e.parentElement&&e.parentElement.removeChild(e),f.insertBefore(e,/(bottom|right)$/.test(o)||/(center|middle)/.test(o)&&f.childNodes.length%2?f.firstChild:null)),this.update()};var Uu={IMPERIAL:"imperial",METRIC:"metric"};t("H.ui.UnitSystem",Uu);var Vu={btn:'<svg class="H_icon" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><g transform="translate(3 2)"><path d="m18 13v7h-18v-7h2v5h2v-2h2v2h2v-3h2v3h2v-2h2v2h2v-5z"></path><path d="m2.3.3c.7 0 1.3.1 1.8.4s.9.6 1.1 1 .4.9.4 1.4c0 .5-.1 1-.3 1.4s-.57 1-1 1.6-1.3 1.3-2.3 2.2h3.9l-.2 1.7h-6.16v-1.6c1.1-1.1 2-2 2.5-2.6s.9-1 1-1.4.3-.8.3-1.2c0-.4-.1-.7-.3-.9s-.5-.3-.9-.3c-.3 0-.6 0-.9.2s-.5.4-.8.7l-1.3-1c.4-.5.9-.9 1.4-1.2s1.2-.4 1.8-.4zm14.4 9.7h-2.3l-.2-3.8c 0-.9-.1-1.7-.1-2.4 0-.5 0-1 0-1.5l-1.5 6.7h-2.2l-1.6-6.7c.1.8.1 1.6.1 2.3 0 .5 0 1.1 0 1.7l-.2 3.8h-2.2l.7-9.7h2.9l1.5 6.6 1.4-6.6h2.9z"></path></g></g></svg>',point:'<svg height="22" viewBox="0 0 12 12" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m6 12c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6z" fill="#fff"></path><path d="m6 10c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z" fill="#2ed5c9" stroke="#272c36" stroke-width="2"></path></g></svg>'};function Wu(e){tu.call(this,e),this.j=function(o){o.preventDefault()},this.i=z(function(o){this.Yb()||this.toggleState(),o.preventDefault()},this)}function Xu(e,o,f){$i.call(this,e,{icon:Yu,visibility:f}),Zu(this,o)}function Zu(e,o){e.pn=o,e.P&&(e.P.textContent=o)}u(Wu,tu),t("H.ui.base.PushButton",Wu),Wu.prototype.U=function(e){qu(e,"start",this.i),qu(e,"end",this.j),this.Cc(this.Ce(),!0)},Wu.prototype.renderInternal=Wu.prototype.U,Wu.prototype.to=function(){var e=uu.DOWN;return this.O(this.getState()===e?uu.UP:e),this},Wu.prototype.toggleState=Wu.prototype.to,Wu.prototype.o=function(){var e=this.L();e&&ru(e,"start",this.i),tu.prototype.o.call(this)},u(Xu,$i);var Yu=new Ri(nu(gu.document,"span","H_dm_label"),{onAttach:function(e,o,f){f.P=e,Zu(f,f.pn)},onDetach:function(e,o,f){delete f.P}});function $u(e,o){F.call(this),this.b=e,this.f=new Xu(this.ro,""),o.push(this.f),this.a=new R({objects:o,data:this}),this.jg=this.jg.bind(this)}function av(e,o){o&&(e.nextSibling=o,o.previousSibling=e)}function bv(e,o,f,m){var w=new L,k=[];av(e,this),av(this,o),w.nd(e.wa()),w.nd(o.wa()),this.c=new uh(w,{style:f.Ud}),this.i=new uh(w,{style:{strokeColor:"transparent",lineWidth:Math.min(100,this.c.ea().lineWidth+2*(m||5))}}),f.c&&(this.g=new uh(w,{style:f.c}),k.push(this.g)),k.push(this.c,this.i),$u.call(this,f,k),this.m=this.j=-1,(e=this.a).addEventListener("pointermove",this.v,!0,this),e.addEventListener("pointerleave",this.u,!0,this)}function cv(e,o,f){var m=e.c.ca();m.af(3*+f,3,[o.lat,o.lng,0]),e.g&&e.g.$(m),e.i.$(m),e.c.$(m)}function dv(e,o,f){f=o.b(f||0),this.c=new Jn(e,{icon:f,zIndex:0}),this.c.draggable=!0,$u.call(this,o,[this.c]),(e=this.a).addEventListener("dragstart",this.Fn,!0,this),e.addEventListener("drag",this.Gn,!0,this),e.addEventListener("dragend",this.En,!0,this)}function ev(e){var o=0;e.nextSibling&&e.previousSibling&&(e.nextSibling.Rc||e.previousSibling.Rc?e.nextSibling.Rc&&!e.previousSibling.Rc&&(o=2):o=1),o=e.b.b(o),e.c.Bc(o)}function fv(e,o){this.c=o,this.b=e,this.a={Rc:!0},gv(this,this.a),this.Qf=z(this.Qf,this)}function hv(e,o){for(var f=(e=e.a).nextSibling;f!==e;){var m=f;(m.s=f.previousSibling!==e&&o)?m.jg():(m.Hh&&x.clearTimeout(m.Hh),m.Hh=x.setTimeout(m.jg,100)),f=f.nextSibling}}function iv(e,o){var f=o||e.a.nextSibling,m=0,w=0;if(o&&!jv(e,o))throw new D(e.Te,0,o);for(f instanceof dv?m=f.Ae():f instanceof bv&&(m=f.previousSibling.Ae()),o=f;o&&o!==e.a;o=o.nextSibling,w++)o.di(m),w%2==1&&(m+=o.Ae())}function jv(e,o){for(var f=e.a.nextSibling,m=!1;f!==e.a;){if(f===o){m=!0;break}f=f.nextSibling}return m}function kv(e,o,f){o=new bv(o,f,e.c),e.b.aa(o.a)}function gv(e,o){e.a.nextSibling=o,o.previousSibling=e.a}function lv(e){var o,f=(e=e||{}).lineStyle;Gu.call(this),this.m=new Wu({label:Vu.btn,onStateChange:z(this.Cn,this)}),this.Fa(this.m),(o=e.distanceFormatter)&&(this.ej=o),f&&(this.Xj=f,this.sk=B),this.Nb(e.alignment||"right-bottom"),this.g={},this.g[0]=e.startIcon,this.g[2]=e.endIcon,this.g[1]=e.stopoverIcon,this.g[3]=e.splitIcon}function mv(e){var f,o=e.map,m={};e.f||(e.j=new N,e.s=new rl(e.j,{pixelRatio:e.map.Ua()}),e.u=f=e.j.Wb(),e.u.Vk(!0),f.addEventListener("dragstart",e.An,!0,e),f.addEventListener("dragend",e.$e,!0,e),f.addEventListener("pointerenter",e.$e,!0,e),f.addEventListener("pointerleave",e.Bn,!0,e),f.addEventListener("tap",e.Pn,!0,e),e.i=nv(e),m.a=z(e.ej,e),m.b=z(e.dk,e),m.g=z(e.wj,e),m.map=e.map,m.f=e.i,m.Ud=e.Xj,m.c=e.sk,e.b=new fv(e.u,m),e.f=!0),e.i&&e.u.aa(e.i),o.addEventListener("tap",e.pk,!0,e),o.a.add(e.s)}function ov(e){var o=e.map;e.f&&(o.removeEventListener("tap",e.pk,!0,e),o.Se(e.s),e.b.ma())}function nv(e){function o(){var _e=f.rb();return _e={anchor:f.fd().clone().scale(k).floor(),size:new Ui(Ad(_e.w*k),Ad(_e.h*k)),hitArea:m},new Uj(f.Kc(),_e)}var w,f=e.dk(3),m=new Vi(Wi.NONE,[]),k=f===e.B?.5:1;if(1===f.getState())var Y=o();else Y=new Uj("<svg/>",{hitArea:m}),f.addEventListener("statechange",function(){1===f.getState()&&w.Bc(o())});return w=new Jn(e.map.Za(),{visibility:!1,icon:Y})}function pv(){this.b=qv.CLOSED,Fu.call(this,"div","H_overlay")}u($u,F),p=$u.prototype,p.Rc=!1,p.ro={lat:0,lng:0},p.Cc=function(e,o){Zu(this.f,e),this.f.$(o)},p.Hh=0,p.jg=function(){this.f.lb(this.s)},u(bv,$u),bv.prototype.Ae=function(){var e=this.c.ca();return e.te(0).Ta(e.te(1))},bv.prototype.v=function(e){var o=e.currentPointer;e=this.previousSibling.wa();var f=this.nextSibling.wa(),m=this.b.f,w=o.viewportX;o=o.viewportY,(this.j!==w||this.m!==o)&&(this.j=w,this.m=o,m.$(this.b.g(e,f,{x:w,y:o})),m.lb(!0))},bv.prototype.u=function(){this.b.f.lb()},bv.prototype.di=function(){this.Cc(this.b.a(this.Ae()),this.c.J().Za())},u(dv,$u),p=dv.prototype,p.hk=0,p.A={$c:"change"},p.Ae=function(){return this.hk},p.wa=function(){return this.c.ca()},p.Gn=function(e){var o=e.currentPointer;e=o.viewportX,o=o.viewportY,(this.i!==e||this.j!==o)&&(this.i=e,this.j=o,this.c.$(this.b.map.Ra(e-this.g.x,o-this.g.y)),this.dispatchEvent(new td(this.A.$c,this)))},p.Fn=function(e){var o=e.currentPointer,f=o.viewportX;o=o.viewportY;var m=this.b.map.Aa(this.wa());this.c.ce(1),this.g={x:f-m.x,y:o-m.y},e.stopPropagation()},p.En=function(){this.c.ce(0)},p.di=function(e){this.hk=e,this.Cc(this.b.a(e),this.wa())},t("H.ui.distanceMeasurement.Model",fv),p=fv.prototype,p.If=function(){return this.a.nextSibling===this.a},p.je=function(e){var o=this.a.previousSibling,f=this.If();return e=new dv(e,this.c,f?0:2),this.b.aa(e.a),av(e,this.a),e.addEventListener(e.A.$c,this.Qf),f?gv(this,e):(kv(this,o,e),ev(o),iv(this,o)),e},p.insertBefore=function(e,o){var f,m=1;if(o){if(!jv(this,o))throw new D(this.insertBefore,1,o);(f=o.previousSibling.Rc)&&(m=0),(e=new dv(e,this.c,m)).addEventListener(e.A.$c,this.Qf),this.b.aa(e.a),f?(kv(this,e,f=this.a.nextSibling),gv(this,e),o=e,ev(f)):(o=(f=o.previousSibling).previousSibling,m=f.nextSibling,this.b.Da(f.a),kv(this,o,e),kv(this,e,m)),iv(this,o)}else e=this.je(e);return e},p.ma=function(){gv(this,this.a),this.b.ma()},p.Te=function(e){var o=this.a,f=e.previousSibling,m=e.nextSibling;if(!jv(this,e))throw new D(this.Te,0,e);if(this.b.Da(e.a),f===o){var w=m;w!==o?(gv(this,e=w.nextSibling),e.di(0),ev(e),iv(this,e)):gv(this,this.a)}else m===o?(av(e=(w=f).previousSibling,o),ev(e)):f&&m&&(kv(this,f.previousSibling,m.nextSibling),this.b.od([m.a,f.a]),iv(this,f.previousSibling));w&&w!==o&&this.b.Da(w.a)},p.Qf=function(e){var o=(e=e.target).previousSibling,f=e.nextSibling,m=e.wa();if(!f.Rc){cv(f,m,!1);var w=e}o.Rc||(cv(o,m,!0),w=o.previousSibling),iv(this,w)},u(lv,Gu),t("H.ui.DistanceMeasurement",lv),p=lv.prototype,p.Gh=Uu.METRIC,p.Xj={strokeColor:"rgb(39,44,54)",lineWidth:5},p.sk={strokeColor:"white",lineWidth:7},p.ej=function(e){var o="m",f=0;return"metric"===this.Gh?1e3<=e&&(e/=1e3,o="km",f=1):(o="ft",5280<=(e/=.3048)&&(e/=5280,o="mi",f=1)),e.toFixed(f)+" "+this.va().translate("scale."+o)},p.wj=function(e,o,f){var m=this.map.Aa(e);return o=this.map.Aa(o),f=new G(f.x,f.y).vj(m,o),this.map.Ra(f.x,f.y)||og(e)},p.U=function(e,o){var f=22*(this.map.f.type===ik.P2D?this.map.Ua():1),m=f/2;Gu.prototype.renderInternal.call(this,e,o),this.Gh=Uu.METRIC,this.B=new Uj(Vu.point,{anchor:{x:m,y:m},size:{w:f,h:f},hitArea:new Vi(Wi.CIRCLE,[m,m,m])}),this.m.ec(this.va().translate("distance.measurement"))},lv.prototype.renderInternal=lv.prototype.U,p=lv.prototype,p.dk=function(e){return this.g[e]||this.B},p.$e=function(){hv(this.b,!0)},p.An=function(){hv(this.b)},p.Bn=function(e){"touch"!==e.currentPointer.type&&hv(this.b)},p.Pn=function(e){var m,o=e.currentPointer,f=e.target.Ca;f&&(f=f.getData())instanceof $u&&(m=f),e=(e=e.originalEvent).metaKey||e.altKey,(f=m)&&(e&&f instanceof dv?this.b.Te(f):f instanceof bv&&(e=f.previousSibling.wa(),m=f.nextSibling.wa(),this.b.insertBefore(this.wj(e,m,o={x:o.viewportX,y:o.viewportY}),f.nextSibling),this.i.lb()),this.$e())},p.pk=function(e){var o=e.currentPointer;(e=e.target)!==this.map&&e.getProvider&&e.getProvider()===this.j||(this.b.je(this.map.Ra(o.viewportX,o.viewportY)),this.i.lb(),this.$e())},p.Cn=function(e){"down"===e.target.getState()?mv(this):ov(this)},p.Le=function(e){this.Gh=e,this.f&&(iv(this.b),this.$e())},lv.prototype.onUnitSystemChange=lv.prototype.Le,lv.prototype.o=function(){ov(this),this.f&&(this.j.D(),this.s.D()),lv.l.o.call(this)},lv.prototype.Ea=function(e){e?this.m.getState()===uu.DOWN&&(this.map=e,mv(this)):(ov(this),this.f=!1),Gu.prototype.Ea.apply(this,arguments)},lv.prototype.setMap=lv.prototype.Ea,u(pv,Fu),t("H.ui.base.OverlayPanel",pv),pv.prototype.O=function(e,o){return(e!==this.b||o)&&(this.b=e,e===qv.OPEN?this.Ga("H_open"):this.hb("H_open")),this},pv.prototype.setState=pv.prototype.O,pv.prototype.getState=function(){return this.b},pv.prototype.getState=pv.prototype.getState,pv.prototype.xk=function(e){var o=e.Gc;e=e.L();var f=this.L(),m=f.style;if(this.hb("H_top"),this.hb("H_middle"),this.hb("H_bottom"),this.hb("H_left"),this.hb("H_center"),this.hb("H_right"),m.bottom=m.top=m.left=m.right=m.margin="",/top/g.test(o)){this.Ga("H_top"),m.top="0",m.margin="0 12px";var w=-1}else/bottom/g.test(o)?(this.Ga("H_bottom"),m.bottom="0",m.margin="0 12px",w=1):(this.Ga("H_middle"),m.top="50%",m.margin="0 12px",m.marginTop=-Math.round(.5*f.offsetHeight)+"px",w=0);/left/g.test(o)?(this.Ga("H_left"),m.left=e.offsetWidth+"px",m.marginLeft="12px"):/right/g.test(o)?(this.Ga("H_right"),m.right=e.offsetWidth+"px",m.marginRight="12px"):(this.Ga("H_center"),m.left="50%",0>w?(m.top=e.offsetHeight+"px",m.marginTop="12px"):0<w&&(m.bottom=e.offsetHeight+"px",m.marginBottom="12px"),m.marginLeft=-Math.round(.5*f.offsetWidth)+"px",e.appendChild(f))},pv.prototype.pointToControl=pv.prototype.xk;var qv={OPEN:"open",CLOSED:"closed"};function rv(e){e=e||{},Fu.call(this,"div","H_rdo"),this.g=new X("div","H_rdo_title"),this.b=new Fu("div","H_rdo_buttons"),this.Fa(this.g),this.Fa(this.b),this.i=z(function(o){o.target.getState()===uu.DOWN?(this.Kk(o.target,!0),this.dispatchEvent(sv)):o.target.O(uu.DOWN,!0)},this),this.addEventListener("statechange",this.i),this.si(e.title||""),e.onActiveButtonChange&&this.addEventListener(sv,e.onActiveButtonChange),e.buttonsOptions&&e.buttonsOptions.forEach(function(o){this.yg(new Wu(o))},this)}pv.State=qv,u(rv,Fu),t("H.ui.base.RadioGroup",rv);var sv="activebuttonchange";function tv(e){e=e||{},Gu.call(this),this.g=new pv,this.b=this.b.bind(this),this.m=this.m.bind(this),this.s=this.s.bind(this),this.Nb(e.alignment||"bottom-right"),uv(this,e.baseLayers,e.layers)}function uv(e,o,f){var m=e.Vb();e.f&&e.f.forEach(function(w){var k=w.layer;w=k&&Yt(f,function(Y){return Y.layer===k}),k&&!w&&m.Se(k)}),e.j=Ac(o)?o:[],e.f=Ac(f)?f:[],e.i&&(e.i.ma(),e.u.ma(),vv(e))}function vv(e){var o=e.va();e.j.forEach(function(f,m){this.i.yg(new Wu({label:wv(o,f.label),data:m,disabled:!f.layer}))},e),e.f.forEach(function(f,m){this.u.Fa(new Wu({label:wv(o,f.label),onStateChange:this.V.bind(this,f.layer),data:m,disabled:!f.layer}))},e),e.N.lb(!(!e.f.length||!e.j.length)),x.setTimeout(function(){this.map&&(this.b(),this.B.ta(!(this.j&&this.j.length||this.f&&this.f.length)))}.bind(e))}function zv(e,o){var f,m,w={},k=o.ka(),Y=window.H.service&&window.H.service.omv.Provider;if(Y&&o.ka()instanceof Y&&k.ea().se){var _e=k.ea(),_o=function(){var _u=Av.ground.filter(function(iy){return!!_e.dh("layers."+iy)}),pd=Av.water.filter(function(iy){return!!_e.dh("layers."+iy)});_u.concat(pd).length&&(Xh(w,_e.se(_u)),Xh(w,_e.se(pd,!1,!0)),delete w.global,f=new qi(w,_e.Bb()),(m=k.j.cd(f)).sg=o,this.map.Ag(m)),_e.removeEventListener(Wh.CHANGE,_o)}.bind(e);_e.getState()!==Uh.READY?_e.addEventListener(Wh.CHANGE,_o):_o()}}function xv(e){return Yt(e.map.a.Ha(),function(o){return!!o.sg})}function yv(e){e=e.map.a.Ha();var o=window.H.service&&window.H.service.traffic.flow.Provider;return!!o&&e.some(function(f){return f.ka()instanceof o})}rv.prototype.U=function(e,o){Fu.prototype.renderInternal.call(this,e,o),this.si(this.f,!0)},rv.prototype.renderInternal=rv.prototype.U,rv.prototype.ma=function(){this.b.ma()},rv.prototype.si=function(e,o){return(e!==this.f||o)&&(this.f=e,this.g.L()&&(this.g.L().innerHTML=this.f)),this},rv.prototype.setTitle=rv.prototype.si,rv.prototype.Tm=function(){return this.f},rv.prototype.getTitle=rv.prototype.Tm,rv.prototype.yg=function(e){if(!(e instanceof Wu))throw Error("PushButton expected");return e.ia(this),this.b.Fa(e),this},rv.prototype.addButton=rv.prototype.yg,rv.prototype.Wn=function(e){return this.b.removeChild(e),e.ia(null),this},rv.prototype.removeButton=rv.prototype.Wn,rv.prototype.wf=function(){return this.b.Vg()},rv.prototype.getButtons=rv.prototype.wf,rv.prototype.Kk=function(e,o){for(var f=this.wf(),m=f.length;m--;)f[m].O(f[m]===e?uu.DOWN:uu.UP,o)},rv.prototype.setActiveButton=rv.prototype.Kk,rv.prototype.o=function(){this.removeEventListener("statechange",this.i),this.ma(),Fu.prototype.o.call(this)},u(tv,Gu),t("H.ui.MapSettingsControl",tv),tv.prototype.Y=function(){var e=this.Vb();e&&(e.addEventListener("tap",this.m),(e=e.a).addEventListener("add",this.b),e.addEventListener("remove",this.b),e.addEventListener("set",this.b))},tv.prototype.K=function(){var e=this.Vb();e&&(e.removeEventListener("tap",this.m),(e=e.a).removeEventListener("add",this.b),e.removeEventListener("remove",this.b),e.removeEventListener("set",this.b))},tv.prototype.U=function(e,o){var f=this.va().translate("layers.choose");Gu.prototype.renderInternal.call(this,e,o),this.Y(),this.B=new Wu({tooltip:f,label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.7,14.6 L4.5,16 L12,20.6 L19.5,16 L17.3,14.6 L19.1,13.5 L23,16 L12,23 L1,16 L4.9,13.5 L6.7,14.6 Z M12,2 L23,9 L12,16 L1,9 L12,2 Z"></path></svg>',onStateChange:z(function(m){m.target.getState()===uu.DOWN?(this.g.O(qv.OPEN),this.g.xk(this)):this.g.O(qv.CLOSED)},this)}),this.i=new rv({title:f,onActiveButtonChange:function(){t:{for(var m=this.i.wf(),w=m.length;w--;)if(m[w].getState()===uu.DOWN){m=m[w];break t}m=null}m=m.getData(),this.map.rd(this.j[m].layer),this.s()}.bind(this)}),this.u=new Fu("div","H_grp"),this.N=new X("div","H_separator"),this.Fa(this.B),this.Fa(this.g),this.g.Fa(this.i),this.g.Fa(this.N),this.g.Fa(this.u),vv(this)},tv.prototype.renderInternal=tv.prototype.U,tv.prototype.b=function(){var e=this.map.g,o=this.map.a;this.j.forEach(function(f,m){this.i.wf()[m].O(uu[f.layer===e?"DOWN":"UP"],!0)},this),this.f.forEach(function(f,m){m=this.u.Vg()[m],f.layer?m.O(uu[-1!==o.indexOf(f.layer)?"DOWN":"UP"],!0):m.ta(!0)},this)},tv.prototype.V=function(e,o){o.target.getState()===uu.DOWN?this.map.Ag(e):this.map.Se(e),this.s()},tv.prototype.s=function(){var e;(e=xv(this))&&(e.sg.ka().ea().Je(e.ka().ea().Lc()),this.map.Se(e),e.D(),delete e.sg),yv(this)&&zv(this,this.map.g)};var Av={water:["water.water-labels"],ground:"road_labels continent_label island_label roads.shields roads.directions truck-restriction.signs places landuse.label".split(" ")};function wv(e,o){return/^layers?/.test(o)&&e.ih(o)?e.translate(o):o}tv.prototype.m=function(){this.B.O(uu.UP)},tv.prototype.o=function(){tv.l.o.call(this),this.K()};var Bv=[];t("H.ui.i18n.defaultLocales",Bv);var Cv={},Dv=[];function Ev(e,o){Cv[e]=o,-1===Bv.indexOf(e)&&Bv.push(e),Dv.length?Fv(e,o):Dv=Object.keys(o)}function Fv(e,o){for(var w,f=Dv,m=f.length;m--;)if(!o[w=f[m]])throw Error("'"+w+"' key missing in translation map for "+e)}function Gv(e){e=e||{},Gu.call(this),this.f=new Wu({label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><g transform="translate(1 3)"><path fill-rule="nonzero" d="M5,0 L5,2 L2,2 L2,16 L5,16 L5,18 L2,18 C0.9,18 0,17 0,15.75 L0,2.25 C0,1 0.9,0 2,0 L5,0 Z M17,0 L20,0 C21.1,0 22,1 22,2.25 L22,15.75 C22,17 21.1,18 20,18 L17,18 L17,16 L20,16 L20,2 L17,2 L17,0 Z"></path><rect width="10" height="2" x="6" y="8"></rect><rect width="2" height="10" x="10" y="4"></rect></g></svg>',onStateChange:z(this.Dn,this)}),this.Fa(this.f),this.Nb(e.alignment||"right-bottom")}function Hv(e,o){if(!Bc(e))throw new TypeError("string locale code required");if(Ea(o))Fv(e,o);else{if(-1===Bv.indexOf(e))throw Error("Default locale '"+e+"' does nto exist.");o=Cv[e]}this.a=o||{},this.b=e}function Iv(e){e=e||{},Gu.call(this),this.Ga("H_scalebar"),this.Nb(e.alignment||"right-bottom"),this.s=150,this.update=z(this.update,this),this.i=this.g=this.b=this.f=null}function Jv(e){C(e,Re,Jv,1),X.call(this,"div","H_context_menu_item"),this.b=e,this.f=z(this.f,this),this.a=z(this.a,this),this.b.addEventListener("update",this.a)}function Kv(e){C(e,Array,Kv,1),Fu.call(this,"div","H_context_menu"),this.f=e,this.b=null}function Lv(e,o){o=o||{};var f=this;X.call(this,"div","H_ib H_ib_top"),this.B=z(function(m){f.Yb()||(f.close(),m.preventDefault())},this),this.update=z(this.update,this),this.i=z(this.i,this),this.setPosition(e),this.We(o.content),o.onStateChange&&this.addEventListener("statechange",o.onStateChange),this.O(Mv.OPEN)}u(Gv,Gu),t("H.ui.ZoomRectangle",Gv),p=Gv.prototype,p.Dn=function(e){var o=this.map,f=o.b.element;e.target.getState()===uu.DOWN?(o.addEventListener("dragstart",this.fk,!0,this),o.addEventListener("drag",this.gk,!0,this),o.addEventListener("dragend",this.ek,!0,this),(e=f.ownerDocument.createElement("div")).className="H_zoom_lasso",f.appendChild(e),this.b=e):(o.removeEventListener("dragstart",this.fk,!0,this),o.removeEventListener("drag",this.gk,!0,this),o.removeEventListener("dragend",this.ek,!0,this),f.removeChild(this.b))},p.fk=function(e){var o=this.b.style,f=e.currentPointer,m=f.viewportX;f=f.viewportY,e.target===this.map&&(e.stopPropagation(),o.width="0px",o.height="0px",o.top=f+"px",o.left=m+"px",o.display="block",this.i=f,this.g=m)},p.gk=function(e){var o=e.currentPointer,f=o.viewportX,m=o.viewportY;o=this.g;var w=this.i,k=this.b.style;e.target===this.map&&(e.stopPropagation(),e=f-o,f=m-w,k.left=o+(0>e?e:0)+"px",k.top=w+(0>f?f:0)+"px",k.width=Math.abs(e)+"px",k.height=Math.abs(f)+"px")},p.ek=function(e){var o=this.map,f=e.currentPointer;e.target===this.map&&(e.stopPropagation(),this.b.style.display="none",o.c.Ob({bounds:ug([o.Ra(this.g,this.i),o.Ra(f.viewportX,f.viewportY)])},!0))},p.U=function(e,o){Gu.prototype.renderInternal.call(this,e,o),this.f.ec(this.va().translate("zoom.rectangle"))},Gv.prototype.renderInternal=Gv.prototype.U,Ev("nl-NL",{"layers.normal":"Kaartweergave","layers.satellite":"Satelliet","layers.terrain":"Terrein","layer.transit":"Openbaar vervoer","layer.traffic":"Verkeerssituatie","layer.incidents":"Toon verkeersincidenten","layers.choose":"Weergave kiezen",minimap:"Minimap","scale.switchToImperial":"Overgaan naar mijlen","scale.switchToMetric":"Wijzigen naar km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Uitzoomen","zoom.in":"Inzoomen","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Openbaar vervoer","traffic.MISCELLANEOUS":"Diversen","traffic.ACCIDENT":"Ongeval","traffic.OTHER_NEWS":"Meer informatie","traffic.PLANNED_EVENT":"Geplande afzetting","traffic.ROAD_HAZARD":"Gevaar op de weg","traffic.ROAD_CLOSURE":"Rijbaan afgesloten","traffic.WEATHER":"Weer","traffic.CONGESTION":"Verkeersopstopping","traffic.CONSTRUCTION":"Wegwerkzaamheden","traffic.DISABLED_VEHICLE":"Voertuig met pech","traffic.from":"Begintijd:","traffic.until":"Geschatte eindtijd:","distance.measurement":"Measure distance"}),Ev("pt-PT",{"layers.normal":"Vista do mapa","layers.satellite":"Sat\xe9lite","layers.terrain":"Terreno","layer.transit":"Transportes p\xfablicos","layer.traffic":"Condi\xe7\xf5es de tr\xe2nsito","layer.incidents":"Mostrar incidentes de tr\xe2nsito","layers.choose":"Escolher vista",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Diminuir","zoom.in":"Aumentar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transportes p\xfablicos","traffic.MISCELLANEOUS":"Diversos","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras not\xedcias","traffic.PLANNED_EVENT":"Evento planeado","traffic.ROAD_HAZARD":"Perigo na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Meteorologia","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Constru\xe7\xe3o","traffic.DISABLED_VEHICLE":"Ve\xedculo avariado","traffic.from":"Hora de in\xedcio:","traffic.until":"Hora de fim prevista:","distance.measurement":"Measure distance"}),Ev("ru-RU",{"layers.normal":"\u0420\u0435\u0436\u0438\u043c \u043a\u0430\u0440\u0442\u044b","layers.satellite":"\u0421\u043f\u0443\u0442\u043d\u0438\u043a\u043e\u0432\u0430\u044f","layers.terrain":"\u041c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u044c","layer.transit":"\u041e\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442","layer.traffic":"\u0414\u043e\u0440\u043e\u0436\u043d\u044b\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f","layer.incidents":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0434\u043e\u0440\u043e\u0436\u043d\u044b\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f","layers.choose":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0438\u0434",minimap:"Minimap","scale.switchToImperial":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0438\u043b\u0438","scale.switchToMetric":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0438\u043b\u043e\u043c\u0435\u0442\u0440\u044b","scale.km":"\u043a\u043c","scale.m":"\u043c","scale.mi":"\u043c\u0438\u043b\u044c","scale.ft":"\u0444\u0443\u0442","zoom.out":"\u041e\u0442\u0434\u0430\u043b\u0438\u0442\u044c","zoom.in":"\u041f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u044c","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"\u041e\u0431\u0449\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0442\u0440\u0430\u043d\u0441\u043f\u043e\u0440\u0442","traffic.MISCELLANEOUS":"\u041f\u0440\u043e\u0447\u0435\u0435 \u0414\u0422\u041f","traffic.ACCIDENT":"\u0414\u0422\u041f","traffic.OTHER_NEWS":"\u0414\u0440\u0443\u0433\u0438\u0435 \u043d\u043e\u0432\u043e\u0441\u0442\u0438","traffic.PLANNED_EVENT":"\u041f\u043b\u0430\u043d\u043e\u0432\u043e\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435","traffic.ROAD_HAZARD":"\u0414\u043e\u0440\u043e\u0436\u043d\u0430\u044f \u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","traffic.ROAD_CLOSURE":"\u0414\u043e\u0440\u043e\u0433\u0430 \u0437\u0430\u043a\u0440\u044b\u0442\u0430","traffic.WEATHER":"\u041f\u043e\u0433\u043e\u0434\u0430","traffic.CONGESTION":"\u041f\u0440\u043e\u0431\u043a\u0430","traffic.CONSTRUCTION":"\u0420\u0435\u043c\u043e\u043d\u0442","traffic.DISABLED_VEHICLE":"\u041d\u0435\u0438\u0441\u043f\u0440\u0430\u0432\u043d\u044b\u0439 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c","traffic.from":"\u0412\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430:","traffic.until":"\u041e\u0436\u0438\u0434\u0430\u0435\u043c\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f:","distance.measurement":"\u0418\u0437\u043c\u0435\u0440\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0435"}),Ev("fi-FI",{"layers.normal":"Karttan\xe4kym\xe4","layers.satellite":"Satelliitti","layers.terrain":"Maasto","layer.transit":"Julkinen liikenne","layer.traffic":"Liikenneolosuhteet","layer.incidents":"N\xe4yt\xe4 liikennetapahtumat","layers.choose":"Valitse n\xe4kym\xe4",minimap:"Minimap","scale.switchToImperial":"Vaihda maileihin","scale.switchToMetric":"Vaihda kilometreihin","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Loitonna","zoom.in":"L\xe4henn\xe4","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Julkinen liikenne","traffic.MISCELLANEOUS":"Erittelem\xe4t\xf6n syy","traffic.ACCIDENT":"Onnettomuus","traffic.OTHER_NEWS":"Muu tapahtuma","traffic.PLANNED_EVENT":"Suunniteltu tapahtuma","traffic.ROAD_HAZARD":"Vaara tiell\xe4","traffic.ROAD_CLOSURE":"Tie suljettu","traffic.WEATHER":"S\xe4\xe4","traffic.CONGESTION":"Ruuhka","traffic.CONSTRUCTION":"Rakennusty\xf6","traffic.DISABLED_VEHICLE":"Pys\xe4htynyt ajoneuvo","traffic.from":"Alkamisaika:","traffic.until":"Arvioitu p\xe4\xe4ttymisaika:","distance.measurement":"Measure distance"}),Ev("pt-BR",{"layers.normal":"Exibi\xe7\xe3o do mapa","layers.satellite":"Sat\xe9lite","layers.terrain":"Terreno","layer.transit":"Transporte p\xfablico","layer.traffic":"Condi\xe7\xf5es do tr\xe2nsito","layer.incidents":"Mostrar incidentes no tr\xe2nsito","layers.choose":"Escolher exibi\xe7\xe3o",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"milhas","scale.ft":"p\xe9s","zoom.out":"Menos zoom","zoom.in":"Mais zoom","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte p\xfablico","traffic.MISCELLANEOUS":"Miscel\xe2nea","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras not\xedcias","traffic.PLANNED_EVENT":"Evento planejado","traffic.ROAD_HAZARD":"Risco na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Clima","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Constru\xe7\xe3o","traffic.DISABLED_VEHICLE":"Ve\xedculo incapacitado","traffic.from":"Hora de in\xedcio:","traffic.until":"Tempo final estimado:","distance.measurement":"Measure distance"}),Ev("zh-CN",{"layers.normal":"\u5730\u56fe\u89c6\u56fe","layers.satellite":"\u536b\u661f","layers.terrain":"\u5730\u5f62","layer.transit":"\u516c\u5171\u4ea4\u901a","layer.traffic":"\u4ea4\u901a\u60c5\u51b5","layer.incidents":"\u663e\u793a\u4ea4\u901a\u4e8b\u4ef6","layers.choose":"\u9009\u62e9\u89c6\u56fe",minimap:"Minimap","scale.switchToImperial":"\u5207\u6362\u4e3a\u300c\u82f1\u91cc\u300d","scale.switchToMetric":"\u5207\u6362\u4e3a\u300c\u516c\u91cc\u300d","scale.km":"\u516c\u91cc","scale.m":"\u7c73","scale.mi":"\u82f1\u91cc","scale.ft":"\u82f1\u5c3a","zoom.out":"\u7f29\u5c0f","zoom.in":"\u653e\u5927","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"\u516c\u5171\u4ea4\u901a","traffic.MISCELLANEOUS":"\u7efc\u5408\u4e8b\u4ef6","traffic.ACCIDENT":"\u4ea4\u901a\u610f\u5916","traffic.OTHER_NEWS":"\u5176\u4ed6\u65b0\u95fb","traffic.PLANNED_EVENT":"\u9884\u5b9a\u4e8b\u4ef6","traffic.ROAD_HAZARD":"\u9053\u8def\u5371\u9669","traffic.ROAD_CLOSURE":"\u9053\u8def\u5df2\u5173\u95ed","traffic.WEATHER":"\u5929\u6c14","traffic.CONGESTION":"\u5835\u585e","traffic.CONSTRUCTION":"\u65bd\u5de5","traffic.DISABLED_VEHICLE":"\u8f66\u8f86\u629b\u951a","traffic.from":"\u5f00\u59cb\u65f6\u95f4\uff1a","traffic.until":"\u9884\u8ba1\u7ed3\u675f\u65f6\u95f4\uff1a","distance.measurement":"Measure distance"}),Ev("es-ES",{"layers.normal":"Mapa","layers.satellite":"Sat\xe9lite","layers.terrain":"Terreno","layer.transit":"Transporte p\xfablico","layer.traffic":"Estado del tr\xe1fico","layer.incidents":"Mostrar incidentes de tr\xe1fico","layers.choose":"Elija una vista",minimap:"Minimap","scale.switchToImperial":"Cambiar a millas","scale.switchToMetric":"Cambiar a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Alejar","zoom.in":"Acercar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte p\xfablico","traffic.MISCELLANEOUS":"Varios","traffic.ACCIDENT":"Accidente","traffic.OTHER_NEWS":"M\xe1s noticias","traffic.PLANNED_EVENT":"Acto programado","traffic.ROAD_HAZARD":"Riesgo en carretera","traffic.ROAD_CLOSURE":"Carretera cerrada","traffic.WEATHER":"Tiempo","traffic.CONGESTION":"Atasco","traffic.CONSTRUCTION":"Construcci\xf3n","traffic.DISABLED_VEHICLE":"Veh\xedculo averiado","traffic.from":"Inicio:","traffic.until":"Finalizaci\xf3n estimada:","distance.measurement":"Measure distance"}),Ev("fr-FR",{"layers.normal":"Carte","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Transports publics","layer.traffic":"Conditions de circulation","layer.incidents":"Afficher les incidents de circulation","layers.choose":"Choisir la vue",minimap:"Minimap","scale.switchToImperial":"Passer en miles","scale.switchToMetric":"Passer en km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom arri\xe8re","zoom.in":"Zoom avant","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transports publics","traffic.MISCELLANEOUS":"Divers","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Autre","traffic.PLANNED_EVENT":"\xc9v\xe9nement pr\xe9vu","traffic.ROAD_HAZARD":"Danger routier","traffic.ROAD_CLOSURE":"Chauss\xe9e ferm\xe9e","traffic.WEATHER":"M\xe9t\xe9o","traffic.CONGESTION":"Embouteillage","traffic.CONSTRUCTION":"Travaux","traffic.DISABLED_VEHICLE":"V\xe9hicule en panne","traffic.from":"Date ou heure de d\xe9but:","traffic.until":"Date et heure de fin estim\xe9es:","distance.measurement":"Measure distance"}),Ev("pl-PL",{"layers.normal":"Widok mapy","layers.satellite":"Satelita","layers.terrain":"Teren","layer.transit":"Transport publiczny","layer.traffic":"Warunki drogowe","layer.incidents":"Poka\u017c zdarzenia drogowe","layers.choose":"Wybierz widok",minimap:"Minimap","scale.switchToImperial":"Zmie\u0144 na mile","scale.switchToMetric":"Zmie\u0144 na km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Oddal","zoom.in":"Przybli\u017c","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transport publiczny","traffic.MISCELLANEOUS":"Inne zdarzenie","traffic.ACCIDENT":"Wypadek","traffic.OTHER_NEWS":"Inne wiadomo\u015bci","traffic.PLANNED_EVENT":"Zdarzenie planowane","traffic.ROAD_HAZARD":"Niebezpiecze\u0144stwo na drodze","traffic.ROAD_CLOSURE":"Jezdnia zamkni\u0119ta","traffic.WEATHER":"Pogoda","traffic.CONGESTION":"Korek","traffic.CONSTRUCTION":"Budowa","traffic.DISABLED_VEHICLE":"Uszkodzony pojazd","traffic.from":"Data rozpocz\u0119cia:","traffic.until":"Przybli\u017cona data zako\u0144czenia:","distance.measurement":"Measure distance"}),Ev("de-DE",{"layers.normal":"Kartenansicht","layers.satellite":"Satellit","layers.terrain":"Gel\xe4nde","layer.transit":"\xd6ffentliche Verkehrsmittel","layer.traffic":"Verkehrslage","layer.incidents":"Verkehrsst\xf6rungen anzeigen","layers.choose":"Ansicht ausw\xe4hlen",minimap:"Minimap","scale.switchToImperial":"Umrechnung in Meilen","scale.switchToMetric":"Umrechnung in Kilometer","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Verkleinern","zoom.in":"Vergr\xf6\xdfern","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"\xd6ffentliche Verkehrsmittel","traffic.MISCELLANEOUS":"Diverse","traffic.ACCIDENT":"Unfall","traffic.OTHER_NEWS":"Anderes Ereignis","traffic.PLANNED_EVENT":"Geplantes Ereignis","traffic.ROAD_HAZARD":"Verkehrshindernis","traffic.ROAD_CLOSURE":"Fahrbahn gesperrt","traffic.WEATHER":"Wetter","traffic.CONGESTION":"Verkehrsstau","traffic.CONSTRUCTION":"Baustelle","traffic.DISABLED_VEHICLE":"Liegengebliebenes Fahrzeug","traffic.from":"Beginn:","traffic.until":"Voraussichtliches Ende:","distance.measurement":"Measure distance"}),Ev("tr-TR",{"layers.normal":"Harita g\xf6r\xfcn\xfcm\xfc","layers.satellite":"Uydu","layers.terrain":"Arazi","layer.transit":"Toplu ula\u015f\u0131m","layer.traffic":"Trafik durumlar\u0131","layer.incidents":"Trafik olaylar\u0131n\u0131 g\xf6ster","layers.choose":"G\xf6r\xfcn\xfcm se\xe7",minimap:"Minimap","scale.switchToImperial":"Mile d\xf6n\xfc\u015ft\xfcr","scale.switchToMetric":"Kilometreye d\xf6n\xfc\u015ft\xfcr","scale.km":"km","scale.m":"m","scale.mi":"mil","scale.ft":"ft","zoom.out":"Uzakla\u015ft\u0131r","zoom.in":"Yak\u0131nla\u015ft\u0131r","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Toplu ula\u015f\u0131m","traffic.MISCELLANEOUS":"\xc7e\u015fitli","traffic.ACCIDENT":"Kaza","traffic.OTHER_NEWS":"Di\u011fer haberler","traffic.PLANNED_EVENT":"Planl\u0131 etkinlik","traffic.ROAD_HAZARD":"Yol tehlikesi","traffic.ROAD_CLOSURE":"Yol kapal\u0131","traffic.WEATHER":"Hava durumu","traffic.CONGESTION":"Yo\u011funluk","traffic.CONSTRUCTION":"Yol \xe7al\u0131\u015fmas\u0131","traffic.DISABLED_VEHICLE":"Ara\xe7 ar\u0131zas\u0131","traffic.from":"Ba\u015flang\u0131\xe7 zaman\u0131:","traffic.until":"Tahmini biti\u015f zaman\u0131:","distance.measurement":"Measure distance"}),Ev("it-IT",{"layers.normal":"Vista mappa","layers.satellite":"Satellite","layers.terrain":"Terreno","layer.transit":"Mezzi pubblici","layer.traffic":"Condizioni del traffico","layer.incidents":"Mostra incidenti stradali","layers.choose":"Scegli vista",minimap:"Minimap","scale.switchToImperial":"Passa a miglia","scale.switchToMetric":"Passa a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom indietro","zoom.in":"Zoom avanti","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Mezzi pubblici","traffic.MISCELLANEOUS":"Varie","traffic.ACCIDENT":"Incidente","traffic.OTHER_NEWS":"Altre notizie","traffic.PLANNED_EVENT":"Evento pianificato","traffic.ROAD_HAZARD":"Strada dissestata","traffic.ROAD_CLOSURE":"Strada chiusa","traffic.WEATHER":"Maltempo","traffic.CONGESTION":"Ingorgo","traffic.CONSTRUCTION":"Lavori in corso","traffic.DISABLED_VEHICLE":"Veicolo in panne","traffic.from":"Ora di inizio:","traffic.until":"Ora di fine stimata:","distance.measurement":"Measure distance"}),Ev("en-US",{"layers.normal":"Map view","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Public transport","layer.traffic":"Traffic conditions","layer.incidents":"Show traffic incidents","layers.choose":"Choose view",minimap:"Minimap","scale.switchToImperial":"Change to miles","scale.switchToMetric":"Change to km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom out","zoom.in":"Zoom in","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Public transport","traffic.MISCELLANEOUS":"Miscellaneous","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Other news","traffic.PLANNED_EVENT":"Planned event","traffic.ROAD_HAZARD":"Road hazard","traffic.ROAD_CLOSURE":"Roadway closed","traffic.WEATHER":"Weather","traffic.CONGESTION":"Congestion","traffic.CONSTRUCTION":"Construction","traffic.DISABLED_VEHICLE":"Disabled vehicle","traffic.from":"Start time:","traffic.until":"Estimated end time:","distance.measurement":"Measure distance"}),t("H.ui.i18n.Localization",Hv),Hv.prototype.sm=function(){return this.b},Hv.prototype.getLocale=Hv.prototype.sm,Hv.prototype.mm=function(){return Object.keys(this.a)},Hv.prototype.getKeys=Hv.prototype.mm,Hv.prototype.ih=function(e){return!(!this.a||!this.a[e])},Hv.prototype.hasKey=Hv.prototype.ih,Hv.prototype.translate=function(e){var o=this.a[e];if(!Bc(o))throw Error("Translation missing for key '"+e+"'.");return o},Hv.prototype.translate=Hv.prototype.translate,u(Iv,Gu),t("H.ui.ScaleBar",Iv),Iv.prototype.U=function(e,o){Gu.prototype.renderInternal.call(this,e,o),e.innerHTML='<svg height="12" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline style="fill:none; stroke:white; stroke-width:4" points="2,2 2,10 98,10 98,2"/><polyline style="fill:none; stroke:black; stroke-width:2" points="2,2 2,10 98,10 98,2"/></svg><div style="padding: 0 0 0 10px"></div>',e.style.direction="ltr",this.f=e.firstChild,this.b=(o=this.f.childNodes)[0],this.g=o[1],this.i=e.lastChild,this.j=Uu.METRIC,this.m=z(function(f){this.Yb()||(this.dispatchEvent("toggleunitsystem"),f.preventDefault())},this),this.u=z(function(f){f.preventDefault()},this),qu(e,"start",this.u),qu(e,"end",this.m),this.ec(this.va().translate("scale.switchToImperial")),this.update()},Iv.prototype.renderInternal=Iv.prototype.U,Iv.prototype.Ea=function(e){this.map&&this.map.removeEventListener("mapviewchange",this.update),e&&e.addEventListener("mapviewchange",this.update),Gu.prototype.Ea.apply(this,arguments)},Iv.prototype.setMap=Iv.prototype.Ea,Iv.prototype.capture=function(e,o,f){var m=this.L(),w=m.ownerDocument,k=w.createElement("canvas"),Y=k.getContext("2d"),_e=w.createElementNS("http://www.w3.org/2000/svg","svg"),_o=w.createElementNS("http://www.w3.org/2000/svg","foreignObject"),_u=mf(m,w,!1);w=parseFloat(m.offsetWidth)+1;var pd=parseFloat(m.offsetHeight),iy=w*e;e*=pd,k.width=iy,k.height=e,_e.setAttribute("xmlns","http://www.w3.org/2000/svg"),_e.setAttribute("width",iy),_e.setAttribute("height",e),_e.setAttribute("viewBox","0 0 "+w+" "+pd),_o.setAttribute("width","100%"),_o.setAttribute("height","100%"),_e.appendChild(_o),_u.setAttribute("width","100%"),_u.setAttribute("height","100%"),_u.setAttribute("xmlns","http://www.w3.org/1999/xhtml");var sy=window.getComputedStyle(m);"box-shadow display align-items font font-family font-size height text-shadow direction".split(" ").forEach(function(gy){_u.style.setProperty(gy,sy.getPropertyValue(gy))}),_o.appendChild(_u),new uf("image",m=cf(_e.outerHTML)).then(function(gy){Y.drawImage(gy,0,0),o(k)},f)},Iv.prototype.capture=Iv.prototype.capture,Iv.prototype.Le=function(e){this.j=e,this.ec("imperial"===e?this.va().translate("scale.switchToMetric"):this.va().translate("scale.switchToImperial")),this.update()},Iv.prototype.onUnitSystemChange=Iv.prototype.Le,Iv.prototype.update=function(){var e;if(this.L()){this.f=this.f,this.b=this.b;var o=this.s,f=0,m=this.map;if(m){var w=Math.round(.5*m.b.width),k=Math.round(.5*m.b.height);(e=m.Ra(w,k))&&(m=m.Ra(w+1,k))&&(f=100*e.Ta(m))}f&&(this.j===Uu.IMPERIAL?1609.344>f?(m=f/.3048006,e=this.va().translate("scale.ft")):(m=f/1609.344,e=this.va().translate("scale.mi")):1e3>f?(m=f,e=this.va().translate("scale.m")):(m=f/1e3,e=this.va().translate("scale.km")),(m=(f=Math.pow(10,Math.floor(Math.log(m)/Math.LN10)))/m*100)<o/5?(f*=5,m*=5):m<o/2?(f*=2,m*=2):m>o&&(f/=2,m/=2),m=Math.round(m),this.f.setAttribute("width",m),this.i.textContent=f+" "+e,this.b.points.getItem(2).x=this.g.points.getItem(2).x=this.b.points.getItem(3).x=this.g.points.getItem(3).x=m-2)}},u(Jv,X),t("H.ui.context.Item",Jv),Jv.prototype.f=function(e){var o=this.b,f=o.callback;f&&!o.isDisabled()&&(this.dispatchEvent("click"),f(e))},Jv.prototype.U=function(){var e=this,o=this.L();Ee(o,"click",this.f),o.addEventListener("keyup",function(f){13==f.keyCode&&e.f(f)}),this.a()},Jv.prototype.renderInternal=Jv.prototype.U,Jv.prototype.a=function(){var e=this.L(),o=this.b;o.callback?(this.Ga("clickable"),e.setAttribute("tabindex","0")):(this.hb("clickable"),e.removeAttribute("tabindex")),o.isDisabled()?this.Ga("disabled"):this.hb("disabled"),o=o.getLabel(),hu.textContent=o,e.innerHTML=hu.innerHTML.split("\n").join("<br/>")},Jv.prototype.o=function(){X.prototype.o.call(this),this.b.removeEventListener("update",this.a)},u(Kv,Fu),t("H.ui.context.Menu",Kv),Kv.prototype.U=function(){Fu.prototype.U.apply(this,arguments),this.f.forEach(function(e){e===Se?e=new X("div","H_context_menu_item_separator"):(e=new Jv(e)).addEventListener("click",this.g.bind(this)),this.Fa(e)},this),Ee(this.L(),["mousedown","touchstart","pointerdown","wheel"],function(e){e.stopPropagation()})},Kv.prototype.renderInternal=Kv.prototype.U,Kv.prototype.setPosition=function(e,o){if(this.b){var f=this.L(),m=f.offsetWidth,w=f.offsetHeight,k=this.b,Y=k.b.width;e+m>Y&&e>Y/2&&(e-=m),o+w>(k=k.b.height)&&o>k/2&&(o-=w),au(f,e,o)}},Kv.prototype.setPosition=Kv.prototype.setPosition,Kv.prototype.g=function(){this.b&&this.b.dispatchEvent(new td("contextmenuclose",this.b))},Kv.prototype.Ea=function(e){this.b=e},Kv.prototype.setMap=Kv.prototype.Ea,u(Lv,X),t("H.ui.InfoBubble",Lv),Lv.prototype.a=null,Lv.prototype.wa=function(){return this.u},Lv.prototype.setPosition=function(e){this.u=og(e),this.update()},Lv.prototype.setPosition=Lv.prototype.setPosition,Lv.prototype.Ea=function(e){this.a=e},Lv.prototype.U=function(e,o){this.m=nu(o,"div","H_ib_body"),this.tailEl_=nu(o,"div","H_ib_tail"),this.f=nu(o,"div","H_ib_close H_btn",'<svg version="1.1" class="H_icon" viewBox="0 0 12 12"><path d="m8.12 6 3.66-3.66c.29-.29.29-.76 0-1.05l-1.06-1.06c-.29-.29-.76-.29-1.05 0l-3.66 3.66-3.66-3.66c-.29-.29-.76-.29-1.05 0l-1.06 1.06c-.29.29-.3.76 0 1.05l3.66 3.66-3.66 3.66c-.29.29-.29.76 0 1.05l1.06 1.06c.29.29.76.29 1.05 0l3.66-3.66 3.66 3.66c.29.29.76.29 1.05 0l1.06-1.06c.29-.29.3-.76 0-1.05z"></path></svg>'),this.b=nu(o,"div","H_ib_content","&nbsp;"),this.m.appendChild(this.f),this.m.appendChild(this.b),qu(this.f,"start",this.B),this.a.c.addEventListener("sync",this.update),this.a.b.addEventListener("sync",this.update),e.appendChild(this.m),e.appendChild(this.tailEl_),this.We(this.g)},Lv.prototype.renderInternal=Lv.prototype.U,Lv.prototype.i=function(){this.s||(this.s=setTimeout(this.update,0))},Lv.prototype.update=function(){var f,e=this.L(),o=this.a,m="none";if(this.s=0,o&&e&&this.getState()===Mv.OPEN){if(f=o.Aa(this.u)){var w=f.x;f=f.y,(w>=-(o=o.b.width)||w<=2*o||f>=-o||f<=2*o)&&(m="",bu?(e.style.left=w-o+"px",e.style.top=f+"px"):au(e,w,f))}e.style.display=m,""===m&&(e.style.visibility="visible")}};var Mv={OPEN:"open",CLOSED:"closed"};function Nv(e){this.c=e,this.a=this.b=null,this.i=0,this.g=22,this.f=z(this.f,this),(e=this.c.Vb()).addEventListener("mapviewchange",this.s,!1,this),(e=e.a).addEventListener("add",this.j,!1,this),e.addEventListener("remove",this.m,!1,this)}function Ov(e,o){e.b&&o&&e.b===o.ka()||(e.b&&e.b.removeEventListener("tap",e.f),o?(e.b=o.ka(),e.b.addEventListener("tap",e.f),e.i=e.b.min,e.g=e.b.max):(e.b=null,e.i=0,e.g=22))}function Pv(e){return window.H.service&&e.ka()instanceof window.H.service.traffic.incidents.Provider}function Qv(e,o){var f=e.L(),m=this;F.call(this),this.c=e,this.i=f.ownerDocument,this.f={},this.b=[],new Nv(this),this.P=nu(this.i,"div","H_ui"),this.setDirection(),this.S=z(function(w){this.s.put(w.target,w.target.Gc)},this),this.addEventListener("alignmentchange",this.S),this.K=z(function(){this.fl()},this),this.addEventListener("toggleunitsystem",this.K),this.P.addEventListener("contextmenu",this.v,!1),this.P.addEventListener("MSHoldVisual",this.v,!1),this.c.addEventListener("contextmenu",this.B,!1,this),this.c.addEventListener("contextmenuclose",this.u,!1,this),this.c.nb(this.D.bind(this)),this.a=null,this.m=-1,this.s=new Ju(this.P,this.i),this.g=Uu.METRIC,Rv(this,"en-US"),o&&Sv(this,o),f.appendChild(this.P),x.setTimeout(function(){m.s.update()},1)}function Rv(e,o){if(Bc(o))var f=o;else{if(!(o instanceof Hv))throw Error("The locale parameter must be a string or a H.ui.i18n.Localization object.");f=o.b;var m=o}if(!f)throw Error("No locale was defined.");if(m)e.j=m;else{if(!(0<=Bv.indexOf(f)))throw Error("Locale ["+f+"] is not supported.");e.j=new Hv(f)}}function Sv(e,o){var f,m;o.unitSystem&&e.mg(o.unitSystem),(m=o.locale)&&Rv(e,m),(f=o.zoom)&&e.xd("zoom",new Hu(Ea(f)?f:null)),(f=o.zoomrectangle)&&e.xd("zoomrectangle",new Gv(Ea(f)?f:null)),(f=o.mapsettings)&&e.xd("mapsettings",new tv(Ea(f)?f:null)),(f=o.scalebar)&&e.xd("scalebar",new Iv(Ea(f)?f:null)),(f=o.distancemeasurement)&&e.xd("distancemeasurement",new lv(Ea(f)?f:null))}function Uv(e,o,f,m){for(var w=e,k=0;w&&k<o.length;k++)w=w[o[k]];w&&w!==e&&m.push({label:f,layer:w})}function Tv(e,o,f){var m=[],w=[],k=o.raster;if(e===ik.P2D&&k){if(Uv(o,["raster","normal","map"],"layers.normal",m),Uv(o,["raster","satellite","map"],"layers.satellite",m),Uv(o,["raster","terrain","map"],"layers.terrain",m),f)for(var Y in k)if(k[Y]&&k[Y].map===f){var _e=Y;break}Uv(o,["raster","normal","trafficincidents"],"layer.incidents",w),Uv(o,["raster",_e,"transit"],"layer.transit",w)}else Uv(o,["vector","normal","map"],"layers.normal",m),Uv(o,["raster","satellite","map"],"layers.satellite",m),Uv(o,["vector","normal","traffic"],"layer.traffic",w),Uv(o,["vector","normal","trafficincidents"],"layer.incidents",w);return{alignment:"bottom-right",baseLayers:m,layers:w}}function Vv(e,o){if(o=o||{},!(e&&e instanceof ql))throw Error("Base layer is mandatory for overview UI element");Gu.call(this),this.f=new Wu({label:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="H_icon"><g fill-rule="evenodd" transform="translate(2 2)"><rect width="9" height="9" x="10" y="10"/><rect class="H_icon_stroke" width="18" height="18" x="1" y="1" fill="none" stroke="#000" stroke-width="2" rx="2"/></g></svg>',onStateChange:z(this.g,this)}),this.Fa(this.f),this.b=new Wv(e,o.zoomDelta,o.scaleX,o.scaleY),this.Nb(o.alignment||"right-bottom"),this.Fa(this.b)}function Wv(e,o,f,m){this.j=e,"number"==typeof o&&(this.il=o),"number"==typeof f&&(this.tk=f),"number"==typeof m&&(this.uk=m),Fu.call(this,"div","H_overview")}function Yv(e){!e.wd&&Xv(e),e.hb("H_overview_active"),e.b.removeEventListener("mapviewchange",e.vi,!1,e)}function Xv(e,o){var f=e.b.b.element,m=e.L().style,w=f.offsetWidth/e.tk/10;f=f.offsetHeight/e.uk/10;var k=e.g.style;o?(m.width=w+"em",m.height=f+"em",k.width=w+"em",k.height=f+"em"):m.width=m.height="0em",e.f.b.resize()}function Zv(e,o){if(!e)throw new D(Zv,0,e);Zv.l.constructor.call(this,e),this.b={},this.c=!(!o||!o.jc),this.f=$v++}Lv.State=Mv,Lv.prototype.j=Mv.OPEN,Lv.prototype.getState=function(){return this.j},Lv.prototype.getState=Lv.prototype.getState,Lv.prototype.O=function(e){e!==this.j&&(this.j=e,this.dispatchEvent("statechange")),(e=this.L())&&(this.j===Mv.OPEN?(e.style.display="block",e.style.visibility="hidden",this.i()):e.style.display="none")},Lv.prototype.setState=Lv.prototype.O,Lv.prototype.close=function(){this.O(Mv.CLOSED)},Lv.prototype.close=Lv.prototype.close,Lv.prototype.open=function(){this.O(Mv.OPEN)},Lv.prototype.open=Lv.prototype.open,Lv.prototype.Tl=function(){return this.b||null},Lv.prototype.getContentElement=Lv.prototype.Tl,Lv.prototype.We=function(e){if(e){if("string"!=typeof e&&("number"!=typeof e.nodeType||"string"!=typeof e.nodeName))throw Error("InfoBubble content must be a string or HTML node.");this.g=e}else this.g="";this.L()&&(this.g?(this.b.innerHTML="","string"==typeof this.g?this.b.innerHTML=e:"number"==typeof e.nodeType&&"string"==typeof e.nodeName&&this.b.appendChild(e)):this.b.innerHTML="&nbsp;",this.i())},Lv.prototype.setContent=Lv.prototype.We,Lv.prototype.o=function(){this.close(),this.We(""),this.f&&ru(this.f,"end",this.B),this.a&&(this.a.c.removeEventListener("sync",this.update),this.a.b.removeEventListener("sync",this.update)),X.prototype.o.call(this)},Nv.prototype.s=function(e){var o=e.newValue.zoom;this.a&&e.modifiers&e.ZOOM&&(o<this.i||o>this.g)&&this.a.close()},Nv.prototype.j=function(e){Pv(e=e.added)&&Ov(this,e)},Nv.prototype.m=function(e){Pv(e.removed)&&(this.a&&this.a.close(),Ov(this,null))},Nv.prototype.f=function(e){var o;if(e.target&&(o=e.target.getData())&&0===e.currentPointer.button){var f=e.target.ca();this.a||(this.a=new Lv(f),this.a.Ga("H_tib"),this.c.Oi(this.a)),this.a.setPosition(f),f=o.TRAFFIC_ITEM_TYPE_DESC.replace(" ","_"),f=this.c.va().ih("traffic."+f)?this.c.va().translate("traffic."+f):o.TRAFFIC_ITEM_DESCRIPTION[o.TRAFFIC_ITEM_DESCRIPTION.length-1].value,this.a.We('<div class="H_tib_content"><div class="H_rdo_title" dir="auto">{{title}}</div><div class="H_tib_desc" dir="auto"><span>{{desc}}</span><div class="H_tib_time"><span class="H_tib_left">{{traffic.from}}</span><span class="H_tib_right">{{from}}</span><br/><span class="H_tib_left">{{traffic.until}}</span><span class="H_tib_right">{{until}}</span></div></div>'.replace("{{title}}",f).replace("{{desc}}",o.TRAFFIC_ITEM_DESCRIPTION[0].value).replace("{{traffic.from}}",this.c.va().translate("traffic.from")).replace("{{traffic.until}}",this.c.va().translate("traffic.until")).replace("{{from}}",o.START_TIME).replace("{{until}}",o.END_TIME)),this.a.open()}e.stopPropagation()},u(Qv,F),t("H.ui.UI",Qv),Qv.prototype.v=function(e){for(var o=e.target;o&&!/\bH_ib_content\b/.test(o.className);)o=o.parentNode;o||e.preventDefault()},Qv.prototype.L=function(){return this.P},Qv.prototype.getElement=Qv.prototype.L,Qv.prototype.Vb=function(){return this.c},Qv.prototype.getMap=Qv.prototype.Vb,Qv.prototype.Wm=function(){return this.g},Qv.prototype.getUnitSystem=Qv.prototype.Wm,Qv.prototype.mg=function(e){var f,o=this.f;if(e!==this.g)for(f in this.g=e,o)o[f]instanceof Gu&&o[f].onUnitSystemChange(this.g)},Qv.prototype.setUnitSystem=Qv.prototype.mg,Qv.prototype.setDirection=function(e){this.P.setAttribute("dir",e||getComputedStyle(this.Vb().L()).direction)},Qv.prototype.setDirection=Qv.prototype.setDirection,Qv.prototype.va=function(){return this.j},Qv.prototype.fl=function(){this.mg(this.g===Uu.METRIC?Uu.IMPERIAL:Uu.METRIC)},Qv.prototype.toggleUnitSystem=Qv.prototype.fl,Qv.prototype.Oi=function(e){var o=this.b.length,f=this.P;if(0>this.b.indexOf(e)){e.ia(this),e.Ea(this.c);var m=e.T(this.i);o=0<o?this.b[o-1].L().nextSibling:this.P.firstChild,f.insertBefore(m,o),this.b.push(e)}},Qv.prototype.addBubble=Qv.prototype.Oi,Qv.prototype.B=function(e){var o=e.items;this.a&&this.u(),clearTimeout(this.m),this.m=x.setTimeout(function(){o.length&&(this.a=new Kv(o),this.P.insertBefore(this.a.T(this.i),this.P.firstChild),this.a.ia(this),this.a.Ea(this.c),this.a.setPosition(e.viewportX,e.viewportY))}.bind(this),0)},Qv.prototype.u=function(){this.a&&(this.a.D(),this.a=null)},Qv.prototype.Vn=function(e){var o=this.b.indexOf(e);-1<o&&(e.ia(null),e.Ea(null),this.b.splice(o,1),this.P.removeChild(e.L()))},Qv.prototype.removeBubble=Qv.prototype.Vn,Qv.prototype.Pl=function(){return this.b},Qv.prototype.getBubbles=Qv.prototype.Pl,Qv.prototype.xd=function(e,o){if(this.ye(e))throw Error("A control with name ["+e+"] is already registered.");o.ia(this),o.Ea(this.c),o.ua=this.j,o.T(this.i),o.onUnitSystemChange(this.g),this.f[e]=o},Qv.prototype.addControl=Qv.prototype.xd,Qv.prototype.Xn=function(e){var o=this.ye(e);if(!o)throw Error("Control ["+e+"] not found in this UI's controls.");return o.K(),o.ia(null),o.Ea(null),su(o),delete this.f[e],o},Qv.prototype.removeControl=Qv.prototype.Xn,Qv.prototype.ye=function(e){return this.f[e]},Qv.prototype.getControl=Qv.prototype.ye,Qv.prototype.o=function(){for(var e in this.f)Zt.hasOwnProperty.call(this.f,e)&&this.f[e].D();this.b.forEach(function(o){o.D()}),(e=this.P.parentNode)&&e.removeChild(this.P),F.prototype.o.call(this),delete this.P},Qv.prototype.capture=function(e,o,f,m){var w=this.ye("scalebar"),k=e.getContext("2d"),Y=e.width,_e=e.height,_o=this.c.m,_u=5+(_o?_o.L().childNodes[1].offsetHeight:0);w&&w.pc()?w.capture(o,function(pd){k.drawImage(pd,Y-pd.width-5*o,_e-pd.height-_u*o),f(e)},m):f(e)},Qv.prototype.capture=Qv.prototype.capture,Qv.createDefault=function(e,o,f){var m=e.f.type;if(f=new Qv(e,{unitSystem:Uu.METRIC,zoom:{alignment:"right-bottom"},mapsettings:Tv(m,o,e.g),scalebar:{alignment:"bottom-right"},locale:f||"en-US"}),m===ik.P2D){var w=f.ye("mapsettings"),k=function(){if(w.Vb()){var Y=Tv(m,o,e.g);uv(w,Y.baseLayers,Y.layers)}};e.addEventListener(e.A.ff,k),f.nb(function(){e.removeEventListener(e.A.ff,k)}),w.nb(function(){e.removeEventListener(e.A.ff,k)})}return f},u(Vv,Gu),t("H.ui.Overview",Vv),Vv.prototype.rd=function(e){return this.b.rd(e),this},Vv.prototype.setBaseLayer=Vv.prototype.rd,Vv.prototype.g=function(e){e.target.getState()===uu.DOWN?(Xv(e=this.b,!0),e.vi(),e.Ga("H_overview_active"),e.b.addEventListener("mapviewchange",e.vi,!1,e)):Yv(this.b)},Vv.prototype.U=function(e,o){Gu.prototype.renderInternal.call(this,e,o),this.f.L().style.float=this.Gc.match("right")?"right":"left",this.b.Ea(this.map),this.f.ec(this.va().translate("minimap"))},Vv.prototype.renderInternal=Vv.prototype.U,Vv.prototype.o=function(){this.b.D(),X.prototype.o.call(this)},u(Wv,Gu),Wv.prototype.rd=function(e){this.f.rd(e)},Wv.prototype.U=function(e,o){ou(e,o=nu(o,"div","H_overview_map")),this.g=o},Wv.prototype.renderInternal=Wv.prototype.U,Wv.prototype.renderInternal=Wv.prototype.U,p=Wv.prototype,p.il=3,p.tk=5,p.uk=5,p.Ea=function(e){this.b=e,this.f=new U(this.g,this.j,{pixelRatio:this.b.Ua(),engineType:this.b.f.type}),this.f.m.L().style.display="none",this.m=this.f.c,this.i=this.b.c},p.vi=function(e){e&&e.modifiers&e.SIZE&&Xv(this,!0),(e=this.i.fb()).zoom-=this.il,this.m.Ob(e)},p.o=function(){Wv.l.o.call(this),Yv(this),this.f.D(),this.f=this.m=this.i=this.b=this.j=this.g=null},t("H.ui.buildInfo",function(){return If("H-ui","1.37.1","8e9b6d2",{region:"row"})}),u(Zv,wm);var $v=0;function aw(e,o){o=o||{},C(e,rl,aw,0),aw.l.constructor.call(this,e),this.jc=!!o.jc,this.c=o.bb||0,this.a=[],this.b={}}Zv.prototype.T=function(e,o,f,m,w,k){var Y=zd(m),_e=this.ab,_o=Y+(f.exp-_e.pixelProjection.exp),_u=_e.min,pd=_e.max;m=_e.tileSize;var iy=_e.ka().g,sy=this.ib,gy=sy.Oc(),wy=sy.rb().w,Ey=f.w,Py=f.x,Jy=f.y,_m={};if(Y<_u||Y>pd)return uk.DONE;for(e=(w=_e.requestTiles(e,_o,w,k,this.f)).total,k=(w=w.tiles).length,this.g=f,this.j=o,this.a=_o,gy!==iy&&sy.cc(iy),f=m=m*Ey/(Fd(2,_o)*m),this.c||(m%1&&(Py/=Ey=f/(m=Ad(m)),Jy/=Ey,Ey=Fd(2,_o)*m),Py=Ad(Py),Jy=Ad(Jy)),this.i=f,_o=-m,Y=wy+m,_e=0;_e<k;_e++){if((_u=(wy=w[_e]).data)&&_u.tagName){for(sy.Ic(_u,f=o.x-(Py-wy.x*m),iy=o.y-(Jy-wy.y*m),m,m),gy=f;(gy-=Ey)>_o;)sy.Ic(_u,gy,iy,m,m);for(gy=f;(gy+=Ey)<Y;)sy.Ic(_u,gy,iy,m,m)}_m[this.a+"_"+wy.x+"_"+wy.y]=wy}return this.b=_m,k===e?uk.DONE:uk.PENDING},Zv.prototype.Ba=function(e,o,f){var _e,m=this.i,w=m/this.ab.tileSize,k=this.g,Y=this.j;if(vc(this.a)&&k){e=k.x+(e-Y.x),o=k.y+(o-Y.y);var _o=Ad(k.w/m),_u=k=Ad(e/m);Y=Ad(o/m),Cd(_u)>=_o&&(_u%=_o),0>_u&&(_u=_o+_u),(_o=this.b[this.a+"_"+_u+"_"+Y])&&_o.Ba&&(_e=_o.Ba((e-m*k)/w,(o-m*Y)/w,f))}return _e||jf},Zv.prototype.Pd=function(){return"2d"},u(aw,wm),aw.prototype.T=function(e,o,f,m,w,k){var Y,_o,_e=this.ab;m-=this.c,this.a.length=0;var _u=this.b;if(this.b=Y={},m>=_e.min&&m<=_e.max){var pd=_e.pd(e,m,w,k),iy=pd.overlays;if(e=iy.length)for(iy.sort(qh),m=this.ib,w=this.jc,k=0;k<e;k++){var sy=(_e=iy[k]).J(),gy=f.eb(sy.Gb()),wy=f.eb(sy.Cb());sy=f.w,gy.x>=wy.x&&(gy.x-=sy),gy.x+=sy*=-((gy.x+wy.x)/sy>>1),gy.add(o),wy.x+=sy,wy.add(o),w||(gy.round(),wy.round()),(sy=_u[_o=_e.$a()])?delete _u[_o]:sy={Sn:_e},Y[_o]=sy;var Ey=gy.x,Py=wy.x,Jy=Py-Ey,_m=(wy=wy.y)-(gy=gy.y);m.cc(_e.Oc()),m.Ic(_e.Kc(),Ey,gy,Jy,_m),sy.Ng?sy.Ng.set(Ey,gy,Py,wy):sy.Ng=new wk(Ey,gy,Py,wy),this.a.push(sy)}}return!pd||pd.requested&&pd.requested===pd.total||!pd.requested&&iy.length===pd.total?uk.DONE:uk.PENDING},aw.prototype.Ba=function(e,o,f){for(var k,_e,m=this.a,w=m.length;w--;)if((k=m[w]).Ng.pf(e,o))if(k=k.Sn,_e)_e.push(k);else if(_e=[k],f)break;return _e||jf},aw.prototype.Pd=function(){return"2d"},aw.prototype.o=function(){delete this.a,aw.l.o.call(this)},aw.prototype.disposeInternal=aw.prototype.o;var bw={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:0},incline:{min:0,max:0},heading:{min:180,max:180}},interaction:{ZOOM:Hl.ZOOM,COORD:Hl.COORD},capture:!0};function cw(e,o){this.a=[],cw.l.constructor.apply(this,arguments)}function Z(e,o,f,m){Z.l.constructor.call(this,e,o,f,m),this.K=new G(0,0),(f=m.renderBaseBackground)&&(this.Ln=f.lower,this.Kn=f.higher),this.wn=!!m.enableSubpixelRendering,this.Zc=dw,this.tf=0,this.Cd=this.ue=!1,this.g=new im,this.a=m=new qm,this.ad=z(this.ad,this),m.addEventListener(m.A.tg,this.ad),this.Aa=z(this.Aa,this),this.oa=e=(m=e.element).ownerDocument.createElement("div"),e.style.position="absolute",e.style.width=e.style.height="100%",e.style.zIndex=0,m.insertBefore(e,m.firstChild),this.Jj=new Nm(this.oa,this.na),this.s=[],ew(this),this.zh=z(Z.prototype.zh,this),this.V=fw,this.cg(),this.zoom=gw(this,this.v.kb()+this.bb),this.xb(),hw(this,o.fb().position,this.zoom),this.Wa(),this.da()}t("H.map.render.p2d.capabilities",bw),u(cw,Am),p=cw.prototype,p.hj=function(){return this.ab.xc.apply(this.ab,arguments)},p.T=function(e,o,f,m,w,k,Y){return this.a=[],cw.l.T.apply(this,arguments)},p.$j=1,p.Ek=function(e,o,f,m,w,k){var Y=this.$j=m.Ua();w*=Y,k*=Y;var _e=f.rb();o=_e.w*Y,_e=_e.h*Y;var _o=f.fd();this.jc?(w-=_o.x*Y,k-=_o.y*Y):(w=zd(w-_o.x*Y),k=zd(k-_o.y*Y)),m.Ic(f.Kc(),w,k,o,_e),e.detail?e.detail.set(w,k,w+o,k+_e):e.detail=new wk(w,k,w+o,k+_e),this.a.push(e)},p.Ba=function(e,o,f){for(var k,Y,_e,m=this.a,w=m.length,_o=jf,_u=this.$j;w--&&!((Y=(k=m[w]).detail).pf(e,o)&&(k=k.ik,(!(_e=k.qb().c)||_e.Gf((e-Y.left)/_u,(o-Y.top)/_u,0))&&0>_o.indexOf(k)&&(_o===jf&&(_o=[]),_o.push(k),f))););return _o},p.Pd=function(){return"2d"},p.o=function(){this.a=[],cw.l.o.call(this)},cw.prototype.disposeInternal=cw.prototype.o,u(Z,Dl),t("H.map.render.p2d.RenderEngine",Z),Z.prototype.type=Nl.P2D;var fw=2;function iw(e,o,f){return Cd(o=f-o)<e.b.w/2?o:o-e.b.w*f/Cd(f)}function ew(e){var o=e.c.Ha(),f=0,m=o.length;for([e.N={},e.u={},e.ra={},e.Y={}].forEach(function(w){w.Hc=[],w.ha=[]}),e.Qb=e.c.Ha();f<m;f++)e.Ke(f,o[f]);e.xb()}function rw(e){var o=[];return(o=(o=(o=(o=o.concat(e.u.ha)).concat(e.N.ha)).concat(e.ra.ha)).concat(e.Y.ha)).filter(vc)}function lw(e,o){var f=Jl(e,Jl(e,o.zoom)+e.bb);return(e=Kl(e,o)).zoom=f,e}function hw(e,o,f){var m=e.b;m.Ka(f),e.m=m.projection.Jc(o),m.x=m.w*e.m.x,m.y=m.h*e.m.y}function qw(e){return{w:(e=e.ua[2]).right-e.left,h:e.bottom-e.top}}function sw(e){e.i&&e.i.qa()||Jk()-e.Wj<e.Zc&&!e.yd?e.Tn=Hk(e.zh):(e.yd&&(e.$d(),tw(e)),e.V=fw)}function tw(e,o){e.dispatchEvent({type:e.A.Li,target:o||e})}function xw(e,o,f){nw(e,o*e.na,f*e.na),e.K.set(0,0),e.Wa(),e.fa()}function nw(e,o,f){var m=e.b;e=e.m,m.x=Yd(m.x+o,m.w),m.y=yd(0,xd(m.w,m.y+f)),e.x=m.x/m.w,e.y=m.y/m.h}function ow(e,o,f,m){var w=e.na,k=e.f.center;f===+f&&m===+m?(e.K.set(f=(f-k.x)*w,m=(m-k.y)*w),nw(e,f,m),e.b.Ka(o),nw(e,-f,-m)):(e.K.set(0,0),e.b.Ka(o)),e.zoom=o,e.Wa(),e.fa()}function jw(e,o,f,m){var w=e.getCapabilities().lookAt.zoom.max,k=o.Za(),Y=m||k;if(o.If()||f&&m)f=f===B?w:f;else{var _e=new lj(e.b.projection);_e.Ka(w);var _o=_e.eb(o.Gb()).round(),_u=_e.eb(o.Cb()).round();w=_e.w,o.ub()&&(_o.x-=w),m?(k=_e.eb(Y),o=2*yd(k.x-_o.x,_u.x-k.x),_o=2*yd(k.y-_o.y,_u.y-k.y)):(o=_u.x-_o.x,_o=_u.y-_o.y,Y=k),f===B&&(f=(k=e.ua[4]).right-k.left,k=k.bottom-k.top,f=Jl(e,f=-8+xd(Dd(f/o*w)/Nd,Dd(k/_o*w)/Nd)-e.bb))}return{zoom:Ad(f),position:Y}}function kw(e){pw(e,!0),e.a.qa()&&e.ob(!0),e.g.qa()&&e.pb(!0),pw(e,!0)}function yw(e,o){if(o){var f={};f.Oe=o.power,f.re=o.ease,f.duration=o.duration,e.j=f}}function gw(e,o){return Jl(e,Jl(e,o-e.bb)+e.bb)}function Aw(e,o){var f=e.m,m=e.b.projection.Jc(o.position),w=e.b.Xd(m),k=w.y;w=w.x;var Y=o.zoom;o=(f=e.b.Xd(f)).y;var _e=f.x;f=e.zoom;var _o=e.a.sb(),_u=e.a.a,pd=e.a.b,iy=0;if(w=iw(e,_e,w),o=Ed((w-=_e)*w+(k-=o)*k+(f=Y-f)*f),0!==_o&&0!==o){var sy=w/o,gy=k/o,wy=f/o,Ey=_o*_o/(2*o);mw(e,function(Py,Jy){var _m;1!==Py?((_m=wy*(Jy=(Py=_o*Jy-Ey*Jy*Jy/2)-iy))&&(_m=gw(e,e.zoom+_m),ow(e,gw(e,_m),_u,pd)),xw(e,zd(sy*Jy),zd(gy*Jy)),iy=Py):(e.m=m,ow(e,gw(e,Y),_u,pd),e.Wa(),e.fa())},2*o/_o)}}function zw(e,o,f){f=f||0,o.c&&ow(e,gw(e,e.zoom+o.c*f),e.a.atX,e.a.atY),xw(e,o.a*f,o.b*f)}function mw(e,o,f,m,w){e.i&&e.i.qa()&&e.i.stop(!0),e.i=new zm(e,o,f,m,w),e.i.start()}function pw(e,o){e.i&&e.i.qa()&&e.i.stop(o)}Z.prototype.getState=function(){return this.V},Z.prototype.getState=Z.prototype.getState,Z.prototype.Eg=function(e){var o=this,f=e.b,m=e.newValue,w=e.modifiers;e=m.position;var Y,k=m.bounds,_e=this.zoom,_o=this.m,_u=0;if(w&cj.POSITION&&(Y=o.b.eb(e)),w&cj.BOUNDS)m=jw(this,k.J(),w&cj.ZOOM?m.zoom:B,w&cj.POSITION?e:B),this.v.Ob(m,f);else{w&cj.POSITION||(Y=o.b.eb(m.position));var pd=Y.x,iy=Y.y;kw(this),this.K.set(0,0);var sy=(m=lw(this,m)).zoom,gy=m.position;if(f){var wy=sy-_e,Ey={x:_o.x,y:_o.y};f=this.b.Xd(Ey).x;var Py=this.b.projection.Jc(e);(Py.x!==this.m.x||Py.y!==this.m.y||sy!==this.zoom)&&(pd=iw(this,f,pd),mw(this,function(Jy){var _m=Jy-_u;if(sy!==_e){Y=o.b.Xd(Py);var y0=o.b.Xd(Ey);pd=iw(o,y0.x,Y.x),iy=Y.y-y0.y}_u=Jy,nw(o,pd*_m,iy*_m),ow(o,_e+=wy*_m),o.Wa(),o.fa()},this.ya,function(){hw(o,gy,sy),ow(o,sy),o.Wa(gy),o.fa()},this.Ya))}else pw(this),hw(this,gy,sy),ow(this,sy),this.Wa(gy);this.fa()}},Z.prototype.ya=300,Z.prototype.gg=function(e){var o=Ec(e);if(!o||o&&0>e)throw new D(this.gg,1,"positive number required");this.ya=e},Z.prototype.setAnimationDuration=Z.prototype.gg,Z.prototype.Sg=function(){return this.ya},Z.prototype.getAnimationDuration=Z.prototype.Sg,Z.prototype.Ya=Zl,Z.prototype.hg=function(e){if(!Da(e))throw new D(this.hg,1,"function required");this.Ya=e},Z.prototype.setAnimationEase=Z.prototype.hg,Z.prototype.Tg=function(){return this.Ya},Z.prototype.getAnimationEase=Z.prototype.Tg,Z.prototype.cg=function(){this.Ya=Zl,this.ya=300},Z.prototype.resetAnimationDefaults=Z.prototype.cg,Z.prototype.Nh=function(e,o,f){var m;this.Wj=Jk(),(m=this.N.ha.splice(e,1)[0])&&m.D&&m.D(),(m=this.u.ha.splice(e,1)[0])&&m.D&&m.D(),(m=this.ra.ha.splice(e,1)[0])&&m.D&&m.D(),(m=this.Y.ha.splice(e,1)[0])&&m.D&&m.D(),this.Qb=this.c.Ha(),0===e&&(Il(this,o,!1),this.xb()),this.s=Om(this.Jj,qw(this),rw(this)),this.$d(),f||this.fa()},Z.prototype.Oh=function(){this.xb(),this.fa()},Z.prototype.jh=function(e,o,f){var m,w,k,Y;if(o){var _e={jc:this.wn,bb:this.bb};o.T?C(o,ym)?w=new xm(o):C(o,Km)&&(Y=new xm(o)):(o.requestOverlays&&(m=new aw(o,_e)),o.requestTiles&&(w=new Zv(o,_e)),o.requestMarkers&&(k=new cw(o,_e)),o.requestDomMarkers&&(Y=new Dm(o,_e)))}this.N.ha.splice(e,f=f||0,m),this.u.ha.splice(e,f,w),this.ra.ha.splice(e,f,k),this.Y.ha.splice(e,f,Y),this.Qb=this.c.Ha(),this.s=Om(this.Jj,qw(this),rw(this))},Z.prototype.Ra=function(e,o){var f=this.f.center,m=this.na;return this.b.La((e-f.x)*m,(o-f.y)*m)},Z.prototype.screenToGeo=Z.prototype.Ra,Z.prototype.fg=function(e,o){return e=this.Ra(e,o),(o=this.v.fb()).position=e,o},Z.prototype.Aa=function(e){var o=this.na,f=this.f.center,m=f.x*o;f=f.y*o,e=this.b.eb(e);var w=this.b.w;return new G(zd((e.x-zd(e.x/w)*w+m)/o),zd((e.y+f)/o))},Z.prototype.geoToScreen=Z.prototype.Aa,Z.prototype.J=function(e,o){var f=this.ua[e||4],m=f.left-o,w=(e=this.b).La(m,f.top-o),k=f.right+o;return o=e.La(k,f.bottom+o),k-m>=e.w&&(w.lng=-(o.lng=180)),tg(w,o)},Z.prototype.Ba=function(e,o,f,m){var Y,w=[],k=this.na;for(e*=k,o*=k,Y=(k=[this.N,this.u,this.ra,this.Y]).length;Y--&&(!f||!w.length);){for(var _e=w,_o=k[Y].ha,_u=e,pd=o,iy=f,sy=_o.length;sy--&&!((w=_o[sy])&&w.Ba&&(_e=_e.concat(w.Ba(_u,pd,iy)),_e.length&&iy)););w=_e}m(w)},Z.prototype.getObjectsAt=Z.prototype.Ba,Z.prototype.Fc=y,Z.prototype.da=function(){var o,e=this.s.length;Z.l.da.call(this);var f=qw(this);this.K.set(0,0);var m=f.w;for(o=f.h;e--;){var w=(f=this.s[e]).rb();w.w===m&&w.h===o||f.Ye(m,o)}this.Fc=new Ui(m,o),this.fa()},Z.prototype.getCapabilities=function(){return bw},Z.prototype.getCapabilities=Z.prototype.getCapabilities,p=Z.prototype,p.$d=function(){this.N.Hc.length=0,this.u.Hc.length=0,this.ra.Hc.length=0,this.Y.Hc.length=0},p.zh=function(){var e;this.B&&this.B.before();var o=this.u.ha,f=this.f.center.clone().scale(this.na).round(),m=this.J(1,0),w=this.J(1,uw),k=this.zoom,Y=k-this.bb,_e=this.b,_o=this.Ln,_u=this.Kn,pd=o[0];o=this.K;var iy=this.s.length,sy=this.Qb;for(e=sy.length;iy--;){var gy=this.s[iy];C(gy,vm)&&gy.clear()}if(pd){if(_o)for(;_o;)pd.T(m,f,_e,iy=k-_o,!0,o),--_o;if(_u&&this.Cd)for(gy=1;gy<=_u&&(_e.Ka(iy=k+gy),_o=this.J(2,0),_e.Ka(k),!pd.T(_o,f,_e,iy,!0,o));gy++);}for(this.Zc=dw;e--;)C(_e=sy[e],oj)&&_e.ka()&&_e.ka().Pe(w,Y);m=this.Zj(m,f,k,!1,o,vw,this.u,this.N),f=this.Zj(w,f,Y,!1,o,ww,this.ra,this.Y),this.yd=m&&f,this.i&&this.i.qa()&&this.ug(),this.S||(this.S=this.v.fb()),this.S.bounds=this.J(4,0),this.v.Wa(this.S),this.S=null,this.Fc&&(this.f.Wa(this.Fc),this.Fc=y),k<this.tf?this.Cd=!0:this.ue&&(this.Cd=!1),this.tf=k,this.ue=m,this.B&&this.B.after(),sw(this)},p.Zj=function(e,o,f,m,w,k,Y){var sy,_e=Array.prototype.slice.call(arguments,6),_o=_e.length,_u=_e[0].ha.length,pd=_o*_u,iy=!!pd;for(sy=0;sy<pd;sy++){if(k===vw)var gy=sy%_o,wy=Math.floor(sy/_o);else gy=Math.floor(sy/_u),wy=sy%_u;var Ey=_e[gy].ha[wy];gy=_e[gy].Hc,Ey&&((Ey=Ey.T(e,o,this.b,f,m,w,this.Aa))===uk.ACTIVE&&(this.Zc=1/0),Ey!==uk.DONE||gy[wy]||(tw(this,this.Qb[wy]),gy[wy]=!0),gy[wy]||(iy=!1))}return iy},p.o=function(){var e=this.c.Ha()[0],o=this.f;Ik(this.Tn),pw(this,!0),e&&Il(this,e,!1),rw(this).forEach(function(f){f.D()}),o.element&&o.element.removeChild(this.oa),this.oa=null,this.V=3,Z.l.o.call(this)},p.fa=function(){this.Wj=Jk(),this.V===fw&&(this.yd=!1,this.V=1,sw(this))},p.ud=function(e,o,f){ow(this,e=Jl(this,Jl(this,e)+this.bb),o,f)},Z.prototype.zoomAt=Z.prototype.ud,Z.prototype.gc=function(e,o){kw(this),yw(this,o),this.g.start(e,!!o)},Z.prototype.startInteraction=Z.prototype.gc,Z.prototype.Xb=function(e,o,f,m,w){var k=!1;this.g.qa()&&(o=this.g.store(e,o,f,m,w),this.g.tc(Hl.COORD)&&0<hm(e=this.g.Ld())&&(xw(this,-e.x,-e.y),k=!0),o&&this.g.tc(Hl.ZOOM)&&(e=this.g.uf(),o=this.g.vf(),(o=Dd(Fd(2,this.zoom)*o)/Nd)!==this.zoom&&(ow(this,o=gw(this,o),e.x,e.y),k=!0)),k&&this.fa())},Z.prototype.interaction=Z.prototype.Xb,Z.prototype.pb=function(e){var o=this;if(this.g.qa()&&!e){if(this.j){e=this.g.sb();var f=this.g.lc(),m=this.j.duration,w=(this.j.Oe||1)*e,k=new Lm(-w/(0<m?m:1),w);!E(f.x)&&!E(f.y)&&0<w&&o.g.tc(Hl.COORD)&&mw(this,function(Y){w=k.ze(Y*m),E(w)||xw(o,zd(-f.x*w),zd(-f.y*w))},m,void 0,this.j.re)}this.j=null,this.g.clear()}},Z.prototype.endInteraction=Z.prototype.pb,Z.prototype.fc=function(e,o,f){kw(this),this.a.start(o,f),yw(this,e)},Z.prototype.startControl=Z.prototype.fc,Z.prototype.control=function(e,o,f){if(E(+f))throw new D(this.control,2,f);if(E(e))throw new D(this.control,0,e);if(E(o))throw new D(this.control,1,o);this.a.qa()&&this.a.set(e,o,f,0,0,0)},Z.prototype.control=Z.prototype.control,Z.prototype.ob=function(e,o){var m,f=this;if(this.a.qa()){pw(this,!0);var w=Jk(),k=w-this.Lj;if(1<=k&&zw(this,tm(this.a),k),!this.j||e||o)"function"==typeof o&&((e=this.fb()).zoom=this.zoom-this.bb,o(e),e.zoom+=this.bb,Aw(this,e));else{o=this.a.sb();var _e=this.a.lc(),_o=this.j.duration,_u=(this.j.Oe||1)*o,pd=new Lm(-_u/(0<_o?_o:1),_u);!E(_e.a)&&!E(_e.b)&&0<_u&&mw(this,function(iy,sy,gy,wy){w&&(gy=wy-w,w=0),_u=pd.ze(iy*_o)*gy,E(_u)||((m=_e.c*_u)&&ow(f,gw(f,f.zoom+m),f.a.a,f.a.b),xw(f,zd(_e.a*_u),zd(_e.b*_u)))},_o,void 0,this.j.re)}this.a.reset()}},Z.prototype.endControl=Z.prototype.ob,Z.prototype.ad=function(e){var o=this,f=e.b;this.K.set(0,0),f.a||f.b||f.c?(this.Lj=Jk(),mw(this,function(m,w,k,Y){o.Lj=Y,zw(o,f,k)},Number.POSITIVE_INFINITY),this.fa()):pw(this,!0)},Z.prototype.Og=function(){},Z.prototype.enter=Z.prototype.Og,Z.prototype.Pg=function(e){Gl(this.oa,e)},Z.prototype.exit=Z.prototype.Pg,Z.prototype.capture=function(e,o,f,m){var w=this.oa.ownerDocument.createElement("canvas"),k=w.getContext("2d"),Y=this.na;for(w.width=(f-e)*Y,w.height=(m-o)*Y,f=0;f<this.s.length;f++)C(m=this.s[f],vm)&&k.drawImage(m.L(),-e*Y,-o*Y);return Zb(w)};var ww=0,vw=1,dw=1e3,uw=256;function Bw(e){var o;if(e)for(Cw={},o=e.length;o--;)Cw[e[o]]=!0;this.Yk={}}var Dw,Cw={};Bw.prototype.parse=function(e,o,f){var m,w,k,Y,_e;Dw=!1;try{f=JSON.parse(f)}catch{Dw=!0}if(f&&(m=f.metadata)){var _o={spatials:[]};for(w in m)if((f=!Cw[w]&&(k=Ew[w]))&&((Y=m[w])||(Dw=!0,Y=void 0),f=Y),f)for(f=Y.length;f--;){var _u;(_u=Y[f])||(Dw=!0,_u=void 0),(_e=_u)&&k(o,e,this,w,_e,_o)}}else Dw=!0;return Dw?void 0:_o},Bw.prototype.parse=Bw.prototype.parse;var Ew={"street labels":function(e,o,f,m,w,k){var Y;if((Y=w.vertices)||(Dw=!0,Y=void 0),Y){var _e,_u,_o=Y.length;if((_u=0<_o)||(Dw=!0,_u=void 0),_u)for(_e=Array(_o/2);_o;){var pd=Y[--_o];_u=Y[--_o],_e[_o/2]=new G(_u,pd)}_e=_e?{a:[_e]}:B,_o=+w["font size"]/e.Ua(),(Y=f.Yk[_o])||(Fw.lineWidth=_o,Y=f.Yk[_o]=f.Bd.kj(Fw)),Gw(e,o,_e,!1,Y,w,m,k)}delete w.vertices},"city center labels":function(e,o,f,m,w,k){Gw(e,o,Hw(w,new Mh([])),!0,f.Bd,w,m,k)},labels:function(e,o,f,m,w,k){var Y;if((Y=w["bounding boxes"])||(Dw=!0,Y=void 0),Y){for(var _u,_e=Y.length,_o=new Mh([]);_e--;){var pd;(pd=Y[_e])||(Dw=!0,pd=void 0),(_u=pd)&&Hw(_u,_o)}Gw(e,o,_o,!0,f.Bd,w,m,k)}delete w["bounding boxes"]},buildings:function(e,o,f,m,w,k){var _o,_u,pd,gy,Y=w.id,_e=o.Zf[Y],iy=[],sy=[];(_o=w)||(Dw=!0,_o=void 0),_o&&((_u=_o.vertices)||(Dw=!0,_u=void 0),_u)&&((gy=_o.polygons)||(Dw=!0,gy=void 0),(pd=gy)&&iy.push.apply(iy,Iw(_u,pd)),(_o=_o.outlines)||(Dw=!0,_o=void 0),(pd=_o)&&sy.push.apply(sy,Iw(_u,pd))),pd=iy.length,iy.push.apply(iy,sy),sy=new Mh(iy,Vd,pd),(iy=iy.length)||(Dw=!0,iy=void 0),iy&&(_e?(Uq(_e,e,[sy]),k.spatials.push(_e)):(_e=Gw(e,o,sy,!0,f.Bd,w,m,k,Y),o.aa(_e)))}};Ew["transit stops"]=Ew.POIs=Ew.labels;var Jw=["box 2","box 1","annotation box","icon box"];function Hw(e,o){for(var m,w,f=Jw.length;f--;)if(w=e[m=Jw[f]]){var k=w[0],Y=w[1],_e=w[2];w=w[3],o.a.push([new G(k,Y),new G(k+_e,Y),new G(k+_e,Y+w),new G(k,Y+w)]),delete e[m]}return o}function Iw(e,o){var m,w,k,f=o.length;if(0<f)for(w=Array(f);f--;)if((m=o[f])||(Dw=!0,m=void 0),m){var Y=m.length;if(0<Y)for(w[f]=k=Array(Y);Y--;){var _e=2*m[Y];k[Y]=new G(e[_e],e[_e+1])}}return w||[]}var Kw={};function Gw(e,o,f,m,w,k,Y,_e,_o){return Kw.style=w,m=new Qq(o,m,_o,Kw),f&&Uq(m,e,[f]),Lw(k),k.category=Y,m.setData(k),_e.spatials.push(m),m.ia(o),m}Bw.prototype.Bd=new O({strokeColor:"transparent",fillColor:"transparent",lineWidth:0});var Fw={};function Lw(e){var o,f=!1;switch(typeof e){case"object":if(e instanceof Array)for(o=e.length;o--;)Lw(e[o])?f=!0:delete e[o];else if(e)for(o in e)Lw(e[o])?f=!0:delete e[o];break;case"number":f=!0;break;default:f=!!e}return f}function Mw(e,o,f){o=o||{};var m=(f=f||{}).tileType||"maptile",w=f.scheme||"normal.day";if(S.call(this,{min:0,max:20}),!0===o.pois&&(o.pois="!F"),this.K=o,!(e&&e instanceof Nw))throw Error("InvalidArgument: service required");this.u=e,this.i=z(this.i,this),this.u.addEventListener("versionupdate",this.i),this.B=e.C().clone().F(m+"/"+e.oc()+"/"+w).I(Ow).I(o),this.Y=e.f||null,this.N=f.pixelRatio||f.pixelratio||Ue(),this.tileSize=f.tileSize||256,this.tileType=m,this.scheme=w,this.b=new $q(new Bw(f.categoryFilter)),this.b.ia(this),this.v=z(this.v,this),this.b.addEventListener("update",this.v),S.call(this,{min:0,max:20}),this.s(new Pk(f.tileCacheSize||256,z(this.V,this)))}u(Mw,S),t("H.service.metaInfo.TileProvider",Mw),Mw.prototype.V=function(e,o){for(var m,f=(e=o.Pa()).length;f--;)delete(m=e[f]).a[o.key],m.release();o.data&&(up.push(o.Xf(),this.tileSize),o.Yf())},Mw.prototype.v=function(){this.dispatchEvent("update")},Mw.prototype.G=function(e,o,f,m,w){var _u,k=this.B.clone(),Y=this.Y,_e=this.tileSize,_o=this.getTileKey(e,o,f);if((_o=this.Db().get(_o))&&!_o.Sd()){m(up.pop(this.tileSize),null);var pd={cancel:function(){}}}else{Y&&k.za(Y[(f+o+e)%Y.length]),k.F(f+"/"+e+"/"+o+"/"+_e+"/png8");var iy=sp.setTimeout(function(){(_u=new uf("text/plain",k.toString())).then(function(sy){m(null,sy)},w)},500)}return pd||{cancel:function(){_u?_u.cancel():sp.clearTimeout(iy)}}},Mw.prototype.requestInternal=Mw.prototype.G,Mw.prototype.Ub=function(e,o,f,m,w){var k=this.b,Y=m||up.pop(this.tileSize);if(m)(e=this.Db().get(this.getTileKey(e,o,f))).T(m);else if(delete(m=e=new Zk(this.hd(e,o,f),e,o,f,this.tileSize,this.N,f,k)).j,m.m=w,e.T(Y))for(Y=(w=e.Pa()).length;Y--;)w[Y].eg();else up.push(Y,this.tileSize);return e},Mw.prototype.createTileInternal=Mw.prototype.Ub,Mw.prototype.D=function(){this.b.D(),this.u.removeEventListener("versionupdate",this.i),S.prototype.D.call(this)},Mw.prototype.dispose=Mw.prototype.D,Mw.prototype.i=function(){var e=this.u;this.B=e.C().clone().F(this.tileType+"/"+e.oc()+"/"+this.scheme).I(Ow).I(this.K),this.reload(!1)};var Ow={metadata:"metaonly",mgen:"2"};function Nw(e){Nw.l.constructor.call(this,Nw,e),e=Sp(this,e),this.f=e.shards,(this.b=e.ignoreTypes?null:e.type)&&this.C().za(this.b),this.c=e.version,this.j=new $p,"newest"===this.c&&Pw(this)}function Qw(e,o){for(var f={},m=e[o+"s"][o],w=m.length;w--;)f[m[w].id]=m[w];e[o+"s"]=f}function Pw(e){var o=e.C().clone().F("info").I({output:"json"});e.f&&o.za(e.f[0]),e.G(o,function(f){var m;if(Qw(f=f.response,"map"),Qw(f,"scheme"),Qw(f,"tiletype"),Qw(f,"format"),Qw(f,"resolution"),Qw(f,"language"),"newest"===e.c&&"traffic"!==e.b)for(m in f.maps)f.maps[m].hash&&f.maps[m].newest&&(e.c=f.maps[m].hash,e.dispatchEvent("versionupdate"));e.m=f,e.dispatchEvent("infoupdate")},function(f){throw f})}u(Nw,Rp),t("H.service.metaInfo.Service",Nw),Nw.prototype.Ia=function(){return{type:"base",version:"newest",subDomain:"maps.ls",path:"maptile/2.1",shards:["1","2","3","4"]}},Nw.CONFIG_KEY="metaInfo",Nw.prototype.Ej=function(){return this.b},Nw.prototype.oc=function(){return this.c},Nw.prototype.getVersion=Nw.prototype.oc,Nw.prototype.ba=function(){return this.j},Nw.prototype.getCopyrights=Nw.prototype.ba,Nw.prototype.Be=function(){return this.m},Nw.prototype.getInfo=Nw.prototype.Be,Nw.prototype.qe=function(e,o,f,m,w,k){return new Mw(this,m,{tileSize:e,pixelRatio:o,categoryFilter:f,tileType:w,scheme:k})},Nw.prototype.createTileProvider=Nw.prototype.qe,Nw.prototype.ic=function(e,o,f,m,w,k){return new ql(this.qe(e,o,f,m,w,k))},Nw.prototype.createTileLayer=Nw.prototype.ic,W.prototype.tj=function(e){return this.Ma(Nw,e)},W.prototype.getMetaInfoService=W.prototype.tj,function(){var e=W.prototype.createDefaultLayers;W.prototype.createDefaultLayers=function(o,f,m,w,k,Y){var _e=e.call(this,o,f,m,w,k,Y),_o={},_u=this.tj();"object"==typeof o&&(o=(Y=o).tileSize,f=Y.ppi,m=Y.lg,w=Y.lg2,k=Y.style,Y=Y.pois),o=o||256;var pd=320===f?2:1;if(0>[72,250,320,500].indexOf(+f)){if(f!==B)throw new D(this.qf,1,f)}else _o.ppi=+f;return m&&(_o.lg=m),w&&(_o.lg2=w),k&&(_o.style=k),Y&&(_o.pois=Y),_e.raster.normal.metaInfo=_u.ic(o,pd,["buildings"],_o),_e}}(),H.__bootstrap__='var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(a,b){if(b){var c=ba;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}var ea;\nif("function"==typeof Object.setPrototypeOf)ea=Object.setPrototypeOf;else{var fa;a:{var ha={lb:!0},ja={};try{ja.__proto__=ha;fa=ja.lb;break a}catch(a){}fa=!1}ea=fa?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ka=ea;ca("Object.setPrototypeOf",function(a){return a||ka});var p=this||self;\nfunction la(a,b,c){a=a.split(".");c=c||p;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function ma(){}\nfunction na(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";\nelse if("function"==b&&"undefined"==typeof a.call)return"object";return b}function r(a){return"function"==na(a)}function oa(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var pa="closure_uid_"+(1E9*Math.random()>>>0),ra=0;function sa(a,b,c){return a.call.apply(a.bind,arguments)}\nfunction ta(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function ua(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ua=sa:ua=ta;return ua.apply(null,arguments)}\nfunction va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function t(a,b){la(a,b,void 0)}function wa(a,b){function c(){}c.prototype=b.prototype;a.U=b.prototype;a.prototype=new c;a.prototype.constructor=a};function v(){}t("H.util.ICache",v);v.prototype.add=function(){};v.prototype.add=v.prototype.add;v.prototype.get=function(){};v.prototype.get=v.prototype.get;v.prototype.sa=function(){};v.prototype.drop=v.prototype.sa;v.prototype.forEach=function(){};v.prototype.forEach=v.prototype.forEach;v.prototype.S=function(){};v.prototype.removeAll=v.prototype.S;v.prototype.aa=function(){};v.prototype.registerOnDrop=v.prototype.aa;v.prototype.qa=function(){};v.prototype.deRegisterOnDrop=v.prototype.qa;function xa(){var a=ya,b;for(b in a)return!1;return!0}function za(a){var b={},c;for(c in a)b[c]=a[c];return b}var Aa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ba(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Aa.length;f++)c=Aa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Ca=this;function Da(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Da);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}wa(Da,Error);Da.prototype.name="CustomError";var Ea=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var Fa=ua,Ga=String,Ha=Ca.Object.freeze||function(a){return a},x=[].pop(),Ia=/x/.exec("");function Ja(a){return Ga(a).split(","!==x?",":" ")}var Ma="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Na(a,b,c,d){if(!(b=a instanceof b)&&c)throw new y(c,d,void 0!==x?void 0:a);return b}function Oa(a,b,c,d){var e;if(!(e="Array"===Pa(a))&&b)throw new y(b,c,d!==x?d:a);return e}\nt("H.lang.isArray",function(a,b,c,d){return Oa(a,b,c,d)});function Qa(a){return"string"===typeof a}t("H.lang.isString",Qa);var Ra=isNaN;function Sa(a){return a===+a}t("H.lang.isNumber",Sa);t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(a){return"number"===typeof a&&0===a%1});function Pa(a){var b=Object[Ma[0]][Ma[6]].call(a).match(/^\\[object (\\w+)\\]$/);return b?b[1]:typeof a}var Ta=[];0>Ta.indexOf(Ta)&&Ta.push(Ta);\nfunction Ua(a,b,c,d){var e="",f=2>arguments.length,g;f&&(b={H:Ca.H},c="",d=Ta.slice());Va(b,!0,function(h,k){try{if(g=h[k],k=Wa(h,g),!(oa(g)&&g.window===g&&g.self===g||oa(g)&&0<g.nodeType&&r(g.cloneNode))&&oa(g)){if(g===a)return e=c+"."+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=Ua(a,g,c+"."+k,d)))return!0}}catch(m){}});f&&(e=e?e.substr(1).replace("."+Ma[0]+".","#"):"~"+(r(a)?Xa(a)+"()":Pa(a)));return e}\nfunction Wa(a,b){var c=[];Va(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(Ya)[0]}function Ya(a,b){return b.length-a.length}var Za=Object[Ma[0]][Ma[2]];function Va(a,b,c){var d;if(a){for(e in a)if((!b||Za.call(a,e))&&c(a,e,!0))return;for(d=Ma.length;d--;){var e=Ma[d];if((!b||Za.call(a,e))&&c(a,e,!1))break}}}function Xa(a){return(a=/^\\s*function ([^\\( ]+)/.exec(a))?a[1]:"anonymous"}function $a(a,b,c){c[b]="#"+b};function A(a,b,c){this.g=[];b&&this.aa(b);if(c&&!r(c))throw new y(A,2,c);this.b=0;this.filter=c;this.a={};this.f=this.c=null;this.Ha(a)}t("H.util.Cache",A);A.prototype.add=function(a,b,c){var d,e;c=+c;if(!Sa(c)||0>c)throw new y(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.a[a])?(d.data!==b&&ab(this,d),this.b+=c-d.size,d.size=c,d.data=b,eb(this,d)):this.a[a]=fb(this,{id:a,data:b,size:c,m:null,C:null},this.c),gb(this);return e};A.prototype.add=A.prototype.add;\nA.prototype.aa=function(a){if(!r(a))throw new y(this.aa,0,a);this.g.push(a)};A.prototype.registerOnDrop=A.prototype.aa;A.prototype.qa=function(a){this.g=this.g.filter(function(b){return b!==a})};A.prototype.deRegisterOnDrop=A.prototype.qa;A.prototype.get=function(a,b){return(a=b?this.a[a]:eb(this,this.a[a]))&&a.data};A.prototype.get=A.prototype.get;A.prototype.sa=function(a){var b;(b=this.a[a])&&hb(this,b,!0)};A.prototype.drop=A.prototype.sa;\nA.prototype.forEach=function(a,b,c){var d;for(d in this.a){var e=this.a[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};A.prototype.forEach=A.prototype.forEach;A.prototype.S=function(a){var b;for(b in this.a){var c=this.a[b];(a?a(b,c.data,c.size):1)&&hb(this,this.a[b],!0)}};A.prototype.removeAll=A.prototype.S;A.prototype.Ha=function(a){if(!(0<+a))throw new y(A.prototype.Ha,0,a);this.i=+a;gb(this);return this};A.prototype.setMaxSize=A.prototype.Ha;A.prototype.Bb=function(){return this.i};\nA.prototype.getMaxSize=A.prototype.Bb;A.prototype.xb=function(){return this.b};A.prototype.getCurrentSize=A.prototype.xb;function eb(a,b){b&&(a.c=fb(a,b,a.c));return b}function gb(a){for(;a.b>a.i&&a.f;)hb(a,a.f,!0)}function fb(a,b,c){if(c!==b){(b.m||b.C)&&hb(a,b,!1);if(b.m=c)b.C=c.C,c.C=b;b.C||(a.c=b);b.m||(a.f=b);a.b+=b.size}return b}function hb(a,b,c){var d=b.C,e=b.m;if(d||e||b==a.c&&b==a.f)d?d.m=e:a.c=e,e?e.C=d:a.f=d,a.b-=b.size,c&&(delete a.a[b.id],ab(a,b));b.m=b.C=null}\nfunction ab(a,b){for(var c=a.g.length;c--;)a.g[c].call(a,b.id,b.data,b.size)};function B(){}t("H.service.extension.dataView.ITable",B);B.prototype.xa=function(){};B.prototype.getMeta=B.prototype.xa;B.prototype.ya=function(){};B.prototype.getRowCount=B.prototype.ya;B.prototype.ga=function(){};B.prototype.getRow=B.prototype.ga;B.prototype.A=function(){};B.prototype.getColumnNames=B.prototype.A;B.prototype.wa=function(){};B.prototype.getColumn=B.prototype.wa;B.prototype.l=function(){};B.prototype.getCell=B.prototype.l;B.prototype.concat=function(){};B.prototype.concat=B.prototype.concat;function ib(){}t("H.service.extension.dataView.IRow",ib);ib.prototype.A=function(){};ib.prototype.getColumnNames=ib.prototype.A;ib.prototype.l=function(){};ib.prototype.getCell=ib.prototype.l;ib.prototype.za=function(){};ib.prototype.getTable=ib.prototype.za;function jb(a,b){this.a=a;this.b=b}t("H.service.extension.dataView.ObjRow",jb);jb.prototype.A=function(){return this.a.A()};jb.prototype.getColumnNames=jb.prototype.A;jb.prototype.l=function(a){return this.a.l(this.b,a)};jb.prototype.getCell=jb.prototype.l;jb.prototype.za=function(){return this.a};jb.prototype.getTable=jb.prototype.za;function kb(){}t("H.service.extension.dataView.IColumn",kb);kb.prototype.l=function(){};kb.prototype.getCell=kb.prototype.l;function lb(a,b){this.b=a;this.a=b}t("H.service.extension.dataView.ObjColumn",lb);lb.prototype.l=function(a){return this.b.l(a,this.a)};lb.prototype.getCell=lb.prototype.l;function y(a,b,c){var d=arguments.length;b=b!==x?+b:b;if(b!==x){var e=(e=/^.*?\\(([^\\)]+)/.exec((""+a).replace(/(\\/\\*([\\s\\S]*?)\\*\\/)|(\\/\\/(.*)$)/gm,"")))?Ja(e[1].replace(/\\s+/g,"")):[];e.forEach($a);e=e[b]||"#"+b}var f=a?Ua(a):"";d=2<d?Ga(c):"";if(e||d)f+=" (Argument "+(e||"")+(d?" "+d:"")+")";d=Error(f);Object.setPrototypeOf(d,y.prototype);return d}wa(y,Error);t("H.lang.InvalidArgumentError",y);y.prototype.name="InvalidArgumentError";function C(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):x);this.D=a;if(b)for(this.M=b,this.pa=a=Object.create(Ia,void 0),d=b.length;d--;)a[b[d]]=!0;c!==x&&(this.Ca=c)}t("H.service.extension.dataView.ObjTable",C);l=C.prototype;l.Ca=x;l.D=x;l.M=x;l.pa=x;l.xa=function(){return this.Ca};C.prototype.getMeta=C.prototype.xa;C.prototype.ya=function(){return this.D?this.D.length:0};C.prototype.getRowCount=C.prototype.ya;C.prototype.ga=function(a){var b=this.D;return b&&b[a]?new jb(this,a):x};\nC.prototype.getRow=C.prototype.ga;C.prototype.A=function(){return this.M||mb};C.prototype.getColumnNames=C.prototype.A;C.prototype.wa=function(a){return this.pa[a]?new lb(this,a):x};C.prototype.getColumn=C.prototype.wa;C.prototype.l=function(a,b){var c=this.D;return(a=c&&this.pa[b]&&c[a])&&a[b]};C.prototype.getCell=C.prototype.l;\nC.prototype.concat=function(){var a=arguments.length,b,c=this.M,d=""+this.M,e=(this.D||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof C))throw new y(this.concat,b);if(f.D){if(c&&""+f.M!==d)throw new y(this.concat,b,"Incompatible columns!");e=e.concat(f.D)}}return new C(e,this.M,this.Ca)};C.prototype.concat=C.prototype.concat;var D=Math,nb=D.min,ob=D.max,pb=D.round,qb=D.floor,rb=D.ceil,sb=D.abs,tb=D.log,ub=D.sqrt,vb=D.pow,wb=D.exp,xb=D.sin,yb=D.asin,zb=D.cos,Ab=D.tan,Bb=D.atan,Cb=D.atan2,Db=D.LN2,E=D.PI,Eb=E/2,Fb=E/4,Gb=2*E,Hb=3*E,Ib=E/180,Kb=180/E,Lb=1/0;vb(-2,53);function Mb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}t("H.math.normalize",function(a,b,c){b-=c=c||0;a-=c;return a-qb(a/b)*b+c});function Nb(a,b,c){return a>c?c:a<b?b:a}t("H.math.clamp",Nb);function Ob(a,b,c){return b<c?a>=b&&a<=c:a>=c&&a<=b}\nfunction Pb(a,b,c,d,e,f){return ub(vb((a-e)*(d-f)-(b-f)*(c-e),2)/(vb(c-e,2)+vb(d-f,2)))}var Qb={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",Qb);\nfunction Rb(a,b,c){for(var d=c.length,e=d,f,g,h,k,m=c[0],n=0,q=0,u=0;1!=n&&1<e;){g=c[--e];f=c[--e];k=c[e?e-1:(d+(e-1))%d];h=c[e?e-2:(d+(e-2))%d];if(f>=a&&f<=a&&g>=b&&g<=b||h>=a&&h<=a&&k>=b&&k<=b)n=1;else if(!n&&f===a)h===a&&(g<b&&k>b||g>b&&k<b)||(m<=a&&h>a||m>=a&&h<a)&&(g>=b?++q:++u),n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0;else if(!n&&Ob(a,f,h)){if(f<a&&h>a||f>a&&h<a)m=g+(a-f)/(h-f)*(k-g),q+=m>b,u+=m<b;n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0}m=f}!n&&0!==u&&0!==q%2&&(n=3);return n}\nfunction Sb(a,b){return Rb(a.x,a.y,b)!==Qb.NONE}t("H.math.isPointInsidePolygon",Sb);function Tb(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&a[0].x!==x;b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}t("H.math.flatten",Tb);function F(a,b){this.x=+a;this.y=+b}t("H.math.Point",F);F.prototype.set=F;F.prototype.set=F.prototype.set;F.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new F(this.x,this.y);return a};F.prototype.clone=F.prototype.clone;F.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};F.prototype.add=F.prototype.add;F.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};F.prototype.sub=F.prototype.sub;F.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};\nF.prototype.scale=F.prototype.scale;F.prototype.round=function(){this.x=pb(this.x);this.y=pb(this.y);return this};F.prototype.round=F.prototype.round;F.prototype.floor=function(){this.x=qb(this.x);this.y=qb(this.y);return this};F.prototype.floor=F.prototype.floor;F.prototype.ceil=function(){this.x=rb(this.x);this.y=rb(this.y);return this};F.prototype.ceil=F.prototype.ceil;F.prototype.F=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};F.prototype.equals=F.prototype.F;\nF.prototype.Cb=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=a;if(c||d){var f=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d);0>=f?e=a:1<=f?e=b:e=new F(a.x+f*c,a.y+f*d)}return e};F.prototype.getNearest=F.prototype.Cb;F.prototype.ra=function(a){return ub(vb(this.x-a.x,2)+vb(this.y-a.y,2))};F.prototype.distance=F.prototype.ra;F.fromIPoint=function(a){if(!a)throw Error("invalid argument");return a instanceof F?a:new F(a.x,a.y)};function Ub(a,b,c,d,e,f){var g,h,k=a.length,m,n;if(k)for(g=[];k--;){var q=a[k];var u=q.length;var I=0;for(m=1;m<u;m++)if(n=Vb(q[m-1],q[m],c,b,d,e)){var L=n[0];var w=n[1];I&&I.F(L)?h.push(w):g.push(h=n);I=w;f&&(m=u,k=0)}}else g=a;return g}t("H.math.clipping.clipStrips",Ub);\nfunction Vb(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var m=a;g=h;a=b;h=k;b=m;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var n=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);n&&(a=-a,b=-b);return k?[new F(h,-b),new F(g,-a)]:[new F(g,-a),new F(h,-b)]}\nfunction Wb(a,b,c){a=Xb(a,!0);b=Xb(b,!1);var d,e;var f={};var g=d=1;switch(~~(c||0)){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.W=new Yb(b.x,b.y,null,Zb(b));a.W=new Yb(a.x,a.y,null,Zb(a));for(g=b;g.next;g=g.next)if(!g.u)for(d=a;d.next;d=d.next)if(!d.u){var k=$b(g.next);var m=$b(d.next);if(e=ac(g,k,d,m,f)){e=f.mb;var n=f.nb;var q=f.ec;var u=f.fc;e=new Yb(q,u,null,null,null,null,!0,0,0,e);bc(e,g,k);k=new Yb(q,u,null,null,null,null,!0,0,0,n);bc(k,d,m);e.Da=k;k.Da=e}}f=\nSb(b,cc(a));c&&(f=!f);for(g=b;g;g=g.next)g.u&&(g.Aa=f,f=!f);f=Sb(a,cc(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.u&&(d.Aa=f,f=!f);dc(b);for(dc(a);(a=ec(b))!=b;){for(c=null;!a.na;a=a.Da){for(f=a.Aa;;){c=new Yb(a.x,a.y,c);c.artificial=a.u||a.Wa;a.na=1;a=f?a.next:a.o;if(!a)break;if(a.u){a.na=1;break}}if(!a)break}c.Za=I||null;var I=c}return I}}t("H.math.clipping.clipPolygon",Wb);\nfunction Yb(a,b,c,d,e,f,g,h,k,m){this.x=a;this.y=b;this.next=c||null;this.o=d||null;this.Za=e||null;this.Da=f||null;this.u=!!g;this.Aa=!!h;this.na=k||0;this.alpha=m||0;d&&(d.next=this);c&&(c.o=this);this.Wa=!1;this.W=null}function $b(a){for(;a&&a.u;)a=a.next;return a}function Zb(a){if(a)for(;a.next;)a=a.next;return a}function ec(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.u||b.u&&b.na))}return b}function dc(a){var b=Zb(a);b.o.next=a;a.o=b.o}\nfunction ac(a,b,c,d,e){var f,g=b.x-a.x,h=b.y-a.y;var k=d.x-c.x;var m=d.y-c.y;var n=g*m-h*k;if(!n)return 0;k=((c.x-a.x)*m-(c.y-a.y)*k)/n;n=(h*(c.x-a.x)-g*(c.y-a.y))/n;if(0>k||1<k||0>n||1<n)return 0;0===k?f=a:1===k?f=b:0===n?f=c:1===n&&(f=d);if(f)return f.x+=2.480549651603763E-5,f.y+=7.321997314118067E-5,f.W&&(f.W.x=f.x,f.W.y=f.y),ac(a,b,c,d,e);e.ec=a.x+k*g;e.fc=a.y+k*h;e.mb=k;e.nb=n;return 1}function cc(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}\nfunction bc(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.o=b.o;a.next.o=a;a.o.next=a}function Xb(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=new Yb(a[e].x,a[e].y,d);c.Wa=b;if(c.next=d)d.o=c;d=c}return d};function fc(a,b){var c=[];a&&c.push(Ua(a));1<arguments.length&&c.push(""+b);c=Error(c.join(" "));Object.setPrototypeOf(c,fc.prototype);return c}wa(fc,Error);t("H.lang.IllegalOperationError",fc);fc.prototype.name="IllegalOperationError";function gc(){this.constructor=this.constructor;if(!Qa("STATIC_DB"))throw new y(this.constructor,0);this.i=hc();if(!this.i)throw new fc(this.constructor,"This browser does not support IndexedDB");this.a=[];this.c=[];this.g=Fa(this.g,this)}var ic,jc;gc.prototype.get=function(a,b,c){var d;if(!Qa(a)&&!Sa(a))throw new y(this.get,0);if(!r(b))throw new y(this.get,1);kc(this,function(e){d=e.get(a);lc(d,b,c)},c);return{cancel:function(){d&&(d.onsuccess=mc)}}};\ngc.prototype.g=function(){var a=this.b.result;a.objectStoreNames.contains("data")||a.createObjectStore("data")};\nfunction nc(a,b,c){if(a.b)a.a?(a.a.push(b),c&&a.c.push(c)):a.f?c&&c(a.f):b(a.b.result);else{a.b=a.i.open("H_STATIC_DB",1);a.b.onupgradeneeded=a.g;var d=a.b.onerror=function(){clearTimeout(a.j);a.f=this.error;a.c.forEach(function(e){e(a.f)});delete a.a;delete a.c};a.j=setTimeout(function(){d.call({error:Error("DbOpenTimeoutError")})},500);a.b.onsuccess=function(){clearTimeout(a.j);a.a?(a.a.forEach(function(e){e(this.result)},this),delete a.a,delete a.c):(delete a.b,delete a.f,a.a=[],a.c=[])};\na.a.push(b);c&&a.c.push(c)}}function kc(a,b,c){nc(a,function(d){d=d.transaction(["data"],"readwrite");b(d.objectStore("data"))},c)}function lc(a,b,c){b&&(a.onsuccess=function(){b(this.result)});c&&(a.onerror=function(){c(this.error)})}t("H.util.IndexedDBStorage.getInstance",function(){ic||(ic=new gc);return ic});function hc(){return Ca.indexedDB||Ca.webkitIndexedDB||Ca.mozIndexedDB||Ca.msIndexedDB}\nt("H.util.IndexedDBStorage.isSupported",function(){var a="";if(jc===x)if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)jc=!1;else{try{var b=hc();a="H_TEST_DB";var c=b&&b.open(a,1)}catch(d){}jc=!!c&&null===c.onupgradeneeded;c&&b.deleteDatabase&&b.deleteDatabase(a)}return jc});function J(){0!=oc&&(pc[this[pa]||(this[pa]=++ra)]=this);this.c=this.c;this.a=this.a}var oc=0,pc={};J.prototype.c=!1;J.prototype.s=function(){if(!this.c&&(this.c=!0,this.v(),0!=oc)){var a=this[pa]||(this[pa]=++ra);if(0!=oc&&this.a&&0<this.a.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass\' method.");delete pc[a]}};\nJ.prototype.L=function(a,b){this.c?void 0!==b?a.call(b):a():(this.a||(this.a=[]),this.a.push(void 0!==b?ua(a,b):a))};J.prototype.v=function(){if(this.a)for(;this.a.length;)this.a.shift()()};function K(a,b){this.type=a;this.currentTarget=this.target=b;this.a=!1;this.ab=!0}K.prototype.stopPropagation=function(){this.a=!0};K.prototype.c=function(){this.ab=!1};t("H.util.Event",K);K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.CAPTURING_PHASE=1;K.prototype.CAPTURING_PHASE=K.prototype.CAPTURING_PHASE;K.prototype.AT_TARGET=2;K.prototype.AT_TARGET=K.prototype.AT_TARGET;K.prototype.BUBBLING_PHASE=3;K.prototype.BUBBLING_PHASE=K.prototype.BUBBLING_PHASE;K.prototype.eventPhase=0;K.prototype.eventPhase=K.prototype.eventPhase;function qc(a,b,c){qc.U.constructor.call(this,a,c);this.data=b}wa(qc,K);t("H.util.DataEvent",qc);function rc(a,b,c){rc.U.constructor.call(this,a,c);this.message=b}wa(rc,K);t("H.util.ErrorEvent",rc);function sc(){}t("H.util.ICancelable",sc);sc.prototype.cancel=function(){};sc.prototype.cancel=sc.prototype.cancel;function tc(a,b){this.c=a;this.f=b;this.b=0;this.a=null}tc.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};function uc(a,b){a.f(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};function vc(){this.b=this.a=null}var xc=new tc(function(){return new wc},function(a){a.reset()});vc.prototype.add=function(a,b){var c=xc.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};function yc(){var a=zc,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function wc(){this.next=this.b=this.a=null}wc.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};wc.prototype.reset=function(){this.next=this.b=this.a=null};var Ac=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function Bc(a,b){return a<b?-1:a>b?1:0};var Cc;a:{var Dc=p.navigator;if(Dc){var Ec=Dc.userAgent;if(Ec){Cc=Ec;break a}}Cc=""}function M(a){return-1!=Cc.indexOf(a)};function Hc(a,b){this.b=a===Ic&&b||"";this.a=Jc}var Jc={},Ic={},Kc=new Hc(Ic,"");function Lc(a,b){this.b=a===Mc&&b||"";this.a=Nc}var Nc={},Mc={};function Oc(){this.a="";this.b=Pc}function Qc(){var a=Rc;if(a instanceof Oc&&a.constructor===Oc&&a.b===Pc)return a.a;na(a);return"type_error:SafeHtml"}var Pc={};function Sc(a){var b=new Oc;b.a=a;return b}Sc("<!DOCTYPE html>");var Rc=Sc("");Sc("<br>");function Tc(a){var b=new Lc(Mc,Kc instanceof Hc&&Kc.constructor===Hc&&Kc.a===Jc?Kc.b:"type_error:Const");b instanceof Lc&&b.constructor===Lc&&b.a===Nc?b=b.b:(na(b),b="type_error:TrustedResourceUrl");a.src=b.toString()};function Uc(a){Uc[" "](a);return a}Uc[" "]=ma;var Vc=M("Opera"),Wc=M("Trident")||M("MSIE"),Xc=M("Edge"),Yc=M("Gecko")&&!(-1!=Cc.toLowerCase().indexOf("webkit")&&!M("Edge"))&&!(M("Trident")||M("MSIE"))&&!M("Edge"),Zc=-1!=Cc.toLowerCase().indexOf("webkit")&&!M("Edge");function $c(){var a=p.document;return a?a.documentMode:void 0}var ad;\na:{var bd="",cd=function(){var a=Cc;if(Yc)return/rv:([^\\);]+)(\\)|;)/.exec(a);if(Xc)return/Edge\\/([\\d\\.]+)/.exec(a);if(Wc)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(Zc)return/WebKit\\/(\\S+)/.exec(a);if(Vc)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();cd&&(bd=cd?cd[1]:"");if(Wc){var dd=$c();if(null!=dd&&dd>parseFloat(bd)){ad=String(dd);break a}}ad=bd}var ed={},fd;fd=p.document&&Wc?$c():void 0;function gd(a){var b=document;a=String(a);"application/xhtml+xml"===b.contentType&&(a=a.toLowerCase());return b.createElement(a)};function hd(a){p.setTimeout(function(){throw a;},0)}var id;\nfunction jd(){var a=p.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!M("Presto")&&(a=function(){var e=gd("IFRAME");e.style.display="none";Tc(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(Qc());e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=ua(function(k){if(("*"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},\nthis);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!M("Trident")&&!M("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Pa;c.Pa=null;e()}};return function(e){d.next={Pa:e};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in gd("SCRIPT")?function(e){var f=gd("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;\nf.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){p.setTimeout(e,0)}};function kd(a,b){ld||md();nd||(ld(),nd=!0);zc.add(a,b)}var ld;function md(){if(p.Promise&&p.Promise.resolve){var a=p.Promise.resolve(void 0);ld=function(){a.then(od)}}else ld=function(){var b=od;!r(p.setImmediate)||p.Window&&p.Window.prototype&&!M("Edge")&&p.Window.prototype.setImmediate==p.setImmediate?(id||(id=jd()),id(b)):p.setImmediate(b)}}var nd=!1,zc=new vc;function od(){for(var a;a=yc();){try{a.a.call(a.b)}catch(b){hd(b)}uc(xc,a)}nd=!1};function pd(a){this.a=qd;this.j=void 0;this.f=this.b=this.c=null;this.g=this.i=!1;if(a!=ma)try{var b=this;a.call(void 0,function(c){rd(b,sd,c)},function(c){rd(b,td,c)})}catch(c){rd(this,td,c)}}var qd=0,sd=2,td=3;function ud(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}ud.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var vd=new tc(function(){return new ud},function(a){a.reset()});function wd(a,b,c){var d=vd.get();d.f=a;d.b=b;d.c=c;return d}\nfunction xd(a,b,c){yd(a,b,c,null)||kd(va(b,a))}function zd(a){return new pd(function(b,c){var d=a.length,e=[];if(d)for(var f=function(m,n){d--;e[m]=n;0==d&&b(e)},g=function(m){c(m)},h=0,k;h<a.length;h++)k=a[h],xd(k,va(f,h),g);else b(e)})}function Ad(){var a,b,c=new pd(function(d,e){a=d;b=e});return new Bd(c,a,b)}pd.prototype.then=function(a,b,c){return Cd(this,r(a)?a:null,r(b)?b:null,c)};pd.prototype.$goog_Thenable=!0;\npd.prototype.cancel=function(a){if(this.a==qd){var b=new Dd(a);kd(function(){Ed(this,b)},this)}};function Ed(a,b){if(a.a==qd)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==qd&&1==d?Ed(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Fd(c),Gd(c,e,td,b)))}a.c=null}else rd(a,td,b)}function Hd(a,b){a.b||a.a!=sd&&a.a!=td||Id(a);a.f?a.f.next=b:a.b=b;a.f=b}\nfunction Cd(a,b,c,d){var e=wd(null,null,null);e.a=new pd(function(f,g){e.f=b?function(h){try{var k=b.call(d,h);f(k)}catch(m){g(m)}}:f;e.b=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof Dd?g(h):f(k)}catch(m){g(m)}}:g});e.a.c=a;Hd(a,e);return e.a}pd.prototype.Ea=function(a){this.a=qd;rd(this,sd,a)};pd.prototype.Ga=function(a){this.a=qd;rd(this,td,a)};\nfunction rd(a,b,c){a.a==qd&&(a===c&&(b=td,c=new TypeError("Promise cannot resolve to itself")),a.a=1,yd(c,a.Ea,a.Ga,a)||(a.j=c,a.a=b,a.c=null,Id(a),b!=td||c instanceof Dd||Jd(a,c)))}function yd(a,b,c,d){if(a instanceof pd)return Hd(a,wd(b||ma,c||null,d)),!0;if(a)try{var e=!!a.$goog_Thenable}catch(g){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(oa(a))try{var f=a.then;if(r(f))return Kd(a,f,b,c,d),!0}catch(g){return c.call(d,g),!0}return!1}\nfunction Kd(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function Id(a){a.i||(a.i=!0,kd(a.P,a))}function Fd(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}pd.prototype.P=function(){for(var a;a=Fd(this);)Gd(this,a,this.a,this.j);this.i=!1};\nfunction Gd(a,b,c,d){if(c==td&&b.b&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Ld(b,c,d);else try{b.g?b.f.call(b.c):Ld(b,c,d)}catch(e){Md.call(null,e)}uc(vd,b)}function Ld(a,b,c){b==sd?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function Jd(a,b){a.g=!0;kd(function(){a.g&&Md.call(null,b)})}var Md=hd;function Dd(a){Da.call(this,a)}wa(Dd,Da);Dd.prototype.name="cancel";function Bd(a,b,c){this.a=a;this.b=b;this.reject=c};function Nd(a,b,c){this.type=a;this.data=b;this.a=Ad();this.Xa=Fa(this.Xa,this);this.reject=Fa(this.reject,this);this.priority=Od;c!==x&&(this.priority=c);this.b().add(this)}var Od=1,Pd={hc:0,ic:Od,gc:2};l=Nd.prototype;l.then=function(a,b,c){return this.a.a.then(a,b,c)};l.Xa=function(a){this.Z=3;this.a.b(a)};l.reject=function(a){this.Z=5;this.a.reject(a)};l.Z=0;\nl.cancel=function(){if(3>this.Z){this.c();var a=this.b(),b=this.priority,c=a.a[b].indexOf(this);-1<c?a.a[b].splice(c,1):this.Ma&&a.ca.qb(this.Ma);this.Z=4}};Nd.prototype.cancel=Nd.prototype.cancel;function Qd(a){var b;this.a={};for(b in Pd)this.a[Pd[b]]=[];this.ca=a;this.ca.addEventListener("allocatable",Fa(this.b,this))}t("H.util.JobManager",Qd);var Rd=Object.keys(Pd).map(function(a){return Pd[a]}).sort().reverse();Qd.prototype.add=function(a){Na(a,Nd,this.add,0);this.a[a.priority].push(a);this.b()};Qd.prototype.contains=function(a){return-1<this.a[a.priority].indexOf(a)};\nQd.prototype.b=function(){Rd.forEach(function(a){this.a[a]=this.a[a].filter(function(b){var c;if((c=this.ca.jc(b))!==Ia){var d=Fa(this.ca.qb,this.ca,c,b);b.Ma=c;b.then(d,d);b.Z=b.kc(c)?1:5}else return!0},this)},this)};function Sd(a,b,c){var d=[],e=arguments.length;a&&d.push(Ua(a));1<e&&(e=2<e&&Oa(c,void 0,void 0,void 0)?" out of ["+c[0]+"..."+c[1]+"]":"",d.push("("+b+e+")"));d=Error(d.join(" "));Object.setPrototypeOf(d,Sd.prototype);return d}wa(Sd,Error);t("H.lang.OutOfRangeError",Sd);Sd.prototype.name="OutOfRangeError";var Td="closure_listenable_"+(1E6*Math.random()|0),Ud=0;function Vd(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.ha=e;this.key=++Ud;this.T=this.da=!1}function Wd(a){a.T=!0;a.listener=null;a.proxy=null;a.src=null;a.ha=null};function Xd(a){this.src=a;this.a={};this.b=0}Xd.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=Yd(a,b,d,e);-1<g?(b=a[g],c||(b.da=!1)):(b=new Vd(b,this.src,f,!!d,e),b.da=c,a.push(b));return b};function Zd(a,b){var c=b.type;if(c in a.a){var d=a.a[c],e=Ea(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(Wd(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}\nXd.prototype.S=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,Wd(d[e]);delete this.a[c];this.b--}return b};function Yd(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.T&&f.listener==b&&f.capture==!!c&&f.ha==d)return e}return-1};var $d;($d=!Wc)||($d=9<=Number(fd));var ae=$d,be;\nif(be=Wc){var ce;if(Object.prototype.hasOwnProperty.call(ed,"9"))ce=ed["9"];else{for(var de=0,ee=Ac(String(ad)).split("."),fe=Ac("9").split("."),ge=Math.max(ee.length,fe.length),he=0;0==de&&he<ge;he++){var ie=ee[he]||"",je=fe[he]||"";do{var ke=/(\\d*)(\\D*)(.*)/.exec(ie)||["","","",""],le=/(\\d*)(\\D*)(.*)/.exec(je)||["","","",""];if(0==ke[0].length&&0==le[0].length)break;de=Bc(0==ke[1].length?0:parseInt(ke[1],10),0==le[1].length?0:parseInt(le[1],10))||Bc(0==ke[2].length,0==le[2].length)||Bc(ke[2],le[2]);\nie=ke[3];je=le[3]}while(0==de)}ce=ed["9"]=0<=de}be=!ce}var me=be,ne=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{p.addEventListener("test",ma,b),p.removeEventListener("test",ma,b)}catch(c){}return a}();function oe(a,b){K.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(Yc){a:{try{Uc(b.nodeName);var e=!0;break a}catch(f){}e=\n!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=\na.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:pe[a.pointerType]||"";this.b=a;a.defaultPrevented&&this.c()}}wa(oe,K);var pe={2:"touch",3:"pen",4:"mouse"};oe.prototype.stopPropagation=function(){oe.U.stopPropagation.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};\noe.prototype.c=function(){oe.U.c.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,me)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var qe="closure_lm_"+(1E6*Math.random()|0),re={},se=0;function te(a,b,c,d,e){if(d&&d.once)ue(a,b,c,d,e);else if("array"==na(b))for(var f=0;f<b.length;f++)te(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!1,oa(d)?!!d.capture:!!d,e):we(a,b,c,!1,d,e)}\nfunction we(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=oa(e)?!!e.capture:!!e,h=xe(a);h||(a[qe]=h=new Xd(a));c=h.add(b,c,d,g,f);if(!c.proxy){d=ye();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ne||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ze(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");se++}}\nfunction ye(){var a=Ae,b=ae?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function ue(a,b,c,d,e){if("array"==na(b))for(var f=0;f<b.length;f++)ue(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!0,oa(d)?!!d.capture:!!d,e):we(a,b,c,!0,d,e)}\nfunction Be(a,b,c,d,e){if("array"==na(b))for(var f=0;f<b.length;f++)Be(a,b[f],c,d,e);else(d=oa(d)?!!d.capture:!!d,c=ve(c),a&&a[Td])?(a=a.b,b=String(b).toString(),b in a.a&&(f=a.a[b],c=Yd(f,c,d,e),-1<c&&(Wd(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=xe(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yd(b,c,d,e)),(c=-1<a?b[a]:null)&&Ce(c))}\nfunction Ce(a){if("number"!==typeof a&&a&&!a.T){var b=a.src;if(b&&b[Td])Zd(b.b,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ze(c),d):b.addListener&&b.removeListener&&b.removeListener(d);se--;(c=xe(b))?(Zd(c,a),0==c.b&&(c.src=null,b[qe]=null)):Wd(a)}}}function ze(a){return a in re?re[a]:re[a]="on"+a}\nfunction De(a,b,c,d){var e=!0;if(a=xe(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.T&&(f=Ee(f,d),e=e&&!1!==f)}return e}function Ee(a,b){var c=a.listener,d=a.ha||a.src;a.da&&Ce(a);return c.call(d,b)}\nfunction Ae(a,b){if(a.T)return!0;if(!ae){if(!b)a:{b=["window","event"];for(var c=p,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new oe(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.a&&0<=e;e--){b.currentTarget=d[e];var f=De(d[e],a,!0,b);c=c&&f}for(e=0;!b.a&&e<d.length;e++)b.currentTarget=\nd[e],f=De(d[e],a,!1,b),c=c&&f}return c}return Ee(a,new oe(b,this))}function xe(a){a=a[qe];return a instanceof Xd?a:null}var Fe="__closure_events_fn_"+(1E9*Math.random()>>>0);function ve(a){if(r(a))return a;a[Fe]||(a[Fe]=function(b){return a.handleEvent(b)});return a[Fe]};function N(){J.call(this);this.b=new Xd(this);this.j=this;this.i=null}wa(N,J);N.prototype[Td]=!0;l=N.prototype;l.B=function(){return this.i};l.la=function(a){this.i=a};l.addEventListener=function(a,b,c,d){te(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Be(this,a,b,c,d)};\nl.dispatchEvent=function(a){var b,c=this.B();if(c)for(b=[];c;c=c.B())b.push(c);c=this.j;var d=a.type||a;if("string"===typeof a)a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);Ba(a,e)}e=!0;if(b)for(var f=b.length-1;!a.a&&0<=f;f--){var g=a.currentTarget=b[f];e=g.N(d,!0,a)&&e}a.a||(g=a.currentTarget=c,e=g.N(d,!0,a)&&e,a.a||(e=g.N(d,!1,a)&&e));if(b)for(f=0;!a.a&&f<b.length;f++)g=a.currentTarget=b[f],e=g.N(d,!1,a)&&e;return e};\nl.v=function(){N.U.v.call(this);this.b&&this.b.S(void 0);this.i=null};l.N=function(a,b,c){a=this.b.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.T&&f.capture==b){var g=f.listener,h=f.ha||f.src;f.da&&Zd(this.b,f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.ab};t("H.util.EventTarget",N);N.prototype.la=N.prototype.la;N.prototype.setParentEventTarget=N.prototype.la;N.prototype.B=N.prototype.B;N.prototype.getParentEventTarget=N.prototype.B;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.dispatchEvent=N.prototype.dispatchEvent;\nN.prototype.dispatchEvent=N.prototype.dispatchEvent;N.prototype.s=N.prototype.s;N.prototype.dispose=N.prototype.s;N.prototype.L=N.prototype.L;N.prototype.addOnDisposeCallback=N.prototype.L;N.prototype.P=N.prototype.N;\nN.prototype.N=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?"AT_TARGET":b?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=c.type)&&"pointerleave"!==e)c.eventPhase=g,f=N.prototype.P.apply(this,arguments),d&&this.B&&null===this.B()&&delete c.eventPhase;return f};N.prototype.Yb=function(a){for(var b,c=this;c&&(b=c.B())&&b!==a;)c=b;b||c.la(a)};N.prototype.setRootParentEventTarget=N.prototype.Yb;function Q(a){a=a||{};var b=a.callback;this.g=a.label;r(b)&&(this.callback=b);this.f=!!a.disabled;Q.U.constructor.call(this)}wa(Q,N);t("H.util.ContextItem",Q);Q.prototype.zb=function(){return this.g};Q.prototype.getLabel=Q.prototype.zb;Q.prototype.Xb=function(a){this.g!==a&&(this.g=a,this.dispatchEvent("update"));return this};Q.prototype.setLabel=Q.prototype.Xb;Q.prototype.Ob=function(){return this.f};Q.prototype.isDisabled=Q.prototype.Ob;\nQ.prototype.Wb=function(a){a!==this.f&&(this.f=a,this.dispatchEvent("update"));return this};Q.prototype.setDisabled=Q.prototype.Wb;var Ge=new Q;Q.SEPARATOR=Ge;function Ie(a){if(Ca.document){var b=document.createElement("canvas");b.width=b.height=1;b.getContext("2d",{lc:a})}}t("H.util.getPixelRatio",function(){return window.devicePixelRatio||1});Object.create(Ia,void 0);t("H.util.eval",function(a){return eval(a)});t("H.util.provide",function(a){var b=p.$jscomp;if(b&&("function"!=typeof b.wb?0:b.wb()))throw Error("goog.provide cannot be used within a module.");la(a,void 0)});function Je(){this.m=0}\nJe.prototype.next=function(a){if(9007199254740992===this.m)throw new Sd(a,this.m,[0,9007199254740991]);return this.m++};var Ke=new Je;Fa(Ke.next,Ke);function mc(){}var mb=Ha([]);Ha({});Ie(!0);Ie(!1);function Le(a,b,c){var d=Nb(+a,-90,90);if(b&&Ra(d))throw new y(b,c,a);return d}function Me(a,b,c){var d=+a;if(-180>d||180<d)d=Mb(d+180,360)-180;if(b&&Ra(d))throw new y(b,c,a);return d}function Ne(a,b,c){var d;if(a!==x&&Ra(d=+a)&&b)throw new y(b,c,a);return d}t("H.geo.isDBC",function(a,b){return 0>a!==0>b&&180<sb(b-a)});function R(){var a=R;if(!0===(Na(this,a)&&this.constructor===a))throw new TypeError("Illegal constructor "+Ua(a));}t("H.geo.AbstractGeometry",R);R.prototype.getBoundingBox=R.prototype.X;R.prototype.equals=R.prototype.F;R.prototype.oa="";R.prototype.va="";R.prototype.toString=function(){return this.eb([this.oa.toUpperCase()," "]).join("")};R.prototype.toString=R.prototype.toString;R.prototype.$b=function(){return{type:this.va,coordinates:this.cb()}};R.prototype.toGeoJSON=R.prototype.$b;\nR.prototype.ta=function(){return{type:this.oa,coordinates:this.ua(),boundingBox:this.X().ta()}};R.prototype.forWorkerMessage=R.prototype.ta;function S(a,b,c){this.lat=Le(a,S,0);this.lng=Me(b,S,1);c!==x&&(this.alt=Ne(c,S,2))}wa(S,R);t("H.geo.Point",S);S.prototype.F=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};S.prototype.equals=S.prototype.F;S.prototype.ra=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Ib;var c=a.lat*Ib;a=1.274200158E7*yb(nb(1,ub(vb(xb((b-c)/2),2)+zb(b)*zb(c)*vb(xb((this.lng*Ib-a.lng*Ib)/2),2))))}return a};\nS.prototype.distance=S.prototype.ra;\nS.prototype.dc=function(a,b,c){var d;if(c){if(d=b/6371000.79){b=a*Ib;a=Ib*this.lat;var e=xb(a);c=xb(d);var f=zb(d);d=Ib*this.lng;var g=zb(a);a=yb(g*zb(b)*c+e*f);b=Cb(xb(b)*g*c,f-e*xb(a));b=(d+b+E)%(2*E)-E;b*=Kb;e=new S(a*Kb,(b+540)%360-180)}return e||this}a=(a%360+360)%360;if(0===(a+90)%180)return a=this.lng+b/(6371000.79*Gb*zb(this.lat*Ib))*(270===a?-360:360),new S(this.lat,(a+540)%360-180);if(b/=6371000.79)a*=Ib,e=this.lat*Ib,c=this.lng*Ib,d=e+b*zb(a),f=d-e,g=tb(Ab(d/2+Fb)/Ab(e/2+Fb)),g=Ra(f/g)?\nzb(e):f/g,a=b*xb(a)/g,sb(d)>Eb&&(d=0<d?E-d:-(E+d)),d=new S(d*Kb,((c+a+Hb+(sb(e+f)>Eb?E:0))%Gb-E)*Kb);return d||this};S.prototype.walk=S.prototype.dc;S.prototype.X=function(){return new V(this.lat,this.lng,this.lat,this.lng)};S.prototype.getBoundingBox=S.prototype.X;function Oe(a,b,c){var d=oa(a)&&!(Ra(a.lat=Le(a.lat))||Ra(a.lng=Me(a.lng))||a.alt!==x&&Ra(a.alt=Ne(a.alt)));if(!d&&b)throw new y(b,c,a);return d}S.validate=Oe;function Pe(a){if(!a)throw new y(Pe,0,a);return new S(a.lat,a.lng,a.alt)}\nS.fromIPoint=Pe;l=S.prototype;l.oa="Point";l.eb=function(a){a.push("(",this.lng," ",this.lat,")");return a};l.va="Point";l.cb=function(){return[this.lng,this.lat,this.alt||0]};l.ua=function(){return[this.lat,this.lng,this.alt||0]};function Qe(){}function Re(a){return nb(1,ob(0,.5-tb(Ab(Fb+Eb*a/180))/E/2))}Qe.prototype.ia=function(a,b,c){c?(c.x=b/360+.5,c.y=Re(a)):c=new F(b/360+.5,Re(a));return c};Qe.prototype.latLngToPoint=Qe.prototype.ia;Qe.prototype.tb=function(a,b){return this.ia(a.lat,a.lng,b)};Qe.prototype.geoToPoint=Qe.prototype.tb;function Se(a){return 0>=a?90:1<=a?-90:Kb*(2*Bb(wb(E*(1-2*a)))-Eb)}Qe.prototype.V=function(a,b,c){c?(c.lat=Se(b),c.lng=360*(1===a?1:Mb(a,1))-180):c=new S(Se(b),360*(1===a?1:Mb(a,1))-180);return c};\nQe.prototype.xyToGeo=Qe.prototype.V;Qe.prototype.Tb=function(a,b){return this.V(a.x,a.y,b)};Qe.prototype.pointToGeo=Qe.prototype.Tb;var Te=new Qe;t("H.geo.mercator",Te);t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0);t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function W(a,b){this.projection=a||Te;this.b=0;this.a=this.exp=tb(b||256)/Db;Ue(this);this.y=this.x=0}t("H.geo.PixelProjection",W);var Ve=sb(24)+sb(-8);W.prototype.Vb=Te;W.prototype.projection=W.prototype.Vb;W.prototype.x=0;W.prototype.x=W.prototype.x;W.prototype.y=0;W.prototype.y=W.prototype.y;W.prototype.cc=vb(2,Ve);W.prototype.w=W.prototype.cc;W.prototype.Jb=vb(2,Ve);W.prototype.h=W.prototype.Jb;\nW.prototype.ba=function(a){if(Ra(a))throw new y(this.ba,0,a);var b=this.x/this.w;var c=this.y/this.h;this.b=a;this.a=this.exp+a;Ue(this);this.x=b*this.w;this.y=c*this.h};W.prototype.rescale=W.prototype.ba;function Ue(a){a.a>Ve&&(a.a=Ve);a.w=vb(2,a.a);a.h=vb(2,a.a)}W.prototype.Ta=function(){return this.b||0};W.prototype.getZoomScale=W.prototype.Ta;W.prototype.sb=function(a,b){a=this.projection.ia(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};W.prototype.geoToPixel=W.prototype.sb;\nW.prototype.Fa=function(a,b){return this.projection.V((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};W.prototype.pixelToGeo=W.prototype.Fa;W.prototype.V=function(a,b,c){return this.projection.V((a+this.x)/this.w,(b+this.y)/this.h,c)};W.prototype.xyToGeo=W.prototype.V;W.prototype.Ba=function(a,b,c){a=this.projection.ia(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};W.prototype.latLngToPixel=W.prototype.Ba;W.prototype.Ub=function(a){return new F(a.x*this.w-this.x,a.y*this.h-this.y)};\nW.prototype.pointToPixel=W.prototype.Ub;t("H.util.Disposable",J);J.prototype.L=J.prototype.L;J.prototype.addOnDisposeCallback=J.prototype.L;t("H.util.dispose",function(a){a&&"function"==typeof a.s&&a.s()});J.prototype.s=J.prototype.s;J.prototype.dispose=J.prototype.s;J.prototype.v=J.prototype.v;J.prototype.disposeInternal=J.prototype.v;function We(a,b,c,d){if(!a||!b||!c)throw new y(We,x,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c;d&&Ba(this,d)}t("H.util.BuildInfo",We);We.prototype.toString=function(){var a,b=[];for(a in this)Qa(this[a])&&b.push(this[a]);return b.join(";")};var Xe={};function Ye(a,b,c,d){if(!a)throw new y(Ye,1,"Must specify a name parameter");return Xe[a]||(Xe[a]=new We(a,b,c,d))}We.get=Ye;function Y(a,b,c,d,e,f){if(a&&b)this.Ka(a),this.ka(b),this.Ia(c),this.Ja(e),this.bb(f),this.ma(d);else throw new y(Y,x,\'Parameters "scheme" and "host" must be specified\');}t("H.service.Url",Y);\nfunction Ze(a,b){var c=Ca.document,d;var e="";if(c){e=c.createElement("a");if(b){var f=(d=c.getElementsByTagName("base")[0])&&d.href;var g=c.head;var h=d||g.appendChild(c.createElement("base"));h.href=b}e.href=a;e=e.href;b&&(d?d.href=f:g.removeChild(h))}else/[\\w]+:\\/\\//.test(a)&&(e=a);f=/(?:(\\w+):\\/\\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\\/[^?#]*)?(\\?[^#]+)?(#.*)?/.exec(e);a=f[1];g=f[4];b=f[5];h=f[6];c=f[7];d=f[8];!f[2]&&g&&/@/.test(g)&&(g=g.split("@")[1]);f=Y;h=h&&0<h.length?h.substr(1):\n"";e={};var k,m;if(c)for(k=/([?&]?([^=&+]+))(=([^&]+))?/g;m=k.exec(c);)e[decodeURIComponent(m[2])]=m[4]?decodeURIComponent(m[4]):void 0;return new f(a,g,h,e,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):"")}Y.parse=Ze;Y.prototype.clone=function(){var a={},b;for(b in this.a)a[b]=this.a[b];return new Y(this.i,this.g,this.b,a,this.f,this.c)};Y.prototype.clone=Y.prototype.clone;\nY.prototype.Ka=function(a){if(!a||"string"!==typeof a)throw new y(this.Ka,0,\'The "scheme" parameter must be a non-empty string.\');this.i=a;return this};Y.prototype.setScheme=Y.prototype.Ka;Y.prototype.Gb=function(){return this.i};Y.prototype.getScheme=Y.prototype.Gb;Y.prototype.ka=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw new y(this.ka,0,\'The "host" parameter is not a valid host name.\');this.g=a;return this};\nY.prototype.setHost=Y.prototype.ka;Y.prototype.yb=function(){return this.g};Y.prototype.getHost=Y.prototype.yb;Y.prototype.Ia=function(a){this.b=a||void 0;return this};Y.prototype.setPath=Y.prototype.Ia;Y.prototype.Db=function(){return this.b};Y.prototype.getPath=Y.prototype.Db;Y.prototype.ma=function(a){if(a)if("object"==typeof a)this.a=a;else throw new y(this.ma,0,\'Parameter "params" must be an object.\');else this.a={};return this};Y.prototype.setQuery=Y.prototype.ma;Y.prototype.Kb=function(){return!$e(this)};\nY.prototype.hasQuery=Y.prototype.Kb;Y.prototype.getQuery=function(){return this.a};Y.prototype.getQuery=Y.prototype.getQuery;Y.prototype.Ja=function(a){if(void 0===a)this.f=a;else{var b=Nb(+a<<0,0,65535);if(b!=a)throw new y(this.Ja,0,\'Parameter "port" must be an integer in range [0...65535]\');this.f=b}return this};Y.prototype.setPort=Y.prototype.Ja;Y.prototype.Eb=function(){return this.f};Y.prototype.getPort=Y.prototype.Eb;Y.prototype.bb=function(a){this.c=a||void 0;return this};\nY.prototype.setAnchor=Y.prototype.bb;Y.prototype.ub=function(){return this.c};Y.prototype.getAnchor=Y.prototype.ub;Y.prototype.R=function(a){if("object"!==typeof a)throw new y(this.R,0,\'Parameter "other" must be an object.\');var b=this.a,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};Y.prototype.mergeQuery=Y.prototype.R;\nY.prototype.Na=function(a){if(!a||"string"!==typeof a)throw new y(this.Na,0,\'Parameter "subDomain" must be a non-empty string\');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.ka(a+"."+this.g)};Y.prototype.addSubDomain=Y.prototype.Na;Y.prototype.Oa=function(a){if(!a||"string"!==typeof a)throw new y(this.Oa,0,\'Parameter "subPath" must be a non-empty string\');return this.Ia((this.b?this.b+"/":"")+a)};Y.prototype.addSubPath=Y.prototype.Oa;\nY.prototype.toString=function(){return[this.i+"://",this.g,this.f?":"+this.f:"",this.b||!$e(this)||this.c?"/":"",this.b?encodeURI(this.b):"",af(this),this.c?"#"+encodeURIComponent(this.c):""].join("")};Y.prototype.toString=Y.prototype.toString;function bf(a){return encodeURIComponent(a).replace(/[!\'()*]/g,function(b){return"%"+b.charCodeAt(0).toString(16)})}\nfunction af(a){var b=[],c=a.a,d={},e;for(e in c){if(c.hasOwnProperty(e)&&"function"!==typeof c[e]){var f=a.a[e];d.K=bf(e);Na(f,cf)?f.a.forEach(function(g){return function(h){b.push(g.K+"="+bf(h))}}(d)):Na(f,df)?b.push(d.K+"="+f.b.map(function(g){return bf(g)}).join(f.a)):b.push(void 0===f?d.K:d.K+"="+bf(f))}d={K:d.K}}return 0<b.length?"?"+b.join("&"):""}function $e(a){var b,c=0;for(b in a.a)if(a.a.hasOwnProperty(b)&&"function"!==typeof a.a[b]&&(c++,0<c))break;return!c}\nfunction ef(a,b){if(Oa(a,void 0,void 0,void 0))for(var c=0;c<a.length;c++){var d=a[c];if(!Qa(d)&&!Sa(d)){var e="The Array does not contain only strings and numbers";break}}else e="Not an Array";if(e)throw new y(b,0,a);return a}function cf(a){this.a=ef(a,cf)}Y.MultiValueQueryParameter=cf;cf.prototype.Ib=function(){return this.a};cf.prototype.getValues=cf.prototype.Ib;function df(a,b){this.b=ef(a,df);if(!/^[!\\$\\(\\)\\*\\+,;]$/.test(b))throw new y(df,1,\'Invalid delimiter "\'+b+\'"\');this.a=b}\nY.DelimitedQuerySubValues=df;var ff={};function gf(a){try{importScripts.apply(self,arguments)}catch(b){this.postError("invalid_script")}}function hf(a){delete ff[a];this.postMessage(a)}function jf(a,b,c){if(r(b))var d=b;else try{d=self.eval("("+b+")"),r(d)||(d=null)}catch(e){}d?(ff[a]=d,c||this.postMessage(a)):this.postError("invalid_processor")}function kf(a){this.b=a&&a[0];this.a=a&&a[1];this.c=a&&a[2]||[]}kf.prototype.postError=function(a){this.postMessage(a,x,0)};\nkf.prototype.postMessage=function(a,b,c){self.postMessage({processor:this.b,taskId:this.a,type:c===x?1:c,data:a},b||x)};function lf(a,b,c){if(!Qa(a))throw new y(lf,0,"InvalidArgument");if(!r(b))throw new y(lf,1,"InvalidArgument");var d=mf++;nf[d]={mimeType:c||of,ob:b};(new kf(["3",d,[]])).postMessage(a,[],2)}var nf={},mf=0;\nfunction pf(a,b){var c=a;if(nf[this.a]){var d=nf[this.a];var e=d.ob;delete nf[this.a];if(b)e(null,b);else{if(d.mimeType===qf){a=new Uint8Array(a);b=a.byteLength;d="";c=0;for(var f,g,h,k;c<b;)f=a[c++],192>f||(g=a[c++],224>f?f=(f&31)<<6|g&63:(h=a[c++],240>f?f=(f&15)<<12|(g&63)<<6|h&63:(k=a[c++],f=(f&7)<<18|(g&63)<<12|(h&63)<<6|k&63))),65536>f?d+=String.fromCharCode(f):(f-=65536,d+=String.fromCharCode((f>>10)+55296,(f&1023)+56320));c=d}e(c)}}}var of=0,qf=1;function V(a,b,c,d){rf(this,Le(a,V,0),Me(b,V,1),Le(c,V,2),Me(d,V,3))}wa(V,R);t("H.geo.Rect",V);V.prototype.oa="Polygon";V.prototype.eb=function(a){var b=this.f,c=this.a,d=this.c,e=this.b;a.push("(","(",c," ",b,",",e," ",b,",",e," ",d,",",c," ",d,",",c," ",b,")",")");return a};V.prototype.F=function(a){var b=this===a;!b&&Na(a,V)&&(b=this.f===a.f&&this.a===a.a&&this.c===a.c&&this.b===a.b);return b};V.prototype.equals=V.prototype.F;\nV.prototype.clone=function(){return new V(this.f,this.a,this.c,this.b)};V.prototype.clone=V.prototype.clone;function rf(a,b,c,d,e){a.a=c;a.b=e;b<d&&(c=b,b=d,d=c);a.f=b;a.c=d;a.j=a.g=a.i=null;return a}V.prototype.Sa=function(){this.j||(this.j=new S(this.f,this.a));return this.j};V.prototype.getTopLeft=V.prototype.Sa;V.prototype.Ra=function(){this.g||(this.g=new S(this.c,this.b));return this.g};V.prototype.getBottomRight=V.prototype.Ra;V.prototype.Hb=function(){return this.f};V.prototype.getTop=V.prototype.Hb;\nV.prototype.vb=function(){return this.c};V.prototype.getBottom=V.prototype.vb;V.prototype.Ab=function(){return this.a};V.prototype.getLeft=V.prototype.Ab;V.prototype.Fb=function(){return this.b};V.prototype.getRight=V.prototype.Fb;V.prototype.G=function(){this.i||(this.i=new S(this.c+(this.f-this.c)/2,sf(this.a,this.I())));return this.i};V.prototype.getCenter=V.prototype.G;V.prototype.I=function(){return tf(this.a,this.b)};V.prototype.getWidth=V.prototype.I;\nV.prototype.O=function(){return this.f-this.c};V.prototype.getHeight=V.prototype.O;V.prototype.Nb=function(){return this.a>this.b};V.prototype.isCDB=V.prototype.Nb;V.prototype.Pb=function(){return!this.I()&&!this.O()};V.prototype.isEmpty=V.prototype.Pb;V.prototype.X=function(){return new V(this.f,this.a,this.c,this.b)};V.prototype.getBoundingBox=V.prototype.X;\nV.prototype.ea=function(a,b,c){var d=this.G();c||(a=Le(a,this.ea,0),b=Me(b,this.ea,1));b=this.J(a,b,c);a=b.G();return a.lat===d.lat&&a.lng===d.lng&&this.O()===b.O()&&this.I()===b.I()};V.prototype.containsLatLng=V.prototype.ea;V.prototype.fa=function(a,b){b||Oe(a,this.fa,0);return this.ea(a.lat,a.lng,b)};V.prototype.containsPoint=V.prototype.fa;\nV.prototype.Qa=function(a,b){var c=this.G();if(!b&&!Na(a,V))throw new y(this.Qa,0,a);b=this.ja(a,b);a=b.G();return a.lat===c.lat&&a.lng===c.lng&&this.O()===b.O()&&this.I()===b.I()};V.prototype.containsRect=V.prototype.Qa;V.prototype.J=function(a,b,c,d){if(!c){if(Ra(a=Le(a)))throw new y(this.J,0,a);if(Ra(b=Me(b)))throw new y(this.J,1,b);}return uf(this.f,this.a,this.c,this.b,a,b,a,b,d)};V.prototype.mergeLatLng=V.prototype.J;\nV.prototype.Ya=function(a,b,c){b||Oe(a,this.Ya,0);return this.J(a.lat,a.lng,b,c)};V.prototype.mergePoint=V.prototype.Ya;V.prototype.ja=function(a,b,c){if(!b&&!Na(a,V))throw new y(this.ja,0,a);return uf(this.f,this.a,this.c,this.b,a.f,a.a,a.c,a.b,c)};V.prototype.mergeRect=V.prototype.ja;V.prototype.$=function(a,b,c,d,e,f){e||(a=Le(a,this.$,0),b=Me(b,this.$,1),c=Le(c,this.$,2),d=Me(d,this.$,3));return uf(this.f,this.a,this.c,this.b,a,b,c,d,f)};V.prototype.mergeTopLeftBottomRight=V.prototype.$;\nV.prototype.Va=function(a,b){var c=this.a<=this.b,d=a.a<=a.b,e=this.a<a.b,f=a.a<this.b;if(!b&&!Na(a,V))throw new y(this.Va,0,a);return this.c<=a.f&&a.c<=this.f&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};V.prototype.intersects=V.prototype.Va;function tf(a,b){a=b-a;return a+(0>a?360:0)}function sf(a,b){a+=b/2;return a-(180<a?360:0)}\nfunction uf(a,b,c,d,e,f,g,h,k){c=nb(c,g);a=ob(a,e);e=tf(b,d);var m=sf(b,e);g=tf(f,h);var n=sf(f,g)-m;n+=0>n-1E-6?360:0;if(180>n-1E-6){m=b;var q=h}else n=360-n,m=f,q=d;n=n+e/2+g/2;360<=n+5E-7?(m=-180,q=180):n-5E-7<e?(m=b,q=d):n-5E-7<g&&(m=f,q=h);return k?rf(k,a,m,c,q):new V(a,m,c,q)}V.merge=uf;function vf(a,b,c){c||(Oe(a,vf,0),Oe(b,vf,1));return new V(a.lat,a.lng,b.lat,b.lng)}V.fromPoints=vf;\nfunction wf(a,b){var c=1,d=a.length,e=null;var f=na(a);if("array"!=f&&("object"!=f||"number"!=typeof a.length))throw new y(wf,0,a);if(0<d)for(f=a[0],e=vf(f,f,b);c<d;c++)f=a[c],e.J(f.lat,f.lng,b,e);return e}V.coverPoints=wf;function xf(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new y(xf,0,a);if(0<d)for(e=new V(a[0],a[1],a[0],a[1]);c<d;c+=3)e.J(a[c],a[c+1],b,e);return e}V.coverLatLngAlts=xf;\nfunction yf(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new y(yf,0,a);if(0<d)for(e=new V(a[0].f,a[0].a,a[0].c,a[0].b);c<d;c++)e.ja(a[c],b,e);return e}V.coverRects=yf;\nV.prototype.$a=function(a,b){var c=this.a,d=this.f,e=this.b,f=this.c,g=this.G().lng;Oe(a,this.$a,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?rf(b,d,a,f,e):new V(d,a,f,e)};V.prototype.resizeToCenter=V.prototype.$a;V.prototype.va="Polygon";\nV.prototype.cb=function(){return[[this.a,this.f,0],[this.b,this.f,0],[this.b,this.c,0],[this.a,this.c,0],[this.a,this.f,0]]};V.prototype.ta=function(){return this.ua()};V.prototype.ua=function(){return[this.f,this.a,this.c,this.b]};function zf(a,b,c,d){this.key="";this.x=a;this.y=b;this.b=c;this.Y=d;this.a=Ad()}zf.prototype.then=function(a,b,c){return this.a.a.then(a,b,c)};zf.prototype.reject=function(a){this.a.reject(a)};zf.prototype.cancel=function(){this.a.a.cancel()};zf.prototype.cancel=zf.prototype.cancel;function Af(a,b,c,d){var e=!!c,f,g=0,h=0,k=0,m=0,n=0,q,u=-1;var I=Ca.Float32Array;var L,w=[];if(b){b=Ja(b);a=Ja(a);e&&(f=Ja(c));c=b.length;d=d?1E-7:1E-5;for(L=new I(3*c);g<c;){I=b[g];var G=+I;var X=+a[g];e&&(q=+f[g]);Bf.test(I)?0<=u&&(0<g-u&&w.push(u,g+1),u=-1):0>u&&(u=g);g++;m=L[h++]=m+X*d;k=L[h++]=k+G*d;e&&(n=L[h]=n+q);h++}0<=u&&1<c-u&&w.push(u,c)}else L=new I(0);return{path:L,outlineIndices:w}}var Bf=/^-?0\\d/;\nfunction Cf(a,b){for(var c=0,d=a.length/3,e=new Ca.Array(d),f=0;c<d;)e[c++]=b.Ba(a[f],a[++f]),f+=2;return e};function Df(a,b){b=180/(1<<b);var c=a.lat+90;a=(a.lng+180)%360;var d=0;180==c&&d--;d+=Math.floor(c/b);return[d,Math.floor(a/b)]}var Ef=1/Math.pow(10,10);function Ff(a,b){var c=[],d=a.Sa();a=a.Ra();var e;180==a.lng&&(a.lng-=Ef);d=Df(d,b);a=Df(a,b);for(e=d[0];e>=a[0];e--)for(b=d[1];b<=a[1];b++)c.push(e,b);return c};function Gf(a,b){var c=a.tileSize||256;this.b={};this.j=Ze(a.serverUrl);this.g=b;this.fb=a.layerConfigs||[];this.i=a.projected;this.P=c;this.Ea=!1!==a.batchTiles;this.bc=a.horizontalMargin||0;this.gb=a.onlyOutline;this.ib=new W(x,c);this.f=new W(x,c);this.f.ba(22-Math.log(c)/Math.LN2+8)}wa(Gf,J);\nGf.prototype.kb=function(a,b,c){var d=this.P,e=this.bc,f={x:a*d-e,y:b*d};d={x:(a+1)*d-1+e,y:(b+1)*d-1};e=this.ib;e.ba(c);f=e.Fa(f);d=e.Fa(d);return Hf(this,new V(f.lat,f.lng,d.lat,d.lng),this.fb,{x:a,y:b,z:c})};Gf.prototype.jb=function(a,b,c,d,e){return Hf(this,new V(a,b,c,d),e)};\nfunction Hf(a,b,c,d){var e=If(c),f=e.length,g={},h,k=a.b,m=[],n=[];for(c=0;c<f;c++){var q=e[c];var u=q.layerId;var I=q.level;g[u]=q.columns;q=Ff(b,I);var L=q.length-1;for(h=0;h<L;h+=2){var w=[u,q[h+1],q[h],I].join("_");var G=k[w]||a.g.get(w);G||(G=new zf(q[h+1],q[h],I,u),G.key=w,k[w]=G,n.push(G));m.push(G)}}n.length&&(a.Ea?Jf(a,n):Kf(a,n));return zd(m.map(function(X){return X.then(Fa(this.Ga,this,X.Y,Lf(e))).then(Fa(this.hb,this,X,d||Mf)).then(Fa(this.ac,this,g[X.Y]))},a))}var Mf={x:0,y:0,z:0};\nGf.prototype.Ga=function(a,b,c){var d=c.Rows,e=d.length,f,g;if(e&&(f=b[a])){b=new C(c.Rows);var h=[];for(g=0;g<e;g++){var k=d[g];f(b.ga(g),a)&&h.push(k)}a={Rows:h};if(c=c.Meta)a.Meta=c}else a=c;return a};function Kf(a,b){function c(k,m,n){n?(delete a.b[k.key],k.reject(n)):Nf(a,k,m)}var d,e=b.length,f=a.j;for(d=0;d<e;d++){var g=b[d];var h=f.clone().R({tilex:g.x}).R({tiley:g.y}).R({level:g.b}).R({layer:g.Y});new lf(h.toString(),Fa(c,null,g),qf)}}\nfunction Jf(a,b){var c=b.length,d;for(d=0;d<c;d+=15){var e=b.slice(d,d+15);Of(a,e)}}function Of(a,b){var c=a.j.clone(),d=[],e=[],f=[],g=c.getQuery();b.length&&(b.forEach(function(h){d.push(h.x,h.y);e.push(h.b);f.push(h.Y)}),g.tilexy=d.join(","),g.layers=f.join(","),g.levels=e.join(","),c.ma(g),new lf(c.toString(),function(h,k){k?b.forEach(function(m){delete a.b[m.key];m.reject("error")}):Nf(a,b,h)},qf))}\nfunction Nf(a,b,c){var d=b.length,e;if(Oa(b,void 0,void 0,void 0)){var f=c.indexOf("[")+1;for(e=0;e<d;e++){var g=c.indexOf("]},{",f+3)+2;g<f&&(g=c.lastIndexOf("]}"));var h=c.substr(f,g-f);f=g+1;Pf(a,b[e],h)}}else Pf(a,b,c)}function Pf(a,b,c){try{var d=c.length;var e=b.key;delete a.b[e];a.g.add(e,b,2*d);var f=JSON.parse(c);b.a.b(f)}catch(g){b.reject(g.message)}}\nfunction Lf(a){var b={},c,d=a.length;for(c=0;c<d;c++){var e=a[c];if(e.rowFilter){var f=e.layerId;f=f!==x?f:e.layer;b[f]=Fa(e.rowFilter,e.rowFilterContext)}}return b}function Qf(a,b,c,d,e){return e?[new F(a,b),new F(c,b),new F(c,d),new F(a,d),new F(a,b)]:[a,b,c,b,c,d,a,d]}\nGf.prototype.hb=function(a,b,c){var d=this.f.Ta()-b.z,e=this.P<<d,f=50<<d,g=b.x*e;b=b.y*e;var h=g+e;e=b+e;var k=g-f,m=b-f,n=h+f;f=e+f;var q,u,I=c.Rows,L=I.length,w,G=/^ADAS/.test(a.Y),X=this.f,qa=this.gb,O,bb=[],Ka=[],La=[],cb=[];for(a=0;a<L;a++){var z=w=I[a];var T=(O=G)?"HPY":"LAT";var U=O?"HPX":"LON";var da=O?"HPZ":"ZLEVEL";if(z[T]){var P=Af(z[T],z[U],z[da],O);z.geometry=P;delete z[T];delete z[U];delete z[da];if(z.INNER_LAT)for(T=z.INNER_LAT.split(";"),P=z.INNER_LON.split(";"),delete z.INNER_LAT,\ndelete z.INNER_LON,z.interiors=da=[],U=T.length,z=0;z<U;z++)da.push(Af(T[z],P[z],"",O))}if(this.i){U=w;z=X;P=U.$$projected$$;T=0;if(!P){var Z=U.geometry;O=Cf(Z.path,z);w=[O];U.$$projected$$=P={Sb:w};U=(da=U.interiors)?da.length:0;w.length+=U;T|=+Rf(w,O,Z.outlineIndices);if(U)for(P.Lb=1,q=0;q<U;q++)Z=da[q],O=Cf(Z.path,z),w[1+q]=O,T|=+Rf(w,O,Z.outlineIndices);T&&(P.Qb=1+U)}z=P;O=z.Sb;w=z.Lb;var Fc=z.Qb;P=[];T=U=Lb;var db=da=x;z=O[0];if(1===z.length){var Gc=Gc||(Gc=Qf(g,b,h,e,!1));w=z[0];Rb(w.x,w.y,\nGc)&&P.push(Sf(z,g,b,d))}else{var He=O.length;for(Z=qa?Fc:0;Z<He&&(qa||!Z||P.length);Z++)if(z=O[Z],Z>=Fc){Z===Fc&&(T=P.length);var ia=Ub([z],k,m,n,f,!1);Tf(ia,g,b,d,P)}else{var Jb=Jb||(Jb=Qf(k,m,n,f,!0));if(Z>=w)if(Z===w&&(U=P.length),db)for(q=db.length;q--;){if(ia=Uf(db[q],z),u=ia.length){for(da=da||[];u--;)da.push(q);Tf(ia,g,b,d,P)}}else ia=Uf(Jb,z),Tf(ia,g,b,d,P);else if(ia=Uf(Jb,z),Tf(ia,g,b,d,P),1<ia.length&&w<He)for(db=[],q=ia.length;q--;)db[q]=ia[q]}}P.length&&(bb[a]=P,Ka[a]=U,La[a]=da,cb[a]=\nT)}}return{Zb:c,pb:bb,Mb:Ka,rb:La,Rb:cb}};function Rf(a,b,c){for(var d=c.length,e=0,f,g,h=b.length;e<d;)f=c[e++],g=c[e++],a.push(g-f===h?b:b.slice(f,g));return 0<c.length}function Uf(a,b){var c,d=[];if(c=Wb(a,b)){do{a=[];b=c;do a.push(b);while(b=b.next);d.push(a)}while(c=c.Za)}else Sb(b[0],Tb(a))?d.push(b):Sb(a[0],Tb(b))&&d.push(a);return d}function Tf(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++)e.push(Sf(a[f],b,c,d))}\nfunction Sf(a,b,c,d){var e,f=a.length,g=new Int32Array(2*f),h=0;for(e=0;e<f;e++){var k=a[e];g[h++]=k.x-b>>d;g[h++]=k.y-c>>d}return g}\nGf.prototype.ac=function(a,b){var c=b.Zb,d=b.pb,e=b.Mb,f=b.Rb;b=b.rb;for(var g=[],h,k={Rows:g},m,n=a?a.length:0,q=0,u,I=c.Rows,L=I.length,w;q<L;q+=1)if(d[q]||!this.i){h={};u=I[q];if(n)for(m=0;m<n;m++)u.hasOwnProperty(a[m])&&(h[a[m]]=u[a[m]]);else for(w in u)"$$projected$$"!==w&&(h[w]=u[w]);u.geometry&&(h.geometry=u.geometry);m=void 0;var G,X=h,qa=d[q],O=e[q],bb=b[q],Ka=f[q],La=g;if(qa){var cb=qa.length;if(bb)for(G=O;G--;){if(G){var z={};for(m in X)z[m]=X[m]}else z=X;u=[qa[G]];var T=nb(cb,Ka)-O;for(h=\n0;h<T;h++)bb[h]===G&&u.push(qa[O+h]);T=u.length;if(!G)for(h=Ka;h<cb;h++)u.push(qa[h]);z.$HProjGeometry={paths:u,interiorsIndex:1,outlinesIndex:T};La.push(z)}else X.$HProjGeometry={paths:qa,interiorsIndex:O,outlinesIndex:Ka},La.push(X)}else La.push(X)}c.Meta&&(k.Meta=c.Meta);return k};Gf.prototype.v=function(){var a,b=this.b;for(a in b)b.hasOwnProperty(a)&&(b[a].reject("disposed"),delete b[a])};Gf.prototype.disposeInternal=Gf.prototype.v;\nfunction If(a){for(var b=[],c,d=a.length,e=0;e<d;e++){c=za(a[e]);if(c.rowFilter&&(c.rowFilter=eval("("+c.rowFilter+")"),!r(c.rowFilter)))throw Error("Invalid row filter for layer "+c.layerId);b.push(c)}return b};t("H.service.extension.worker.processor",function(a,b,c){function d(h){e.postMessage(h)}var e=this,f=ya[a];var g=function(h){e.postError(h.toString())};if(0===b)f||(ya[a]=new Gf(c,Vf)),this.postMessage(void 0);else if(f)switch(b){case 1:try{f.kb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 2:try{f.jb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 3:f.s();delete ya[a];xa()&&Vf.S();break;default:e.postError("Unsupported command")}});\nvar Vf=new A(26214400),ya=Object.create(Ia,void 0);function Wf(a,b,c){var d=a[b];a=a[b+1];this.Ua=[];this.La=0;this.b=b;this.a=[a-c,d-c,a+c,d+c]}Wf.prototype.fa=function(a,b){var c=a[b];a=a[b+1];b=this.a;return b[1]<=c&&c<=b[3]&&b[0]<=a&&a<=b[2]};Wf.prototype.G=function(){return this.b};var Xf=new F(0,0);function Yf(a,b,c,d,e){d[e]=b;d[e+1]=a}var Zf=new W;function $f(a,b,c,d,e){Zf.Ba(a,b,Xf);d[e]=Xf.x;d[e+1]=Xf.y}\nt("H.clustering.dynamicgrid.worker",function(a,b,c,d,e){var f=e?Yf:$f,g=0;e=!!self.ArrayBuffer;var h=a.byteLength?new Float64Array(a):a,k=h.length/3;a=[];var m=[],n=[],q=e?new Float64Array(2*k):[];k=0;var u=0;for(Zf.ba(d);g<h.length;){var I=h[g++];var L=h[g++];var w=h[g++];f(w,L,d,q,u);for(w=a.length;w--;)if(L=a[w],L.fa(q,u)){var G=L;break}G||(G=new Wf(q,u,b),a.push(G));w=u/2;G.La+=I||1;G.Ua.push(w);G=null;u+=2}for(w=a.length;w--;)L=a[w],b=L.La>=c,f=L.Ua,d=f.length,b?(m.push(d),m=m.concat(f)):\n(k+=d,n=n.concat(f));c=[k].concat(n,m);c=e?(new Uint32Array(c)).buffer:c;this.postMessage(c,[c])});self.addEventListener("message",function(a){a=new kf(a.data);var b=ff[a.b];if(b)try{b.apply(a,a.c)}catch(c){a.postError(c.message)}else a.postError("processor_not_found")});(function(){var a=new kf;var b=function(c,d){jf.apply(a,[c,d,!0])};b("0",gf);b("1",jf);b("2",hf);b("3",pf)})();\n',function(){var e=function(){var o,f,m;typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope||!(module.exports||typeof window<"u")||(o=e.toString(),f="",m=typeof document<"u"&&document.currentScript instanceof HTMLScriptElement?document.currentScript.src:""),function(){function w(s){return k.call(s).slice(8,-1)}var k={}.toString,Y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _e(s,l){return s(l={exports:{}},l.exports),l.exports}function _o(s){return s&&s.Math==Math&&s}function _u(s){try{return!!s()}catch{return!0}}function pd(s){return"object"==typeof s?null!==s:"function"==typeof s}function iy(s){return p1?I0.createElement(s):{}}function sy(s){if(!pd(s))throw TypeError(String(s)+" is not an object");return s}function gy(s,l){if(!pd(s))return s;var h,g;if(l&&"function"==typeof(h=s.toString)&&!pd(g=h.call(s))||"function"==typeof(h=s.valueOf)&&!pd(g=h.call(s))||!l&&"function"==typeof(h=s.toString)&&!pd(g=h.call(s)))return g;throw TypeError("Can't convert object to primitive value")}function wy(s,l){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:l}}function Ey(s,l){try{K_(Oy,s,l)}catch{Oy[s]=l}return l}function Py(s){return"Symbol(".concat(void 0===s?"":s,")_",(++Px+S1).toString(36))}function Jy(s){return fE[s]||(fE[s]=zE&&mC[s]||(zE?mC:Py)("Symbol."+s))}function _m(s){var l,h,g;return void 0===s?"Undefined":null===s?"Null":"string"==typeof(h=function(_,A){try{return _[A]}catch{}}(l=Object(s),G2))?h:i1?w(l):"Object"==(g=w(l))&&"function"==typeof l.callee?"Arguments":g}var y0="object",Oy=_o(typeof globalThis==y0&&globalThis)||_o(typeof window==y0&&window)||_o(typeof self==y0&&self)||_o(typeof Y==y0&&Y)||Function("return this")(),K0=!_u(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),I0=Oy.document,p1=pd(I0)&&pd(I0.createElement),N_=!K0&&!_u(function(){return 7!=Object.defineProperty(iy("div"),"a",{get:function(){return 7}}).a}),q1=Object.defineProperty,Uw={f:K0?q1:function(s,l,h){if(sy(s),l=gy(l,!0),sy(h),N_)try{return q1(s,l,h)}catch{}if("get"in h||"set"in h)throw TypeError("Accessors not supported");return"value"in h&&(s[l]=h.value),s}},K_=K0?function(s,l,h){return Uw.f(s,l,wy(1,h))}:function(s,l,h){return s[l]=h,s},F_=_e(function(s){var l="__core-js_shared__",h=Oy[l]||Ey(l,{});(s.exports=function(g,_){return h[g]||(h[g]=void 0!==_?_:{})})("versions",[]).push({version:"3.1.0",mode:"global",copyright:"\xa9 2019 Denis Pushkarev (zloirock.ru)"})}),Px=0,S1=Math.random(),zE=!_u(function(){return!String(Symbol())}),fE=F_("wks"),mC=Oy.Symbol,G2=Jy("toStringTag"),i1="Arguments"==w(function(){return arguments}()),Lx={};function Fx(s,l){return lS.call(s,l)}function vC(s){return cS[s]||(cS[s]=Py(s))}Lx[Jy("toStringTag")]="z";var CE,W1,q2,W2,o1,G_,_C,r_,bC="[object z]"!==String(Lx)?function(){return"[object "+_m(this)+"]"}:Lx.toString,lS={}.hasOwnProperty,BE=F_("native-function-to-string",Function.toString),$2=Oy.WeakMap,YR="function"==typeof $2&&/native code/.test(BE.call($2)),cS=F_("keys"),jx={};_C=YR?(CE=new(0,Oy.WeakMap),W1=CE.get,q2=CE.has,W2=CE.set,o1=function(s,l){return W2.call(CE,s,l),l},G_=function(s){return W1.call(CE,s)||{}},function(s){return q2.call(CE,s)}):(r_=vC("state"),jx[r_]=!0,o1=function(s,l){return K_(s,r_,l),l},G_=function(s){return Fx(s,r_)?s[r_]:{}},function(s){return Fx(s,r_)});var DE={set:o1,get:G_,has:_C,enforce:function(s){return _C(s)?G_(s):o1(s,{})},getterFor:function(s){return function(l){var h;if(!pd(l)||(h=G_(l)).type!==s)throw TypeError("Incompatible receiver, "+s+" required");return h}}},Y2=_e(function(s){var l=DE.get,h=DE.enforce,g=String(BE).split("toString");F_("inspectSource",function(_){return BE.call(_)}),(s.exports=function(_,A,j,$){var _t=!!$&&!!$.unsafe,Ye=!!$&&!!$.enumerable,_i=!!$&&!!$.noTargetGet;"function"==typeof j&&("string"!=typeof A||Fx(j,"name")||K_(j,"name",A),h(j).source=g.join("string"==typeof A?A:"")),_!==Oy?(_t?!_i&&_[A]&&(Ye=!0):delete _[A],Ye?_[A]=j:K_(_,A,j)):Ye?_[A]=j:Ey(A,j)})(Function.prototype,"toString",function(){return"function"==typeof this&&l(this).source||BE.call(this)})}),hS=Object.prototype;function K2(s){return isNaN(s=+s)?0:(0<s?sI:ZR)(s)}function fS(s){if(null==s)throw TypeError("Can't call method on "+s);return s}function q_(s){return uI(fS(s))}function oI(s){return 0<s?EC(K2(s),9007199254740991):0}function Z2(s,l){var h,g=q_(s),_=0,A=[];for(h in g)!Fx(jx,h)&&Fx(g,h)&&A.push(h);for(;l.length>_;)Fx(g,h=l[_++])&&(~dS(A,h)||A.push(h));return A}function UT(s,l){var h=eD[tD(s)];return h==rD||h!=nD&&("function"==typeof l?_u(l):!!l)}function GT(s,l){var h,g,_,A,j=s.target,$=s.global,_t=s.stat,Ye=$?Oy:_t?Oy[j]||Ey(j,{}):(Oy[j]||{}).prototype;if(Ye)for(h in l){if(_=l[h],g=s.noTargetGet?(A=yS(Ye,h))&&A.value:Ye[h],!uT($?h:j+(_t?".":"#")+h,s.forced)&&void 0!==g){if(typeof _==typeof g)continue;!function(_i,_s){for(var Ja=CC(_s),_l=Uw.f,lc=J2.f,_p=0;_p<Ja.length;_p++){var ka=Ja[_p];Fx(_i,ka)||_l(_i,ka,lc(_s,ka))}}(_,g)}(s.sham||g&&g.sham)&&K_(_,"sham",!0),Y2(Ye,h,_,s)}}bC!==hS.toString&&Y2(hS,"toString",bC,{unsafe:!0});var xA,HE,X2,ZR=Math.ceil,sI=Math.floor,aT={}.propertyIsEnumerable,xC=Object.getOwnPropertyDescriptor,XR={f:xC&&!aT.call({1:2},1)?function(s){var l=xC(this,s);return!!l&&l.enumerable}:aT},aI="".split,uI=_u(function(){return!Object("z").propertyIsEnumerable(0)})?function(s){return"String"==w(s)?aI.call(s,""):Object(s)}:Object,lI=Object.getOwnPropertyDescriptor,J2={f:K0?lI:function(s,l){if(s=q_(s),l=gy(l,!0),N_)try{return lI(s,l)}catch{}if(Fx(s,l))return wy(!XR.f.call(s,l),s[l])}},EC=Math.min,Q2=Math.max,pS=Math.min,dS=(!1,function(s,l,h){for(var g,_,j=q_(s),$=oI(j.length),_t=(g=$,(_=K2(h))<0?Q2(_+g,0):pS(_,g));_t<$;_t++)if(_t in j&&j[_t]===l)return _t||0;return-1}),EA=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],cI=EA.concat("length","prototype"),gS={f:Object.getOwnPropertyNames||function(s){return Z2(s,cI)}},TC={f:Object.getOwnPropertySymbols},AC=Oy.Reflect,CC=AC&&AC.ownKeys||function(s){var l=gS.f(sy(s)),h=TC.f;return h?l.concat(h(s)):l},$1=/#|\.prototype\./,tD=UT.normalize=function(s){return String(s).replace($1,".").toLowerCase()},eD=UT.data={},nD=UT.NATIVE="N",rD=UT.POLYFILL="P",uT=UT,yS=J2.f,hI=!_u(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype}),pE=vC("IE_PROTO"),mS=Object.prototype,s1=hI?Object.getPrototypeOf:function(s){return Fx(s=Object(fS(s)),pE)?s[pE]:"function"==typeof s.constructor&&s instanceof s.constructor?s.constructor.prototype:s instanceof Object?mS:null},UE=Jy("iterator"),dE=!1;function SE(){}[].keys&&("next"in(X2=[].keys())?(HE=s1(s1(X2)))!==Object.prototype&&(xA=HE):dE=!0),null==xA&&(xA={}),Fx(xA,UE)||K_(xA,UE,function(){return this});var $_={IteratorPrototype:xA,BUGGY_SAFARI_ITERATORS:dE},iD=Object.keys||function(s){return Z2(s,EA)},DC=K0?Object.defineProperties:function(s,l){sy(s);for(var h,g=iD(l),_=g.length,A=0;A<_;)Uw.f(s,h=g[A++],l[h]);return s},SC=Oy.document,GE=SC&&SC.documentElement,qT=vC("IE_PROTO"),MC="prototype",qE=function(){var s,l=iy("iframe"),h=EA.length;for(l.style.display="none",GE.appendChild(l),l.src=String("javascript:"),(s=l.contentWindow.document).open(),s.write("<script>document.F=Object<\/script>"),s.close(),qE=s.F;h--;)delete qE[MC][EA[h]];return qE()},WT=Object.create||function(s,l){var h;return null!==s?(SE[MC]=sy(s),h=new SE,SE[MC]=null,h[qT]=s):h=qE(),void 0===l?h:DC(h,l)};function IC(s,l,h){s&&!Fx(s=h?s:s.prototype,oD)&&ME(s,oD,{configurable:!0,value:l})}function vS(){return this}function fI(){return this}function kC(s,l,h,g,_,A,j){var $,Ye;function _i(ly){if(ly===_&&ny)return ny;if(!$T&&ly in ka)return ka[ly];switch(ly){case"keys":case l_:case TA:return function(){return new h(this,ly)}}return function(){return new h(this)}}Ye=l+" Iterator",($=h).prototype=WT(pI,{next:wy(1,g)}),IC($,Ye,!1),Z_[Ye]=vS;var _s,Ja,_l,lc=l+" Iterator",_p=!1,ka=s.prototype,ty=ka[WE]||ka["@@iterator"]||_&&ka[_],ny=!$T&&ty||_i(_),ry="Array"==l&&ka.entries||ty;if(ry&&(_s=s1(ry.call(new s)),E_!==Object.prototype&&_s.next&&(s1(_s)!==E_&&(OC?OC(_s,E_):"function"!=typeof _s[WE]&&K_(_s,WE,fI)),IC(_s,lc,!0))),_==l_&&ty&&ty.name!==l_&&(_p=!0,ny=function(){return ty.call(this)}),ka[WE]!==ny&&K_(ka,WE,ny),Z_[l]=ny,_)if(Ja={values:_i(l_),keys:A?ny:_i("keys"),entries:_i(TA)},j)for(_l in Ja)!$T&&!_p&&_l in ka||Y2(ka,_l,Ja[_l]);else GT({target:l,proto:!0,forced:$T||_p},Ja);return Ja}jx[qT]=!0;var ME=Uw.f,oD=Jy("toStringTag"),Z_={},pI=$_.IteratorPrototype,OC=Object.setPrototypeOf||("__proto__"in{}?function(){var s,l=!1,h={};try{(s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(h,[]),l=h instanceof Array}catch{}return function(g,_){return function(A,j){if(sy(A),!pd(j)&&null!==j)throw TypeError("Can't set "+String(j)+" as a prototype")}(g,_),l?s.call(g,_):g.__proto__=_,g}}():void 0),WE=Jy("iterator"),E_=$_.IteratorPrototype,$T=$_.BUGGY_SAFARI_ITERATORS,l_="values",TA="entries",ix="String Iterator",H_=DE.set,O0=DE.getterFor(ix);kC(String,"String",function(s){H_(this,{type:ix,string:String(s),index:0})},function(){var s,l,g,_,A,j,$,_t=O0(this),Ye=_t.string,_i=_t.index;return _i>=Ye.length?{value:void 0,done:!0}:(l=_i,A=String(fS(Ye)),j=K2(l),$=A.length,s=j<0||$<=j?"":(g=A.charCodeAt(j))<55296||56319<g||j+1===$||(_=A.charCodeAt(j+1))<56320||57343<_?A.charAt(j):A.slice(j,j+2),_t.index+=s.length,{value:s,done:!1})});var RC={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},_S=Jy("unscopables"),a0=Array.prototype;function YT(s){a0[_S][s]=!0}null==a0[_S]&&K_(a0,_S,WT(null));var Z0="Array Iterator",P_=DE.set,bS=DE.getterFor(Z0),NC=kC(Array,"Array",function(s,l){P_(this,{type:Z0,target:q_(s),index:0,kind:l})},function(){var s=bS(this),l=s.target,h=s.kind,g=s.index++;return!l||g>=l.length?{value:s.target=void 0,done:!0}:"keys"==h?{value:g,done:!1}:"values"==h?{value:l[g],done:!1}:{value:[g,l[g]],done:!1}},"values");Z_.Arguments=Z_.Array,YT("keys"),YT("values"),YT("entries");var sD=Jy("iterator"),Ww=Jy("toStringTag"),s_=NC.values;for(var AA in RC){var wS=Oy[AA],$E=wS&&wS.prototype;if($E){if($E[sD]!==s_)try{K_($E,sD,s_)}catch{$E[sD]=s_}if($E[Ww]||K_($E,Ww,AA),RC[AA])for(var ox in NC)if($E[ox]!==NC[ox])try{K_($E,ox,NC[ox])}catch{$E[ox]=NC[ox]}}}function YE(s){if("function"!=typeof s)throw TypeError(String(s)+" is not a function");return s}function R0(s,l,h){if(YE(s),void 0===l)return s;switch(h){case 0:return function(){return s.call(l)};case 1:return function(g){return s.call(l,g)};case 2:return function(g,_){return s.call(l,g,_)};case 3:return function(g,_,A){return s.call(l,g,_,A)}}return function(){return s.apply(l,arguments)}}var JR=Jy("iterator"),QR=Array.prototype,dI=Jy("iterator"),gI=_e(function(s){var l={};(s.exports=function(h,g,_,A,j){var $,_t,Ye,_i,_s,Ja,_l=R0(g,_,A?2:1);if(j)$=h;else{if("function"!=typeof(_t=function(lc){if(null!=lc)return lc[dI]||lc["@@iterator"]||Z_[_m(lc)]}(h)))throw TypeError("Target is not iterable");if(void 0!==(Ja=_t)&&(Z_.Array===Ja||QR[JR]===Ja)){for(Ye=0,_i=oI(h.length);Ye<_i;Ye++)if((A?_l(sy(_s=h[Ye])[0],_s[1]):_l(h[Ye]))===l)return l;return}$=_t.call(h)}for(;!(_s=$.next()).done;)if(function(lc,_p,ka,ty){try{return ty?_p(sy(ka)[0],ka[1]):_p(ka)}catch(ry){var ny=lc.return;throw void 0!==ny&&sy(ny.call(lc)),ry}}($,_l,_s.value,A)===l)return l}).BREAK=l}),CA=Jy("iterator"),aD=!1;try{var Y1=0;({next:function(){return{done:!!Y1++}},return:function(){aD=!0}})[CA]=function(){return this}}catch{}function c0(s,l){var h,g=sy(s).constructor;return void 0===g||null==(h=sy(g)[gg])?l:YE(h)}function PC(s){var l;s0.hasOwnProperty(s)&&(l=s0[s],delete s0[s],l())}function _d(s){return function(){PC(s)}}function _r(s){PC(s.data)}function Ni(s){Oy.postMessage(s+"",oy.protocol+"//"+oy.host)}var ga,ba,_h,gg=Jy("species"),oy=Oy.location,uy=Oy.setImmediate,cy=Oy.clearImmediate,vy=Oy.process,Ty=Oy.MessageChannel,Ay=Oy.Dispatch,e0=0,s0={},ky="onreadystatechange";uy&&cy||(uy=function(s){for(var l=[],h=1;h<arguments.length;)l.push(arguments[h++]);return s0[++e0]=function(){("function"==typeof s?s:Function(s)).apply(void 0,l)},ga(e0),e0},cy=function(s){delete s0[s]},"process"==w(vy)?ga=function(s){vy.nextTick(_d(s))}:Ay&&Ay.now?ga=function(s){Ay.now(_d(s))}:Ty?(_h=(ba=new Ty).port2,ba.port1.onmessage=_r,ga=R0(_h.postMessage,_h,1)):!Oy.addEventListener||"function"!=typeof postMessage||Oy.importScripts||_u(Ni)?ga=ky in iy("script")?function(s){GE.appendChild(iy("script"))[ky]=function(){GE.removeChild(this),PC(s)}}:function(s){setTimeout(_d(s),0)}:(ga=Ni,Oy.addEventListener("message",_r,!1)));var u0,t0,Fy,jy,By,qy,h0,Ly={set:uy,clear:cy},Qy=Oy.navigator,n0=Qy&&Qy.userAgent||"",Gy=J2.f,g0=Ly.set,N0=Oy.MutationObserver||Oy.WebKitMutationObserver,w0=Oy.process,E0=Oy.Promise,u_="process"==w(w0),__=Gy(Oy,"queueMicrotask"),b_=__&&__.value;function U_(s){var l,h;this.promise=new s(function(g,_){if(void 0!==l||void 0!==h)throw TypeError("Bad Promise constructor");l=g,h=_}),this.resolve=YE(l),this.reject=YE(h)}function V0(s,l){if(sy(s),pd(l)&&l.constructor===s)return l;var h=IE.f(s);return(0,h.resolve)(l),h.promise}function q0(s){try{return{error:!1,value:s()}}catch(l){return{error:!0,value:l}}}function a1(s){return"function"==typeof s?s:void 0}function B0(s,l){return arguments.length<2?a1(T1[s])||a1(Oy[s]):T1[s]&&T1[s][l]||Oy[s]&&Oy[s][l]}function M1(s){var l;return!(!pd(s)||"function"!=typeof(l=s.then))&&l}function KT(s,l,h){var g;l.notified||(l.notified=!0,g=l.reactions,k1(function(){for(var _=l.value,A=1==l.state,j=0;g.length>j;)!function($){var _t,Ye,_i,_s=A?$.ok:$.fail,Ja=$.resolve,_l=$.reject,lc=$.domain;try{_s?(A||(2===l.rejection&&_3(s,l),l.rejection=1),!0===_s?_t=_:(lc&&lc.enter(),_t=_s(_),lc&&(lc.exit(),_i=!0)),_t===$.promise?_l(v1("Promise-chain cycle")):(Ye=M1(_t))?Ye.call(_t,Ja,_l):Ja(_t)):_l(_)}catch(_p){lc&&!_i&&lc.exit(),_l(_p)}}(g[j++]);l.reactions=[],l.notified=!1,h&&!l.rejection&&tN(s,l)}))}function $x(s,l,h){var g,_;lD?((g=MA.createEvent("Event")).promise=l,g.reason=h,g.initEvent(s,!1,!0),Oy.dispatchEvent(g)):g={promise:l,reason:h},(_=Oy["on"+s])?_(g):s===kA&&function(A,j){var $=Oy.console;$&&$.error&&(1===arguments.length?$.error(A):$.error(A,j))}("Unhandled promise rejection",h)}function u1(s,l,h,g){return function(_){s(l,h,_,g)}}function ZT(s,l,h,g){l.done||(l.done=!0,g&&(l=g),l.value=h,l.state=2,KT(s,l,!0))}b_||(u0=function(){var s,l;for(u_&&(s=w0.domain)&&s.exit();t0;){l=t0.fn,t0=t0.next;try{l()}catch(h){throw t0?jy():Fy=void 0,h}}Fy=void 0,s&&s.enter()},jy=u_?function(){w0.nextTick(u0)}:N0&&!/(iphone|ipod|ipad).*applewebkit/i.test(n0)?(By=!0,qy=document.createTextNode(""),new N0(u0).observe(qy,{characterData:!0}),function(){qy.data=By=!By}):E0&&E0.resolve?(h0=E0.resolve(void 0),function(){h0.then(u0)}):function(){g0.call(Oy,u0)});var DA,H0,z1,y_,JT,xS,k1=b_||function(s){var l={fn:s,next:void 0};Fy&&(Fy.next=l),t0||(t0=l,jy()),Fy=l},IE={f:function(s){return new U_(s)}},T1=Oy,K1=Jy("species"),o0="Promise",X0=Ly.set,l1=Jy("species"),Vx=DE.get,SA=DE.set,Z1=DE.getterFor(o0),sx=Oy[o0],v1=Oy.TypeError,MA=Oy.document,KE=Oy.process,c_=Oy.fetch,uD=KE&&KE.versions,LC=uD&&uD.v8||"",XT=IE.f,IA=XT,O1="process"==w(KE),lD=!!(MA&&MA.createEvent&&Oy.dispatchEvent),kA="unhandledrejection",yx=uT(o0,function(){function s(){}var l=sx.resolve(1),h=(l.constructor={})[l1]=function(g){g(s,s)};return!((O1||"function"==typeof PromiseRejectionEvent)&&l.then(s)instanceof h&&0!==LC.indexOf("6.6")&&-1===n0.indexOf("Chrome/66"))}),FC=yx||!function(s,l){if(!aD)return!1;var h=!1;try{var g={};g[CA]=function(){return{next:function(){return{done:h=!0}}}},function(s){sx.all(s).catch(function(){})}(g)}catch{}return h}(),tN=function(s,l){X0.call(Oy,function(){var h,g=l.value;if(t1(l)&&(h=q0(function(){O1?KE.emit("unhandledRejection",g,s):$x(kA,s,g)}),l.rejection=O1||t1(l)?2:1,h.error))throw h.value})},t1=function(s){return 1!==s.rejection&&!s.parent},_3=function(s,l){X0.call(Oy,function(){O1?KE.emit("rejectionHandled",s):$x("rejectionhandled",s,l.value)})},yI=function(s,l,h,g){if(!l.done){l.done=!0,g&&(l=g);try{if(s===h)throw v1("Promise can't be resolved itself");var _=M1(h);_?k1(function(){var A={done:!1};try{_.call(h,u1(yI,s,A,l),u1(ZT,s,A,l))}catch(j){ZT(s,A,j,l)}}):(l.value=h,l.state=1,KT(s,l,!1))}catch(A){ZT(s,{done:!1},A,l)}}};function T_(s){return(T_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(l){return typeof l}:function(l){return l&&"function"==typeof Symbol&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(s)}function D0(s,l){if(!(s instanceof l))throw new TypeError("Cannot call a class as a function")}function QT(s,l){for(var h=0;h<l.length;h++){var g=l[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(s,g.key,g)}}function T0(s,l,h){return l&&QT(s.prototype,l),h&&QT(s,h),s}function OA(s,l,h){return l in s?Object.defineProperty(s,l,{value:h,enumerable:!0,configurable:!0,writable:!0}):s[l]=h,s}function L_(s,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(l&&l.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),l&&jC(s,l)}function h1(s){return(h1=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)})(s)}function jC(s,l){return(jC=Object.setPrototypeOf||function(h,g){return h.__proto__=g,h})(s,l)}function cD(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function RA(s,l,h){return(RA=cD()?Reflect.construct:function(g,_,A){var j=[null];j.push.apply(j,_);var $=new(Function.bind.apply(g,j));return A&&jC($,A.prototype),$}).apply(null,arguments)}function gE(s){var l="function"==typeof Map?new Map:void 0;return(gE=function(h){if(null===h||-1===Function.toString.call(h).indexOf("[native code]"))return h;if("function"!=typeof h)throw new TypeError("Super expression must either be null or a function");if(void 0!==l){if(l.has(h))return l.get(h);l.set(h,_)}function _(){return RA(h,arguments,h1(this).constructor)}return _.prototype=Object.create(h.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),jC(_,h)})(s)}function mI(s){if(void 0===s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function B1(s){var l=cD();return function(){var h,_,A,j=h1(s);return _=this,!(A=l?(h=h1(this).constructor,Reflect.construct(j,arguments,h)):j.apply(this,arguments))||"object"!=typeof A&&"function"!=typeof A?mI(_):A}}function kE(s,l,h){return(kE=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(g,_,A){var j=function(_t,Ye){for(;!Object.prototype.hasOwnProperty.call(_t,Ye)&&null!==(_t=h1(_t)););return _t}(g,_);if(j){var $=Object.getOwnPropertyDescriptor(j,_);return $.get?$.get.call(A):$.value}})(s,l,h||s)}function A0(s,l){return function(h){if(Array.isArray(h))return h}(s)||function(h,g){if(!(typeof Symbol>"u")&&Symbol.iterator in Object(h)){var _=[],A=!0,j=!1,$=void 0;try{for(var _t,Ye=h[Symbol.iterator]();!(A=(_t=Ye.next()).done)&&(_.push(_t.value),!g||_.length!==g);A=!0);}catch(_i){j=!0,$=_i}finally{try{A||null==Ye.return||Ye.return()}finally{if(j)throw $}}return _}}(s,l)||eN(s,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A_(s){return function(l){if(Array.isArray(l))return nN(l)}(s)||function(l){if(typeof Symbol<"u"&&Symbol.iterator in Object(l))return Array.from(l)}(s)||eN(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eN(s,l){if(s){if("string"==typeof s)return nN(s,l);var h=Object.prototype.toString.call(s).slice(8,-1);return"Object"===h&&s.constructor&&(h=s.constructor.name),"Map"===h||"Set"===h?Array.from(s):"Arguments"===h||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?nN(s,l):void 0}}function nN(s,l){(null==l||l>s.length)&&(l=s.length);for(var h=0,g=new Array(l);h<l;h++)g[h]=s[h];return g}function ES(s,l){var h;if(typeof Symbol>"u"||null==s[Symbol.iterator]){if(Array.isArray(s)||(h=eN(s))||l&&s&&"number"==typeof s.length){h&&(s=h);var g=0,_=function(){};return{s:_,n:function(){return g>=s.length?{done:!0}:{done:!1,value:s[g++]}},e:function(_t){throw _t},f:_}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var A,j=!0,$=!1;return{s:function(){h=s[Symbol.iterator]()},n:function(){var _t=h.next();return j=_t.done,_t},e:function(_t){$=!0,A=_t},f:function(){try{j||null==h.return||h.return()}finally{if($)throw A}}}}yx&&(sx=function(s){(function(h,g,_){if(!(h instanceof g))throw TypeError("Incorrect Promise invocation")})(this,sx),YE(s),DA.call(this);var l=Vx(this);try{s(u1(yI,this,l),u1(ZT,this,l))}catch(h){ZT(this,l,h)}},(DA=function(){SA(this,{type:o0,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(s,l,h){for(var g in l)Y2(s,g,l[g],void 0);return s}(sx.prototype,{then:function(s,l){var h=Z1(this),g=XT(c0(this,sx));return g.ok="function"!=typeof s||s,g.fail="function"==typeof l&&l,g.domain=O1?KE.domain:void 0,h.parent=!0,h.reactions.push(g),0!=h.state&&KT(this,h,!1),g.promise},catch:function(s){return this.then(void 0,s)}}),H0=function(){var s=new DA,l=Vx(s);this.promise=s,this.resolve=u1(yI,s,l),this.reject=u1(ZT,s,l)},IE.f=XT=function(s){return s===sx||s===z1?new H0:IA(s)},"function"==typeof c_&&GT({global:!0,enumerable:!0,forced:!0},{fetch:function(s){return V0(sx,c_.apply(Oy,arguments))}})),GT({global:!0,wrap:!0,forced:yx},{Promise:sx}),IC(sx,o0,!1),y_=B0(o0),K0&&y_&&!y_[K1]&&(0,Uw.f)(y_,K1,{configurable:!0,get:function(){return this}}),z1=T1[o0],GT({target:o0,stat:!0,forced:yx},{reject:function(s){var l=XT(this);return l.reject.call(void 0,s),l.promise}}),GT({target:o0,stat:!0,forced:yx},{resolve:function(s){return V0(this,s)}}),GT({target:o0,stat:!0,forced:FC},{all:function(s){var l=this,h=XT(l),g=h.resolve,_=h.reject,A=q0(function(){var j=YE(l.resolve),$=[],_t=0,Ye=1;gI(s,function(_i){var _s=_t++,Ja=!1;$.push(void 0),Ye++,j.call(l,_i).then(function(_l){Ja||(Ja=!0,$[_s]=_l,--Ye||g($))},_)}),--Ye||g($)});return A.error&&_(A.value),h.promise},race:function(s){var l=this,h=XT(l),g=h.reject,_=q0(function(){var A=YE(l.resolve);gI(s,function(j){A.call(l,j).then(h.resolve,g)})});return _.error&&g(_.value),h.promise}}),GT({target:"Promise",proto:!0,real:!0},{finally:function(s){var l=c0(this,B0("Promise")),h="function"==typeof s;return this.then(h?function(g){return V0(l,s()).then(function(){return g})}:s,h?function(g){return V0(l,s()).then(function(){throw g})}:s)}}),"function"!=typeof Object.assign&&(Object.assign=function(s){if(null==s)throw new TypeError("Cannot convert undefined or null to object");for(var l=Object(s),h=1;h<arguments.length;h++){var g=arguments[h];if(null!=g)for(var _ in g)g.hasOwnProperty(_)&&(l[_]=g[_])}return l}),"function"!=typeof Object.values&&(Object.values=function(s){return Object.keys(s).map(function(l){return s[l]})}),Math.hypot=Math.hypot||function(){for(var s=0,l=arguments.length,h=0;h<l;h++){if(arguments[h]===1/0||arguments[h]===-1/0)return 1/0;s+=arguments[h]*arguments[h]}return Math.sqrt(s)},Math.log2=Math.log2||function(s){return Math.log(s)*Math.LOG2E},typeof window<"u"?(!("performance"in window)&&(window.performance={}),JT=window.performance):typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&(!("performance"in self)&&(self.performance={}),JT=self.performance),JT&&"function"!=typeof JT.now&&(xS=+new Date,JT.now=function(){return new Date-xS});var gV=hD;function hD(s,l){this.x=s,this.y=l}hD.prototype={clone:function(){return new hD(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,l){return this.clone()._rotateAround(s,l)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var l=s.x-this.x,h=s.y-this.y;return l*l+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,l){return Math.atan2(this.x*l-this.y*s,this.x*s+this.y*l)},_matMult:function(s){var h=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=h,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var l=Math.cos(s),h=Math.sin(s),_=h*this.x+l*this.y;return this.x=l*this.x-h*this.y,this.y=_,this},_rotateAround:function(s,l){var h=Math.cos(s),g=Math.sin(s),A=l.y+g*(this.x-l.x)+h*(this.y-l.y);return this.x=l.x+h*(this.x-l.x)-g*(this.y-l.y),this.y=A,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},hD.convert=function(s){return s instanceof hD||!Array.isArray(s)?s:new hD(s[0],s[1])};var b3=fD;function fD(s,l,h,g,_){this.properties={},this.extent=h,this.type=0,this._pbf=s,this._geometry=-1,this._keys=g,this._values=_,s.readFields(yV,this,l)}function yV(s,l,h){1==s?l.id=h.readVarint():2==s?function(g,_){for(var A=g.readVarint()+g.pos;g.pos<A;){var j=_._keys[g.readVarint()],$=_._values[g.readVarint()];_.properties[j]=$}}(h,l):3==s?l.type=h.readVarint():4==s&&(l._geometry=h.pos)}fD.types=["Unknown","Point","LineString","Polygon"],fD.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var l,h,g=s.readVarint()+s.pos,_=1,A=0,j=0,$=0,_t=[];s.pos<g;)if(A||(_=7&(h=s.readVarint()),A=h>>3),A--,1===_||2===_)j+=s.readSVarint(),$+=s.readSVarint(),1===_&&(l&&_t.push(l),l=[]),l.push(new gV(j,$));else{if(7!==_)throw new Error("unknown command "+_);l&&l.push(l[0].clone())}return l&&_t.push(l),_t},fD.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var l,h=s.readVarint()+s.pos,g=1,_=0,A=0,j=0,$=1/0,_t=-1/0,Ye=1/0,_i=-1/0;s.pos<h;)if(_||(g=7&(l=s.readVarint()),_=l>>3),_--,1===g||2===g)(A+=s.readSVarint())<$&&($=A),_t<A&&(_t=A),(j+=s.readSVarint())<Ye&&(Ye=j),_i<j&&(_i=j);else if(7!==g)throw new Error("unknown command "+g);return[$,Ye,_t,_i]},fD.prototype.toGeoJSON=function(s,l,h){var g,_=this.extent*Math.pow(2,h),A=this.extent*s,j=this.extent*l,$=this.loadGeometry(),_t=fD.types[this.type];function Ye(_l){for(var lc=0;lc<_l.length;lc++){var _p=_l[lc];_l[lc]=[360*(_p.x+A)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(_p.y+j)/_)*Math.PI/180))-90]}}switch(this.type){case 1:for(var _i=[],_s=0;_s<$.length;_s++)_i[_s]=$[_s][0];Ye($=_i);break;case 2:for(_s=0;_s<$.length;_s++)Ye($[_s]);break;case 3:for($=function(_l){var lc=_l.length;if(lc<=1)return[_l];for(var _p,ka,ty=[],ny=0;ny<lc;ny++){var ry=function(ly){for(var ey,hy,fy=0,_y=0,Iy=ly.length,Sy=Iy-1;_y<Iy;Sy=_y++)fy+=((hy=ly[Sy]).x-(ey=ly[_y]).x)*(ey.y+hy.y);return fy}(_l[ny]);0!==ry&&(void 0===ka&&(ka=ry<0),ka===ry<0?(_p&&ty.push(_p),_p=[_l[ny]]):_p.push(_l[ny]))}return _p&&ty.push(_p),ty}($),_s=0;_s<$.length;_s++)for(g=0;g<$[_s].length;g++)Ye($[_s][g])}1===$.length?$=$[0]:_t="Multi"+_t;var Ja={type:"Feature",geometry:{type:_t,coordinates:$},properties:this.properties};return"id"in this&&(Ja.id=this.id),Ja};var mV=w3;function w3(s,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(vV,this,l),this.length=this._features.length}function vV(s,l,h){15===s?l.version=h.readVarint():1===s?l.name=h.readString():5===s?l.extent=h.readVarint():2===s?l._features.push(h.pos):3===s?l._keys.push(h.readString()):4===s&&l._values.push(function(g){for(var _=null,A=g.readVarint()+g.pos;g.pos<A;){var j=g.readVarint()>>3;_=1==j?g.readString():2==j?g.readFloat():3==j?g.readDouble():4==j?g.readVarint64():5==j?g.readVarint():6==j?g.readSVarint():7==j?g.readBoolean():null}return _}(h))}function _V(s,l,h){var g;3!==s||(g=new mV(h,h.readVarint()+h.pos)).length&&(l[g.name]=g)}w3.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var l=this._pbf.readVarint()+this._pbf.pos;return new b3(this._pbf,l,this.extent,this._keys,this._values)};var OE,rN=function(s,l){this.layers=s.readFields(_V,{},l)},TS=b3,tA=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},lT={};(function(){var s,l,h="function"==typeof Object.defineProperties?Object.defineProperty:function(_c,_g,dy){_c!=Array.prototype&&_c!=Object.prototype&&(_c[_g]=dy.value)},g=(typeof window>"u"||window!==this)&&void 0!==tA&&null!=tA?tA:this;if("function"==typeof Object.setPrototypeOf)s=Object.setPrototypeOf;else{t:{var _={};try{_.__proto__={ea:!0},l=_.ea;break t}catch{}l=!1}s=l?function(_c,_g){if(_c.__proto__=_g,_c.__proto__!==_g)throw new TypeError(_c+" is not extensible");return _c}:null}var A=s;!function(_c,_g){if(_g){var dy=g;_c=_c.split(".");for(var py=0;py<_c.length-1;py++){var my=_c[py];my in dy||(dy[my]={}),dy=dy[my]}(_g=_g(py=dy[_c=_c[_c.length-1]]))!=py&&null!=_g&&h(dy,_c,{configurable:!0,writable:!0,value:_g})}}("Object.setPrototypeOf",function(_c){return _c||A});var j=this||self;function $(_c){var _g=T_(_c);if("object"==_g){if(!_c)return"null";if(_c instanceof Array)return"array";if(_c instanceof Object)return _g;var dy=Object.prototype.toString.call(_c);if("[object Window]"==dy)return"object";if("[object Array]"==dy||"number"==typeof _c.length&&void 0!==_c.splice&&void 0!==_c.propertyIsEnumerable&&!_c.propertyIsEnumerable("splice"))return"array";if("[object Function]"==dy||void 0!==_c.call&&void 0!==_c.propertyIsEnumerable&&!_c.propertyIsEnumerable("call"))return"function"}else if("function"==_g&&void 0===_c.call)return"object";return _g}function _t(_c){return"function"==$(_c)}function Ye(_c){var _g=T_(_c);return"object"==_g&&null!=_c||"function"==_g}function _i(_c,_g){_c=_c.split(".");var dy,py=j;for((_c[0]in py||void 0===py.execScript||py.execScript("var "+_c[0]));_c.length&&(dy=_c.shift());)_c.length||void 0===_g?py=py[dy]&&py[dy]!==Object.prototype[dy]?py[dy]:py[dy]={}:py[dy]=_g}function _s(_c,_g){function dy(){}dy.prototype=_g.prototype,_c.ua=_g.prototype,_c.prototype=new dy,_c.prototype.constructor=_c}var Ja=Math,_l=Ja.min,lc=Ja.max,_p=Ja.round,ka=Ja.floor,ty=Ja.ceil,ny=Ja.abs,ry=Ja.log,ly=Ja.sqrt,ey=Ja.pow,hy=Ja.sin,fy=Ja.asin,_y=Ja.cos,Iy=Ja.tan,Sy=Ja.atan2,Dy=Ja.PI,Ny=Dy/2,r0=Dy/4,Vy=2*Dy,Yy=3*Dy,S0=Dy/180,o_=180/Dy;function $0(_c,_g,dy){return dy<_c?dy:_c<_g?_g:_c}function Q0(_c,_g,dy){return _g<dy?_g<=_c&&_c<=dy:dy<=_c&&_c<=_g}function d_(_c,_g,dy,py,my,Cy){return ly(ey((_c-my)*(py-Cy)-(_g-Cy)*(dy-my),2)/(ey(dy-my,2)+ey(py-Cy,2)))}_i("H.math.normalize",function(_c,_g,dy){return _g-=dy=dy||0,(_c-=dy)-ka(_c/_g)*_g+dy}),_i("H.math.clamp",$0);var Y_={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function r1(_c,_g){var dy=_c.x;_c=_c.y;for(var py,my,Cy,_v,Wy=_g.length,m0=Wy,M0=_g[0],P0=0,L0=0,v_=0;1!=P0&&1<m0;)my=_g[--m0],py=_g[--m0],_v=_g[m0?m0-1:(Wy+(m0-1))%Wy],Cy=_g[m0?m0-2:(Wy+(m0-2))%Wy],dy<=py&&py<=dy&&_c<=my&&my<=_c||dy<=Cy&&Cy<=dy&&_c<=_v&&_v<=_c?P0=1:P0||py!==dy?!P0&&Q0(dy,py,Cy)&&((py<dy&&dy<Cy||dy<py&&Cy<dy)&&(L0+=_c<(M0=my+(dy-py)/(Cy-py)*(_v-my)),v_+=M0<_c),P0=Q0(_c,my,_v)&&d_(dy,_c,py,my,Cy,_v)<=0?2:0):(Cy===dy&&(my<_c&&_c<_v||_c<my&&_v<_c)||(M0<=dy&&dy<Cy||dy<=M0&&Cy<dy)&&(_c<=my?++L0:++v_),P0=Q0(_c,my,_v)&&d_(dy,_c,py,my,Cy,_v)<=0?2:0),M0=py;return P0||0===v_||L0%2==0||(P0=3),P0!==Y_.NONE}function t_(_c,_g){this.x=+_c,this.y=+_g}function C_(_c,_g,dy,py,my,Cy,_v,Wy,m0,M0){return _c={x:_c,y:_g,next:dy||null,s:py||null,ta:my||null,X:Cy||null,o:!!_v,T:Wy||0,O:m0||0,alpha:M0||0},py&&(_c.s.next=_c),dy&&(_c.next.s=_c),_c}function Ix(_c){for(;_c&&_c.o;)_c=_c.next;return _c}function H1(_c){if(_c)for(;_c.next;)_c=_c.next;return _c}function px(_c){var _g=H1(_c);(_g.s.next=_c).s=_g.s}function FE(_c){for(var _g=[];_c;)_g.push(_c.x,_c.y),_c=_c.next;return _g}function _1(_c,_g,dy){for(_g=_g.next;_g!==dy&&_g.alpha<=_c.alpha;)_g=_g.next;_c.next=_g,_c.s=_g.s,(_c.next.s=_c).s.next=_c}function D_(_c,_g){for(var dy,py=null,my=0,Cy=_c.length;my<Cy;my++)(dy=C_(_c[my].x,_c[my].y,py)).qa=_g,(dy.next=py)&&(py.s=dy),py=dy;return py}function C1(_c,_g,dy,py){return(_c-=dy)*_c+(_g-=py)*_g}_i("H.math.CoverType",Y_),_i("H.math.isPointInsidePolygon",r1),_i("H.math.flatten",function(_c){for(var _g=_c.length,dy=new Float64Array(2*_g),py=_g&&_c[0].x!==dx;_g--;){var my=_c[_g],Cy=_g<<1;dy[Cy]=py?my.x:my[0],dy[1+Cy]=py?my.y:my[1]}return dy}),_i("H.math.Point",t_),(t_.prototype.set=t_).prototype.clone=function(_c){return _c?(_c.x=this.x,_c.y=this.y):_c=new t_(this.x,this.y),_c},t_.prototype.add=function(_c){return this.x+=_c.x,this.y+=_c.y,this},t_.prototype.sub=function(_c){return this.x-=_c.x,this.y-=_c.y,this},t_.prototype.scale=function(_c,_g){return this.x*=_c,this.y*=void 0===_g?_c:_g,this},t_.prototype.round=function(){return this.x=_p(this.x),this.y=_p(this.y),this},t_.prototype.floor=function(){return this.x=ka(this.x),this.y=ka(this.y),this},t_.prototype.ceil=function(){return this.x=ty(this.x),this.y=ty(this.y),this},t_.prototype.equals=t_.prototype.w=function(_c){return!(!_c||this.x!==_c.x||this.y!==_c.y)},t_.prototype.getNearest=t_.prototype.la=function(_c,_g){var dy,py=_g.x-_c.x,my=_g.y-_c.y,Cy=_c;return(py||my)&&(Cy=(dy=((this.x-_c.x)*py+(this.y-_c.y)*my)/(py*py+my*my))<=0?_c:1<=dy?_g:new t_(_c.x+dy*py,_c.y+dy*my)),Cy},t_.prototype.distance=t_.prototype.R=function(_c){return ly(ey(this.x-_c.x,2)+ey(this.y-_c.y,2))},t_.fromIPoint=function(_c){if(!_c)throw Error("invalid argument");return _c instanceof t_?_c:new t_(_c.x,_c.y)},_i("H.math.clipping.clipStrips",function(_c,_g,dy,py,my,Cy){var _v,Wy,m0,M0=_c.length;if(M0)for(_v=[];M0--;)for(var L0,v_=_c[M0],R_=v_.length,y1=0,k0=1;k0<R_;k0++)(m0=function(e_,F0,h_,z_,M_,J_){var a_=e_.x;e_=-e_.y;var p_=F0.x;if(F0=-F0.y,h_=-h_,J_=-J_,p_<a_){if(M_<p_||a_<z_)return;var aE=a_,Q_=e_;a_=p_,e_=F0,p_=aE,F0=Q_,aE=1}else if(M_<a_||p_<z_)return;if(F0<e_){if(h_<F0||e_<J_)return;var Zw=1;e_=-e_,F0=-F0,Q_=J_,J_=-h_,h_=-Q_}else if(h_<e_||F0<J_)return;if(a_<z_){if((e_+=(z_-a_)*(F0-e_)/(p_-a_))>h_)return;a_=z_}if(e_<J_){if((a_+=(J_-e_)*(p_-a_)/(F0-e_))>M_)return;e_=J_}return M_<p_&&(F0=e_+(M_-a_)*(F0-e_)/(p_-a_),p_=M_),h_<F0&&(p_=a_+(h_-e_)*(p_-a_)/(F0-e_),F0=h_),Zw&&(e_=-e_,F0=-F0),aE?[new t_(p_,-F0),new t_(a_,-e_)]:[new t_(a_,-e_),new t_(p_,-F0)]}(v_[k0-1],v_[k0],dy,_g,py,my))&&(L0=m0[1],y1&&y1.w(m0[0])?Wy.push(L0):_v.push(Wy=m0),y1=L0,Cy&&(k0=R_,M0=0));else _v=_c;return _v}),_i("H.math.clipping.clipPolygon",function(_c,_g,dy){var py;_c=D_(_c,!0),_g=D_(_g,!1);var my={},Cy=py=1;switch(~~(dy||0)){case 1:Cy=py=0;break;case 2:py=0,Cy=1;break;case 3:py=1,Cy=0}dy=py;var _v,Wy,m0,M0,P0,L0,v_=Cy;if(_g&&_c){for(_g.M=C_(_g.x,_g.y,null,H1(_g)),_c.M=C_(_c.x,_c.y,null,H1(_c)),Cy=_g;Cy.next;Cy=Cy.next)if(!Cy.o)for(py=_c;py.next;py=py.next)py.o||(L0=function y1(k0,e_,F0,h_,z_){var M_,J_=e_.x-k0.x,a_=e_.y-k0.y,p_=h_.x-F0.x,aE=h_.y-F0.y,Q_=J_*aE-a_*p_;return!Q_||(p_=((F0.x-k0.x)*aE-(F0.y-k0.y)*p_)/Q_,Q_=(a_*(F0.x-k0.x)-J_*(F0.y-k0.y))/Q_,p_<0||1<p_||Q_<0||1<Q_)?0:(0===p_?M_=k0:1===p_?M_=e_:0===Q_?M_=F0:1===Q_&&(M_=h_),M_?(M_.x+=2480549651603763e-20,M_.y+=7321997314118067e-20,M_.M&&(M_.M.x=M_.x,M_.M.y=M_.y),y1(k0,e_,F0,h_,z_)):(z_.xa=k0.x+p_*J_,z_.ya=k0.y+p_*a_,z_.fa=p_,z_.ga=Q_,1))}(Cy,_v=Ix(Cy.next),py,Wy=Ix(py.next),my))&&(m0=my.ga,_1(L0=C_(M0=my.xa,P0=my.ya,null,null,null,null,!0,0,0,L0=my.fa),Cy,_v),_1(_v=C_(M0,P0,null,null,null,null,!0,0,0,m0),py,Wy),(L0.X=_v).X=L0);for(my=r1(_g,FE(_c)),dy&&(my=!my),Cy=_g;Cy;Cy=Cy.next)Cy.o&&(my=!(Cy.T=my));for(my=r1(_c,FE(_g)),v_&&(my=!my),py=_c;py.next;py=py.next)py.o&&(my=!(py.T=my));for(px(_g),px(_c);(_c=function(y1){var k0=y1;if(k0)for(;(k0=k0.next)!=y1&&(!k0.o||k0.o&&k0.O););return k0}(_g))!=_g;){for(dy=null;!_c.O;_c=_c.X){for(my=_c.T;(dy=C_(_c.x,_c.y,dy)).artificial=_c.o||_c.qa,_c.O=1,_c=my?_c.next:_c.s;)if(_c.o){_c.O=1;break}if(!_c)break}dy.ta=R_;var R_=dy}return R_}}),_i("H.math.simplifyDP",function(_c,_g,dy){return function py(my,Cy,_v,Wy,m0){var M0=0,P0=Wy,L0=my[Wy].x,v_=my[Wy].y,R_=my[m0].x,y1=my[m0].y,k0=Wy+1,e_=C1(L0,v_,R_,y1);if(e_)for(;k0<m0;){var F0=my[k0++],h_=F0.x,z_=((h_-L0)*(R_-L0)+((F0=F0.y)-v_)*(y1-v_))/e_;M0<(h_=z_<0?C1(h_,F0,L0,v_):1<z_?C1(h_,F0,R_,y1):C1(h_,F0,L0+z_*(R_-L0),v_+z_*(y1-v_)))&&(M0=h_,P0=k0-1)}else for(;k0<m0;)M0<(h_=C1(h_=(F0=my[k0++]).x,F0=F0.y,L0,v_))&&(M0=h_,P0=k0-1);return Cy<=M0||0<_v&&P0-Wy?(--_v,1<P0-Wy?(Wy=py(my,Cy,_v,Wy,P0)).splice(Wy.length-1,1):Wy=[my[Wy]],Wy.concat(1<m0-P0?py(my,Cy,_v,P0,m0):my.slice(P0,m0+1))):[my[Wy],my[m0]]}(_c,_g*_g,dy||0,0,_c.length-1)});var Gx=this,nE=String,dx=[].pop(),gA=/x/.exec(""),gx="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function kx(_c,_g){if(_c instanceof _g&&_c.constructor===_g)throw new TypeError("Illegal constructor "+U1(_g))}_i("H.lang.isArray",function(_c,_g,dy,py){var my;if(!(my="Array"===jE(_c))&&_g)throw new X_(_g,dy,py!==dx?py:_c);return my}),_i("H.lang.isString",function(_c){return"string"==typeof _c});var d1=isNaN;function Yw(_c){return _c===+_c}function jE(_c){var _g=Object[gx[0]][gx[6]].call(_c).match(/^\[object (\w+)\]$/);return _g?_g[1]:T_(_c)}_i("H.lang.isNumber",Yw),_i("H.lang.isInteger",Number.isInteger?Number.isInteger:function(_c){return"number"==typeof _c&&_c%1==0});var wE=[];function U1(_c,_g,dy,py){var my,Cy,_v="",Wy=arguments.length<2;return Wy&&(_g={H:Gx.H},dy="",py=wE.slice()),iC(_g,!0,function(m0,M0){try{if(P0=my=m0[M0],iC(m0,!(L0=[]),function(v_,R_){v_[R_]===P0&&L0.push(R_)}),M0=L0.sort(M2)[0],!(Ye(my)&&my.window===my&&my.self===my||Ye(my)&&0<my.nodeType&&_t(my.cloneNode))&&Ye(my)){if(my===_c)return _v=dy+"."+M0,1;if(py.indexOf(my)<0&&(py.push(my),_v=U1(_c,my,dy+"."+M0,py)))return 1}}catch{}var P0,L0}),Wy&&(_v=_v?_v.substr(1).replace("."+gx[0]+".","#"):"~"+(_t(_c)?((Cy=/^\s*function ([^\( ]+)/.exec(Cy=_c))?Cy[1]:"anonymous")+"()":jE(_c))),_v}function M2(_c,_g){return _g.length-_c.length}wE.indexOf(wE)<0&&wE.push(wE);var rC=Object[gx[0]][gx[2]];function iC(_c,_g,dy){var py;if(_c){for(my in _c)if((!_g||rC.call(_c,my))&&dy(_c,my,!0))return;for(py=gx.length;py--;){var my=gx[py];if((!_g||rC.call(_c,my))&&dy(_c,my,!1))break}}}function $D(_c,_g,dy){dy[_g]="#"+_g}function X_(_c,_g,dy){var py,my,Cy=arguments.length;return(_g=_g!==dx?+_g:_g)!==dx&&((my=py=(my=/^.*?\(([^\)]+)/.exec((""+_c).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?nE(my[1].replace(/\s+/g,"")).split(","!==dx?",":" "):[]).forEach($D),my=my[_g]||"#"+_g),py=_c?U1(_c):"",Cy=2<Cy?nE(dy):"",(my||Cy)&&(py+=" (Argument "+(my||"")+(Cy?" "+Cy:"")+")"),Cy=Error(py),Object.setPrototypeOf(Cy,X_.prototype),Cy}function rE(_c,_g,dy){var py=$0(+_c,-90,90);if(_g&&d1(py))throw new X_(_g,dy,_c);return py}function iE(_c,_g,dy){var py,my=+_c;if((my<-180||180<my)&&(my=((py=(my+180)%360)<0?360+py:py)-180),_g&&d1(my))throw new X_(_g,dy,_c);return my}function PM(_c,_g,dy){var py;if(_c!==dx&&d1(py=+_c)&&_g)throw new X_(_g,dy,_c);return py}function F1(){kx(this,F1)}function S_(_c,_g,dy){this.lat=rE(_c,S_,0),this.lng=iE(_g,S_,1),dy!==dx&&(this.alt=PM(dy,S_,2))}function eT(_c,_g,dy){var py=Ye(_c)&&!(d1(_c.lat=rE(_c.lat))||d1(_c.lng=iE(_c.lng))||_c.alt!==dx&&d1(_c.alt=PM(_c.alt)));if(!py&&_g)throw new X_(_g,dy,_c);return py}function f0(_c,_g,dy,py){OT(this,rE(_c,f0,0),iE(_g,f0,1),rE(dy,f0,2),iE(py,f0,3))}function OT(_c,_g,dy,py,my){return _c.f=dy,_c.g=my,_g<py&&(dy=_g,_g=py,py=dy),_c.i=_g,_c.h=py,_c.m=_c.b=_c.c=null,_c}function oE(_c,_g){return(_c=_g-_c)+(_c<0?360:0)}function oC(_c,_g){return(_c+=_g/2)-(180<_c?360:0)}function RT(_c,_g,dy,py,my,Cy,_v,Wy,m0){dy=_l(dy,_v),_c=lc(_c,my);var M0=oC(_g,my=oE(_g,py)),P0=oC(Cy,_v=oE(Cy,Wy))-M0,L0=(P0+=P0-1e-6<0?360:0)-1e-6<180?(M0=_g,Wy):(P0=360-P0,M0=Cy,py);return 360<=(P0=P0+my/2+_v/2)+5e-7?(M0=-180,L0=180):P0-5e-7<my?(M0=_g,L0=py):P0-5e-7<_v&&(M0=Cy,L0=Wy),m0?OT(m0,_c,M0,dy,L0):new f0(_c,M0,dy,L0)}function I2(_c,_g,dy){return dy||(eT(_c,I2,0),eT(_g,I2,1)),new f0(_c.lat,_c.lng,_g.lat,_g.lng)}function sE(_c,_g,dy,py,my,Cy){kx(this,sE),this.sa=_c||10,this.c=this.b=null,this.j=py||0,this.l=my||0,this.m=_g||1,this.u=dy||1,this.I=!!Cy,this.flush()}function nT(_c,_g,dy){var py,my;if(_c.I&&(py=_c.c))for(my=3;0<=my;my--){var Cy=_g[my];if(my%3?Cy>=py[my]:Cy<=py[my]){if(!dy){_c.c=null;break}py[my]=Cy}}}function tR(_c,_g){var dy,py=_c.a;if(_g){var my=_g;if(my!==py)for(py=my;my=my.c;)(my.entries||1<my.a)&&(py=my)}else for(;!py.entries&&(dy=py.a)<2&&dy;)py=my;_c.a=py}_s(X_,Error),_i("H.lang.InvalidArgumentError",X_),X_.prototype.name="InvalidArgumentError",_i("H.geo.isDBC",function(_c,_g){return 0!=(_c<0^_g<0)&&180<ny(_g-_c)}),_i("H.geo.AbstractGeometry",F1),F1.prototype.getBoundingBox=F1.prototype.D,F1.prototype.equals=F1.prototype.w,F1.prototype.a="",F1.prototype.l="",F1.prototype.toString=function(){return this.I([this.a.toUpperCase()," "]).join("")},F1.prototype.toGeoJSON=F1.prototype.va=function(){return{type:this.l,coordinates:this.u()}},F1.prototype.forWorkerMessage=F1.prototype.U=function(){return{type:this.a,coordinates:this.j(),boundingBox:this.D().U()}},_s(S_,F1),_i("H.geo.Point",S_),S_.prototype.equals=S_.prototype.w=function(_c){return this===_c||!!_c&&this.lat===_c.lat&&this.lng===_c.lng&&(this.alt||0)===(_c.alt||0)},S_.prototype.distance=S_.prototype.R=function(_c){var _g,dy;return this===_c||this.lat===_c.lat&&this.lng===_c.lng?0:12742001.58*fy(_l(1,ly(ey(hy(((_g=this.lat*S0)-(dy=_c.lat*S0))/2),2)+_y(_g)*_y(dy)*ey(hy((this.lng*S0-_c.lng*S0)/2),2))))},S_.prototype.walk=S_.prototype.wa=function(_c,_g,dy){var py,my,Cy,_v,Wy,m0,M0;return dy?((_g/=6371000.79)&&(_c*=S0,py=hy(Wy=S0*this.lat),my=hy(_g),Cy=_y(_g),_v=S0*this.lng,m0=_y(Wy),Wy=fy(m0*_y(_c)*my+py*Cy),m0=(_c=(_v+(_c=Sy(hy(_c)*m0*my,Cy-py*hy(Wy)))+Dy)%(2*Dy)-Dy)*o_),_g?new S_(Wy*o_,(m0+540)%360-180):this):(90+(_c=(_c%360+360)%360))%180==0?(Wy=this.lng+_g/(6371000.79*Vy*_y(this.lat*S0))*(270===_c?-360:360),new S_(this.lat,(Wy+540)%360-180)):((_g/=6371000.79)&&(py=this.lng*S0,Cy=(my=(_v=this.lat*S0)+_g*_y(_c*=S0))-_v,Wy=ry(Iy(my/2+r0)/Iy(_v/2+r0)),Wy=d1(Cy/Wy)?_y(_v):Cy/Wy,M0=_g*hy(_c)/Wy,ny(my)>Ny&&(my=0<my?Dy-my:-(Dy+my))),_g?new S_(my*o_,((py+M0+Yy+(ny(_v+Cy)>Ny?Dy:0))%Vy-Dy)*o_):this)},S_.prototype.getBoundingBox=S_.prototype.D=function(){return new f0(this.lat,this.lng,this.lat,this.lng)},S_.validate=eT,S_.fromIPoint=function _c(_g){if(!_g)throw new X_(_c,0,_g);return new S_(_g.lat,_g.lng,_g.alt)},S_.prototype.a="Point",S_.prototype.I=function(_c){return _c.push("(",this.lng," ",this.lat,")"),_c},S_.prototype.l="Point",S_.prototype.u=function(){return[this.lng,this.lat,this.alt||0]},S_.prototype.j=function(){return[this.lat,this.lng,this.alt||0]},_s(f0,F1),_i("H.geo.Rect",f0),f0.prototype.a="Polygon",f0.prototype.I=function(_c){var _g=this.i,dy=this.f,py=this.h,my=this.g;return _c.push("(","(",dy," ",_g,",",my," ",_g,",",my," ",py,",",dy," ",py,",",dy," ",_g,")",")"),_c},f0.prototype.equals=f0.prototype.w=function(_c){return this===_c||!!_c&&this.i===_c.i&&this.f===_c.f&&this.h===_c.h&&this.g===_c.g},f0.prototype.clone=function(){return new f0(this.i,this.f,this.h,this.g)},f0.prototype.getTopLeft=f0.prototype.W=function(){return this.m||(this.m=new S_(this.i,this.f)),this.m},f0.prototype.getBottomRight=f0.prototype.V=function(){return this.b||(this.b=new S_(this.h,this.g)),this.b},f0.prototype.getTop=f0.prototype.na=function(){return this.i},f0.prototype.getBottom=f0.prototype.ha=function(){return this.h},f0.prototype.getLeft=f0.prototype.ja=function(){return this.f},f0.prototype.getRight=f0.prototype.ma=function(){return this.g},f0.prototype.getCenter=f0.prototype.F=function(){return this.c||(this.c=new S_(this.h+(this.i-this.h)/2,oC(this.f,this.A()))),this.c},f0.prototype.getWidth=f0.prototype.A=function(){return oE(this.f,this.g)},f0.prototype.getHeight=f0.prototype.G=function(){return this.i-this.h},f0.prototype.isCDB=f0.prototype.N=function(){return this.f>this.g},f0.prototype.isEmpty=f0.prototype.ra=function(){return!this.A()&&!this.G()},f0.prototype.getBoundingBox=f0.prototype.D=function(){return new f0(this.i,this.f,this.h,this.g)},f0.prototype.containsLatLng=f0.prototype.L=function(_c,_g,dy){var py=this.F();return dy||(_c=rE(_c,this.L,0),_g=iE(_g,this.L,1)),(_c=(_g=this.B(_c,_g,dy)).F()).lat===py.lat&&_c.lng===py.lng&&this.G()===_g.G()&&this.A()===_g.A()},f0.prototype.containsPoint=f0.prototype.$=function(_c,_g){return _g||eT(_c,this.$,0),this.L(_c.lat,_c.lng,_g)},f0.prototype.containsRect=f0.prototype.aa=function(_c,_g){var dy=this.F();if(!(_g||_c instanceof f0))throw new X_(this.aa,0,_c);return(_c=(_g=this.J(_c,_g)).F()).lat===dy.lat&&_c.lng===dy.lng&&this.G()===_g.G()&&this.A()===_g.A()},f0.prototype.mergeLatLng=f0.prototype.B=function(_c,_g,dy,py){if(!dy){if(d1(_c=rE(_c)))throw new X_(this.B,0,_c);if(d1(_g=iE(_g)))throw new X_(this.B,1,_g)}return RT(this.i,this.f,this.h,this.g,_c,_g,_c,_g,py)},f0.prototype.mergePoint=f0.prototype.ca=function(_c,_g,dy){return _g||eT(_c,this.ca,0),this.B(_c.lat,_c.lng,_g,dy)},f0.prototype.mergeRect=f0.prototype.J=function(_c,_g,dy){if(!(_g||_c instanceof f0))throw new X_(this.J,0,_c);return RT(this.i,this.f,this.h,this.g,_c.i,_c.f,_c.h,_c.g,dy)},f0.prototype.mergeTopLeftBottomRight=f0.prototype.C=function(_c,_g,dy,py,my,Cy){return my||(_c=rE(_c,this.C,0),_g=iE(_g,this.C,1),dy=rE(dy,this.C,2),py=iE(py,this.C,3)),RT(this.i,this.f,this.h,this.g,_c,_g,dy,py,Cy)},f0.prototype.intersects=f0.prototype.ba=function(_c,_g){var dy=this.f<=this.g,py=_c.f<=_c.g,my=this.f<_c.g,Cy=_c.f<this.g;if(!(_g||_c instanceof f0))throw new X_(this.ba,0,_c);return this.h<=_c.i&&_c.h<=this.i&&(!dy&&(!py||my||Cy)||!py&&(my||Cy)||my&&Cy)},f0.merge=RT,f0.fromPoints=I2,f0.coverPoints=function _c(_g,dy){var py=1,my=_g.length,Cy=null,_v=$(_g);if("array"!=_v&&("object"!=_v||"number"!=typeof _g.length))throw new X_(_c,0,_g);if(0<my)for(Cy=I2(_v=_g[0],_v,dy);py<my;py++)Cy.B((_v=_g[py]).lat,_v.lng,dy,Cy);return Cy},f0.coverLatLngAlts=function _c(_g,dy){var py,my=3,Cy=_g.length;if(!(dy||_g&&null!=_g.length))throw new X_(_c,0,_g);if(0<Cy)for(py=new f0(_g[0],_g[1],_g[0],_g[1]);my<Cy;my+=3)py.B(_g[my],_g[my+1],dy,py);return py},f0.coverRects=function _c(_g,dy){var py,my=1,Cy=_g.length;if(dy&&(!_g||null==_g.length))throw new X_(_c,0,_g);if(0<Cy)for(py=new f0(_g[0].i,_g[0].f,_g[0].h,_g[0].g);my<Cy;my++)py.J(_g[my],dy,py);return py},f0.prototype.resizeToCenter=f0.prototype.da=function(_c,_g){var dy=this.f,py=this.i,my=this.g,Cy=this.h,_v=this.F().lng;eT(_c,this.da,0);var Wy=_c.lat-Cy-(py-Cy)/2,m0=_c.lng-_v;return _c=(_c=dy+((m0=180<m0||m0<-180?-(_v+_c.lng):m0)<0?2*m0:0))<-180?360+_c:_c,my=180<(my+=0<m0?2*m0:0)?my-360:my,90<=(py=0<Wy?py+2*Wy:py)&&(py=90),(Cy=Wy<0?Cy+2*Wy:Cy)<=-90&&(Cy=-90),_g?OT(_g,py,_c,Cy,my):new f0(py,_c,Cy,my)},f0.prototype.l="Polygon",f0.prototype.u=function(){return[[this.f,this.i,0],[this.g,this.i,0],[this.g,this.h,0],[this.f,this.h,0],[this.f,this.i,0]]},f0.prototype.U=function(){return this.j()},f0.prototype.j=function(){return[this.i,this.f,this.h,this.g]},sE.prototype.remove=function(_c){var _g,dy,py,my,Cy,_v,Wy=!1;if(_c&&(_g=_c.a)&&_g.b===this&&(dy=_g.entries)&&0<=(py=dy.indexOf(_c))){for(dy.splice(py,1),dy=this.a;_g;)(my=_g.entries)&&my.length||(my&&delete _g.entries,_g.a||!(Cy=_g.c))?_g=gA:((py=Cy)[_v=(Wy=_g).j]===Wy&&(delete py[_v],delete Wy.c,--py.a),dy===_g&&(dy=Cy),_g=Cy);this.a!==dy&&(this.a=dy,tR(this)),nT(this,_c,!1),Wy=!0}return Wy},sE.prototype.flush=function(){var _c=new YD(null,NaN,this.j-this.m,this.l-this.u,this.j+this.m,this.l+this.u);(_c.b=this).a=this.b=_c,this.c=null},sE.prototype.o=function(_c,_g,dy,py,my,Cy){var _v=[],Wy=this.a,m0=this.b;return _c<=Wy[5]&&_g<=Wy[6]&&(my?dy>=Wy[7]:dy>Wy[7])&&(Cy?py>=Wy[4]:py>Wy[4])&&function M0(P0,L0,v_,R_,y1,k0,e_,F0,h_){var z_,M_=L0.entries,J_=L0[7],a_=L0[4],p_=L0[5],aE=L0[6],Q_=L0[8],Zw=L0[9];if(M_){var NT=M_.length;if(a_<y1||J_<R_||e_<aE||k0<p_)for(;NT--;)a_=(J_=M_[NT])[3],p_=J_[0],aE=J_[1],y1<=J_[2]&&R_<=aE&&(p_<e_||F0&&p_==e_)&&(a_<k0||h_&&a_==k0)&&v_.push(J_);else for(;NT--;)v_.push(M_[NT])}(Q_<k0||h_&&k0==Q_)&&(y1<Zw&&(z_=L0[1])&&M0(P0,z_,v_,R_,y1,k0,e_,F0,h_),(Zw<e_||F0&&e_==Zw)&&(z_=L0[3])&&M0(P0,z_,v_,R_,y1,k0,e_,F0,h_)),R_<Q_&&(y1<Zw&&(z_=L0[0])&&M0(P0,z_,v_,R_,y1,k0,e_,F0,h_),(Zw<e_||F0&&e_==Zw)&&(z_=L0[2])&&M0(P0,z_,v_,R_,y1,k0,e_,F0,h_))}(this,Wy,_v,_c,_g,dy,py,Cy||py>=m0[6],my||dy>=m0[5]),_v};var XP=0;function YD(_c,_g,dy,py,my,Cy){this.j=_g,_c&&(this.c=_c,this.b=_c.b,my=1&_g?(dy=_c[8],_c[5]):(dy=_c[7],_c[8]),Cy=2&_g?(py=_c[9],_c[6]):(py=_c[4],_c[9])),this[7]=dy,this[5]=my,this[8]=(dy+my)/2,this[4]=py,this[6]=Cy,this[9]=(py+Cy)/2}function VE(_c,_g,dy,py,my,Cy){VE.ua.constructor.apply(this,arguments)}function KD(_c,_g,dy,py,my,Cy,_v){var Wy,m0,M0=_g[8],P0=_g[9];return _v&&(my<M0||(Wy=M0<=dy))&&(Cy<P0||(m0=P0<=py))?dy=(M0=KD)(_c,_g=_g[Wy|=m0<<1]||(++_g.a,_g[Wy]=new YD(_g,Wy)),dy,py,my,Cy,_v-1):(py=dy=new ZD(dy,py,my,Cy),(_g.entries||(_g.entries=[])).push(py),py.a=_g,nT(_c,dy,!0),tR(_c,_g)),dy}function ZD(_c,_g,dy,py){this.id=XP++,this[0]=_g,this[1]=dy,this[2]=py,this[3]=_c}function xE(_c){this.l=new VE(+_c||10,180,90,0,0,!0),this.j=[],this.m=!1,this.a=this.b=this.c=null}function JP(_c,_g,dy,py,my,Cy){if(Cy)Cy=new ZD(my,-_g,dy+360,-py),_c.j.push(Cy),_c.m=!0,_c.a&&_c.a.C(_g,dy,py,my,!0,_c.a);else{var _v=-_g,Wy=-py,m0=(Cy=_c.l).b,M0=m0[5],P0=m0[6];if(!(m0[7]<=dy&&m0[4]<=_v&&(my<M0||M0===my&&M0===m0.b.b[5])&&(Wy<P0||P0===Wy&&P0===m0.b.b[6])))throw Error("Coordinates out of bounds");Cy=KD(Cy,Cy.b,dy,_v,my,Wy,Cy.sa),_c.b&&_c.b.C(_g,dy,py,my,!0,_c.b)}return _c.c=null,Cy}function LM(_c,_g,dy,py,my,Cy,_v){var Wy=(_c=_c.j).length,m0=[];if(Wy)for(var M0=dy+360,P0=my+360;Wy--;){var L0=_c[Wy];(eR(L0,_g,dy,py,my,Cy,_v)||eR(L0,_g,M0,py,P0,Cy,_v))&&m0.push(L0)}return m0}function eR(_c,_g,dy,py,my,Cy,_v){var Wy=_c[3],m0=_c[0],M0=_c[1];return _c=_c[2],(Cy?m0<=py:m0<py)&&(_v?Wy<=my:Wy<my)&&_g<=_c&&dy<=M0}function nR(_c,_g){var dy,py;if(dy=_g.length){for(var my=_c.length,Cy={};my--;)Cy[_c[my].id]=1;for(;dy--;)(py=_g[dy]).id in Cy||_c.push(py)}}function EE(){}function g1(_c,_g,dy){if(this.l=[],_g&&this.K(_g),dy&&!_t(dy))throw new X_(g1,2,dy);this.b=0,this.m=dy,this.a={},this.j=this.c=null,this.Z(_c)}function QP(_c,_g){return _g&&(_c.c=tL(_c,_g,_c.c)),_g}function z4(_c){for(;_c.b>_c.u&&_c.j;)rR(_c,_c.j,!0)}function tL(_c,_g,dy){return dy!==_g&&((_g.H||_g.v)&&rR(_c,_g,!1),(_g.H=dy)&&(_g.v=dy.v,dy.v=_g),_g.v||(_c.c=_g),_g.H||(_c.j=_g),_c.b+=_g.size),_g}function rR(_c,_g,dy){var py=_g.v,my=_g.H;(py||my||_g==_c.c&&_g==_c.j)&&(py?py.H=my:_c.c=my,my?my.v=py:_c.j=py,_c.b-=_g.size,dy&&(delete _c.a[_g.id],eL(_c,_g))),_g.H=_g.v=null}function eL(_c,_g){for(var dy=_c.l.length;dy--;)_c.l[dy].call(_c,_g.id,_g.data,_g.size)}YD.prototype.a=0,_s(VE,sE),_i("H.geo.QuadTree",xE),xE.prototype.N=function(){return this.m},xE.prototype.D=function(){var _c;if(!this.c){var _g,dy,py=[];if((_v=!this.b)&&(Wy=(Cy=this.l).c,Cy.I&&!Wy&&((_v=Cy.a).entries||_v[0]||_v[1]||_v[2]||_v[3])&&(Wy=function M0(P0,L0){for(var v_,R_,y1=0,k0=3;0<=k0;k0--){for(var e_=k0+4,F0=0<k0%3,h_=[],z_=L0[k0],M_=P0[k0],J_=M_.length;J_--;){var a_=M_[J_];if(v_=a_.entries)for(R_=v_.length;R_--;){var p_=v_[R_][k0];(F0?z_<p_:p_<z_)&&(z_=p_)}for(R_=4;R_--;)(v_=a_[R_])&&(F0?v_[e_]>z_:v_[e_]<z_)&&h_.push(v_)}y1+=h_.length,L0[k0]=z_,P0[k0]=h_}return y1&&(L0=M0(P0,L0)),L0}([Wy=[_v],Wy,Wy,Wy],[_v[6],_v[7],_v[4],_v[5]]),Cy.c=Wy),_v=Cy=Wy),_v&&(this.b=new f0(-Cy[0],Cy[3],-Cy[2],Cy[1])),(_c=this.b)&&py.push(_c),!this.a&&(dy=(_g=this.j).length)){for(_v=360,Wy=-(Cy=90),m0=0;dy--;)var my=_g[dy],Cy=_l(Cy,my[0]),_v=_l(_v,my[3]),Wy=lc(Wy,my[2]),m0=lc(m0,my[1]);this.a=new f0(-Cy,_v,-Wy,m0-360)}(_c=this.a)&&py.push(_c),(_c=py[0])&&(py[1]&&(_c=_c.J(py[1],!0)),this.c=_c)}return this.c},xE.prototype.insertBoundingBox=xE.prototype.oa=function(_c){var _g=_c.W(),dy=_c.V();return(_c=_c.N())?JP(this,_g.lat,dy.lng,dy.lat,_g.lng,_c):JP(this,_g.lat,_g.lng,dy.lat,dy.lng,_c)},xE.prototype.remove=function(_c){var _g,dy;return _c.a?(dy=this.l.remove(_c),this.b=null):(dy=0<=(_c=(_g=this.j).indexOf(_c)))&&(_g.splice(_c,1),this.m=0<_g.length,this.a=null),dy&&(this.c=null),dy},xE.prototype.intersectBoundingBox=xE.prototype.pa=function(_c,_g,dy){var py=this.l,Cy=_c.W(),Wy=_c.V(),my=-Cy.lat,_v=(Cy=Cy.lng,-Wy.lat);return Wy=Wy.lng,!_g&&my==_v||!dy&&Cy===Wy?_c=[]:_c.N()?(nR(_c=py.o(-180,my,Wy,_v,dy,_g),py.o(Cy,my,180,_v,!1,_g)),nR(_c,LM(this,my,Wy,_v,Cy+360,_g,dy))):nR(_c=py.o(Cy,my,Wy,_v,dy,_g),LM(this,my,Cy,_v,Wy,_g,dy)),_c},_i("H.util.ICache",EE),EE.prototype.add=function(){},EE.prototype.get=function(){},EE.prototype.drop=EE.prototype.S=function(){},EE.prototype.forEach=function(){},EE.prototype.removeAll=EE.prototype.Y=function(){},EE.prototype.registerOnDrop=EE.prototype.K=function(){},EE.prototype.deRegisterOnDrop=EE.prototype.P=function(){},_i("H.util.Cache",g1),g1.prototype.add=function(_c,_g,dy){var py,my;if(!Yw(dy=+dy)||dy<0)throw new X_(this.add,2,dy);return _c=String(_c),(my=!this.m||this.m(_c,_g,dy))&&((py=this.a[_c])?(py.data!==_g&&eL(this,py),this.b+=dy-py.size,py.size=dy,py.data=_g,QP(this,py)):this.a[_c]=tL(this,{id:_c,data:_g,size:dy,H:null,v:null},this.c),z4(this)),my},g1.prototype.registerOnDrop=g1.prototype.K=function(_c){if(!_t(_c))throw new X_(this.K,0,_c);this.l.push(_c)},g1.prototype.deRegisterOnDrop=g1.prototype.P=function(_c){this.l=this.l.filter(function(_g){return _g!==_c})},g1.prototype.get=function(_c,_g){return(_c=_g?this.a[_c]:QP(this,this.a[_c]))&&_c.data},g1.prototype.drop=g1.prototype.S=function(_c){var _g;(_g=this.a[_c])&&rR(this,_g,!0)},g1.prototype.forEach=function(_c,_g,dy){var py;for(py in this.a){var my=this.a[py];dy&&!dy(py,my.data,my.size)||_c.call(_g,py,my.data,my.size)}},g1.prototype.removeAll=g1.prototype.Y=function(_c){var _g;for(_g in this.a){var dy=this.a[_g];_c&&!_c(_g,dy.data,dy.size)||rR(this,this.a[_g],!0)}},g1.prototype.setMaxSize=g1.prototype.Z=function(_c){if(!(0<+_c))throw new X_(g1.prototype.Z,0,_c);return this.u=+_c,z4(this),this},g1.prototype.getMaxSize=g1.prototype.ka=function(){return this.u},g1.prototype.getCurrentSize=g1.prototype.ia=function(){return this.b}}).call(lT);var p0,j_=OE={};function iN(s){return RA(lT.H.math.Point,A_(s))}OE.clipPolygon=function(s,l){var h,g,_,A=[],j=lT.H.math.clipping.clipPolygon(s.map(iN),l.map(iN));if(j)do{for(h=[],g=j;h.push([(_=g).x,_.y]),g=g.next;);A.push(h)}while(j=j.nextPoly);else OE.isPointInsidePolygon(l[0],s)?A.push(l):OE.isPointInsidePolygon(s[0],l)&&A.push(s);return A},OE.isPointInsidePolygon=function(s,l){return lT.H.math.isPointInsidePolygon({x:s[0],y:s[1]},lT.H.math.flatten(l))},OE.clamp=function(s,l,h){return(s-=0)>h?h:s<l?l:s},OE.splitLegs=function(s,l){var h=[];s.push(s[0]);for(var g=0;g<s.length-1;g++){var A=s[g],j=s[g+1];h.push(A),Math.abs(j[0]-A[0])>=l&&h.push([(A[0]+j[0])/2,(A[1]+j[1])/2])}return h.length!==s.length-1?OE.splitLegs(h,l):h},OE.getBBox=function(s){var l=1/0,h=1/0,g=-1/0,_=-1/0;return s.forEach(function(A){A[0]<l&&(l=A[0]),A[1]<h&&(h=A[1]),A[0]>g&&(g=A[0]),A[1]>_&&(_=A[1])}),[l,h,g,_]},OE.getBBoxCenter=function(s){var l=A0(s,4),h=l[0],g=l[1];return[h+(l[2]-h)/2,g+(l[3]-g)/2]},OE.getLineLength=function(s,l,h,g){return Math.sqrt(Math.pow(s-h,2)+Math.pow(l-g,2))},OE.modulo=function(s,l){var h;return(h=s%l)<0==l<0?h:h+l};var My=p0={};p0.default_source_max_zoom=18,p0.default_view_max_zoom=20,p0.tile_size=256,p0.half_circumference_meters=20037508.342789244,p0.circumference_meters=2*p0.half_circumference_meters,p0.min_zoom_meters_per_pixel=p0.circumference_meters/p0.tile_size;var AS=[];p0.metersPerPixel=function(s){return AS[s]=AS[s]||p0.min_zoom_meters_per_pixel/Math.pow(2,s),AS[s]};var vI=[];p0.metersPerTile=function(s){return vI[s]=vI[s]||p0.circumference_meters/Math.pow(2,s),vI[s]},p0.tile_scale=4096,p0.units_per_pixel=p0.tile_scale/p0.tile_size,p0.height_scale=16;var _I=[];p0.unitsPerMeter=function(s){return _I[s]=_I[s]||p0.tile_scale/(p0.tile_size*p0.metersPerPixel(s)),_I[s]},p0.metersForTile=function(s){return{x:s.x*p0.circumference_meters/Math.pow(2,s.z)-p0.half_circumference_meters,y:-(s.y*p0.circumference_meters/Math.pow(2,s.z)-p0.half_circumference_meters)}},p0.tileForMeters=function(s,l){var h=A0(s,2),_=h[1];return{x:Math.floor((h[0]+p0.half_circumference_meters)/(p0.circumference_meters/Math.pow(2,l))),y:Math.floor((-_+p0.half_circumference_meters)/(p0.circumference_meters/Math.pow(2,l))),z:l}},p0.metersToExactTileCoords=function(s,l){var h=A0(s,2),g=h[0],_=h[1];return{x:Math.pow(2,l-1)*(1+g/p0.half_circumference_meters),y:Math.pow(2,l-1)*(1-_/p0.half_circumference_meters),z:l}},p0.wrapTile=function(s){var l=s.x,h=s.y,g=s.z,_=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{x:!0,y:!1},A=(1<<g)-1;return _.x&&(l&=A),_.y&&(h&=A),{x:l,y:h,z:g}},p0.wrapMeters=function(s){var h=s.y;return{x:j_.modulo(s.x+p0.half_circumference_meters,p0.circumference_meters)-p0.half_circumference_meters,y:h}},p0.metersToLatLng=function(s){var l=A0(s,2),h=l[0],g=l[1];return h/=p0.half_circumference_meters,g/=p0.half_circumference_meters,g=(2*Math.atan(Math.exp(g*Math.PI))-Math.PI/2)/Math.PI,[h*=180,g*=180]},p0.latLngToMeters=function(s){var l=A0(s,2),h=l[0],g=l[1];return g=Math.log(Math.tan(g*Math.PI/360+Math.PI/4))/Math.PI,g*=p0.half_circumference_meters,g=Math.min(Math.max(g,-p0.half_circumference_meters),p0.half_circumference_meters),[h*=p0.half_circumference_meters/180,g]},p0.tileSpaceToMeters=function(s,l,h){var g=A0(s,2),_=g[0],A=g[1],j=p0.unitsPerMeter(l);return[_/j+h.x,A/j+h.y]},p0.tileSpaceToLatlng=function(s,l,h){var g=p0.unitsPerMeter(l);return p0.transformGeometry(s,function(_){_[0]=_[0]/g+h.x,_[1]=_[1]/g+h.y;var A=A0(p0.metersToLatLng(_),2),$=A[1];_[0]=A[0],_[1]=$}),s},p0.copyGeometry=function(s){if(null!=s){var l={type:s.type};return"Point"===s.type?l.coordinates=[s.coordinates[0],s.coordinates[1]]:"LineString"===s.type||"MultiPoint"===s.type?l.coordinates=s.coordinates.map(function(h){return[h[0],h[1]]}):"Polygon"===s.type||"MultiLineString"===s.type?l.coordinates=s.coordinates.map(function(h){return h.map(function(g){return[g[0],g[1]]})}):"MultiPolygon"===s.type&&(l.coordinates=s.coordinates.map(function(h){return h.map(function(g){return g.map(function(_){return[_[0],_[1]]})})})),l}},p0.transformGeometry=function(s,l){null!=s&&("Point"===s.type?l(s.coordinates):"LineString"===s.type||"MultiPoint"===s.type?s.coordinates.forEach(l):"Polygon"===s.type||"MultiLineString"===s.type?s.coordinates.forEach(function(h){return h.forEach(l)}):"MultiPolygon"===s.type&&s.coordinates.forEach(function(h){h.forEach(function(g){return g.forEach(l)})}))},p0.boxIntersect=function(s,l){return!(l.sw.x>s.ne.x||l.ne.x<s.sw.x||l.sw.y>s.ne.y||l.ne.y<s.sw.y)},p0.findBoundingBox=function(s){for(var l=1/0,h=-1/0,g=1/0,_=-1/0,A=s[0].length,j=0;j<A;j++){var $=s[0][j];$[0]<l&&(l=$[0]),$[1]<g&&(g=$[1]),$[0]>h&&(h=$[0]),$[1]>_&&(_=$[1])}return[l,g,h,_]},p0.geometryType=function(s){return"Polygon"===s||"MultiPolygon"===s?"polygon":"LineString"===s||"MultiLineString"===s?"line":"Point"===s||"MultiPoint"===s?"point":void 0},p0.centroid=function(s){var l=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(s&&0!==s.length){var h,g=0,_=0,A=0,j=s[0],$=j.length;l&&(h=j[0],j=j.map(function(lc){return[lc[0]-h[0],lc[1]-h[1]]}));for(var _t=0,Ye=$-1;_t<$;Ye=_t,_t++){var _i=j[_t],_s=j[Ye],Ja=_i[1]*_s[0]-_s[1]*_i[0];g+=(_i[0]+_s[0])*Ja,_+=(_i[1]+_s[1])*Ja,A+=3*Ja}var _l=[g/A,_/A];return l&&(_l[0]+=h[0],_l[1]+=h[1]),_l}},p0.multiCentroid=function(s){for(var l=s.length,h=[0,0],g=0;g<s.length;g++){var _=p0.centroid(s[g]);h[0]+=_[0],h[1]+=_[1]}return h[0]/=l,h[1]/=l,h},p0.signedPolygonRingAreaSum=function(s){for(var l=0,h=s.length,g=0;g<h-1;g++){var _=s[g],A=s[g+1];l+=_[0]*A[1]-A[0]*_[1]}return l+(s[h-1][0]*s[0][1]-s[0][0]*s[h-1][1])},p0.polygonRingArea=function(s){return Math.abs(p0.signedPolygonRingAreaSum(s))/2},p0.polygonArea=function(s){if(s)return p0.polygonRingArea(s[0])},p0.multiPolygonArea=function(s){for(var l=0,h=0;h<s.length;h++)l+=p0.polygonArea(s[h]);return l},p0.ringWinding=function(s){var l=p0.signedPolygonRingAreaSum(s);return 0<l?"CW":l<0?"CCW":void 0},p0.getTileBoundingBox=function(s,l){var h=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,g=p0.wrapTile(s,{x:!0}),_=p0.metersForTile(g),A=p0.metersPerPixel(g.z),j=p0.metersToLatLng([_.x-h*A,_.y+h*A]),$=p0.metersToLatLng([_.x+(l+h)*A,_.y-(l+h)*A]),_t=p0.isLastTile(g);return new lT.H.geo.Rect(0===s.y?90:j_.clamp(j[1],-90,90),j_.clamp(j[0],-180,180),_t.row?-90:j_.clamp($[1],-90,90),_t.column?180:j_.clamp($[0],-180,180))},p0.isLastTile=function(s){var l=s.x,g=s.z;return{row:s.y===Math.pow(2,g)-1,column:l===Math.pow(2,g)-1}};var CS,DS,bI=function(){L_(l,gE(Error));var s=B1(l);function l(h){var g;return D0(this,l),(g=s.call(this)).name="MethodNotImplemented",g.message="Method "+h+" must be implemented in subclass",g}return l}(),pD=!1,oN=!1;try{window.document!==HTMLDocument&&(oN=!0)}catch{void 0!==self&&(pD=!0,self.window={document:{}},self.document=self.window.document)}var V_={get is_fake_worker(){return self.is_fake_worker},get is_worker(){return void 0!==DS?DS:pD||self.is_fake_worker},set is_worker(s){DS=s},get is_main(){return void 0!==CS?CS:oN&&!self.is_fake_worker},set is_main(s){CS=s},is_native_worker:pD},_0={},VC=0,Yx={},SS={},sN={};function b1(s,l,h){var g=2<arguments.length&&void 0!==h?h:SS,_=[];if("string"==typeof s&&(s=(_=s.split(".")).pop()),V_.is_main&&l&&1===_.length&&"self"===_[0])g=l;else for(var A=0;A<_.length;A++){if(!g[_[A]])return[];g=g[_[A]]}return[s,g]}_0.addTarget=function(s,l){V_.is_fake_worker?sN[s]=l:SS[s]=l},_0.removeTarget=function(s){delete SS[s],delete sN[s]};var wI=" No object with that name is registered on main thread.",aN=" Object has no method with that name.",dD="_worker_broker_error_not_set_";function X1(s){Array.isArray(s)&&s.filter(function(l){return l.parent&&l.property}).forEach(function(l){return delete l.parent[l.property]})}_0.withTransferables=function(){for(var s=arguments.length,l=new Array(s),h=0;h<s;h++)l[h]=arguments[h];if(!(this instanceof _0.withTransferables))return RA(_0.withTransferables,l);this.value=l,this.transferables=function g(_){var A=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,j=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,$=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[];if(!_)return $;if(Array.isArray(_))_.forEach(function(Ye,_i){return g(Ye,_,_i,$)});else if("object"===T_(_))if(_ instanceof ArrayBuffer)$.push({object:_,parent:A,property:j});else if(_.buffer instanceof ArrayBuffer)$.push({object:_.buffer,parent:A,property:j});else for(var _t in _)g(_[_t],_,_t,$);return $}(this.value)},V_.is_main&&(_0.postMessage=function(s,l){for(var h=arguments.length,g=new Array(2<h?h-2:0),_=2;_<h;_++)g[_-2]=arguments[_];if(Array.isArray(s))return Promise.all(s.map(function(_s){return _0.postMessage.apply(_0,[_s,l].concat(A_(g)))}));var A,j={};"object"===T_(l)&&(l=(j=l).method);var $="main_send";"string"==typeof s?(l=s,g=Array.prototype.slice.call(arguments,1),A=!0,$="worker_send"):s.init&&(A=!0);var _t,Ye=[];if(g&&1===g.length&&g[0]instanceof _0.withTransferables&&(Ye=g[0].transferables,g=g[0].value),_t={type:$,message_id:++VC,method:l,message:g},A)return function(_s,Ja){var lc=A0(b1(_s.method,Ja,"main_send"===_s.type?sN:SS),2),_p=lc[0],ka=lc[1],ty="Worker broker could not dispatch message type ".concat(_s.method," on target ").concat(_s.target,".");if(!ka)throw Error(ty+wI);var ny="function"==typeof ka[_p]&&ka[_p];if(!ny)throw Error(ty+aN);return new Promise(function(ry,ly){var ey;try{ey=ny.apply(ka,_s.message)}catch(hy){return void ly(hy)}ey instanceof Promise?ey.then(function(hy){hy instanceof _0.withTransferables&&(hy=hy.value[0]),ry(hy)},function(hy){ly(hy instanceof Error?"".concat(hy.message,": ").concat(hy.stack):hy)}):(ey instanceof _0.withTransferables&&(ey=ey.value[0]),ry(ey))})}(_t,s&&s.init?s:void 0);var _i=new Promise(function(_s,Ja){Yx[VC]={method:l,message:g,resolve:_s,reject:Ja}});return j.stringify&&(_t=JSON.stringify(_t)),s.postMessage(_t,Ye.map(function(_s){return _s.object})),X1(Ye),_i},_0.addWorker=function(s){if(!(s instanceof Worker))throw Error("Worker broker could not add non-Worker object",s);s.addEventListener("message",function(l){var h="string"==typeof l.data?JSON.parse(l.data):l.data,g=h.message_id;if("worker_reply"===h.type)Yx[g]&&(h.error?Yx[g].reject(h.error):Yx[g].resolve(h.message),delete Yx[g]);else if("worker_send"===h.type&&null!=g){var _=A0(b1(h.method),2),A=_[0],j=_[1],$="Worker broker could not dispatch message type ".concat(h.method," on target ").concat(h.target,".");if(!j)throw Error($+wI);var _t="function"==typeof j[A]&&j[A];if(!_t)throw Error($+aN);var Ye,_i=dD;try{Ye=_t.apply(j,h.message)}catch(_l){_i=_l}var _s,Ja=[];Ye&&"function"==typeof Ye.then?Ye.then(function(_l){_l instanceof _0.withTransferables&&(Ja=_l.transferables,_l=_l.value[0]),s.postMessage(_s={type:"main_reply",message_id:g,message:_l},Ja.map(function(lc){return lc.object})),X1(Ja)},function(_l){s.postMessage({type:"main_reply",message_id:g,error:_l instanceof Error?"".concat(_l.message,": ").concat(_l.stack):_l})}):(Ye instanceof _0.withTransferables&&(Ja=Ye.transferables,Ye=Ye.value[0]),_s={type:"main_reply",message_id:g,message:Ye,error:_i instanceof Error?"".concat(_i.message,": ").concat(_i.stack):_i},s.postMessage(_s,Ja.map(function(_l){return _l.object})),X1(Ja))}})},_0.getMessages=function(){return Yx},_0.getMessageId=function(){return VC}),V_.is_worker&&(_0.postMessage=function(s){for(var l=arguments.length,h=new Array(1<l?l-1:0),g=1;g<l;g++)h[g-1]=arguments[g];var _={};"object"===T_(s)&&(s=(_=s).method);var A,j=new Promise(function(_t,Ye){Yx[VC]={method:s,message:h,resolve:_t,reject:Ye}}),$=[];return h&&1===h.length&&h[0]instanceof _0.withTransferables&&($=h[0].transferables,h=h[0].value),A={type:"worker_send",message_id:VC,method:s,message:h},_.stringify&&(A=JSON.stringify(A)),self.postMessage(A,$.map(function(_t){return _t.object})),X1($),VC++,j},self.addEventListener("message",function(s){var l="string"==typeof s.data?JSON.parse(s.data):s.data,h=l.message_id;if("main_reply"===l.type)Yx[h]&&(l.hasOwnProperty("error")&&l.error!==dD?Yx[h].reject(l.error):Yx[h].resolve(l.message),delete Yx[h]);else if("main_send"===l.type&&null!=h){var g=A0(b1(l.method),2),_=g[0],A=g[1],j="Worker broker could not dispatch message type ".concat(l.method," on target ").concat(l.target,".");if(!A)throw Error(j+wI);var $,_t,Ye="function"==typeof A[_]&&A[_];if(!Ye)throw Error(j+aN);try{$=Ye.apply(A,l.message)}catch(Ja){_t=Ja}var _i,_s=[];$ instanceof Promise?$.then(function(Ja){Ja instanceof _0.withTransferables&&(_s=Ja.transferables,Ja=Ja.value[0]),_i={type:"worker_reply",message_id:h,message:Ja},self.postMessage(_i,_s.map(function(_l){return _l.object})),X1(_s)},function(Ja){self.postMessage({type:"worker_reply",message_id:h,error:Ja instanceof Error?"".concat(Ja.message,": ").concat(Ja.stack):Ja})}):($ instanceof _0.withTransferables&&(_s=$.transferables,$=$.value[0]),_i={type:"worker_reply",message_id:h,message:$,error:_t instanceof Error?"".concat(_t.message,": ").concat(_t.stack):_t},self.postMessage(_i,_s.map(function(Ja){return Ja.object})),X1(_s))}}));var w_,MS={silent:-1,error:0,warn:1,info:2,debug:3,trace:4},eA={},mx={};function $y(s){var l,h="object"===T_(s)?s.level:s;if(MS[h]<=MS[$y.level]){for(var g=arguments.length,_=new Array(1<g?g-1:0),A=1;A<g;A++)_[A-1]=arguments[A];if(V_.is_native_worker)_0.postMessage.apply(_0,[{method:"_logProxy",stringify:!0},s].concat(_));else{if("object"===T_(s)&&!0===s.once){if(mx[JSON.stringify(_)])return;mx[JSON.stringify(_)]=!0}var j=(eA[l=h]=eA[l]||(console[l]?console[l]:console.log).bind(console),eA[l]);1<_.length?j.apply(void 0,["Tangram [".concat(h,"]: ").concat(_[0])].concat(A_(_.slice(1)))):j("Tangram [".concat(h,"]: ").concat(_[0]))}}}function NA(s,l,h){var g,_;return h=h||0,function(){var A=this,j=arguments;function $(){_=0,s.apply(A,j)}clearTimeout(g),_&&h&&Date.now()-_>=h?$():(_=_||Date.now(),g=setTimeout(function(){$()},l))}}$y.level="info",$y.workers=null,$y.setLevel=function(s){$y.level=s,V_.is_main&&Array.isArray($y.workers)&&_0.postMessage($y.workers,"_logSetLevelProxy",s)},V_.is_main&&($y.setWorkers=function(s){$y.workers=s},$y.reset=function(){mx={}}),_0.addTarget("_logProxy",$y),_0.addTarget("_logSetLevelProxy",$y.setLevel);var G0=w_={};_0.addTarget("Utils",w_),w_.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},w_.isMicrosoft=function(){return/(Trident\/7.0|Edge[ /](\d+[\.\d]+))/i.test(navigator.userAgent)},w_._requests={},w_._proxy_requests={},w_.io=function(s){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:6e4,h=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"text",g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"GET",_=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},A=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,j=6<arguments.length&&void 0!==arguments[6]&&arguments[6];if(V_.is_worker&&w_.isMicrosoft())return $y("debug","Proxying request for URL to worker",s),A&&(w_._proxy_requests[A]=!0),_0.postMessage("Utils.io",s,l,h,g,_,A,!0);var $=new XMLHttpRequest,_t=(_t=new Promise(function(Ye,_i){$.open(g,s,!0),$.timeout=l,$.responseType=h,$.onload=function(){200===$.status?-1<["text","json"].indexOf($.responseType)?Ye($.responseText):Ye($.response):_i(Error("Request error with a status of "+$.statusText))},$.onerror=function(_s){_i(Error("There was a network error"+_s.toString()))},$.ontimeout=function(_s){_i(Error("timeout "+_s.toString()))},$.send()})).then(function(Ye){return A&&delete w_._requests[A],j?_0.withTransferables(Ye):Ye});return A&&(w_._requests[A]=$),_t},w_.cancelRequest=function(s){if(V_.is_worker&&w_._proxy_requests[s])return _0.postMessage("Utils.cancelRequest",s);w_._requests[s]?($y("trace","Cancelling network request key '".concat(s,"'")),w_._requests[s].abort(),delete w_._requests[s]):$y("trace","Could not find network request key '".concat(s,"'"))},w_.requestAnimationFramePolyfill=function(){"function"!=typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(s){setTimeout(s,16.666666666666668)})},w_.serializeWithFunctions=function(s){return"function"==typeof s?s.toString():JSON.stringify(s,function(l,h){return"function"==typeof h?h.toString():h})},w_.stringsToFunctions=function(s,l){if("string"==typeof s)s=w_.stringToFunction(s,l);else if(null!=s&&"object"===T_(s))for(var h in s)s[h]=w_.stringsToFunctions(s[h],l);return s},w_._use_count=0,w_._function_cache={};var yE,zC,xI=NA(function(){$y("trace","Cleared cached ".concat(Object.keys(w_._function_cache).length," functions (reused ").concat(w_._use_count," times)")),w_._use_count=0,w_._function_cache={}},1e4),i_=/^\s*function[^(]*\(([^)]*)\)\s*?\{([\s\S]*)\}$/m;function BC(s){if("string"!=typeof s||-1!==s.search(/^(data|blob):/))return"";var l=s.indexOf("?");-1<l&&(s=s.substr(0,l));var h=s.indexOf("#");return-1<h&&(s=s.substr(0,h)),s.substr(0,s.lastIndexOf("/")+1)||""}function EI(s){return"string"==typeof s&&!(-1<s.search(/^(http|https|data|blob):/)||"//"===s.substr(0,2))}function TI(s){return void 0===yE&&"function"!=typeof(yE=window.URL&&window.URL.createObjectURL||window.webkitURL&&window.webkitURL.createObjectURL)&&(yE=null,$y("warn","window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs")),yE?yE(s):s}w_.stringToFunction=function(s,l){var h=s;l&&(h+=l.toString());var g=w_._function_cache[h];if(xI(),g)return w_._use_count++,g;var _="string"==typeof s&&s.match(i_);if(_&&2<_.length)try{var A=_[2],j=0<(j=0<_[1].length&&_[1].split(",").map(function(_t){return _t.trim()}).filter(function(_t){return _t})).length?j:["context"],$=new Function(j.toString(),"function"==typeof l?l(A):A);return w_._function_cache[h]=$}catch{return s}return s},w_.device_pixel_ratio=1,w_.isPowerOf2=function(s){return 0==(s&s-1)},w_.interpolate=function(s,l,h){if(!Array.isArray(l)||!Array.isArray(l[0])||l.length<1)return l;var g,_,A,j,$;if(s<=l[0][0])j=l[0][1],"function"==typeof h&&(j=h(j));else if(s>=l[l.length-1][0])j=l[l.length-1][1],"function"==typeof h&&(j=h(j));else for(var _t=0;_t<l.length-1;_t++)if(s>=l[_t][0]&&s<l[_t+1][0]){if(g=l[_t][0],_=l[_t+1][0],Array.isArray(l[_t][1])){j=[];for(var Ye=0;Ye<l[_t][1].length;Ye++)"function"==typeof h?($=h(l[_t][1][Ye]),A=h(l[_t+1][1][Ye])-$,j[Ye]=A*(s-g)/(_-g)+$):j[Ye]=(A=l[_t+1][1][Ye]-l[_t][1][Ye])*(s-g)/(_-g)+l[_t][1][Ye]}else j="function"==typeof h?($=h(l[_t][1]),(A=h(l[_t+1][1])-$)*(s-g)/(_-g)+$):(A=l[_t+1][1]-l[_t][1])*(s-g)/(_-g)+l[_t][1];break}return j},w_.toCSSColor=function(s){return 1===s[3]?"rgb(".concat(s.slice(0,3).map(function(l){return Math.round(255*l)}).join(", "),")"):"rgba(".concat(s.map(function(l,h){return h<3&&Math.round(255*l)||l}).join(", "),")")},w_.pointInTile=function(s){return 0<=s[0]&&s[1]>-My.tile_scale&&s[0]<My.tile_scale&&s[1]<=0},w_.zoomToTileLevel=function(s){return Math.floor(s)};var ax=function(){function s(l,h){var g=this;if(D0(this,s),this.config=l,this.sources=h,this.id=l.id,this.name=l.name,this.pad_scale=l.pad_scale||1e-4,this.default_winding=null,this.rasters=[],Array.isArray(l.rasters)&&l.rasters.forEach(function(A){-1===g.rasters.indexOf(A)&&g.rasters.push(A)}),this.preprocess=l.preprocess,"function"==typeof this.preprocess&&this.preprocess.bind(this),this.transform=l.transform,"function"==typeof this.transform)this.transform=this.transform.bind(this);else if("object"===T_(this.transform))for(var _ in this.transform)"function"==typeof this.transform[_]&&(this.transform[_]=this.transform[_].bind(this));this.extra_data=l.extra_data,this.scripts=l.scripts,this.max_zoom=null!=l.max_zoom?l.max_zoom:My.default_source_max_zoom,this.setTileSize(l.tile_size),this.max_coord_zoom=this.max_zoom+this.zoom_bias,this.min_display_zoom=null!=l.min_display_zoom?l.min_display_zoom:0,this.max_display_zoom=null!=l.max_display_zoom?l.max_display_zoom:null,this._has_volatile_data=!!l.has_volatile_data}return T0(s,[{key:"hasLabeledData",value:function(){return!0}},{key:"_transformTile",value:function(l){if(l.source_data.layers){var h={coords:l.coords},g=[];if("function"==typeof this.transform)g.push(this.transform);else if("object"===T_(this.transform))for(var _=Object.keys(this.transform).sort(),A=0;A<_.length;A++)g.push(this.transform[_[A]]);for(var j=1===Object.keys(l.source_data.layers).length&&l.source_data.layers._default,$=0;$<g.length;$++)j?l.source_data.layers._default=g[$](l.source_data.layers._default,this.extra_data,h):l.source_data.layers=g[$](l.source_data.layers,this.extra_data,h)}}},{key:"_postProcessTile",value:function(l){var h=this;for(var g in this._transformTile(l),l.source_data.layers){var _=l.source_data.layers[g];_&&_.features&&_.features.forEach(function(A){My.transformGeometry(A.geometry,function(j){j[1]=-j[1],h.pad_scale&&(j[0]=Math.round(j[0]*(1+h.pad_scale)-My.tile_scale*h.pad_scale/2),j[1]=Math.round(j[1]*(1+h.pad_scale)-My.tile_scale*h.pad_scale/2))}),h.updateDefaultWinding(A.geometry)})}l.default_winding=this.default_winding||"CCW"}},{key:"load",value:function(l){return l.source_data={},l.source_data.layers={},l.pad_scale=this.pad_scale,l.rasters=A_(this.rasters),this._load(l)}},{key:"_load",value:function(){throw new bI("_load")}},{key:"setTileSize",value:function(l){this.tile_size=l||256,("number"!=typeof this.tile_size||this.tile_size<256||!G0.isPowerOf2(this.tile_size))&&($y({level:"warn",once:!0},"Data source '".concat(this.name,"': 'tile_size' parameter must be a number that is a power of 2 greater than or equal to 256, but was '").concat(l,"'")),this.tile_size=256),this.zoom_bias=Math.log2(this.tile_size)-8}},{key:"updateDefaultWinding",value:function(l){return null==this.default_winding&&("Polygon"===l.type?this.default_winding=My.ringWinding(l.coordinates[0]):"MultiPolygon"===l.type&&(this.default_winding=My.ringWinding(l.coordinates[0][0]))),this.default_winding}},{key:"includesTile",value:function(l,h){if(l.z<this.min_display_zoom||null!=this.max_display_zoom&&h>this.max_display_zoom)return!1;for(var g=0;g<this.rasters.length;g++){var _=this.rasters[g];if(this.sources[_]&&this.sources[_]!==this&&!this.sources[_].includesTile(l,l.z))return!1}return!0}},{key:"has_volatile_data",get:function(){return this._has_volatile_data},set:function(l){var h=0<arguments.length&&void 0!==l&&l;this._has_volatile_data=h}}],[{key:"create",value:function(l,h){for(var g in h)if(h[g].config.name===l.name&&s.sameConfig(h[g],{config:l}))return h[g];if(s.types[l.type])return new s.types[l.type](l,h)}},{key:"sameConfig",value:function(l,h){if(!l||!h)return!1;var g=Object.assign({},l.config,{id:null,tiled:null,url:null}),_=Object.assign({},h.config,{id:null,tiled:null,url:null});return JSON.stringify(g)===JSON.stringify(_)}},{key:"coordsToMeters",value:function(l){var h=A0(My.latLngToMeters(l),2),_=h[1];l[0]=h[0],l[1]=_}},{key:"projectData",value:function(l){for(var h in l.layers)for(var g=l.layers[h].features.length,_=0;_<g;_++)My.transformGeometry(l.layers[h].features[_].geometry,s.coordsToMeters)}},{key:"metersToTileUnits",value:function(l,h,g){g[0]=Math.round((g[0]-h.x)*l),g[1]=-1*Math.round((g[1]-h.y)*l)}},{key:"scaleData",value:function(l,h){var _=h.min,A=s.metersToTileUnits.bind(this,My.unitsPerMeter(h.coords.z),_);for(var j in l.layers)for(var $=l.layers[j].features.length,_t=0;_t<$;_t++)My.transformGeometry(l.layers[j].features[_t].geometry,A)}},{key:"register",value:function(l,h){l&&h&&(s.types[h]=l)}}]),s}();ax.types={};var uN=0,E3=function(){L_(l,ax);var s=B1(l);function l(h,g){var _;D0(this,l),(_=s.call(this,h,g)).response_type="";var A=A0(function x3(s,l){if(!l||0===Object.keys(l).length)return[s,[]];var h=s.indexOf("?"),g=s.indexOf("#"),_="";-1<g&&(_=s.slice(g),s=s.slice(0,g)),-1===h&&(h=s.length,s+="?"),h++;var A="",j=[];for(var $ in l)""===function(_t,Ye){_t=_t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var _i=new RegExp("[\\?&]"+_t+"=([^&#]*)").exec(Ye);return null===_i?"":decodeURIComponent(_i[1].replace(/\+/g," "))}($,s)?A+="".concat($,"=").concat(l[$],"&"):j.push([$,l[$]]);return[s=s.slice(0,h)+A+s.slice(h)+_,j]}(h.url,h.url_params),2),$=A[1];if(_.url=A[0],$.forEach(function(_t){var Ye=A0(_t,2),_i=Ye[0],_s=Ye[1];$y({level:"warn",once:!0},"Data source '".concat(_.name,"': parameter '").concat(_i,"' already present in URL '").concat(h.url,"', ")+"skipping value '".concat(_i,"=").concat(_s,"' specified in 'url_params'"))}),"string"!=typeof _.url)throw Error("Network data source must provide a string `url` property");return _}return T0(l,[{key:"_load",value:function(h){var g=this,_=this.formatUrl(this.url,h),A=h.source_data;return A.url=_,new Promise(function(j,$){A.error=null;var _t=uN+++"-"+_,Ye=G0.io(_,6e4,g.response_type,"GET",{},_t);A.request_id=_t,Ye.then(function(_i){"function"==typeof g.preprocess&&(_i=g.preprocess(_i)),(_i=_i instanceof Promise?_i:Promise.resolve(_i)).then(function(_s){g.parseSourceData(h,A,_s),g._postProcessTile(h),j(h)})},function(_i){A.error=_i.stack,g._postProcessTile(h),j(h)})})}},{key:"formatUrl",value:function(){throw new bI("formatUrl")}},{key:"parseSourceData",value:function(){throw new bI("parseSourceData")}}]),l}(),T3=function(){L_(l,E3);var s=B1(l);function l(h,g){var _;return D0(this,l),(_=s.call(this,h,g)).tiled=!0,_.parseBounds(h),_.builds_geometry_tiles=!1,_.tms=!0===h.tms,-1<_.url.search("{s}")&&(Array.isArray(h.url_subdomains)&&0<h.url_subdomains.length?(_.url_subdomains=h.url_subdomains,_.next_url_subdomain=0):$y({level:"warn",once:!0},"Data source '".concat(_.name,"': source URL includes '{s}' subdomain marker ('").concat(_.url,"'), but no subdomains ")+"were specified in 'url_subdomains' parameter")),_}return T0(l,[{key:"parseBounds",value:function(h){var g,_,A,j;Array.isArray(h.bounds)&&4===h.bounds.length&&(this.bounds=h.bounds,_=(g=A0(this.bounds,4))[0],A=g[1],j=g[2],this.bounds_meters={min:My.latLngToMeters([_,g[3]]),max:My.latLngToMeters([j,A])},this.bounds_tiles={min:{},max:{}})}},{key:"checkBounds",value:function(h){if(this.bounds){h=My.wrapTile(h,{x:!0});var g=(g=this.bounds_tiles.min[h.z])||(this.bounds_tiles.min[h.z]=My.tileForMeters(this.bounds_meters.min,h.z)),_=(_=this.bounds_tiles.max[h.z])||(this.bounds_tiles.max[h.z]=My.tileForMeters(this.bounds_meters.max,h.z));if(h.x<g.x||h.x>_.x||h.y<g.y||h.y>_.y)return!1}return!0}},{key:"includesTile",value:function(h,g){return!!kE(h1(l.prototype),"includesTile",this).call(this,h,g)&&!!this.checkBounds(h)}},{key:"formatUrl",value:function(h,g){var _=My.wrapTile(g.coords,{x:!0});this.tms&&(_.y=Math.pow(2,_.z)-1-_.y);var A=h.replace("{x}",_.x).replace("{y}",_.y).replace("{z}",_.z);return null!=this.url_subdomains&&(A=A.replace("{s}",this.url_subdomains[this.next_url_subdomain]),this.next_url_subdomain=(this.next_url_subdomain+1)%this.url_subdomains.length),A}},{key:"urlHasTilePattern",value:function(h){return h&&-1<h.search("{x}")&&-1<h.search("{y}")&&-1<h.search("{z}")}}]),l}(),Hy=function(){L_(l,ax);var s=B1(l);function l(h,g){var _;return D0(this,l),(_=s.call(this,h,g)).target_name="MapsJsSource"+h.uid,_.tiled=!!h.tiled,_0.addTarget(_.target_name,mI(_)),V_.is_worker&&_0.postMessage(_.target_name+".onWorkerInitialized"),V_.is_main&&(_._workers_left=0),_}return T0(l,[{key:"initialize",value:function(h,g,_,A){this._main_initialized||(this.provider=h,this.worker=A,this._workers_left+=_,this._on_update=g,this._main_initialized=!0,this._onProviderUpdate=this._onProviderUpdate.bind(this),h.addEventListener("update",this._onProviderUpdate),this._isReady()&&this.onReady())}},{key:"onWorkerInitialized",value:function(){--this._workers_left,this._isReady()&&this.onReady()}},{key:"onReady",value:function(){}},{key:"_isReady",value:function(){return this._main_initialized&&!this._workers_left}},{key:"_onProviderUpdate",value:function(h){this._isReady()&&this.onProviderUpdate(h)}},{key:"onProviderUpdate",value:function(h){this.dispatchUpdate(void 0,h.data)}},{key:"dispatchUpdate",value:function(h,g){this._on_update(this.name,h,g)}},{key:"dispose",value:function(){_0.removeTarget(this.target_name),this.provider.removeEventListener("update",this._onProviderUpdate)}}]),l}(),k_=function(s,l,h,g,_){var A,j,$=8*_-g-1,_t=(1<<$)-1,Ye=_t>>1,_i=-7,_s=h?_-1:0,Ja=h?-1:1,_l=s[l+_s];for(_s+=Ja,A=_l&(1<<-_i)-1,_l>>=-_i,_i+=$;0<_i;A=256*A+s[l+_s],_s+=Ja,_i-=8);for(j=A&(1<<-_i)-1,A>>=-_i,_i+=g;0<_i;j=256*j+s[l+_s],_s+=Ja,_i-=8);if(0===A)A=1-Ye;else{if(A===_t)return j?NaN:1/0*(_l?-1:1);j+=Math.pow(2,g),A-=Ye}return(_l?-1:1)*j*Math.pow(2,A-g)},IS=function(s,l,h,g,_,A){var j,$,_t,Ye=8*A-_-1,_i=(1<<Ye)-1,_s=_i>>1,Ja=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,_l=g?0:A-1,lc=g?1:-1,_p=l<0||0===l&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?($=isNaN(l)?1:0,j=_i):(j=Math.floor(Math.log(l)/Math.LN2),l*(_t=Math.pow(2,-j))<1&&(j--,_t*=2),2<=(l+=1<=j+_s?Ja/_t:Ja*Math.pow(2,1-_s))*_t&&(j++,_t/=2),_i<=j+_s?($=0,j=_i):1<=j+_s?($=(l*_t-1)*Math.pow(2,_),j+=_s):($=l*Math.pow(2,_s-1)*Math.pow(2,_),j=0));8<=_;s[h+_l]=255&$,_l+=lc,$/=256,_-=8);for(j=j<<_|$,Ye+=_;0<Ye;s[h+_l]=255&j,_l+=lc,j/=256,Ye-=8);s[h+_l-lc]|=128*_p},AI=f_;function f_(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}f_.Varint=0,f_.Fixed64=1,f_.Bytes=2,f_.Fixed32=5;var kS=4294967296,HC=1/kS;function J1(s){return s.type===f_.Bytes?s.readVarint()+s.pos:s.pos+1}function OS(s,l,h){var g=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.ceil(Math.log(l)/(7*Math.LN2));h.realloc(g);for(var _=h.pos-1;s<=_;_--)h.buf[_+g]=h.buf[_]}function bV(s,l){for(var h=0;h<s.length;h++)l.writeVarint(s[h])}function A3(s,l){for(var h=0;h<s.length;h++)l.writeSVarint(s[h])}function wV(s,l){for(var h=0;h<s.length;h++)l.writeFloat(s[h])}function lN(s,l){for(var h=0;h<s.length;h++)l.writeDouble(s[h])}function vx(s,l){for(var h=0;h<s.length;h++)l.writeBoolean(s[h])}function cT(s,l){for(var h=0;h<s.length;h++)l.writeFixed32(s[h])}function cN(s,l){for(var h=0;h<s.length;h++)l.writeSFixed32(s[h])}function UC(s,l){for(var h=0;h<s.length;h++)l.writeFixed64(s[h])}function hT(s,l){for(var h=0;h<s.length;h++)l.writeSFixed64(s[h])}function RS(s,l){return(s[l]|s[l+1]<<8|s[l+2]<<16)+16777216*s[l+3]}function PA(s,l,h){s[h]=l,s[h+1]=l>>>8,s[h+2]=l>>>16,s[h+3]=l>>>24}function hN(s,l){return(s[l]|s[l+1]<<8|s[l+2]<<16)+(s[l+3]<<24)}f_.prototype={destroy:function(){this.buf=null},readFields:function(s,l,h){for(h=h||this.length;this.pos<h;){var g=this.readVarint(),_=g>>3,A=this.pos;this.type=7&g,s(_,l,this),this.pos===A&&this.skip(g)}return l},readMessage:function(s,l){return this.readFields(s,l,this.readVarint()+this.pos)},readFixed32:function(){var s=RS(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=hN(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=RS(this.buf,this.pos)+RS(this.buf,this.pos+4)*kS;return this.pos+=8,s},readSFixed64:function(){var s=RS(this.buf,this.pos)+hN(this.buf,this.pos+4)*kS;return this.pos+=8,s},readFloat:function(){var s=k_(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=k_(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var l=this.buf,h=l[this.pos++],g=127&h;return h<128?g:(g|=(127&(h=l[this.pos++]))<<7,h<128?g:(g|=(127&(h=l[this.pos++]))<<14,h<128?g:(g|=(127&(h=l[this.pos++]))<<21,h<128?g:function(_,A,j){var $,_t,Ye=j.buf;if($=(112&(_t=Ye[j.pos++]))>>4,_t<128||($|=(127&(_t=Ye[j.pos++]))<<3,_t<128)||($|=(127&(_t=Ye[j.pos++]))<<10,_t<128)||($|=(127&(_t=Ye[j.pos++]))<<17,_t<128)||($|=(127&(_t=Ye[j.pos++]))<<24,_t<128)||($|=(1&(_t=Ye[j.pos++]))<<31,_t<128))return function nA(s,l,h){return h?4294967296*l+(s>>>0):4294967296*(l>>>0)+(s>>>0)}(_,$,A);throw new Error("Expected varint not more than 10 bytes")}(g|=(15&(h=l[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var s=this.readVarint()+this.pos,l=function(h,g,_){for(var A,j,$,_t="",Ye=g;Ye<_;){var _i=h[Ye],_s=null,Ja=239<_i?4:223<_i?3:191<_i?2:1;if(_<Ye+Ja)break;1===Ja?_i<128&&(_s=_i):2===Ja?128==(192&(A=h[Ye+1]))&&(_s=(31&_i)<<6|63&A)<=127&&(_s=null):3===Ja?(j=h[Ye+2],128==(192&(A=h[Ye+1]))&&128==(192&j)&&((_s=(15&_i)<<12|(63&A)<<6|63&j)<=2047||55296<=_s&&_s<=57343)&&(_s=null)):4===Ja&&(j=h[Ye+2],$=h[Ye+3],128==(192&(A=h[Ye+1]))&&128==(192&j)&&128==(192&$)&&((_s=(15&_i)<<18|(63&A)<<12|(63&j)<<6|63&$)<=65535||1114112<=_s)&&(_s=null)),null===_s?(_s=65533,Ja=1):65535<_s&&(_s-=65536,_t+=String.fromCharCode(_s>>>10&1023|55296),_s=56320|1023&_s),_t+=String.fromCharCode(_s),Ye+=Ja}return _t}(this.buf,this.pos,s);return this.pos=s,l},readBytes:function(){var s=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,s);return this.pos=s,l},readPackedVarint:function(s,l){var h=J1(this);for(s=s||[];this.pos<h;)s.push(this.readVarint(l));return s},readPackedSVarint:function(s){var l=J1(this);for(s=s||[];this.pos<l;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){var l=J1(this);for(s=s||[];this.pos<l;)s.push(this.readBoolean());return s},readPackedFloat:function(s){var l=J1(this);for(s=s||[];this.pos<l;)s.push(this.readFloat());return s},readPackedDouble:function(s){var l=J1(this);for(s=s||[];this.pos<l;)s.push(this.readDouble());return s},readPackedFixed32:function(s){var l=J1(this);for(s=s||[];this.pos<l;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){var l=J1(this);for(s=s||[];this.pos<l;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){var l=J1(this);for(s=s||[];this.pos<l;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){var l=J1(this);for(s=s||[];this.pos<l;)s.push(this.readSFixed64());return s},skip:function(s){var l=7&s;if(l===f_.Varint)for(;127<this.buf[this.pos++];);else if(l===f_.Bytes)this.pos=this.readVarint()+this.pos;else if(l===f_.Fixed32)this.pos+=4;else{if(l!==f_.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(s,l){this.writeVarint(s<<3|l)},realloc:function(s){for(var l,h=this.length||16;h<this.pos+s;)h*=2;h!==this.length&&((l=new Uint8Array(h)).set(this.buf),this.buf=l,this.length=h)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),PA(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),PA(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),PA(this.buf,-1&s,this.pos),PA(this.buf,Math.floor(s*HC),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),PA(this.buf,-1&s,this.pos),PA(this.buf,Math.floor(s*HC),this.pos+4),this.pos+=8},writeVarint:function(s){268435455<(s=+s||0)||s<0?function(l,h){var g,_,A,j;if(0<=l?(g=l%4294967296|0,_=l/4294967296|0):(_=~(-l/4294967296),4294967295^(g=~(-l%4294967296))?g=g+1|0:_=_+1|(g=0)),0x10000000000000000<=l||l<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),A=g,(j=h).buf[j.pos++]=127&A|128,A>>>=7,j.buf[j.pos++]=127&A|128,A>>>=7,j.buf[j.pos++]=127&A|128,A>>>=7,j.buf[j.pos++]=127&A|128,j.buf[j.pos]=127&(A>>>=7),function(A,j){var $=(7&A)<<4;j.buf[j.pos++]|=$|((A>>>=3)?128:0),A&&(j.buf[j.pos++]=127&A|((A>>>=7)?128:0),A&&(j.buf[j.pos++]=127&A|((A>>>=7)?128:0),A&&(j.buf[j.pos++]=127&A|((A>>>=7)?128:0),A&&(j.buf[j.pos++]=127&A|((A>>>=7)?128:0),A&&(j.buf[j.pos++]=127&A)))))}(_,h)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(127<s?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(127<s?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(127<s?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(Boolean(s))},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var l=this.pos;this.pos=function(g,_,A){for(var j,$,_t=0;_t<_.length;_t++){if(55295<(j=_.charCodeAt(_t))&&j<57344){if(!$){56319<j||_t+1===_.length?(g[A++]=239,g[A++]=191,g[A++]=189):$=j;continue}if(j<56320){g[A++]=239,g[A++]=191,g[A++]=189,$=j;continue}j=$-55296<<10|j-56320|65536,$=null}else $&&(g[A++]=239,g[A++]=191,g[A++]=189,$=null);j<128?g[A++]=j:(j<2048?g[A++]=j>>6|192:(j<65536?g[A++]=j>>12|224:(g[A++]=j>>18|240,g[A++]=j>>12&63|128),g[A++]=j>>6&63|128),g[A++]=63&j|128)}return A}(this.buf,s,this.pos);var h=this.pos-l;128<=h&&OS(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h},writeFloat:function(s){this.realloc(4),IS(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),IS(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var l=s.length;this.writeVarint(l),this.realloc(l);for(var h=0;h<l;h++)this.buf[this.pos++]=s[h]},writeRawMessage:function(s,l){this.pos++;var h=this.pos;s(l,this);var g=this.pos-h;128<=g&&OS(h,g,this),this.pos=h-1,this.writeVarint(g),this.pos+=g},writeMessage:function(s,l,h){this.writeTag(s,f_.Bytes),this.writeRawMessage(l,h)},writePackedVarint:function(s,l){this.writeMessage(s,bV,l)},writePackedSVarint:function(s,l){this.writeMessage(s,A3,l)},writePackedBoolean:function(s,l){this.writeMessage(s,vx,l)},writePackedFloat:function(s,l){this.writeMessage(s,wV,l)},writePackedDouble:function(s,l){this.writeMessage(s,lN,l)},writePackedFixed32:function(s,l){this.writeMessage(s,cT,l)},writePackedSFixed32:function(s,l){this.writeMessage(s,cN,l)},writePackedFixed64:function(s,l){this.writeMessage(s,UC,l)},writePackedSFixed64:function(s,l){this.writeMessage(s,hT,l)},writeBytesField:function(s,l){this.writeTag(s,f_.Bytes),this.writeBytes(l)},writeFixed32Field:function(s,l){this.writeTag(s,f_.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(s,l){this.writeTag(s,f_.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(s,l){this.writeTag(s,f_.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(s,l){this.writeTag(s,f_.Fixed64),this.writeSFixed64(l)},writeVarintField:function(s,l){this.writeTag(s,f_.Varint),this.writeVarint(l)},writeSVarintField:function(s,l){this.writeTag(s,f_.Varint),this.writeSVarint(l)},writeStringField:function(s,l){this.writeTag(s,f_.Bytes),this.writeString(l)},writeFloatField:function(s,l){this.writeTag(s,f_.Fixed32),this.writeFloat(l)},writeDoubleField:function(s,l){this.writeTag(s,f_.Fixed64),this.writeDouble(l)},writeBooleanField:function(s,l){this.writeVarintField(s,Boolean(l))}},TS.prototype.loadGeometry=function(s){var l=this._pbf;l.pos=this._geometry;for(var h,g,_=l.readVarint()+l.pos,A=1,j=0,$=0,_t=0,Ye=[];l.pos<_;)if(j<=0&&(A=7&(g=l.readVarint()),j=g>>3),j--,1===A||2===A)$+=l.readSVarint(),_t+=l.readSVarint(),1===A&&(h&&Ye.push(h),h=[]),h.push([$*s,_t*s]);else{if(7!==A)throw new Error("unknown command "+A);h&&h.push(h[0].slice())}return h&&Ye.push(h),Ye};function NS(s){var l=[],h=s&&s.features;if(h)for(var g=0,_=h.length;g<_;g++){var A=h[g],j=A.type,$=void 0;switch(j){case 1:$={type:"MultiPoint",coordinates:A.geometry.map(function(_t){return _t.slice()})};break;case 2:case 3:if($={type:"MultiLineString",coordinates:A.geometry.map(function(_t){return _t.map(function(Ye){return Ye.slice()})})},3===j&&null==($=CI($)))continue;break;default:continue}l.push({id:A.id,type:"Feature",geometry:$,properties:A.tags})}return{type:"FeatureCollection",features:l}}function CI(s){for(var l,h=[],g=[],_=0,A=s.coordinates.length;_<A;_++){var j=s.coordinates[_],$=My.ringWinding(j);null!=$&&($===(l=l||$)&&g.length&&(h.push(g),g=[]),g.push(j))}return 0<g.length&&h.push(g),1===h.length?(s.type="Polygon",s.coordinates=h[0]):1<h.length?(s.type="MultiPolygon",s.coordinates=h):s=null,s}var DI={type:"FeatureCollection",features:[]},fN=function(){L_(l,Hy);var s=B1(l);function l(h,g){return D0(this,l),h.tiled=!0,s.call(this,h,g)}return T0(l,[{key:"fetchTile",value:function(h,g,_){return this.provider?this.provider.requestTileAsPromise(h,g,_).then(function(A){return A.data}):Promise.resolve()}},{key:"_load",value:function(h){var g=this,_=My.wrapTile(h.coords,{x:!0,y:!0});return _0.postMessage(this.target_name+".fetchTile",_.x,_.y,_.z).then(function(_t){var Ye;return _t instanceof ArrayBuffer?(Ye=new AI(new Uint8Array(_t)),h.source_data.layers=function C3(s){var l={};for(var h in s.layers){for(var g=s.layers[h],_=[],A=My.tile_scale/g.extent,j=0,$=g.length;j<$;j++){var _t=g.feature(j),Ye=TS.types[_t.type],_i=_t.loadGeometry(A),_s=null;switch(Ye){case"Point":_s=function(Ja){var _l=Ja.coordinates.length;if(1<_l){Ja.type="MultiPoint";for(var lc=[],_p=0;_p<_l;_p++)lc.push(Ja.coordinates[_p][0]);Ja.coordinates=lc}else Ja.type="Point",Ja.coordinates=Ja.coordinates[0][0];return Ja}({coordinates:_i});break;case"LineString":_s=1===_i.length?{type:Ye,coordinates:_i[0]}:{type:"MultiLineString",coordinates:_i};break;case"Polygon":_s=CI({coordinates:_i})}_s&&_s.coordinates&&_.push({type:"Feature",geometry:_s,properties:_t.properties})}l[h]={type:"FeatureCollection",features:_}}return l}(new rN(Ye))):_t?h.source_data.error=_t:h.source_data.layers={_default:DI},g._postProcessTile(h),h})}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),l}();function PS(s){return Math.max(s,0)}function gD(s){return isNaN(s)?0:s}function LA(s){return Array.isArray(s)?s.map(parseFloat).map(gD):gD(parseFloat(s))}function qC(s){return Array.isArray(s)?s.map(LA).map(PS):PS(LA(s))}ax.register(fN,"MVT"),ax.register(fN,"OMV");var SI=_e(function(s,l){var h={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function g(_t){return(_t=Math.round(_t))<0?0:255<_t?255:_t}function A(_t){return g("%"===_t[_t.length-1]?parseFloat(_t)/100*255:parseInt(_t))}function j(_t){return function _(_t){return _t<0?0:1<_t?1:_t}("%"===_t[_t.length-1]?parseFloat(_t)/100:parseFloat(_t))}function $(_t,Ye,_i){return _i<0?_i+=1:1<_i&&--_i,6*_i<1?_t+(Ye-_t)*_i*6:2*_i<1?Ye:3*_i<2?_t+(Ye-_t)*(2/3-_i)*6:_t}try{l.parseCSSColor=function(_t){var Ye,_i=_t.replace(/ /g,"").toLowerCase();if(_i in h)return h[_i].slice();if("#"===_i[0])return 4===_i.length?0<=(Ye=parseInt(_i.substr(1),16))&&Ye<=4095?[(3840&Ye)>>4|(3840&Ye)>>8,240&Ye|(240&Ye)>>4,15&Ye|(15&Ye)<<4,1]:null:7===_i.length&&0<=(Ye=parseInt(_i.substr(1),16))&&Ye<=16777215?[(16711680&Ye)>>16,(65280&Ye)>>8,255&Ye,1]:null;var _s=_i.indexOf("("),Ja=_i.indexOf(")");if(-1!==_s&&Ja+1===_i.length){var _l=_i.substr(0,_s),lc=_i.substr(_s+1,Ja-(_s+1)).split(","),_p=1;switch(_l){case"rgba":if(4!==lc.length)return null;_p=j(lc.pop());case"rgb":return 3!==lc.length?null:[A(lc[0]),A(lc[1]),A(lc[2]),_p];case"hsla":if(4!==lc.length)return null;_p=j(lc.pop());case"hsl":if(3!==lc.length)return null;var ka=(parseFloat(lc[0])%360+360)%360/360,ty=j(lc[1]),ny=j(lc[2]),ry=ny<=.5?ny*(ty+1):ny+ty-ny*ty,ly=2*ny-ry;return[g(255*$(ly,ry,ka+1/3)),g(255*$(ly,ry,ka)),g(255*$(ly,ry,ka-1/3)),_p];default:return null}}return null}}catch{}}),by={};Object.assign(by,{clampPositive:PS,noNaN:gD,parseNumber:LA,parsePositiveNumber:qC}),by.wrapFunction=function(s){return"\n        var feature = context.feature.properties;\n        var global = context.global;\n        var $zoom = context.zoom;\n        var $layer = context.layer;\n        var $source = context.source;\n        var sources = context.sources;\n        var $geometry = context.geometry;\n        var $meters_per_pixel = context.meters_per_pixel;\n\n        var val = (function(){ ".concat(s," }());\n\n        if (typeof val === 'number' && isNaN(val)) {\n            val = null; // convert NaNs to nulls\n        }\n\n        return val;\n    ")},by.zeroPair=Object.freeze([0,0]),by.defaults={color:[1,1,1,1],width:1,size:1,extrude:!1,height:20,min_height:0,order:0,z:0,outline:{color:[0,0,0,0],width:0},material:{ambient:1,diffuse:1}},by.macros={"Style.color.pseudoRandomColor":function(){return[parseInt(feature.id,16)/100%1*.7,parseInt(feature.id,16)/1e4%1*.7,parseInt(feature.id,16)/1e6%1*.7,1]},"Style.color.randomColor":function(){return[.7*Math.random(),.7*Math.random(),.7*Math.random(),1]}},by.getFeatureParseContext=function(s,l,h,g){return{feature:s,tile:l,global:h,sources:g,zoom:l.style_zoom,geometry:My.geometryType(s.geometry.type),meters_per_pixel:l.meters_per_pixel,meters_per_pixel_sq:l.meters_per_pixel_sq,units_per_meter_overzoom:l.units_per_meter_overzoom}};var WC={STATIC:0,DYNAMIC:1,ZOOM:2};function $C(s){return"string"==typeof s&&"%"===s[s.length-1]}function MI(s){return"auto"===s}function ux(s){return $C(s)||MI(s)}by.CACHE_TYPE=WC,by.createPropertyCache=function(s){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(null!=s){if(s.value)return{value:s.value,zoom:s.zoom?{}:null,type:s.type};var h={value:s,type:WC.STATIC};return Array.isArray(h.value)&&Array.isArray(h.value[0])?(h.zoom={},h.type=WC.ZOOM):"function"==typeof h.value&&(h.type=WC.DYNAMIC),"function"==typeof l&&(h.zoom?h.value=h.value.map(function(g,_){return[g[0],l(g[1],_)]}):"function"!=typeof h.value&&(h.value=l(h.value,0))),h}},by.createColorPropertyCache=function(s){return by.createPropertyCache(s,function(l){return"Style.color.pseudoRandomColor"===l?G0.stringToFunction(by.wrapFunction(by.macros["Style.color.pseudoRandomColor"])):"Style.color.randomColor"===l?by.macros["Style.color.randomColor"]:l})};var fT="'size' can specify either width or height as derived from aspect ratio, but not both";by.createPointSizePropertyCache=function(s){var l=null,h=null;if($C(s))l=[!0];else if(Array.isArray(s))if(Array.isArray(s[0])){if(s.some(function(g){return Array.isArray(g[1])?g[1].some(ux):$C(g[1])})&&(l=s.map(function(g){return Array.isArray(g[1])?g[1].map($C):$C(g[1])}),(h=s.map(function(g){return Array.isArray(g[1])&&g[1].map(MI)})).some(function(g){return Array.isArray(g)&&g.every(function(_){return _})})))throw fT}else if(s.some(ux)&&(l=[s.map($C)],(h=[s.map(MI)])[0].every(function(g){return g})))throw fT;return l?((s={value:s}).has_pct=l,s.has_ratio=h,s.sprites={}):s=by.createPropertyCache(s,qC),s},by.evalCachedPointSizeProperty=function(s,l,h){return s.has_pct||s.has_ratio?l?(s.sprites[l.sprite]||(s.sprites[l.sprite]=by.createPropertyCache(s.value,function(g,_){return Array.isArray(g)?(g=g.map(function(A,j){return s.has_ratio[_][j]?A:qC(A)}).map(function(A,j){return s.has_pct[_][j]?l.css_size[j]*A/100:A}),s.has_ratio[_][0]?g[0]=g[1]*l.aspect:s.has_ratio[_][1]&&(g[1]=g[0]/l.aspect)):(g=qC(g),g=s.has_pct[_]?l.css_size.map(function(A){return A*g/100}):[g,g]),g})),by.evalCachedProperty(s.sprites[l.sprite],h)):void 0:by.evalCachedProperty(s,h)},by.evalCachedProperty=function(s,l){if(null!=s)return s.dynamic?s.dynamic(l):s.static?s.static:s.zoom&&s.zoom[l.zoom]?s.zoom[l.zoom]:"function"!=typeof s.value?Array.isArray(s.value)&&Array.isArray(s.value[0])?(s.zoom=s.zoom||{},s.zoom[l.zoom]=G0.interpolate(l.zoom,s.value),s.zoom[l.zoom]):(s.static=s.value,s.static):(s.dynamic=s.value,s.dynamic(l))},by.convertUnits=function(s,l){if(null!=s.val)return"px"===s.units?s.val*My.metersPerPixel(l.zoom):s.val;if("string"==typeof s)"px"===s.trim().slice(-2)?(s=LA(s),s*=My.metersPerPixel(l.zoom)):s=LA(s);else if(Array.isArray(s))return Array.isArray(s[0])?s.map(function(h){return[h[0],by.convertUnits(h[1],l)]}):s.map(function(h){return by.convertUnits(h,l)});return s},by.parseUnits=function(s){var l={val:LA(s)};return 0!==l.val&&"string"==typeof s&&"px"===s.trim().slice(-2)&&(l.units="px"),l},by.evalCachedDistanceProperty=function(s,l){return s.dynamic?s.dynamic(l):s.zoom&&s.zoom[l.zoom]?s.zoom[l.zoom]:"function"!=typeof s.value?s.zoom?(s.zoom[l.zoom]=G0.interpolate(l.zoom,s.value,function(h){return by.convertUnits(h,l)}),s.zoom[l.zoom]):by.convertUnits(s.value,l):(s.dynamic=s.value,s.dynamic(l))},by.string_colors={},by.colorForString=function(s){if(by.string_colors[s])return by.string_colors[s];var l=null;return"none"!==s&&((l=SI.parseCSSColor(s))&&4===l.length?(l[0]/=255,l[1]/=255,l[2]/=255):l=by.defaults.color),by.string_colors[s]=l},by.evalCachedColorProperty=function(s){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(s.dynamic){var h=s.dynamic(l);return"string"==typeof h&&(h=by.colorForString(h)),h&&null==h[3]&&(h[3]=1),h}if(s.static)return s.static;if(s.zoom&&s.zoom[l.zoom])return s.zoom[l.zoom];if("function"==typeof s.value){s.dynamic=s.value;var g=s.dynamic(l);return"string"==typeof g&&(g=by.colorForString(g)),g&&null==g[3]&&(g[3]=1),g}if("string"==typeof s.value)return s.static=by.colorForString(s.value),s.static;if(s.zoom){if(!s.zoom_preprocessed){for(var _=0;_<s.value.length;_++){var A=s.value[_];A&&"string"==typeof A[1]&&(A[1]=by.colorForString(A[1]))}s.zoom_preprocessed=!0}return s.zoom[l.zoom]=G0.interpolate(l.zoom,s.value),s.zoom[l.zoom][3]=s.zoom[l.zoom][3]||1,s.zoom[l.zoom]}return s.static=s.value.map(function(j){return j}),s.static&&null==s.static[3]&&(s.static[3]=1),s.static},by.parseColor=function(s){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof s&&(s=s(l)),"string"==typeof s)s=by.colorForString(s);else if(Array.isArray(s)&&Array.isArray(s[0])){for(var h=0;h<s.length;h++){var g=s[h];"string"==typeof g[1]&&(g[1]=by.colorForString(g[1]))}l.zoom&&(s=G0.interpolate(l.zoom,s))}return Array.isArray(s)?null==(s=s.map(function(_){return _}))[3]&&(s[3]=1):s=[0,0,0,1],s},by.calculateOrder=function(s,l){return"function"==typeof s?s=s(l):"string"==typeof s&&(s=l.feature.properties[s]?l.feature.properties[s]:qC(s)),s},by.evalProperty=function(s,l){return"function"==typeof s?s(l):s};var c1=function(){function s(l,h){D0(this,s),this.key=l,this.repeat_dist=h,this.repeat_dist_sq=this.repeat_dist*this.repeat_dist,this.positions=[]}return T0(s,[{key:"check",value:function(l){for(var h=l.position,g=0;g<this.positions.length;g++){var _=this.positions[g],A=h[0]-_[0],j=h[1]-_[1],$=A*A+j*j;if($<this.repeat_dist_sq)return{dist_sq:$,repeat_dist_sq:this.repeat_dist_sq}}}},{key:"add",value:function(l){l&&l.position&&this.positions.push(l.position)}}],[{key:"clear",value:function(l){this.groups[l]={}}},{key:"check",value:function(l,h,g){if(h.repeat_distance&&h.repeat_group&&this.groups[g][h.repeat_group])return this.groups[g][h.repeat_group].check(l)}},{key:"add",value:function(l,h,g){h.repeat_distance&&h.repeat_group&&(null==this.groups[g][h.repeat_group]&&(this.groups[g][h.repeat_group]=new s(h.repeat_group,h.repeat_distance*h.repeat_scale)),this.groups[g][h.repeat_group].add(l))}}]),s}();c1.groups={};var pN=function(){function s(l,h,g){D0(this,s);var _=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(l/g),this.yCellCount=Math.ceil(h/g);for(var j=0;j<this.xCellCount*this.yCellCount;j++)_.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=h,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}return T0(s,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(l,h,g,_,A){this._forEachCell(h,g,_,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(_),this.bboxes.push(A)}},{key:"insertCircle",value:function(l,h,g,_){this._forEachCell(h-_,g-_,h+_,g+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(h),this.circles.push(g),this.circles.push(_)}},{key:"insertCircleList",value:function(l,h){for(var g=0;g<h.length-2;g+=3)this.insertCircle("".concat(l,"/").concat(g),h[g],h[g+1],h[g+2])}},{key:"_insertBoxCell",value:function(l,h,g,_,A,j){this.boxCells[A].push(j)}},{key:"_insertCircleCell",value:function(l,h,g,_,A,j){this.circleCells[A].push(j)}},{key:"_query",value:function(l,h,g,_,A,j){if(g<0||l>this.width||_<0||h>this.height)return!A&&[];var $=[];if(l<=0&&h<=0&&this.width<=g&&this.height<=_){if(A)return!0;for(var _t=0;_t<this.boxKeys.length;_t++)$.push({key:this.boxKeys[_t],x1:this.bboxes[4*_t],y1:this.bboxes[4*_t+1],x2:this.bboxes[4*_t+2],y2:this.bboxes[4*_t+3]});for(var Ye=0;Ye<this.circleKeys.length;Ye++){var _i=this.circles[3*Ye],_s=this.circles[3*Ye+1],Ja=this.circles[3*Ye+2];$.push({key:this.circleKeys[Ye],x1:_i-Ja,y1:_s-Ja,x2:_i+Ja,y2:_s+Ja})}return j?$.filter(j):$}return this._forEachCell(l,h,g,_,this._queryCell,$,{hitTest:A,seenUids:{box:{},circle:{}}},j),A?0<$.length:$}},{key:"_queryCircle",value:function(l,h,g,_,A){var j=l-g,$=l+g,_t=h-g,Ye=h+g;if($<0||j>this.width||Ye<0||_t>this.height)return!_&&[];var _i=[];return this._forEachCell(j,_t,$,Ye,this._queryCellCircle,_i,{hitTest:_,circle:{x:l,y:h,radius:g},seenUids:{box:{},circle:{}}},A),_?0<_i.length:_i}},{key:"query",value:function(l,h,g,_,A){return this._query(l,h,g,_,!1,A)}},{key:"hitTest",value:function(l,h,g,_,A){return this._query(l,h,g,_,!0,A)}},{key:"hitTestCircle",value:function(l,h,g,_){return this._queryCircle(l,h,g,!0,_)}},{key:"hitTestCircleList",value:function(l,h){for(var g=0;g<l.length-2;g+=3)if(this.hitTestCircle(l[g],l[g+1],l[g+2],h))return!0;return!1}},{key:"_queryCell",value:function(l,h,g,_,A,j,$,_t){var Ye=$.seenUids,_i=this.boxCells[A];if(null!==_i){var _s,Ja=this.bboxes,_l=ES(_i);try{for(_l.s();!(_s=_l.n()).done;){var lc=_s.value;if(!Ye.box[lc]){Ye.box[lc]=!0;var _p=4*lc;if(l<=Ja[2+_p]&&h<=Ja[3+_p]&&g>=Ja[0+_p]&&_>=Ja[1+_p]&&(!_t||_t(this.boxKeys[lc]))){if($.hitTest)return j.push(!0),!0;j.push({key:this.boxKeys[lc],x1:Ja[_p],y1:Ja[1+_p],x2:Ja[2+_p],y2:Ja[3+_p]})}}}}catch(Iy){_l.e(Iy)}finally{_l.f()}}var ka=this.circleCells[A];if(null!==ka){var ty,ny=this.circles,ry=ES(ka);try{for(ry.s();!(ty=ry.n()).done;){var ly=ty.value;if(!Ye.circle[ly]){Ye.circle[ly]=!0;var ey=3*ly;if(this._circleAndRectCollide(ny[ey],ny[1+ey],ny[2+ey],l,h,g,_)&&(!_t||_t(this.circleKeys[ly]))){if($.hitTest)return j.push(!0),!0;var hy=ny[ey],fy=ny[1+ey],_y=ny[2+ey];j.push({key:this.circleKeys[ly],x1:hy-_y,y1:fy-_y,x2:hy+_y,y2:fy+_y})}}}}catch(Iy){ry.e(Iy)}finally{ry.f()}}}},{key:"_queryCellCircle",value:function(l,h,g,_,A,j,$,_t){var Ye=$.circle,_i=$.seenUids,_s=this.boxCells[A];if(null!==_s){var Ja,_l=this.bboxes,lc=ES(_s);try{for(lc.s();!(Ja=lc.n()).done;){var _p=Ja.value;if(!_i.box[_p]){_i.box[_p]=!0;var ka=4*_p;if(this._circleAndRectCollide(Ye.x,Ye.y,Ye.radius,_l[0+ka],_l[1+ka],_l[2+ka],_l[3+ka])&&(!_t||_t(this.boxKeys[_p])))return j.push(!0),!0}}}catch(fy){lc.e(fy)}finally{lc.f()}}var ty=this.circleCells[A];if(null!==ty){var ny,ry=this.circles,ly=ES(ty);try{for(ly.s();!(ny=ly.n()).done;){var ey=ny.value;if(!_i.circle[ey]){_i.circle[ey]=!0;var hy=3*ey;if(this._circlesCollide(ry[hy],ry[1+hy],ry[2+hy],Ye.x,Ye.y,Ye.radius)&&(!_t||_t(this.circleKeys[ey])))return j.push(!0),!0}}}catch(fy){ly.e(fy)}finally{ly.f()}}}},{key:"_forEachCell",value:function(l,h,g,_,A,j,$,_t){for(var Ye=this._convertToXCellCoord(l),_i=this._convertToYCellCoord(h),_s=this._convertToXCellCoord(g),Ja=this._convertToYCellCoord(_),_l=Ye;_l<=_s;_l++)for(var lc=_i;lc<=Ja;lc++)if(A.call(this,l,h,g,_,this.xCellCount*lc+_l,j,$,_t))return}},{key:"_convertToXCellCoord",value:function(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}},{key:"_convertToYCellCoord",value:function(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}},{key:"_circlesCollide",value:function(l,h,g,_,A,j){var $=_-l,_t=A-h,Ye=g+j;return $*$+_t*_t<Ye*Ye}},{key:"_circleAndRectCollide",value:function(l,h,g,_,A,j,$){var _t=(j-_)/2,Ye=Math.abs(l-(_+_t));if(_t+g<Ye)return!1;var _i=($-A)/2,_s=Math.abs(h-(A+_i));if(_i+g<_s)return!1;if(Ye<=_t||_s<=_i)return!0;var Ja=Ye-_t,_l=_s-_i;return Ja*Ja+_l*_l<=g*g}}]),s}(),D3=function(s,l,h,g){var _;if(g&&(_=function(fy){return fy!==g.id}),!l){if("point"===s.type&&!s.angle){var A=s.getAABB();if(h.hitTest(A.left,-A.top,A.right,-A.bottom,_)){if(Array.isArray(s.layout.anchor))for(var _i=1;_i<s.layout.anchor.length;_i++){s.setAnchor(s.layout.anchor[_i]);var _s=s.getAABB();if(!h.hitTest(_s.left,-_s.top,_s.right,-_s.bottom,_))return!1}return!0}return!1}var ka=s.getBoundingCircles();return h.hitTestCircleList(ka,_)}if(l){if("point"===s.type&&!s.isFlat()){var ty=s.getScreenSpaceBoundingBox();return h.hitTest(ty.left,ty.top,ty.right,ty.bottom,_)}var hy=s.getBoundingCircles();return h.hitTestCircleList(hy,_)}return!1},zx={tiles:{},startTile:function(s,l){var h=1<arguments.length&&void 0!==l?l:{},g=h.apply_repeat_groups,_=void 0===g||g,A=h.return_hidden,j=void 0!==A&&A,$=h.grid_index,_t=void 0===$?null:$,Ye=this.tiles[s]={grid_index:_t||new pN(My.tile_scale,My.tile_scale,240),objects:{},labels:{},styles:{},repeat:_,return_hidden:j};null==Ye.complete&&(Ye.complete=new Promise(function(_i,_s){Ye.resolve=_i,Ye.reject=_s}))},resetTile:function(s){delete this.tiles[s]},abortTile:function(s){this.tiles[s]&&this.tiles[s].resolve&&this.tiles[s].resolve([]),this.resetTile(s)},addStyle:function(s,l){this.tiles[l].styles[s]=!0},collide:function(s,l,h){var g=this.tiles[h];if(!g)return Promise.resolve([]);for(var _=g.objects,A=0;A<s.length;A++){var j=s[A],$=j.label.layout.priority;_[$]=_[$]||{},_[$][l]=_[$][l]||[],_[$][l].push(j)}return delete g.styles[l],0===Object.keys(g.styles).length&&this.endTile(h),g.complete.then(function(){return g.resolve=null,g.labels[l]||[]})},endTile:function(s){var l=this.tiles[s],h=l.labels;l.repeat&&c1.clear(s);for(var g=Object.keys(l.objects).sort(function(_i,_s){return _i-_s}),_=0;_<g.length;_++){var A=l.objects[g[_]];if(A)for(var j in A){var $=A[j];h[j]=h[j]||[];for(var _t=0;_t<$.length;_t++){var Ye=$[_t];this.canBePlaced(Ye,s,Ye.linked,l)?Ye.linked?this.canBePlaced(Ye.linked,s,Ye,l)?(Ye.show=!0,(Ye.label.breach||Ye.linked.label.breach)&&(Ye.label.breach=!0,Ye.linked.label.breach=!0),h[j].push(Ye),this.place(Ye,s,l),this.place(Ye.linked,s,l)):l.return_hidden&&(Ye.show=!1,h[j].push(Ye)):(Ye.show=!0,h[j].push(Ye),this.place(Ye,s,l)):l.return_hidden&&(Ye.show=!1,h[j].push(Ye))}}}delete this.tiles[s],l.resolve()},canBePlaced:function(s,l,h,g){var _=2<arguments.length&&void 0!==h?h:null,A=(3<arguments.length&&void 0!==g?g:{}).repeat,j=void 0===A||A,$=s.label,_t=s.label.layout;if(null!==$.placed)return $.placed;var Ye=this.tiles[l].grid_index;if(_t.collide&&D3($,"main"===l,Ye,_&&_.label))_t.collide&&($.placed=!1);else{if(!j||!c1.check($,_t,l))return!0;$.placed=!1}return $.placed},place:function(s,l,h){var g=s.label,_=h.repeat;null===g.placed&&((void 0===_||_)&&c1.add(g,g.layout,l),function(s,l,h){var g,_,A,Ye,_i,_s,_p=s.id;s.placed=!0,l||("point"!==s.type||s.angle?(g=s.getBoundingCircles(),h.insertCircleList(_p,g)):(A=(_=s.getAABB()).left,h.insert(_p,A,-_.top,_.right,-_.bottom))),l&&("point"!==s.type||s.isFlat()?(Ye=s.getBoundingCircles(),h.insertCircleList(_p,Ye)):(_s=(_i=s.getScreenSpaceBoundingBox()).left,h.insert(_p,_s,_i.top,_i.right,_i.bottom)))}(g,"main"===l,this.tiles[l].grid_index))}},w1={id:0,queue:[],max_time:20,start_time:null,state:{},ignore_user_moving_view:!1,_ignoreViewMoveWithDebounce:NA(function(){w1.ignore_user_moving_view=!0},0,500),add:function(s){s.id=w1.id++,s.max_time=s.max_time||w1.max_time,s.pause_factor=s.pause_factor||1;var l=new Promise(function(h,g){s.resolve=h,s.reject=g});return s.promise=l,s.total_elapsed=0,s.stats={calls:0},this.queue.push(s),this.start_time=this.start_time||performance.now(),this.elapsed=performance.now()-this.start_time,this.elapsed<w1.max_time&&this.process(s),s.promise},remove:function(s){var l=this.queue.indexOf(s);-1<l&&this.queue.splice(l,1)},process:function(s){if(!this.state.user_moving_view||!1!==s.user_moving_view||this.ignore_user_moving_view)return s.pause?(s.pause--,!0):(s.stats.calls++,s.start_time=performance.now(),s.run(s));w1._ignoreViewMoveWithDebounce()},processAll:function(){this.start_time=this.start_time||performance.now(),this.ignore_user_moving_view&&!this.hasPendingTasks()&&(this.ignore_user_moving_view=!1);for(var s=0;s<this.queue.length;s++){var l=this.queue[s];if(!0!==this.process(l)&&(l.pause||(l.pause=l.elapsed>l.max_time?l.pause_factor:0),l.total_elapsed+=l.elapsed),this.elapsed=performance.now()-this.start_time,this.elapsed>=w1.max_time){this.start_time=null;break}}},finish:function(s,l){return s.elapsed=performance.now()-s.start_time,s.total_elapsed+=s.elapsed,this.remove(s),s.resolve(l),s.promise},cancel:function(s){var l;s.cancel instanceof Function&&(l=s.cancel(s)),s.resolve(l||{})},shouldContinue:function(s){return s.elapsed=performance.now()-s.start_time,this.elapsed=performance.now()-this.start_time,s.elapsed<s.max_time&&this.elapsed<w1.max_time},removeForTile:function(s){for(var l=this.queue.length-1;0<=l;l--)this.queue[l].tile_id===s&&(this.cancel(this.queue[l]),this.queue.splice(l,1))},setState:function(s){this.state=s},hasPendingTasks:function(){return!!this.queue.length}};function dN(s){return{coords:s.coords,uid:s.uid,filtering:s.filtering,sprites:s.sprites,url:s.url,element:s.element,data:s.data,width:s.width,height:s.height,density:s.density,repeat:s.repeat,TEXTURE_WRAP_S:s.TEXTURE_WRAP_S,TEXTURE_WRAP_T:s.TEXTURE_WRAP_T,UNPACK_FLIP_Y_WEBGL:s.UNPACK_FLIP_Y_WEBGL,UNPACK_PREMULTIPLY_ALPHA_WEBGL:s.UNPACK_PREMULTIPLY_ALPHA_WEBGL}}var YC=function(){function s(l,h,g){var _=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};D0(this,s),_=dN(_),this.gl=l,this.texture=l.createTexture(),this.texture&&(this.valid=!0),this.manager=g,this.bind(),this.name=h,this.retain_count=0,this.config_type=null,this.loading=null,this.loaded=!1,this.filtering=_.filtering,this.density=_.density||1,this.sprites=_.sprites,this.texcoords={},this.sizes={},this.css_sizes={},this.aspects={},this._byte_length=0,this.setData(1,1,new Uint8Array([0,0,0,0]),{filtering:"nearest"}),this.loaded=!1,this.manager.textures[this.name]&&(this.retain_count=this.manager.textures[this.name].retain_count,this.manager.textures[this.name].retain_count=0,this.manager.textures[this.name].destroy()),(this.manager.textures[this.name]=this).manager.texture_configs[this.name]=JSON.stringify(Object.assign({name:h},_)),this.load(_),$y("trace","creating Texture ".concat(this.name))}return T0(s,[{key:"destroy",value:function(l){var h=(0<arguments.length&&void 0!==l?l:{}).force;0<this.retain_count&&!h?$y("error","Texture '".concat(this.name,"': destroying texture with retain count of '").concat(this.retain_count,"'")):this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,delete this.manager.textures[this.name],delete this.manager.texture_configs[this.name],this.valid=!1,this._byte_length=0,$y("trace","destroying Texture ".concat(this.name)))}},{key:"retain",value:function(){this.retain_count++}},{key:"release",value:function(){this.retain_count<=0&&$y("error","Texture '".concat(this.name,"': releasing texture with retain count of '").concat(this.retain_count,"'")),this.retain_count--,this.retain_count<=0&&this.destroy()}},{key:"bind",value:function(l){var h=0<arguments.length&&void 0!==l?l:0;this.valid&&(this.manager.activeUnit!==h&&(this.gl.activeTexture(this.gl.TEXTURE0+h),this.manager.activeUnit=h,this.manager.boundTexture=null),this.manager.boundTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.manager.boundTexture=this.texture))}},{key:"load",value:function(l){var h=this;return l?(this.loading=null,"string"==typeof l.url?(this.config_type="url",this.setUrl(l.url,l)):l.element?(this.config_type="element",this.setElement(l.element,l)):l.data&&l.width&&l.height&&(this.config_type="data",this.setData(l.width,l.height,l.data,l)),this.loading=this.loading&&this.loading.then(function(){return h.calculateSprites(),h})||Promise.resolve(this),this.loading):this.loading||Promise.resolve(this)}},{key:"setUrl",value:function(l,h){var g=this,_=1<arguments.length&&void 0!==h?h:{};if(this.valid)return this.url=l,this.loading=new Promise(function(A,j){var $=new Image;$.onload=function(){try{g.setElement($,_)}catch(_t){g.loaded=!1,$y("warn","Texture '".concat(g.name,"': failed to load url: '").concat(g.url,"'"),_t,_),g.manager.trigger("warning",{message:"Failed to load texture from ".concat(g.url),error:_t,texture:_})}g.loaded=!0,A(g)},$.onerror=function(_t){g.loaded=!1,$y("warn","Texture '".concat(g.name,"': failed to load url: '").concat(g.url,"'"),_t,_),g.manager.trigger("warning",{message:"Failed to load texture from ".concat(g.url),error:_t,texture:_}),A(g)},G0.isSafari()&&"data:"===g.url.slice(0,5)||($.crossOrigin="anonymous"),$.src=g.url}),this.loading}},{key:"setData",value:function(l,h,g,_){var A=3<arguments.length&&void 0!==_?_:{};return this.width=l,this.height=h,Array.isArray(g)&&(g=new Uint8Array(g)),this.update(g,A),this.setFiltering(A),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(l,h){var g,_=l;return"string"==typeof l&&(l=document.querySelector(l)),l instanceof HTMLCanvasElement||l instanceof HTMLImageElement||l instanceof HTMLVideoElement?(this.update(l,h),this.setFiltering(h)):(this.loaded=!1,g="the 'element' parameter (`element: ".concat(JSON.stringify(_),"`) must be a CSS "),g+="selector string, or a <canvas>, <image> or <video> object",$y("warn","Texture '".concat(this.name,"': ").concat(g),h),this.manager.trigger("warning",{message:"Failed to load texture because ".concat(g),texture:h})),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(l,h){var g=1<arguments.length&&void 0!==h?h:{};this.valid&&(this.bind(),l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof HTMLImageElement&&l.complete?(this.width=l.width,this.height=l.height,this._byte_length=this.width*this.height*4,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1!==g.UNPACK_FLIP_Y_WEBGL),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,g.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,l)):(this._byte_length=l?l.byteLength:0,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,l)),this.manager.trigger("update",this))}},{key:"getByteLength",value:function(){return this._byte_length}},{key:"setFiltering",value:function(l){var h,g=0<arguments.length&&void 0!==l?l:{};this.valid&&(g.filtering=g.filtering||"linear",h=this.gl,this.bind(),G0.isPowerOf2(this.width)&&G0.isPowerOf2(this.height)?(this.power_of_2=!0,h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,g.TEXTURE_WRAP_S||g.repeat&&h.REPEAT||h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,g.TEXTURE_WRAP_T||g.repeat&&h.REPEAT||h.CLAMP_TO_EDGE),"mipmap"===g.filtering?(this.filtering="mipmap",h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR_MIPMAP_LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.generateMipmap(h.TEXTURE_2D)):"linear"===g.filtering?(this.filtering="linear",h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR)):"nearest"===g.filtering&&(this.filtering="nearest",h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST))):(this.power_of_2=!1,h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),"nearest"===g.filtering?(this.filtering="nearest",h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST)):(this.filtering="linear",h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR))),this.manager.trigger("update",this))}},{key:"calculateSprites",value:function(){if(this.sprites)for(var l in this.sprites){var h=this.sprites[l];this.texcoords[l]=this.manager.getTexcoordsForSprite([h[0],h[1]],[h[2],h[3]],[this.width,this.height]),this.sizes[l]=[h[2],h[3]],this.css_sizes[l]=[h[2]/this.density,h[3]/this.density],this.aspects[l]=h[2]/h[3]}}}]),s}();function FA(s){var l=[];return Object.assign(s,{subscribe:function(h){-1===l.indexOf(h)&&l.push(h)},unsubscribe:function(h){var g=l.indexOf(h);-1<g&&l.splice(g,1)},unsubscribeAll:function(){l=[]},trigger:function(h){for(var g=arguments.length,_=new Array(1<g?g-1:0),A=1;A<g;A++)_[A-1]=arguments[A];l.forEach(function(j){if("function"==typeof j[h])try{j[h].apply(j,_)}catch($){$y("warn","Caught exception in listener for event '".concat(h,"':"),$)}})},hasSubscribersFor:function(h){var g=!1;return l.forEach(function(_){"function"==typeof _[h]&&(g=!0)}),g}})}var jA=function(){function s(l){D0(this,s),this.default=s.DEFAULT_TEXTURE_NAME,this.textures={},this.texture_configs={},this.boundTexture=null,this.activeUnit=null,this.scene_id=l,_0.addTarget("Texture"+this.scene_id,this),FA(this)}return T0(s,[{key:"create",value:function(l,h,g){for(var _=s.matchers_,A=0;A<_.length;A++){var j=_[A][0],$=_[A][1];if($&&$(g))return new j(l,h,this,g)}return new YC(l,h,this,g)}},{key:"retain",value:function(l){this.textures[l]&&this.textures[l].retain()}},{key:"release",value:function(l){this.textures[l]&&this.textures[l].release()}},{key:"getRetainCount",value:function(l){if(this.textures[l])return this.textures[l].retain_count}},{key:"getByteLength",value:function(l){if(this.textures[l])return this.textures[l].getByteLength()}},{key:"destroy",value:function(l){var h=this;Object.keys(this.textures).forEach(function(g){var _=h.textures[g];g!==h.default&&_.gl===l&&_.destroy({force:!0})})}},{key:"getSpriteInfo",value:function(l,h){var g=this.textures[l];return g&&{size:g.sizes[h],css_size:g.css_sizes[h],aspect:g.aspects[h],texcoords:g.texcoords[h]}}},{key:"getTexcoordsForSprite",value:function(l,h,g){var _=g[1]-l[1]-h[1];return[l[0]/g[0],_/g[1],(h[0]+l[0])/g[0],(h[1]+_)/g[1]]}},{key:"createFromObject",value:function(l,h){var g=[];if(h)for(var _ in h){var A,j=h[_];this.changed(_,j)&&(A=this.create(l,_,j),g.push(A.loading))}return Promise.all(g)}},{key:"createDefault",value:function(l){return this.create(l,this.default)}},{key:"changed",value:function(l,h){var g=this.textures[l];if(g){if("element"===g.config_type||null!=h.element)return!0;if(h=dN(h),this.texture_configs[l]===JSON.stringify(Object.assign({name:l},h)))return!1}return!0}},{key:"getInfo",value:function(l){var h=this;if(l=l||Object.keys(this.textures),Array.isArray(l))return Promise.all(l.map(function(_){return h.getInfo(_)}));var g=this.textures[l];return g?(g.loading||Promise.resolve(g)).then(function(){return{name:g.name,width:g.width,height:g.height,density:g.density,sprites:g.sprites,texcoords:g.texcoords,sizes:g.sizes,css_sizes:g.css_sizes,aspects:g.aspects,filtering:g.filtering,power_of_2:g.power_of_2,valid:g.valid}}):Promise.resolve(null)}},{key:"syncTexturesToWorker",value:function(l){var h=this;return V_.is_main?Promise.all(l.map(function(g){var _=h.textures[g];return _&&_.loading||Promise.resolve()})).then(function(){return h.textures}):_0.postMessage("Texture"+this.scene_id+".getInfo",l).then(function(g){return g.forEach(function(_){h.textures[_.name]=_}),h.textures})}},{key:"getMaxTextureSize",value:function(l){return l.getParameter(l.MAX_TEXTURE_SIZE)}}],[{key:"register",value:function(l,h){var g=s.matchers_;if(!(l instanceof Function&&h instanceof Function))throw"Invalid texture constructor or matcher";this.deRegister(l),g.push([l,h])}},{key:"deRegister",value:function(l){for(var h=s.matchers_,g=0;g<h.length;g++)h[g][0]===l&&h.splice(g,1)}}]),s}();jA.DEFAULT_TEXTURE_NAME="__default",jA.matchers_=[];var yD={};function ZE(s){return yD[s]||(yD[s]=new jA(s)),yD[s]}var gN=function(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},_x_fromValues=function(s,l,h){var g=new Float64Array(3);return g[0]=s,g[1]=l,g[2]=h,g},_x_transformMat4=function(s,l,h){var g=l[0],_=l[1],A=l[2],j=h[3]*g+h[7]*_+h[11]*A+h[15];return s[0]=(h[0]*g+h[4]*_+h[8]*A+h[12])/(j=j||1),s[1]=(h[1]*g+h[5]*_+h[9]*A+h[13])/j,s[2]=(h[2]*g+h[6]*_+h[10]*A+h[14])/j,s},bx_multiply=function(s,l,h){var g=l[0],_=l[1],A=l[2],j=l[3],$=l[4],_t=l[5],Ye=l[6],_i=l[7],_s=l[8],Ja=l[9],_l=l[10],lc=l[11],_p=l[12],ka=l[13],ty=l[14],ny=l[15],ry=h[0],ly=h[1],ey=h[2],hy=h[3];return s[0]=ry*g+ly*$+ey*_s+hy*_p,s[1]=ry*_+ly*_t+ey*Ja+hy*ka,s[2]=ry*A+ly*Ye+ey*_l+hy*ty,s[3]=ry*j+ly*_i+ey*lc+hy*ny,s[4]=(ry=h[4])*g+(ly=h[5])*$+(ey=h[6])*_s+(hy=h[7])*_p,s[5]=ry*_+ly*_t+ey*Ja+hy*ka,s[6]=ry*A+ly*Ye+ey*_l+hy*ty,s[7]=ry*j+ly*_i+ey*lc+hy*ny,s[8]=(ry=h[8])*g+(ly=h[9])*$+(ey=h[10])*_s+(hy=h[11])*_p,s[9]=ry*_+ly*_t+ey*Ja+hy*ka,s[10]=ry*A+ly*Ye+ey*_l+hy*ty,s[11]=ry*j+ly*_i+ey*lc+hy*ny,s[12]=(ry=h[12])*g+(ly=h[13])*$+(ey=h[14])*_s+(hy=h[15])*_p,s[13]=ry*_+ly*_t+ey*Ja+hy*ka,s[14]=ry*A+ly*Ye+ey*_l+hy*ty,s[15]=ry*j+ly*_i+ey*lc+hy*ny,s},bx_translate=function(s,l,h){var g,_,A,j,$,_t,Ye,_i,_s,Ja,_l,lc,_p=h[0],ka=h[1],ty=h[2];return l===s?(s[12]=l[0]*_p+l[4]*ka+l[8]*ty+l[12],s[13]=l[1]*_p+l[5]*ka+l[9]*ty+l[13],s[14]=l[2]*_p+l[6]*ka+l[10]*ty+l[14],s[15]=l[3]*_p+l[7]*ka+l[11]*ty+l[15]):(_=l[1],A=l[2],j=l[3],$=l[4],_t=l[5],Ye=l[6],_i=l[7],_s=l[8],Ja=l[9],_l=l[10],lc=l[11],s[0]=g=l[0],s[1]=_,s[2]=A,s[3]=j,s[4]=$,s[5]=_t,s[6]=Ye,s[7]=_i,s[8]=_s,s[9]=Ja,s[10]=_l,s[11]=lc,s[12]=g*_p+$*ka+_s*ty+l[12],s[13]=_*_p+_t*ka+Ja*ty+l[13],s[14]=A*_p+Ye*ka+_l*ty+l[14],s[15]=j*_p+_i*ka+lc*ty+l[15]),s},bx_identity=gN,bx_invert=function(s,l){var h=l[0],g=l[1],_=l[2],A=l[3],j=l[4],$=l[5],_t=l[6],Ye=l[7],_i=l[8],_s=l[9],Ja=l[10],_l=l[11],lc=l[12],_p=l[13],ka=l[14],ty=l[15],ny=h*$-g*j,ry=h*_t-_*j,ly=h*Ye-A*j,ey=g*_t-_*$,hy=g*Ye-A*$,fy=_*Ye-A*_t,_y=_i*_p-_s*lc,Iy=_i*ka-Ja*lc,Sy=_i*ty-_l*lc,Dy=_s*ka-Ja*_p,Ny=_s*ty-_l*_p,r0=Ja*ty-_l*ka,Vy=ny*r0-ry*Ny+ly*Dy+ey*Sy-hy*Iy+fy*_y;return Vy?(s[0]=($*r0-_t*Ny+Ye*Dy)*(Vy=1/Vy),s[1]=(_*Ny-g*r0-A*Dy)*Vy,s[2]=(_p*fy-ka*hy+ty*ey)*Vy,s[3]=(Ja*hy-_s*fy-_l*ey)*Vy,s[4]=(_t*Sy-j*r0-Ye*Iy)*Vy,s[5]=(h*r0-_*Sy+A*Iy)*Vy,s[6]=(ka*ly-lc*fy-ty*ry)*Vy,s[7]=(_i*fy-Ja*ly+_l*ry)*Vy,s[8]=(j*Ny-$*Sy+Ye*_y)*Vy,s[9]=(g*Sy-h*Ny-A*_y)*Vy,s[10]=(lc*hy-_p*ly+ty*ny)*Vy,s[11]=(_s*ly-_i*hy-_l*ny)*Vy,s[12]=($*Iy-j*Dy-_t*_y)*Vy,s[13]=(h*Dy-g*Iy+_*_y)*Vy,s[14]=(_p*ry-lc*ey-ka*ny)*Vy,s[15]=(_i*ey-_s*ry+Ja*ny)*Vy,s):null},rA_transformMat4=function(s,l,h){var g=l[0],_=l[1],A=l[2],j=l[3];return s[0]=h[0]*g+h[4]*_+h[8]*A+h[12]*j,s[1]=h[1]*g+h[5]*_+h[9]*A+h[13]*j,s[2]=h[2]*g+h[6]*_+h[10]*A+h[14]*j,s[3]=h[3]*g+h[7]*_+h[11]*A+h[15]*j,s},rA_scale=function(s,l,h){return s[0]=l[0]*h,s[1]=l[1]*h,s[2]=l[2]*h,s[3]=l[3]*h,s},wx=function(){function s(l,h){D0(this,s),this._gl=l,this._requests={},this._pixels=null,this._has_dirty_buffer=!1,this._fbo=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._fbo_size={width:256,height:256};var g=ZE(h).create(this._gl,"selection_fbo",{filtering:"nearest"});g.setData(this._fbo_size.width,this._fbo_size.height,null,{filtering:"nearest"}),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,g.texture,0);var _=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,_),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._fbo_size.width,this._fbo_size.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,_),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return T0(s,[{key:"destroy",value:function(){this._gl&&this._fbo&&(this._gl.deleteFramebuffer(this._fbo),this._fbo=null,this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null))}},{key:"bind",value:function(){var l;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._gl.viewport(0,0,this._fbo_size.width,this._fbo_size.height),(l=this._gl).clearColor.apply(l,A_(s.defaultColor))}},{key:"getFeatureAt",value:function(l,h,g){var _=h.radius,A=h.top_most_only,j=void 0===A||A;!l||l.x<0||l.y<0||1<l.x||1<l.y?g({features:null}):(this.selection_request_id=this.selection_request_id+1||0,this._requests[this.selection_request_id]={id:this.selection_request_id,point:l,radius:_,top_most_only:j,ttl:j?1:s.MAX_PICKING_TRIES,callback:g})}},{key:"hasPendingRequests",value:function(){return 0<Object.keys(this._requests).length}},{key:"clearPendingRequests",value:function(){for(var l in this._requests)this._requests[l].callback(new Error("cleared")),delete this._requests[l];this._pending_deep_request=null}},{key:"read",value:function(l){if(this.hasPendingRequests()){var h=this._gl;for(var g in h.bindFramebuffer(h.FRAMEBUFFER,this._fbo),this._pending_deep_request&&this.processRequest(this._pending_deep_request,l),this._requests)if(this.processRequest(this._requests[g],l))break;h.bindFramebuffer(h.FRAMEBUFFER,null)}}},{key:"processRequest",value:function(l,h){var g,_,A,j=this._gl,$=255,_t=l.point,Ye=l.radius,_i=(A=Ye?(_=Math.min(this._fbo_size.width,this._fbo_size.height),{x:Math.min(Math.ceil(2*Ye.x*this._fbo_size.width),_),y:Math.min(Math.ceil(2*Ye.y*this._fbo_size.height),_)}):(Ye={x:0,y:0},{x:1,y:1})).x*A.y*4;if(null==this._pixels||this._pixels.byteLength<_i)this._pixels=new Uint8Array(_i);else if(this._pixels.fill instanceof Function)this._pixels.fill(0,0,_i);else for(var _s=0;_s<_i;_s++)this._pixels[_s]=0;j.readPixels(Math.round((_t.x-Ye.x)*this._fbo_size.width),Math.round((1-_t.y-Ye.y)*this._fbo_size.height),A.x,A.y,j.RGBA,j.UNSIGNED_BYTE,this._pixels),l.ttl--;var Ja=Math.floor(A.x/2),_l=Math.floor(A.y/2),_p=this._pixels.slice(lc=4*(_l*A.x+Ja),lc+4),ka=_p[0]+(_p[1]<<8)+(_p[2]<<16);if(0<ka)g=ka+(_p[3]<<24)>>>0,$=_p[3];else if(4<_i)for(var ty=1/0,lc=0,ny=0;ny<A.y;ny++)for(var ry,ly=0;ly<A.x;ly++,lc+=4)0<(ka=(_p=this._pixels.slice(lc,lc+4))[0]+(_p[1]<<8)+(_p[2]<<16))&&(ry=Math.pow(ly-Ja,2)+Math.pow(ny-_l,2))<ty&&(g=ka+(_p[3]<<24)>>>0,$=_p[3],ty=ry);if(255!==$){var ey=this._getFeatureByKey(g,h);if(l.features||(l.features=[]),!ey)return void this._finishRead(l);if(l.features.every(function(hy){return hy.id!==ey.id})&&l.features.push(ey),l.ttl)return this._pending_deep_request=l,s._discardColor(_p),this._has_dirty_buffer=!0;this._finishRead(l)}else this._finishRead(l)}},{key:"_finishRead",value:function(l){var h=l.features||s.EMPTY_ARRAY;l.top_most_only||(this._pending_deep_request=null,s._resetDiscardedColors()),delete this._requests[l.id],l.callback({features:h})}},{key:"_getFeatureByKey",value:function(l,h){for(var g=null,_=0;_<h.length;_++){var A=h[_];if(A.selection_data&&(g=A.selection_data[l])){g.tile={coords:A.coords};break}}return g}},{key:"setupDiscards",value:function(l){for(var h=s.MAX_PICKING_TRIES;h--;)l.uniform("4fv","u_selection_discard".concat(h),s._discarded_colors[h]||s.defaultColor)}},{key:"has_dirty_buffer",get:function(){return this._has_dirty_buffer},set:function(){this._has_dirty_buffer=!!this._pending_deep_request}}],[{key:"makeEntry",value:function(){this.map_entry++;var l=255&this.map_entry,h=this.map_entry>>8&255,g=this.map_entry>>16&255,_=this.map_prefix;return{key:l+(h<<8)+(g<<16)+(_<<24)>>>0,color:[l/255,h/255,g/255,_/255]}}},{key:"reset",value:function(){this.map_entry=0}},{key:"setPrefix",value:function(l){this.map_prefix=l}},{key:"_discardColor",value:function(l){this._discarded_colors.push([l[0]/255,l[1]/255,l[2]/255,l[3]/255])}},{key:"_resetDiscardedColors",value:function(){this._discarded_colors.length=0}}]),s}();wx._discarded_colors=[],wx.map_entry=0,wx.map_prefix=0,wx.defaultColor=[0,0,0,1],wx.MAX_PICKING_TRIES=10,wx.EMPTY_ARRAY=Object.freeze([]);var lx={parseUniforms:function(s){var l=[];for(var h in s){var g,_=h,A=s[h];if("number"==typeof A)l.push({type:"float",method:"1f",name:h,value:A,key:_,uniforms:s});else if(Array.isArray(A)){if("number"==typeof A[0])2<=A.length&&A.length<=4?l.push({type:"vec"+A.length,method:A.length+"fv",name:h,value:A,key:_,uniforms:s}):4<A.length&&l.push({type:"float[]",method:"1fv",name:h+"[0]",value:A,key:_,uniforms:s});else if("string"==typeof A[0])for(g=0;g<A.length;g++)l.push({type:"sampler2D",method:"1i",name:h+"["+g+"]",value:A[g],key:g,uniforms:A});else if(Array.isArray(A[0])&&"number"==typeof A[0][0]&&2<=A[0].length&&A[0].length<=4)for(g=0;g<A.length;g++)l.push({type:"vec"+A[0].length,method:A[g].length+"fv",name:h+"["+g+"]",value:A[g],key:g,uniforms:A})}else"boolean"==typeof A?l.push({type:"bool",method:"1i",name:h,value:A,key:_,uniforms:s}):"string"==typeof A&&l.push({type:"sampler2D",method:"1i",name:h,value:A,key:_,uniforms:s})}return l},defineVariable:function(s,l){var h,g;if("number"==typeof l)h="float";else if(Array.isArray(l))"number"==typeof l[0]?2<=l.length&&l.length<=4?h="vec"+l.length:(h="float",g=l.length):"string"==typeof l[0]&&(h="sampler2D",g=l.length);else if("boolean"==typeof l)h="bool";else{if("string"!=typeof l)return;h="sampler2D"}var _="";return _+="".concat(h," ").concat(s),g&&(_+="[".concat(g,"]")),_+";\n"},defineUniform:function(s,l){var h=lx.defineVariable(s,l);if(h)return"uniform "+h},isUniformDefined:function(s,l){var h=new RegExp("uniform[^;]+(?:{[\\s\\S]*})?[^;]*\\b"+s+"\\b","g");return!!l.match(h)},isSymbolReferenced:function(s,l){var h=new RegExp("\\b"+s+"\\b","g");return 0<=l.search(h)},expandVec3:function(s){var l,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(s)){if(2!==s.length)return s;l=[].concat(A_(s),[h]).map(parseFloat)}else l=[s,s,s].map(parseFloat);if(l&&l.every(function(g){return"number"==typeof g&&!isNaN(g)}))return l},expandVec4:function(s){var l,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(s)){if(3!==s.length)return s;l=[].concat(A_(s),[h]).map(parseFloat)}else l=[s,s,s,h].map(parseFloat);if(l&&l.every(function(g){return"number"==typeof g&&!isNaN(g)}))return l}},LS=[];function mD(s,l){var h=LS.filter(function(g){return g[0]===s})[0];return(h=h&&h[1])||(LS.push([s,{}]),h=LS[LS.length-1][1]),h[l]||(h[l]=s.getExtension(l)),h[l]}function II(s){var l,h,g=0;if(0===s.length)return g;for(l=0,h=s.length;l<h;l++)g=(g<<5)-g+s.charCodeAt(l),g|=0;return g}var M3=_e(function(s){var l="(.|[\\r\\n]|\\n)*?\\*\\/\\n?\\n?",h=/(^|[^\S\n])(?:\/\/)([\s\S]+?)$/gm,g=/(^|[^\S\n])(?:\/\/[^!])([\s\S]+?)$/gm,_=s.exports=function(A,j){return A?_.block(_.line(A,j),j):""};_.block=function(A,j){j=j||{};var $=new RegExp("\\/\\*"+l,"gm");return j.safe&&($=new RegExp("\\/\\*(?!\\*?\\!)"+l,"gm")),A?A.replace($,""):""},_.line=function(A,j){var $=h;return(j=j||{}).safe&&($=g),A?A.replace($,""):""}}),kI=/^\s*#pragma.*$/gm,OI=/\\\s*\n/gm,b0=function(){function s(l,h,g,_,A){if(D0(this,s),A=A||{},this.textureManager=ZE(_),this.gl=l,this.program=null,this.compiled=!1,this.compiling=!1,this.error=null,!s.polyfills[_]){s.polyfills[_]={};try{this.gl.uniformMatrix3fv(null,!1,new Float64Array(9))}catch{s.polyfills[_].uniformMatrix3fv=this.gl.uniformMatrix3fv,this.gl.uniformMatrix3fv=function($,_t,Ye){s.polyfills[_].uniformMatrix3fv.call(this,$,_t,new Float32Array(Ye))}}try{this.gl.uniformMatrix4fv(null,!1,new Float64Array(16))}catch{s.polyfills[_].uniformMatrix4fv=this.gl.uniformMatrix4fv,this.gl.uniformMatrix4fv=function($,_t,Ye){s.polyfills[_].uniformMatrix4fv.call(this,$,_t,new Float32Array(Ye))}}}this.defines=Object.assign({},A.defines||{}),this.blocks=Object.assign({},A.blocks||{}),this.block_scopes=Object.assign({},A.block_scopes||{}),this.extensions=A.extensions||[],this.dependent_uniforms=A.uniforms,this.uniforms={},this.attribs={},this.vertex_source=h,this.fragment_source=g,this.id=s.id++,this.name=A.name}return T0(s,[{key:"destroy",value:function(){this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.program=null,this.uniforms={},this.attribs={},this.compiled=!1}},{key:"use",value:function(){this.compiled&&(s.current!==this&&this.gl.useProgram(this.program),s.current=this)}},{key:"compile",value:function(){var l=this;if(this.compiling)throw new Error("ShaderProgram.compile(): skipping for ".concat(this.id," (").concat(this.name,") because already compiling"));this.compiling=!0,this.compiled=!1,this.error=null,this.computed_vertex_source=this.vertex_source,this.computed_fragment_source=this.fragment_source;var h,g=this.checkExtensions(),_=this.buildDefineList(),A=this.buildShaderBlockList();for(var j in A){var $,_t,Ye,_i=A[j];!_i||Array.isArray(_i)&&0===_i.length||(h=new RegExp("^\\s*#pragma\\s+tangram:\\s+"+j+"\\s*$","m"),$=this.computed_vertex_source.match(h),_t=this.computed_fragment_source.match(h),null==$&&null==_t||(Ye="",_i.forEach(function(_l){var lc="".concat(_l.scope,", ").concat(_l.key,", ").concat(_l.num);Ye+="\n// tangram-block-start: ".concat(lc,"\n"),Ye+=_l.source,Ye+="\n// tangram-block-end: ".concat(lc,"\n")}),null!=$&&(this.computed_vertex_source=this.computed_vertex_source.replace(h,Ye)),null!=_t&&(this.computed_fragment_source=this.computed_fragment_source.replace(h,Ye)),_["TANGRAM_BLOCK_"+j.replace(/[\s-]+/g,"_").toUpperCase()]=!0))}this.computed_vertex_source=this.computed_vertex_source.replace(kI,""),this.computed_fragment_source=this.computed_fragment_source.replace(kI,""),this.ensureUniforms(this.dependent_uniforms);var _s=this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.HIGH_FLOAT),Ja=_s&&0<_s.precision?"precision highp float;\n":"precision mediump float;\n";_.TANGRAM_VERTEX_SHADER=!0,_.TANGRAM_FRAGMENT_SHADER=!1,this.computed_vertex_source=Ja+s.buildDefineString(_)+this.computed_vertex_source,_.TANGRAM_VERTEX_SHADER=!1,_.TANGRAM_FRAGMENT_SHADER=!0,this.computed_fragment_source=s.buildExtensionString(g)+Ja+s.buildDefineString(_)+this.computed_fragment_source,this.computed_vertex_source=this.computed_vertex_source.replace(OI,""),this.computed_fragment_source=this.computed_fragment_source.replace(OI,"");try{this.program=s.updateProgram(this.gl,this.program,this.computed_vertex_source,this.computed_fragment_source),this.compiled=!0,this.compiling=!1}catch(_l){throw this.program=null,this.compiled=!1,this.compiling=!1,"vertex"!==(this.error=_l).type&&"fragment"!==_l.type||(this.shader_errors=_l.errors,this.shader_errors.forEach(function(lc){lc.type=_l.type,lc.block=l.block(_l.type,lc.line)})),_l}this.computed_vertex_source=null,this.computed_fragment_source=null,this.use(),this.refreshUniforms(),this.refreshAttributes()}},{key:"buildDefineList",value:function(){var l,h={};for(l in s.defines)h[l]=s.defines[l];for(l in this.defines)h[l]=this.defines[l];return h}},{key:"buildShaderBlockList",value:function(){var l,h,g={};for(l in s.blocks)g[l]=[],Array.isArray(s.blocks[l])?(h=g[l]).push.apply(h,A_(s.blocks[l].map(function(_t,Ye){return{key:l,source:_t,num:Ye,scope:"ShaderProgram"}}))):g[l]=[{key:l,source:s.blocks[l],num:0,scope:"ShaderProgram"}];for(l in this.blocks)if(g[l]=g[l]||[],Array.isArray(this.blocks[l]))for(var _=this.block_scopes&&this.block_scopes[l]||[],A=null,j=0,$=0;$<this.blocks[l].length;$++)_[$]!==A&&(A=_[$],j=0),g[l].push({key:l,source:this.blocks[l][$],num:j,scope:A||this.name}),j++;else g[l].push({key:l,source:this.blocks[l],num:0,scope:this.name});return g}},{key:"ensureUniforms",value:function(l){if(l){var h,g=M3(this.computed_vertex_source),_=M3(this.computed_fragment_source),A=[],j=[];for(var $ in l){var _t=lx.isUniformDefined($,g),Ye=lx.isUniformDefined($,_);if(!_t||!Ye){if(!(h=lx.defineUniform($,l[$])))continue;_t||($y("trace","Program ".concat(this.name,": ").concat($," not defined in vertex shader, injecting: '").concat(h,"'")),A.push(h)),Ye||($y("trace","Program ".concat(this.name,": ").concat($," not defined in fragment shader, injecting: '").concat(h,"'")),j.push(h))}}0<A.length&&(this.computed_vertex_source=A.join("\n")+this.computed_vertex_source),0<j.length&&(this.computed_fragment_source=j.join("\n")+this.computed_fragment_source)}}},{key:"setUniforms",value:function(l,h){var g=!(1<arguments.length&&void 0!==h)||h;if(this.compiled){g&&(this.texture_unit=0);for(var _=lx.parseUniforms(l),A=0;A<_.length;A++){var j=_[A];"sampler2D"===j.type?this.setTextureUniform(j.name,j.value):this.uniform(j.method,j.name,j.value)}}}},{key:"saveUniforms",value:function(l){var h=l||this.uniforms;for(var g in h){var _=this.uniforms[g];_&&(_.saved_value=_.value)}this.saved_texture_unit=this.texture_unit||0}},{key:"restoreUniforms",value:function(l){var h=l||this.uniforms;for(var g in h){var _=this.uniforms[g];_&&_.saved_value&&(_.value=_.saved_value,this.updateUniform(_))}this.texture_unit=this.saved_texture_unit||0}},{key:"setTextureUniform",value:function(l,h){var g=this.textureManager.textures[h];null!=g?(g.bind(this.texture_unit),this.uniform("1i",l,this.texture_unit),this.texture_unit++):$y("warn","Cannot find texture '".concat(h,"'"))}},{key:"uniform",value:function(l,h,g){var _;this.compiled&&(this.uniforms[h]=this.uniforms[h]||{},(_=this.uniforms[h]).name=h,void 0===_.location&&(_.location=this.gl.getUniformLocation(this.program,h)),_.method=l,_.value=g,this.updateUniform(_))}},{key:"updateUniform",value:function(l){this.compiled&&l&&null!=l.location&&(this.use(),this.commitUniform(l))}},{key:"commitUniform",value:function(l){var h=l.location,g=l.value;switch(l.method){case"1i":this.gl.uniform1i(h,g);break;case"1f":this.gl.uniform1f(h,g);break;case"2f":this.gl.uniform2f(h,g[0],g[1]);break;case"3f":this.gl.uniform3f(h,g[0],g[1],g[2]);break;case"4f":this.gl.uniform4f(h,g[0],g[1],g[2],g[3]);break;case"1iv":this.gl.uniform1iv(h,g);break;case"3iv":this.gl.uniform3iv(h,g);break;case"1fv":this.gl.uniform1fv(h,g);break;case"2fv":this.gl.uniform2fv(h,g);break;case"3fv":this.gl.uniform3fv(h,g);break;case"4fv":this.gl.uniform4fv(h,g);break;case"Matrix3fv":this.gl.uniformMatrix3fv(h,!1,g);break;case"Matrix4fv":this.gl.uniformMatrix4fv(h,!1,g)}}},{key:"refreshUniforms",value:function(){if(this.compiled)for(var l in this.uniforms){var h=this.uniforms[l];h.location=this.gl.getUniformLocation(this.program,l),this.updateUniform(h)}}},{key:"refreshAttributes",value:function(){this.attribs={}}},{key:"attribute",value:function(l){if(this.compiled){var h=this.attribs[l]=this.attribs[l]||{};return null!=h.location||(h.name=l,h.location=this.gl.getAttribLocation(this.program,l)),h}}},{key:"source",value:function(l){return"vertex"===l?this.computed_vertex_source:"fragment"===l?this.computed_fragment_source:void 0}},{key:"lines",value:function(l){var h=this.source(l);return h?h.split("\n"):[]}},{key:"line",value:function(l,h){var g=this.lines(l);if(g)return g[h]}},{key:"block",value:function(l,h){for(var g,_=this.lines(l),A=0;A<h&&A<_.length;A++){var j=_[A],$=j.match(/\/\/ tangram-block-start: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/);$&&1<$.length?g={scope:$[1],name:$[2],num:$[3]}:($=j.match(/\/\/ tangram-block-end: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/))&&1<$.length&&(g=null),g&&(g.line=null==g.line?-1:g.line+1,g.source=j)}return g}},{key:"checkExtensions",value:function(){var l=this,h=[];return this.extensions.forEach(function(g){var _=mD(l.gl,g),A="TANGRAM_EXTENSION_".concat(g);l.defines[A]=null!=_,_?h.push(g):$y("debug","Could not enable extension '".concat(g,"'"))}),h}}]),s}();b0.polyfills={},b0.id=0,b0.current=null,b0.defines={},b0.blocks={},b0.reset=function(){b0.programs_by_source={},b0.shaders_by_source={}},b0.reset(),b0.buildDefineString=function(s){var l="";for(var h in s)null!=s[h]&&!1!==s[h]&&("boolean"==typeof s[h]&&!0===s[h]?l+="#define "+h+"\n":"number"==typeof s[h]&&Math.floor(s[h])===s[h]?l+="#define "+h+" "+s[h].toFixed(1)+"\n":l+="#define "+h+" "+s[h]+"\n");return l},b0.buildExtensionString=function(s){var l="";return(s=s||[]).forEach(function(h){l+="#ifdef GL_".concat(h,"\n#extension GL_").concat(h," : enable\n#endif\n")}),l},b0.addBlock=function(s){var l;b0.blocks[s]=b0.blocks[s]||[];for(var h=arguments.length,g=new Array(1<h?h-1:0),_=1;_<h;_++)g[_-1]=arguments[_];(l=b0.blocks[s]).push.apply(l,g)},b0.removeBlock=function(s){b0.blocks[s]=[]},b0.replaceBlock=function(s){b0.removeBlock(s);for(var l=arguments.length,h=new Array(1<l?l-1:0),g=1;g<l;g++)h[g-1]=arguments[g];b0.addBlock.apply(b0,[s].concat(h))},b0.updateProgram=function(s,l,h,g){var _=II(s._tangram_id+"::"+h+"::"+g);if(b0.programs_by_source[_])return $y("trace","Reusing identical source GL program object"),b0.programs_by_source[_];var A=b0.createShader(s,h,s.VERTEX_SHADER),j=b0.createShader(s,g,s.FRAGMENT_SHADER);if(s.useProgram(null),null!=l)for(var $=s.getAttachedShaders(l),_t=0;_t<$.length;_t++)s.detachShader(l,$[_t]);else l=s.createProgram();if(null==A||null==j)return l;if(s.attachShader(l,A),s.attachShader(l,j),s.linkProgram(l),s.getProgramParameter(l,s.LINK_STATUS))return b0.programs_by_source[_]=l;var Ye=new Error("WebGL program error:\n            VALIDATE_STATUS: ".concat(s.getProgramParameter(l,s.VALIDATE_STATUS),"\n            ERROR: ").concat(s.getError(),"\n            --- Vertex Shader ---\n            ").concat(h,"\n            --- Fragment Shader ---\n            ").concat(g));throw Object.assign(new Error(Ye),{type:"program"})};var e1,VA={disabled:!(b0.createShader=function(s,l,h){var g=II(s._tangram_id+"::"+l);if(b0.shaders_by_source[g])return $y("trace","Reusing identical source GL shader object"),b0.shaders_by_source[g];var _=s.createShader(h);if(s.shaderSource(_,l),s.compileShader(_),s.getShaderParameter(_,s.COMPILE_STATUS))return b0.shaders_by_source[g]=_;var A=h===s.VERTEX_SHADER?"vertex":"fragment",j=s.getShaderInfoLog(_),$=function(s){s=String(s);for(var l,h=[];l=s.match(/ERROR\:([^\n]+)/);){s=s.slice(l.index+1);var g=(j=l[1].trim()).split(":"),_=g.slice(2).join(":").trim(),A=parseInt(g[0],10),j=parseInt(g[1],10);h.push({message:_,file:A,line:j})}return h}(j);throw Object.assign(new Error(j),{type:A,errors:$})}),bound_vao:[],init:function(s){var l;!0!==this.disabled&&(l=mD(s,"OES_vertex_array_object")),null!=l?$y("info","Vertex Array Object extension available"):$y("warn",!0!==this.disabled?"Vertex Array Object extension NOT available":"Vertex Array Object extension force disabled")},create:function(s,l,h){var g={};g.setup=l,g.teardown=h;var _=mD(s,"OES_vertex_array_object");return null!=_&&(g._vao=_.createVertexArrayOES(),_.bindVertexArrayOES(g._vao)),g.setup(!0),g},getCurrentBinding:function(s){var l=this.bound_vao.filter(function(h){return h[0]===s})[0];return l&&l[1]},setCurrentBinding:function(s,l){var h=this.bound_vao,g=h.filter(function(_){return _[0]===s})[0];null==g?h.push([s,l]):g[1]=l},bind:function(s,l){var h,g=mD(s,"OES_vertex_array_object");null!=l?null!=g&&null!=l._vao?(g.bindVertexArrayOES(l._vao),this.setCurrentBinding(s,l)):l.setup(!1):(h=this.getCurrentBinding(s),null!=g?g.bindVertexArrayOES(null):null!=h&&"function"==typeof h.teardown&&h.teardown(),this.setCurrentBinding(s,null))},destroy:function(s,l){var h=mD(s,"OES_vertex_array_object");null!=h&&null!=l&&null!=l._vao&&(h.deleteVertexArrayOES(l._vao),l._vao=null)}},ZC=function(){function s(l,h,g,_,A,j){D0(this,s),j=j||{},this.textureManager=ZE(A),this.gl=l,this.vertex_data=h,this.element_data=g,this.vertex_layout=_,this.vertex_buffer=this.gl.createBuffer(),this.buffer_size=this.vertex_data.byteLength,this.draw_mode=j.draw_mode||this.gl.TRIANGLES,this.data_usage=j.data_usage||this.gl.STATIC_DRAW,this.vertices_per_geometry=3,this.uniforms=j.uniforms,this.textures=j.textures,this.retain=j.retain||!1,this.created_at=+new Date,this.fade_in_time=j.fade_in_time||0,this.vertex_count=this.vertex_data.byteLength/this.vertex_layout.stride,this.element_count=0,this.vaos={},this.toggle_element_array=!1,this.element_data?(this.toggle_element_array=!0,this.element_count=this.element_data.length,this.geometry_count=this.element_count/this.vertices_per_geometry,this.element_type=this.element_data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT,this.element_buffer=this.gl.createBuffer(),this.buffer_size+=this.element_data.byteLength,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.element_buffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.element_data,this.data_usage)):this.geometry_count=this.vertex_count/this.vertices_per_geometry,this.upload(),this.retain||(delete this.vertex_data,delete this.element_data),this.valid=!0}return T0(s,[{key:"render",value:function(l){var h=0<arguments.length&&void 0!==l?l:{};if(!this.valid)return!1;var g=h.program||b0.current;g.use(),this.uniforms&&(g.saveUniforms(this.uniforms),g.setUniforms(this.uniforms,!1));var _=(new Date-this.created_at)/1e3;return g.uniform("1f","u_visible_time",_),this.bind(g),this.toggle_element_array?this.gl.drawElements(this.draw_mode,this.element_count,this.element_type,0):this.gl.drawArrays(this.draw_mode,0,this.vertex_count),VA.bind(this.gl,null),this.uniforms&&g.restoreUniforms(this.uniforms),_<this.fade_in_time}},{key:"bind",value:function(l){var h=this,g=this.vaos[l.id];g?VA.bind(this.gl,g):this.vaos[l.id]=VA.create(this.gl,function(_){h.gl.bindBuffer(h.gl.ARRAY_BUFFER,h.vertex_buffer),h.toggle_element_array&&h.gl.bindBuffer(h.gl.ELEMENT_ARRAY_BUFFER,h.element_buffer),h.vertex_layout.enable(h.gl,l,_)})}},{key:"upload",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertex_data,this.data_usage)}},{key:"destroy",value:function(){var l=this;if(!this.valid)return!1;for(var h in this.valid=!1,this.vaos)VA.destroy(this.gl,this.vaos[h]);return this.gl.deleteBuffer(this.vertex_buffer),this.vertex_buffer=null,this.element_buffer&&(this.gl.deleteBuffer(this.element_buffer),this.element_buffer=null),delete this.vertex_data,delete this.element_data,this.textures&&this.textures.forEach(function(g){return l.textureManager.release(g)}),!0}}]),s}(),RI=["emission","ambient","diffuse","specular"],pT=function(){function s(l){var h=this;D0(this,s),l=l||{},RI.forEach(function(g){var _=l[g];null!=_&&(h[g]=_.texture?{texture:_.texture,mapping:_.mapping||"spheremap",scale:lx.expandVec3(null!=_.scale?_.scale:1),amount:lx.expandVec4(null!=_.amount?_.amount:1)}:"number"==typeof _||Array.isArray(_)?{amount:lx.expandVec4(_)}:"string"==typeof _?{amount:by.parseColor(_)}:_)}),this.specular&&(this.specular.shininess=l.shininess?parseFloat(l.shininess):.2),null!=l.normal&&(this.normal={texture:l.normal.texture,mapping:l.normal.mapping||"triplanar",scale:lx.expandVec3(null!=l.normal.scale?l.normal.scale:1),amount:null!=l.normal.amount?l.normal.amount:1})}return T0(s,[{key:"inject",value:function(l){var h=this;RI.forEach(function(g){var _="TANGRAM_MATERIAL_".concat(g.toUpperCase()),A=_+"_TEXTURE";l.defines[_]=null!=h[g],h[g]&&h[g].texture&&(l.defines[A]=!0,l.defines[A+"_"+h[g].mapping.toUpperCase()]=!0,l.defines["TANGRAM_MATERIAL_TEXTURE_".concat(h[g].mapping.toUpperCase())]=!0,l.texcoords=l.texcoords||"uv"===h[g].mapping)}),this.normal&&this.normal.texture&&(l.defines.TANGRAM_MATERIAL_NORMAL_TEXTURE=!0,l.defines["TANGRAM_MATERIAL_NORMAL_TEXTURE_"+this.normal.mapping.toUpperCase()]=!0,l.defines["TANGRAM_MATERIAL_TEXTURE_".concat(this.normal.mapping.toUpperCase())]=!0,l.texcoords=l.texcoords||"uv"===this.normal.mapping),l.replaceShaderBlock(s.block,"/*Defines globals:materiallight_accumulator_**/struct Material{\n#ifdef TANGRAM_MATERIAL_EMISSION\nvec4 emission;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nvec3 emissionScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT\nvec4 ambient;\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nvec3 ambientScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nvec4 diffuse;\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nvec3 diffuseScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 specular;float shininess;\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nvec3 specularScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvec3 normalScale;float normalAmount;\n#endif\n};uniform Material u_material;Material material;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nuniform sampler2D u_material_emission_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nuniform sampler2D u_material_ambient_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nuniform sampler2D u_material_diffuse_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nuniform sampler2D u_material_specular_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nuniform sampler2D u_material_normal_texture;\n#endif\nvec4 light_accumulator_ambient=vec4(vec3(0.0),1.);vec4 light_accumulator_diffuse=vec4(vec3(0.0),1.);\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 light_accumulator_specular=vec4(vec3(0.0),1.);\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_SPHEREMAP\nvec4 getSphereMap(in sampler2D _tex,in vec3 _eyeToPoint,in vec3 _normal,in vec2 _skew){vec3 eye=normalize(_eyeToPoint);eye.xy-=_skew;eye=normalize(eye);vec3 r=reflect(eye,_normal);r.z+=1.0;float m=2.*length(r);vec2 uv=r.xy/m+.5;return texture2D(_tex,uv);}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_TRIPLANAR\nvec3 getTriPlanarBlend(in vec3 _normal){vec3 blending=abs(_normal);blending=normalize(max(blending,0.00001));float b=(blending.x+blending.y+blending.z);return blending/b;}vec4 getTriPlanar(in sampler2D _tex,in vec3 _pos,in vec3 _normal,in vec3 _scale){vec3 blending=getTriPlanarBlend(_normal);vec4 xaxis=texture2D(_tex,fract(_pos.yz*_scale.x));vec4 yaxis=texture2D(_tex,fract(_pos.xz*_scale.y));vec4 zaxis=texture2D(_tex,fract(_pos.xy*_scale.z));return xaxis*blending.x+yaxis*blending.y+zaxis*blending.z;}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_PLANAR\nvec4 getPlanar(in sampler2D _tex,in vec3 _pos,in vec2 _scale){return texture2D(_tex,fract(_pos.xy*_scale.x));}\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvoid calculateNormal(inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_UV\n_normal+=texture2D(u_material_normal_texture,fract(v_texcoord*material.normalScale.xy)).rgb*2.0-1.0;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_PLANAR\nvec3 normalTex=getPlanar(u_material_normal_texture,v_world_position.xyz,material.normalScale.xy).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_TRIPLANAR\nvec3 normalTex=getTriPlanar(u_material_normal_texture,v_world_position.xyz,_normal,material.normalScale).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n_normal=normalize(_normal);}\n#endif\nvoid calculateMaterial(in vec3 _eyeToPoint,inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_UV\nmaterial.emission*=texture2D(u_material_emission_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_PLANAR\nmaterial.emission*=getPlanar(u_material_emission_texture,v_world_position.xyz,material.emissionScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_TRIPLANAR\nmaterial.emission*=getTriPlanar(u_material_emission_texture,v_world_position.xyz,_normal,material.emissionScale);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_SPHEREMAP\nmaterial.emission*=getSphereMap(u_material_emission_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_UV\nmaterial.ambient*=texture2D(u_material_ambient_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_PLANAR\nmaterial.ambient*=getPlanar(u_material_ambient_texture,v_world_position.xyz,material.ambientScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_TRIPLANAR\nmaterial.ambient*=getTriPlanar(u_material_ambient_texture,v_world_position.xyz,_normal,material.ambientScale);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_SPHEREMAP\nmaterial.ambient*=getSphereMap(u_material_ambient_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_UV\nmaterial.diffuse*=texture2D(u_material_diffuse_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_PLANAR\nmaterial.diffuse*=getPlanar(u_material_diffuse_texture,v_world_position.xyz,material.diffuseScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_TRIPLANAR\nmaterial.diffuse*=getTriPlanar(u_material_diffuse_texture,v_world_position.xyz,_normal,material.diffuseScale);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_SPHEREMAP\nmaterial.diffuse*=getSphereMap(u_material_diffuse_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_UV\nmaterial.specular*=texture2D(u_material_specular_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_PLANAR\nmaterial.specular*=getPlanar(u_material_specular_texture,v_world_position.xyz,material.specularScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_TRIPLANAR\nmaterial.specular*=getTriPlanar(u_material_specular_texture,v_world_position.xyz,_normal,material.specularScale);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_SPHEREMAP\nmaterial.specular*=getSphereMap(u_material_specular_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n}","Material"),l.addShaderBlock("setup","\nmaterial = u_material;\n","Material")}},{key:"setupProgram",value:function(l){var h=this;RI.forEach(function(g){h[g]&&(h[g].texture?(l.setTextureUniform("u_material_".concat(g,"_texture"),h[g].texture),l.uniform("3fv","u_material.".concat(g,"Scale"),h[g].scale),l.uniform("4fv","u_material.".concat(g),h[g].amount)):h[g].amount&&l.uniform("4fv","u_material.".concat(g),h[g].amount))}),this.specular&&l.uniform("1f","u_material.shininess",this.specular.shininess),this.normal&&this.normal.texture&&(l.setTextureUniform("u_material_normal_texture",this.normal.texture),l.uniform("3fv","u_material.normalScale",this.normal.scale),l.uniform("1f","u_material.normalAmount",this.normal.amount))}}],[{key:"isValid",value:function(l){return null!=l&&(null!=l.emission||null!=l.ambient||null!=l.diffuse||null!=l.specular)}}]),s}();pT.block="material";var l0=e1={};e1.copy=function(s){for(var l=[],h=s.length,g=0;g<h;g++)l[g]=s[g];return l},e1.neg=function(s){for(var l=[],h=s.length,g=0;g<h;g++)l[g]=-s[g];return l},e1.add=function(s,l){for(var h=[],g=Math.min(s.length,l.length),_=0;_<g;_++)h[_]=s[_]+l[_];return h},e1.sub=function(s,l){for(var h=[],g=Math.min(s.length,l.length),_=0;_<g;_++)h[_]=s[_]-l[_];return h},e1.signed_area=function(s,l,h){return(l[0]-s[0])*(h[1]-s[1])-(h[0]-s[0])*(l[1]-s[1])},e1.mult=function(s,l){var h,g=[],_=s.length;if("number"==typeof l)for(h=0;h<_;h++)g[h]=s[h]*l;else for(_=Math.min(s.length,l.length),h=0;h<_;h++)g[h]=s[h]*l[h];return g},e1.multMatrix=function(s,l){return[s[0][0]*l[0]+s[0][1]*l[1],s[1][0]*l[0]+s[1][1]*l[1]]},e1.div=function(s,l){var h=[];if("number"==typeof l)for(_=0;_<s.length;_++)h[_]=s[_]/l;else for(var g=Math.min(s.length,l.length),_=0;_<g;_++)h[_]=s[_]/l[_];return h},e1.perp=function(s,l){return[l[1]-s[1],s[0]-l[0]]},e1.rot=function(s,l){var h=Math.cos(l),g=Math.sin(l);return[s[0]*h-s[1]*g,s[0]*g+s[1]*h]},e1.angle=function(s){var l=A0(s,2);return Math.atan2(l[1],l[0])},e1.angleBetween=function(s,l){var h=e1.dot(e1.normalize(e1.copy(s)),e1.normalize(e1.copy(l)));return 1<h&&(h=1),Math.acos(h)},e1.signedAngleBetween=function(s,l){return Math.atan2(s[0]*l[1]-s[1]*l[0],s[0]*l[0]+s[1]*l[1])},e1.isEqual=function(s,l){for(var h=s.length,g=0;g<h;g++)if(s[g]!==l[g])return!1;return!0},e1.lengthSq=function(s){return 2===s.length?s[0]*s[0]+s[1]*s[1]:3<=s.length?s[0]*s[0]+s[1]*s[1]+s[2]*s[2]:0},e1.length=function(s){return Math.sqrt(e1.lengthSq(s))},e1.normalize=function(s){var l;if(2===s.length){if(1==(l=s[0]*s[0]+s[1]*s[1]))return s;0!==(l=Math.sqrt(l))?(s[0]/=l,s[1]/=l):(s[0]=0,s[1]=0)}else if(3<=s.length){if(1==(l=s[0]*s[0]+s[1]*s[1]+s[2]*s[2]))return s;0!==(l=Math.sqrt(l))?(s[0]/=l,s[1]/=l,s[2]/=l):(s[0]=0,s[1]=0,s[2]=0)}return s},e1.cross=function(s,l){return 2===s.length?s[0]*l[1]-s[1]*l[0]:3===s.length?[s[1]*l[2]-s[2]*l[1],s[2]*l[0]-s[0]*l[2],s[0]*l[1]-s[1]*l[0]]:void 0},e1.dot=function(s,l){for(var h=0,g=Math.min(s.length,l.length),_=0;_<g;_++)h+=s[_]*l[_];return h};var R1=function(){function s(l,h){D0(this,s),this.name=h.name,this.view=l,this.ambient=null==h.ambient||"number"==typeof h.ambient?lx.expandVec3(h.ambient||0):by.parseColor(h.ambient).slice(0,3),this.diffuse=null==h.diffuse||"number"==typeof h.diffuse?lx.expandVec3(null!=h.diffuse?h.diffuse:1):by.parseColor(h.diffuse).slice(0,3),this.specular=null==h.specular||"number"==typeof h.specular?lx.expandVec3(h.specular||0):by.parseColor(h.specular).slice(0,3)}return T0(s,[{key:"inject",value:function(){var l="\n            uniform ".concat(this.struct_name," u_").concat(this.name,";\n            ").concat(this.struct_name," ").concat(this.name,";\n            "),h="\n            ".concat(this.name," = u_").concat(this.name,";\n\n        ");b0.addBlock(s.block,l),b0.addBlock("setup",h)}},{key:"update",value:function(){}},{key:"setupProgram",value:function(l){l.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient),l.uniform("3fv","u_".concat(this.name,".diffuse"),this.diffuse),l.uniform("3fv","u_".concat(this.name,".specular"),this.specular)}}],[{key:"create",value:function(l,h){if(s.types[h.type])return new s.types[h.type](l,h)}},{key:"setMode",value:function(l,h){!0===l&&(l="fragment"),h.defines.TANGRAM_LIGHTING_FRAGMENT="fragment"===(l=s.enabled&&(l??"fragment")),h.defines.TANGRAM_LIGHTING_VERTEX="vertex"===l}},{key:"inject",value:function(l){if(b0.removeBlock(s.block),s.enabled){var h="";if(l&&0<Object.keys(l).length){var g={};for(var _ in l)g[l[_].type]=!0;for(var A in g)s.types[A].inject();for(var j in l)l[j].inject(),h+="calculateLight(".concat(j,", _eyeToPoint, _normal);\n")}var $="\n            vec4 calculateLighting(in vec3 _eyeToPoint, in vec3 _normal, in vec4 _color) {\n\n                // Do initial material calculations over normal, emission, ambient, diffuse and specular values\n                calculateMaterial(_eyeToPoint,_normal);\n\n                // Un roll the loop of individual ligths to calculate\n                ".concat(h,"\n\n                //  Final light intensity calculation\n                vec4 color = vec4(vec3(0.), _color.a); // start with vertex color alpha\n\n                #ifdef TANGRAM_MATERIAL_EMISSION\n                    color.rgb = material.emission.rgb;\n                    color.a *= material.emission.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_AMBIENT\n                    color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.ambient.rgb;\n                    color.a *= material.ambient.a;\n                #else\n                    #ifdef TANGRAM_MATERIAL_DIFFUSE\n                        color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.diffuse.rgb;\n                    #endif\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_DIFFUSE\n                    color.rgb += light_accumulator_diffuse.rgb * _color.rgb * material.diffuse.rgb;\n                    color.a *= material.diffuse.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_SPECULAR\n                    color.rgb += light_accumulator_specular.rgb * material.specular.rgb;\n                    color.a *= material.specular.a;\n                #endif\n\n                // Clamp final color\n                color = clamp(color, 0.0, 1.0);\n\n                return color;\n            }");b0.addBlock(s.block,$)}}}]),s}();R1.types={},R1.block="lighting",R1.enabled=!0;var xV=function(){L_(l,R1);var s=B1(l);function l(h,g){var _;return D0(this,l),(_=s.call(this,h,g)).type="ambient",_.struct_name="AmbientLight",_}return T0(l,[{key:"setupProgram",value:function(h){h.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient)}}],[{key:"inject",value:function(){b0.addBlock(R1.block,"/*Expected globals:light_accumulator_**/struct AmbientLight{vec3 ambient;};void calculateLight(in AmbientLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;}")}}]),l}();R1.types.ambient=xV;var yN=function(){L_(l,R1);var s=B1(l);function l(h,g){var _,A;return D0(this,l),(_=s.call(this,h,g)).type="directional",_.struct_name="DirectionalLight",g.direction?_._direction=g.direction:(A=Math.sin(60*Math.PI/180),_._direction=[Math.cos(135*Math.PI/180)*A,Math.sin(135*Math.PI/180)*A,-.5]),null==g.ambient&&(_.ambient=lx.expandVec3(.5)),_.direction=_._direction.map(parseFloat),_._initial_direction=[_.direction[0],_.direction[1],_.direction[2]],_}return T0(l,[{key:"update",value:function(){_x_transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"setupProgram",value:function(h){kE(h1(l.prototype),"setupProgram",this).call(this,h),h.uniform("3fv","u_".concat(this.name,".direction"),this.direction)}},{key:"direction",get:function(){return this._direction},set:function(h){this._direction=l0.normalize(l0.copy(h))}}],[{key:"inject",value:function(){b0.addBlock(R1.block,"/*Expected globals:materiallight_accumulator_**/struct DirectionalLight{vec3 ambient;vec3 diffuse;vec3 specular;vec3 direction;};void calculateLight(in DirectionalLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;float nDotVP=clamp(dot(_normal,-_light.direction),0.0,1.0);\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(_light.direction,_normal);float eyeDotR=max(dot(normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf;\n#endif\n}")}}]),l}();R1.types.directional=yN;var NI=function(){L_(l,R1);var s=B1(l);function l(h,g){var _;return D0(this,l),(_=s.call(this,h,g)).type="point",_.struct_name="PointLight",_.position=g.position||[0,0,"100px"],_.position_eye=[],_.origin=g.origin||"ground",_.attenuation=isNaN(parseFloat(g.attenuation))?0:parseFloat(g.attenuation),_.radius=g.radius?Array.isArray(g.radius)&&2===g.radius.length?g.radius:[null,g.radius]:null,_}return T0(l,[{key:"inject",value:function(){kE(h1(l.prototype),"inject",this).call(this),b0.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT=0!==this.attenuation,b0.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS=null!=this.radius&&null!=this.radius[0],b0.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS=null!=this.radius}},{key:"update",value:function(){var h,g,_,A=this.view.lookAtManipulator.getLookAtData().zoom;"world"===this.origin?(g=(h=A0(My.latLngToMeters(this.position),2))[0],_=h[1],this.position_eye[0]=g-this.view.lookAtManipulator.getLookAtData().position[0],this.position_eye[1]=_-this.view.lookAtManipulator.getLookAtData().position[1],this.position_eye[2]=by.convertUnits(this.position[2],{zoom:A,meters_per_pixel:My.metersPerPixel(A)}),this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance):"ground"!==this.origin&&"camera"!==this.origin||(this.position_eye=by.convertUnits(this.position,{zoom:A,meters_per_pixel:My.metersPerPixel(A)}),"ground"===this.origin&&(this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance)),this.position_eye[3]=1}},{key:"setupProgram",value:function(h){kE(h1(l.prototype),"setupProgram",this).call(this,h),h.uniform("4fv","u_".concat(this.name,".position"),this.position_eye),b0.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT&&h.uniform("1f","u_".concat(this.name,".attenuationExponent"),this.attenuation);var g=this.view.lookAtManipulator.getLookAtData().zoom;b0.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS&&h.uniform("1f","u_".concat(this.name,".innerRadius"),by.convertUnits(this.radius[0],{zoom:g,meters_per_pixel:My.metersPerPixel(g)})),b0.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS&&h.uniform("1f","u_".concat(this.name,".outerRadius"),by.convertUnits(this.radius[1],{zoom:g,meters_per_pixel:My.metersPerPixel(g)}))}}],[{key:"inject",value:function(){b0.addBlock(R1.block,"/*Expected globals:materiallight_accumulator_**/struct PointLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\n};void calculateLight(in PointLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(VP,_normal),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nlight_accumulator_ambient.rgb+=_light.ambient*attenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(0.0,dot(-normalize(_eyeToPoint),reflectVector));pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation;\n#endif\n}")}}]),l}();R1.types.point=NI;var I3=function(){L_(l,NI);var s=B1(l);function l(h,g){var _;return D0(this,l),(_=s.call(this,h,g)).type="spotlight",_.struct_name="SpotLight",_.direction=_._direction=(g.direction||[0,0,-1]).map(parseFloat),_._initial_direction=[_.direction[0],_.direction[1],_.direction[2]],_.exponent=g.exponent?parseFloat(g.exponent):.2,_.angle=g.angle?parseFloat(g.angle):20,_}return T0(l,[{key:"setupProgram",value:function(h){kE(h1(l.prototype),"setupProgram",this).call(this,h),h.uniform("3fv","u_".concat(this.name,".direction"),this.direction),h.uniform("1f","u_".concat(this.name,".spotCosCutoff"),Math.cos(3.14159*this.angle/180)),h.uniform("1f","u_".concat(this.name,".spotExponent"),this.exponent)}},{key:"update",value:function(){kE(h1(l.prototype),"update",this).call(this),_x_transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"direction",get:function(){return this._direction},set:function(h){this._direction=l0.normalize(l0.copy(h))}}],[{key:"inject",value:function(){b0.addBlock(R1.block,"/*Expected globals:materiallight_accumulator_**/struct SpotLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\nvec3 direction;float spotCosCutoff;float spotExponent;};void calculateLight(in SpotLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(_normal,VP),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nfloat spotAttenuation=0.0;float spotDot=clamp(dot(-VP,_light.direction),0.0,1.0);if(spotDot>=_light.spotCosCutoff){spotAttenuation=pow(spotDot,_light.spotExponent);}light_accumulator_ambient.rgb+=_light.ambient*attenuation*spotAttenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation*spotAttenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(dot(-normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation*spotAttenuation;\n#endif\n}")}}]),l}();function Q1(s){for(var l=0;l<(arguments.length<=1?0:arguments.length-1);l++){var h=l+1<1||arguments.length<=l+1?void 0:arguments[l+1];if(h)for(var g in h){var _=h[g];null===_||"object"!==T_(_)||Array.isArray(_)?void 0!==_&&(s[g]=_):s[g]=null===s[g]||"object"!==T_(s[g])||Array.isArray(s[g])?Q1({},_):Q1(s[g],_)}}return s}R1.types.spotlight=I3;var mN="#ifdef TANGRAM_FRAGMENT_SHADER\nuniform sampler2D u_raster;uniform vec3 u_raster_offset;\n#define sampleRaster() (texture2D(u_raster, v_modelpos_base_zoom.xy * u_raster_offset.z + u_raster_offset.xy))\n#endif\n",W_={init:function(s){var l=0<arguments.length&&void 0!==s?s:{},h=l.generation,g=l.styles,_=l.sources,A=void 0===_?{}:_,j=l.introspection,$=l.id,_t=void 0!==$?$+"/":"";this.scene_id=$,this.textureManager=ZE($),this.main_thread_target="".concat(_t,"Style/").concat(this.name),this.setGeneration(h),this.styles=g,this.sources=A,this.defines=this.hasOwnProperty("defines")&&this.defines||{},this.shaders=this.hasOwnProperty("shaders")&&this.shaders||{},this.introspection=j||!1,this.selection=this.selection||this.introspection||!1,this.compile_setup=!1,this.program=null,this.selection_program=null,this.feature_style={},this.vertex_template=[],this.tile_data={},this.defines.TANGRAM_WORLD_POSITION_WRAP=1e5,this.blend=this.blend||"opaque",this.defines["TANGRAM_BLEND_".concat(this.blend.toUpperCase())]=!0,null==this.blend_order&&(this.blend_order=-1),this.removeShaderBlock("setup"),this.material instanceof pT||(pT.isValid(this.material)||(this.material=by.defaults.material),this.material=new pT(this.material)),this.material.inject(this),R1.setMode(this.lighting,this),this.setupRasters(),this.initialized=!0},destroy:function(){this.program&&(this.program.destroy(),this.program=null),this.selection_program&&(this.selection_program.destroy(),this.selection_program=null),_0.removeTarget(this.main_thread_target),this.gl=null,this.initialized=!1},reset:function(){},baseStyle:function(){return this.base||this.name},setGeneration:function(s){this.generation=s,V_.is_main&&_0.addTarget(this.main_thread_target,this)},fillVertexTemplate:function(s,l,h,g){var _=g.size,A=void 0===(A=g.offset)?0:A,j=s.index[l];if(void 0!==j)for(var $=0;$<_;++$)this.vertex_template[j+$+A]=h.length>$?h[$]:h;else $y("warn","Style: in style '".concat(this.name,"', no index found in vertex layout for attribute '").concat(l,"'"))},startData:function(s){this.tile_data[s.id]=this.tile_data[s.id]||{meshes:{},uniforms:{},textures:[]}},endData:function(s){var l=this.tile_data[s.id];if(this.tile_data[s.id]=null,l&&0<Object.keys(l.meshes).length){for(var h in l.meshes){var g=l.meshes[h];0!==g.vertex_data.vertex_count?(g.vertex_data.end(),g.vertex_elements=g.vertex_data.element_buffer,g.vertex_data=g.vertex_data.vertex_buffer):delete l.meshes[h]}return s.mesh_data[this.name]=l,this.buildRasterTextures(s,l).then(function(_){return _})}return Promise.resolve(null)},hasDataForTile:function(s){return null!=this.tile_data[s.id]},getTileMesh:function(s,l){var h=this.tile_data[s.id].meshes;return null==h[l.key]&&(h[l.key]={variant:l,vertex_data:this.vertexLayoutForMeshVariant(l).createVertexData()}),h[l.key]},vertexLayoutForMeshVariant:function(){return this.vertex_layout},default_mesh_variant:{key:0},style_mesh_variants:{default:{variants:{0:{variant:{key:0},times_unref:0}}}},addMeshVariantForDraw:function(s,l){this.style_mesh_variants[s]||(this.style_mesh_variants[s]={variants:{}});var h=this.computeVariantForDraw(l);return this.style_mesh_variants[s].variants[h.key]={variant:h,times_unref:0},this.style_mesh_variants[s].variants[h.key].variant},getMeshVariantTypeForDraw:function(s){return this.getMeshVariantType(this.base,s)},getMeshVariantType:function(s,l){void 0===s&&(s="default");var h=this.style_mesh_variants[s];if(void 0===l.variantKey||!h||!h.variants[l.variantKey])return this.addMeshVariantForDraw(s,l);var _=h.variants[l.variantKey];return _.times_unref=0,_.variant},updateMeshVariantTypeCache:function(s){for(var l in this.style_mesh_variants){var h=this.style_mesh_variants[l].variants;for(var g in h){var _=h[g];_.times_unref++,_.times_unref>s&&("default"!==l||0!=+g)&&(delete h[g],0===Object.keys(h).length&&delete this.style_mesh_variants[l])}}},computeVariantForDraw:function(){return this.default_mesh_variant},addFeature:function(s,l,h){var g=h.tile;this.tile_data[g.id]||this.startData(g);var _,A,j,$,_t=this.parseFeature(s,l,h);_t&&(_=this.getMeshVariantTypeForDraw("lines"===this.base?l:_t),j=(A=this.getTileMesh(g,_)).vertex_data.offset,$=A.vertex_data.vertex_count,0<this.buildGeometry(s.geometry,_t,A,h)?s.generation=this.generation:A.vertex_data.vertex_count>$&&(A.vertex_data.vertex_buffer.fill(0,j,A.vertex_data.offset),A.vertex_data.vertex_count=$,A.vertex_data.offset=j))},buildGeometry:function(s,l,h,g){var _;return"Polygon"===s.type?_=this.buildPolygons([s.coordinates],l,h,g):"MultiPolygon"===s.type?_=this.buildPolygons(s.coordinates,l,h,g):"LineString"===s.type?_=this.buildLines([s.coordinates],l,h,g):"MultiLineString"===s.type?_=this.buildLines(s.coordinates,l,h,g):"Point"===s.type?_=this.buildPoints([s.coordinates],l,h,g):"MultiPoint"===s.type&&(_=this.buildPoints(s.coordinates,l,h,g)),_},parseFeature:function(s,l,h){try{var g,_,A,j=this.feature_style;if(j.order=this.parseOrder(l.order,h),null==j.order&&"overlay"!==this.blend){var $="Layer '".concat(l.layers.join(", "),"', draw group '").concat(l.group,"': ");return $+="'order' parameter is required unless blend mode is 'overlay'",null!=l.order&&($+="; 'order' was set to a dynamic value (e.g. string tied to feature property, ",$+="or JS function), but evaluated to null for one or more features"),void $y({level:"warn",once:!0},$)}return(j=this._parseFeature(s,l,h))?(j.interactive=!!this.selection&&by.evalProperty(this.introspection||l.interactive,h),!0===j.interactive?(_=(g=wx.makeEntry()).color,A=g.key,j.selection_color=_,h.tile.selection_data||(h.tile.selection_data={}),h.tile.selection_data[A]={id:s.id||A,properties:s.properties,source_name:h.source,source_layer:h.layer,layers:h.layers}):j.selection_color=wx.defaultColor,j):void 0}catch(_t){$y("error","Style.parseFeature: style parsing error",s,j,_t.stack)}},_parseFeature:function(){return this.feature_style},preprocess:function(s,l){if(!s.preprocessed){if(this.draw)for(var h in this.draw){var g=this.draw[h];"object"!==T_(g)||Array.isArray(g)?null==s[h]&&(s[h]=g):s[h]=Q1({},g,s[h])}if(!(s=this._preprocess(s,l||"")))return;s.preprocessed=!0}return s},_preprocess:function(s){return s},parseOrder:function(s,l){return"number"!=typeof s?by.calculateOrder(s,l):s},scaleOrder:function(s){return 2*s},parseColor:function(s,l){return s?by.evalCachedColorProperty(s,l):this.shaders.blocks.color||this.shaders.blocks.filter?by.defaults.color:void 0},buildPolygons:function(){return 0},buildLines:function(){return 0},buildPoints:function(){return 0},setGL:function(s){this.gl=s,this.max_texture_size=this.textureManager.getMaxTextureSize(this.gl)},makeMesh:function(s,l,h){var g=2<arguments.length&&void 0!==h?h:{},_=this.vertexLayoutForMeshVariant(g.variant);return new ZC(this.gl,s,l,_,this.scene_id,g)},render:function(s){return s.render()},getProgram:function(s){var l=0<arguments.length&&void 0!==s?s:"program";this.compileSetup();var h=this[l];if(h&&!h.error){if(!h.compiled)try{h.compile()}catch(g){$y("error","Style: error compiling program for style '".concat(this.name,"' (program key '").concat(l,"')"),this,g.stack)}return h}},compileSetup:function(){if(!this.compile_setup){if(!this.gl)throw new Error("style.compile(): skipping for ".concat(this.name," because no GL context"));var s,l=this.buildDefineList();this.selection&&((s=Object.assign({},l)).TANGRAM_FEATURE_SELECTION=!0);var h=this.shaders&&this.shaders.blocks,g=this.shaders&&this.shaders.block_scopes,_=Object.assign({},this.shaders&&this.shaders.uniforms);for(var A in _)null==_[A]&&$y({level:"warn",once:!0},"Style '".concat(this.name,"' has invalid uniform '").concat(A,"': uniform values must be non-null"));var j=this.shaders&&this.shaders.extensions;"string"==typeof j&&(j=[j]),this.program=new b0(this.gl,this.vertex_shader_src,this.fragment_shader_src,this.scene_id,{name:this.name,defines:l,uniforms:_,blocks:h,block_scopes:g,extensions:j}),this.selection_program=this.selection?new b0(this.gl,this.vertex_shader_src,this.crop_by_tile?"\n#pragma tangram: utils\n#ifdef TANGRAM_FEATURE_SELECTION\nuniform float u_meters_per_pixel;varying vec4 v_selection_color;varying vec4 v_local_space_position;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}else{gl_FragColor=v_selection_color;}\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}":"\n#ifdef TANGRAM_FEATURE_SELECTION\nvarying vec4 v_selection_color;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\ngl_FragColor=v_selection_color;\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}",this.scene_id,{name:this.name+" (selection)",defines:s,uniforms:_,blocks:h,block_scopes:g,extensions:j}):null,this.compile_setup=!0}},addShaderBlock:function(s,l,h){var g=2<arguments.length&&void 0!==h?h:null;this.shaders.blocks=this.shaders.blocks||{},this.shaders.blocks[s]=this.shaders.blocks[s]||[],this.shaders.blocks[s].push(l),this.shaders.block_scopes=this.shaders.block_scopes||{},this.shaders.block_scopes[s]=this.shaders.block_scopes[s]||[],this.shaders.block_scopes[s].push(g)},removeShaderBlock:function(s){this.shaders.blocks&&(this.shaders.blocks[s]=null)},replaceShaderBlock:function(s,l,h){var g=2<arguments.length&&void 0!==h?h:null;this.removeShaderBlock(s),this.addShaderBlock(s,l,g)},buildDefineList:function(){var s={};if(null!=this.defines)for(var l in this.defines)s[l]=this.defines[l];if(null!=this.shaders&&null!=this.shaders.defines)for(l in this.shaders.defines)s[l]=this.shaders.defines[l];return s},hasRasters:function(){return-1<["color","normal","custom"].indexOf(this.raster)},setupRasters:function(){if(!V_.is_main||!this.hasRasters())return!1;"color"===this.raster?this.defines.TANGRAM_RASTER_TEXTURE_COLOR=!0:"normal"===this.raster&&(this.defines.TANGRAM_RASTER_TEXTURE_NORMAL=!0);var s=!1;for(var l in this.sources)if(this.sources[l]instanceof jS){s=!0;break}return!!s&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",mN,"Raster"),!0)},buildRasterTextures:function(s,l){var h=this;if(!this.hasRasters())return Promise.resolve(l);var g={};return s.rasters.map(function(_){return h.sources[_]}).filter(function(_){return _}).forEach(function(_,A){var j;_ instanceof jS&&(j=_.tileTexture(s),g[j.url]=j)}),0===Object.keys(g).length?Promise.resolve(l):_0.postMessage(this.main_thread_target+".loadTextures",g).then(function(_){if(!_||_.length<1)return $y("trace","Missing texture info for tile ".concat(s.key)),null;if(_.some(function(Ye){return!Ye.loaded}))return null;l.uniforms=l.uniforms||{},l.textures=l.textures||[];var j,$=_[0].name,_t=g[$].coords;return l.uniforms.u_raster=$,l.textures.push($),s.coords.z>_t.z?(j=Math.pow(2,s.coords.z-_t.z),l.uniforms.u_raster_offset=[(s.coords.x%j+j)%j/j,(j-1-s.coords.y%j)/j,1/j]):l.uniforms.u_raster_offset=[0,0,1],l})},loadTextures:function(s){var l=this;return this.textureManager.createFromObject(this.gl,s).then(function(){return Promise.all(Object.keys(s).map(function(h){return l.textureManager.textures[h]&&l.textureManager.textures[h].load()}).filter(function(h){return h}))}).then(function(h){return h.forEach(function(g){return g.retain()}),h.map(function(g){return{name:g.name,width:g.width,height:g.height,loaded:g.loaded}})})},setup:function(){this.setUniforms(),this.material.setupProgram(b0.current)},setUniforms:function(){var s=b0.current;s&&s.setUniforms(this.shaders&&this.shaders.uniforms,!0)},render_states:{opaque:{depth_test:!0,depth_write:!0},translucent:{depth_test:!0,depth_write:!0},add:{depth_test:!0,depth_write:!1},multiply:{depth_test:!0,depth_write:!1},inlay:{depth_test:!0,depth_write:!1},overlay:{depth_test:!1,depth_write:!1}},default_blend_orders:{opaque:0,add:1,multiply:2,inlay:3,translucent:4,overlay:5},sortByBlendOrderWithinLayers:function(s){var l=[],h={};for(var g in s.forEach(function(_){var A=parseInt(_.name,10)||0;h[A]||(h[A]=[]),h[A].push(_)}),h)l.push.apply(l,A_(h[g].sort(W_.blendOrderSort)));return l},blendOrderSort:function(s,l){return"opaque"===s.blend||"opaque"===l.blend?"opaque"===s.blend&&"opaque"===l.blend?s.name<l.name?-1:1:"opaque"===s.blend?-1:1:s.blend_order<l.blend_order||!(s.blend_order>l.blend_order)&&(W_.default_blend_orders[s.blend]<W_.default_blend_orders[l.blend]||!(W_.default_blend_orders[s.blend]>W_.default_blend_orders[l.blend])&&s.name<l.name)?-1:1}},PI=0,LI=0,n1=function(){function s(l){var h=l.coords,g=l.style_zoom,_=l.source,A=l.worker,j=l.view,$=l.sceneId;D0(this,s),this.textureManager=ZE($),this.id=PI++,this.worker=A,this.view=j,this.source=_,this.generation=null,this.valid=!0,this.proxy_for=null,this.proxy_depth=0,this.proxied_as=null,this.fade_in=!0,this.loading=!1,this.loaded=!1,this.built=!1,this.labeled=!1,this.error=null,this.style_zoom=g,this.coords=s.normalizedCoordinate(h,this.source,this.style_zoom),this.key=s.key(this.coords,this.source,this.style_zoom),this.overzoom=Math.max(this.style_zoom-this.coords.z,0),this.overzoom2=Math.pow(2,this.overzoom),this.min=My.metersForTile(this.coords),this.max=My.metersForTile({x:this.coords.x+1,y:this.coords.y+1,z:this.coords.z}),this.span={x:this.max.x-this.min.x,y:this.max.y-this.min.y},this.bounds={sw:{x:this.min.x,y:this.max.y},ne:{x:this.max.x,y:this.min.y}},this.center_dist=0,this.meters_per_pixel=My.metersPerPixel(this.style_zoom),this.meters_per_pixel_sq=this.meters_per_pixel*this.meters_per_pixel,this.units_per_pixel=My.units_per_pixel/this.overzoom2,this.units_per_meter_overzoom=My.unitsPerMeter(this.coords.z)*this.overzoom2,this.meshes={},this.new_mesh_styles=[]}return T0(s,[{key:"freeResources",value:function(){for(var l in this.meshes)this.meshes[l].forEach(function(h){return h.destroy()});this.meshes={}}},{key:"destroy",value:function(){w1.removeForTile(this.id),this.workerMessage("self.removeTile",this.id),this.freeResources(),this.worker=null,this.valid=!1}},{key:"buildAsMessage",value:function(){return{id:this.id,key:this.key,source:this.source.name,coords:this.coords,min:this.min,max:this.max,units_per_pixel:this.units_per_pixel,meters_per_pixel:this.meters_per_pixel,meters_per_pixel_sq:this.meters_per_pixel_sq,units_per_meter_overzoom:this.units_per_meter_overzoom,style_zoom:this.style_zoom,overzoom:this.overzoom,overzoom2:this.overzoom2,generation:this.generation}}},{key:"workerMessage",value:function(){for(var l=arguments.length,h=new Array(l),g=0;g<l;g++)h[g]=arguments[g];return _0.postMessage.apply(_0,[this.worker].concat(h))}},{key:"build",value:function(l,h){var g=(1<arguments.length&&void 0!==h?h:{}).fade_in,_=void 0===g||g;return this.generation=l,this.fade_in=_,this.loaded||(this.loading=!0,this.built=!1,this.labeled=!1),this.workerMessage("self.buildTile",{tile:this.buildAsMessage()})}},{key:"buildMeshes",value:function(l,h){if(!this.error){this.build_id=LI++;var g={},_=this.mesh_data;if(_)for(var A in _){for(var j in _[A].meshes){var $=_[A].meshes[j];if($.vertex_data){if(!l[A]){$y("warn","Could not create mesh because style '".concat(A,"' not found, for tile ").concat(this.key,", aborting tile"));break}var _t=Object.assign({},_[A]);_t.uniforms=Object.assign({},_t.uniforms,$.uniforms),_t.variant=$.variant,$.textures&&(_t.textures=$.textures),$.labels&&(_t.retain=!0);var Ye=l[A].makeMesh($.vertex_data,$.vertex_elements,_t);Ye.variant=_t.variant,Ye.labels=$.labels,g[A]=g[A]||[],g[A].push(Ye),null==Ye.variant.order&&(Ye.variant.order=g[A].length-1)}}g[A]&&g[A].sort(function(Ja,_l){var lc=Ja.variant.order,_p=_l.variant.order;return null!=lc&&(null==_p||lc<_p)?-1:1})}for(var _i in delete this.mesh_data,g)this.meshes[_i]&&this.meshes[_i].forEach(function(Ja){return Ja.destroy()}),this.meshes[_i]=g[_i],this.new_mesh_styles.push(_i);if(h.done){for(var _s in this.meshes)-1===this.new_mesh_styles.indexOf(_s)&&(this.meshes[_s].forEach(function(Ja){return Ja.destroy()}),delete this.meshes[_s]);this.new_mesh_styles=[]}}}},{key:"setProxyFor",value:function(l){l?(this.proxy_for=this.proxy_for||[],this.proxy_for.push(l),this.proxy_depth=1,l.proxied_as=l.style_zoom>this.style_zoom?"child":"parent"):(this.proxy_for=null,this.proxy_depth=0)}},{key:"isProxy",value:function(){return null!=this.proxy_for}},{key:"shouldProxyForStyle",value:function(l){return!this.proxy_for||this.proxy_for.some(function(h){return null==h.meshes[l]})}},{key:"setupProgram",value:function(l,h){var g=l.model,_=l.model32;h.uniform("4fv","u_tile_origin",[this.min.x,this.min.y,this.style_zoom,this.coords.z]),h.uniform("1f","u_tile_proxy_depth",this.proxy_depth),bx_identity(g),bx_translate(g,g,_x_fromValues(this.min.x,this.min.y,0)),function(s,l,h){var g=h[0],_=h[1],A=h[2];s[0]=l[0]*g,s[1]=l[1]*g,s[2]=l[2]*g,s[3]=l[3]*g,s[4]=l[4]*_,s[5]=l[5]*_,s[6]=l[6]*_,s[7]=l[7]*_,s[8]=l[8]*A,s[9]=l[9]*A,s[10]=l[10]*A,s[11]=l[11]*A,s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15]}(g,g,_x_fromValues(this.span.x/My.tile_scale,-1*this.span.y/My.tile_scale,1)),function(s,l){s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5],s[6]=l[6],s[7]=l[7],s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15]}(_,g),h.uniform("Matrix4fv","u_model",_),h.uniform("1i","u_tile_fade_in",this.fade_in&&"child"!==this.proxied_as)}},{key:"merge",value:function(l){return this.loading=l.loading,this.loaded=l.loaded,this.generation=l.generation,this.error=l.error,this.mesh_data=l.mesh_data,this.selection_data?Object.assign(this.selection_data,l.selection_data):this.selection_data=l.selection_data,this}}],[{key:"coord",value:function(l){return{x:l.x,y:l.y,z:l.z,key:s.coordKey(l)}}},{key:"coordKey",value:function(l){return l.x+"/"+l.y+"/"+l.z}},{key:"key",value:function(l,h,g){if(!(l.y<0||l.y>=1<<l.z||l.z<0))return[h.name,g,l.x,l.y,l.z].join("/")}},{key:"normalizedKey",value:function(l,h,g){return s.key(s.normalizedCoordinate(l,h,g),h,g)}},{key:"normalizedCoordinate",value:function(l,h){return h.zoom_bias&&(l=s.coordinateAtZoom(l,Math.max(0,l.z-h.zoom_bias))),s.coordinateWithMaxZoom(l,h.max_zoom)}},{key:"coordinateAtZoom",value:function(l,h){var g,_=l.x,A=l.y,j=l.z;return j!==h&&(g=Math.pow(2,j-h),_=Math.floor(_/g),A=Math.floor(A/g),j=h),s.coord({x:_,y:A,z:j})}},{key:"coordinateWithMaxZoom",value:function(l,h){var g=l.x,_=l.y,A=l.z;return void 0!==h&&h<A?s.coordinateAtZoom({x:g,y:_,z:A},h):s.coord({x:g,y:_,z:A})}},{key:"childrenForCoordinate",value:function(l){var h=l.x,g=l.y,_=l.z,A=l.key;return s.coord_children[A]||(_++,s.coord_children[A]=[s.coord({x:h*=2,y:g*=2,z:_}),s.coord({x:h+1,y:g,z:_}),s.coord({x:h,y:g+1,z:_}),s.coord({x:h+1,y:g+1,z:_})]),s.coord_children[A]}},{key:"isDescendant",value:function(l,h){if(h.z>l.z){var g=s.coordinateAtZoom(h,l.z);return l.x===g.x&&l.y===g.y}return!1}},{key:"cancel",value:function(l){l&&(l.canceled=!0,l.source_data&&l.source_data.request_id&&(G0.cancelRequest(l.source_data.request_id),l.source_data.request_id=null),s.abortBuild(l))}},{key:"buildGeometry",value:function(l,h){var g=h.scene_id,_=h.layers,A=h.styles,j=h.global,$=h.sources,_t=h.meshVariantMaxLife,Ye=l.source_data;for(var _i in zx.startTile(l.id,{apply_repeat_groups:!0}),_){var _s=_[_i];if(_s&&_s.config_data){if(_s.config_data.source===l.source)for(var Ja=s._getDataForSource(Ye,_s.config_data,_i),_l=0;_l<Ja.length;_l++){var lc=Ja[_l],_p=lc.geom;if(_p)for(var ka=0;ka<_p.features.length;ka++){var ty=_p.features[ka];if(null!=ty.geometry){var ny=by.getFeatureParseContext(ty,l,j,$);ny.winding=l.default_winding,ny.source=l.source,ny.layer=lc.layer;var ry=_s.buildDrawGroups(ny,!0);if(ry)for(var ly in ry){var ey=ry[ly],hy=ey.style||ly,fy=A[hy];fy?null!=(ey=fy.preprocess(ey,l.source))&&!1!==ey.visible&&(ny.layers=ey.layers,fy.addFeature(ty,ey,ny)):$y("warn","Style '".concat(hy,"' not found, skipping layer '").concat(_i,"':"),ey,ty)}}}}}else $y("warn","Layer ".concat(_i," was defined without a geometry data source and will not be rendered."))}var _y=s._stylesForTile(l,A);s._sendStyleGroups(l,_y,{scene_id:g,meshVariantMaxLife:_t},function(Iy){return Iy.collision?"collision":"non-collision"})}},{key:"_stylesForTile",value:function(l,h){var g=[];for(var _ in h)h[_].hasDataForTile(l)&&g.push(h[_]);return g}},{key:"_sendStyleGroups",value:function(l,h,g,_){var A=g.scene_id,j=g.meshVariantMaxLife,$={};h.forEach(function(_t){var Ye=_(_t);$[Ye]=$[Ye]||[],$[Ye].push(_t)}),0<Object.keys($).length?function(){var _t={start:!0};for(var Ye in l.mesh_data={},$)!function(_i){Promise.all($[_i].map(function(Ja){return Ja.endData(l)})).then(function(){$y("trace","Finished style group '".concat(_i,"' for tile ").concat(l.key)),$[_i]=[],Object.keys($).every(function(Ja){return 0===$[Ja].length})&&(_t.done=!0),_0.postMessage("TileManager_".concat(A,".buildTileStylesCompleted"),_0.withTransferables({tile:s.slice(l,["mesh_data","selection_data"]),progress:_t})),_t.start=null,l.mesh_data={},l.selection_data={},_t.done&&zx.resetTile(l.id)},function(Ja){$y("error","Error for style group '".concat(_i,"' for tile ").concat(l.key),Ja)})}(Ye);W_.updateMeshVariantTypeCache(j)}():(_0.postMessage("TileManager_".concat(A,".buildTileStylesCompleted"),_0.withTransferables({tile:s.slice(l),progress:{start:!0,done:!0}})),zx.resetTile(l.id))}},{key:"_getDataForSource",value:function(l,h,g){var _=2<arguments.length&&void 0!==g?g:null,A=[];return null!=h&&null!=l&&null!=l.layers&&(!h.layer&&l.layers._default||"string"==typeof h.layer&&!l.layers[h.layer]&&new RegExp("^\\d+_"+h.layer+"$").test(_)&&l.layers._default?A.push({geom:l.layers._default}):!h.layer&&_?A.push({layer:_,geom:l.layers[_]}):"string"==typeof h.layer?A.push({layer:h.layer,geom:l.layers[h.layer]}):Array.isArray(h.layer)&&h.layer.forEach(function(j){l.layers[j]&&l.layers[j].features&&A.push({layer:j,geom:l.layers[j]})})),A}},{key:"abortBuild",value:function(l,h){if(w1.removeForTile(l.id),zx.abortTile(l.id),l.mesh_data)for(var g in l.mesh_data){var _=l.mesh_data[g].textures;_&&_.forEach(function(A){var j=ZE(h).textures[A];j&&($y("trace","releasing texture ".concat(A," for tile ").concat(l.key)),j.release())})}}},{key:"slice",value:function(l,h){var g=["id","key","loading","loaded","generation","error","debug"];Array.isArray(h)&&g.push.apply(g,A_(h));for(var _={},A=0;A<g.length;A++){var j=g[A];_[j]=l[j]}return _}}]),s}();n1.coord_children={};var XC,jS=function(){L_(l,T3);var s=B1(l);function l(h,g){var _;return D0(this,l),-1===(_=s.call(this,h,g)).rasters.indexOf(_.name)&&_.rasters.unshift(_.name),_.filtering=h.filtering,_.textures={},_}return T0(l,[{key:"load",value:function(h){h.source_data={},h.source_data.layers={},h.pad_scale=this.pad_scale,h.rasters=A_(this.rasters);var g=My.tile_scale;return h.source_data.layers={_default:{type:"FeatureCollection",features:[{geometry:{type:"Polygon",coordinates:[[[0,0],[g,0],[g,-g],[0,-g],[0,0]]]},properties:{}}]}},h.default_winding="CW",Promise.resolve(h)}},{key:"tileTexture",value:function(h){var g,_,A=h.coords.key;return this.textures[A]||(g=n1.coordinateWithMaxZoom(h.coords,this.max_zoom),_=this.formatUrl(this.url,{coords:g}),this.textures[A]={url:_,filtering:this.filtering,coords:g}),this.textures[A]}}]),l}();ax.register(jS,"Raster");var VS=XC={};function zS(s,l,h,g){for(var _,A=g,j=h-l>>1,$=h-l,_t=s[l],Ye=s[l+1],_i=s[h],_s=s[h+1],Ja=l+3;Ja<h;Ja+=3){var _l,lc=(_p=s[Ja],ka=s[Ja+1],fy=void 0,ey=void 0,hy=void 0,hy=(ly=_s)-(ny=Ye),0==(ey=(ry=_i)-(ty=_t))&&0===hy||(1<(fy=((_p-ty)*ey+(ka-ny)*hy)/(ey*ey+hy*hy))?(ty=ry,ny=ly):0<fy&&(ty+=ey*fy,ny+=hy*fy)),(ey=_p-ty)*ey+(hy=ka-ny)*hy);A<lc?(_=Ja,A=lc):lc!==A||(_l=Math.abs(Ja-j))<$&&(_=Ja,$=_l)}var _p,ka,ty,ny,ry,ly,fy,ey,hy;g<A&&(3<_-l&&zS(s,l,_,g),s[_+2]=A,3<h-_&&zS(s,_,h,g))}function JC(s,l,h,g){var _={id:void 0===s?null:s,type:l,geometry:h,tags:g,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(A){var j=A.geometry,$=A.type;if("Point"===$||"MultiPoint"===$||"LineString"===$)BS(A,j);else if("Polygon"===$||"MultiLineString"===$)for(var _t=0;_t<j.length;_t++)BS(A,j[_t]);else if("MultiPolygon"===$)for(_t=0;_t<j.length;_t++)for(var Ye=0;Ye<j[_t].length;Ye++)BS(A,j[_t][Ye])}(_),_}function BS(s,l){for(var h=0;h<l.length;h+=3)s.minX=Math.min(s.minX,l[h]),s.minY=Math.min(s.minY,l[h+1]),s.maxX=Math.max(s.maxX,l[h]),s.maxY=Math.max(s.maxY,l[h+1])}function vN(s,l){var h=[];if("FeatureCollection"===s.type)for(var g=0;g<s.features.length;g++)zA(h,s.features[g],l,g);else zA(h,"Feature"===s.type?s:{geometry:s},l);return h}function zA(s,l,h,g){if(l.geometry){var _=l.geometry.coordinates,A=l.geometry.type,j=Math.pow(h.tolerance/((1<<h.maxZoom)*h.extent),2),$=[],_t=l.id;if(h.promoteId?_t=l.properties[h.promoteId]:h.generateId&&(_t=g||0),"Point"===A)QC(_,$);else if("MultiPoint"===A)for(var Ye=0;Ye<_.length;Ye++)QC(_[Ye],$);else if("LineString"===A)FI(_,$,j,!1);else if("MultiLineString"===A){if(h.lineMetrics){for(Ye=0;Ye<_.length;Ye++)FI(_[Ye],$=[],j,!1),s.push(JC(_t,"LineString",$,l.properties));return}HS(_,$,j,!1)}else if("Polygon"===A)HS(_,$,j,!0);else{if("MultiPolygon"!==A){if("GeometryCollection"!==A)throw new Error("Input data is not a valid GeoJSON object.");for(Ye=0;Ye<l.geometry.geometries.length;Ye++)zA(s,{id:_t,geometry:l.geometry.geometries[Ye],properties:l.properties},h,g);return}for(Ye=0;Ye<_.length;Ye++){var _i=[];HS(_[Ye],_i,j,!0),$.push(_i)}}s.push(JC(_t,A,$,l.properties))}}function QC(s,l){l.push(jI(s[0])),l.push(BA(s[1])),l.push(0)}function FI(s,l,h,g){for(var _,A,j=0,$=0;$<s.length;$++){var _t=jI(s[$][0]),Ye=BA(s[$][1]);l.push(_t),l.push(Ye),l.push(0),0<$&&(j+=g?(_*Ye-_t*A)/2:Math.sqrt(Math.pow(_t-_,2)+Math.pow(Ye-A,2))),_=_t,A=Ye}var _i=l.length-3;l[2]=1,zS(l,0,_i,h),l[2+_i]=1,l.size=Math.abs(j),l.start=0,l.end=l.size}function HS(s,l,h,g){for(var _=0;_<s.length;_++){var A=[];FI(s[_],A,h,g),l.push(A)}}function jI(s){return s/360+.5}function BA(s){var l=Math.sin(s*Math.PI/180),h=.5-.25*Math.log((1+l)/(1-l))/Math.PI;return h<0?0:1<h?1:h}function RE(s,l,h,g,_,A,j,$){if(g/=l,(h/=l)<=A&&j<g)return s;if(j<h||g<=A)return null;for(var _t=[],Ye=0;Ye<s.length;Ye++){var _i=s[Ye],_s=_i.geometry,Ja=_i.type,_l=0===_?_i.minX:_i.minY,lc=0===_?_i.maxX:_i.maxY;if(h<=_l&&lc<g)_t.push(_i);else if(!(lc<h||g<=_l)){var _p=[];if("Point"===Ja||"MultiPoint"===Ja)!function(ny,ry,ly,ey,hy){for(var fy=0;fy<ny.length;fy+=3){var _y=ny[fy+hy];ly<=_y&&_y<=ey&&(ry.push(ny[fy]),ry.push(ny[fy+1]),ry.push(ny[fy+2]))}}(_s,_p,h,g,_);else if("LineString"===Ja)$w(_s,_p,h,g,_,!1,$.lineMetrics);else if("MultiLineString"===Ja)VI(_s,_p,h,g,_,!1);else if("Polygon"===Ja)VI(_s,_p,h,g,_,!0);else if("MultiPolygon"===Ja)for(var ka=0;ka<_s.length;ka++){var ty=[];VI(_s[ka],ty,h,g,_,!0),ty.length&&_p.push(ty)}if(_p.length){if($.lineMetrics&&"LineString"===Ja){for(ka=0;ka<_p.length;ka++)_t.push(JC(_i.id,Ja,_p[ka],_i.tags));continue}"LineString"!==Ja&&"MultiLineString"!==Ja||(1===_p.length?(Ja="LineString",_p=_p[0]):Ja="MultiLineString"),"Point"!==Ja&&"MultiPoint"!==Ja||(Ja=3===_p.length?"Point":"MultiPoint"),_t.push(JC(_i.id,Ja,_p,_i.tags))}}}return _t.length?_t:null}function $w(s,l,h,g,_,A,j){for(var $,_t,Ye=US(s),_i=0===_?vD:t2,_s=s.start,Ja=0;Ja<s.length-3;Ja+=3){var ry=s[Ja],ly=s[Ja+1],ey=s[Ja+2],_l=s[Ja+3],lc=s[Ja+4],_p=0===_?ry:ly,ka=0===_?_l:lc,ty=!1;j&&($=Math.sqrt(Math.pow(ry-_l,2)+Math.pow(ly-lc,2))),_p<h?h<ka&&(_t=_i(Ye,ry,ly,_l,lc,h),j&&(Ye.start=_s+$*_t)):g<_p?ka<g&&(_t=_i(Ye,ry,ly,_l,lc,g),j&&(Ye.start=_s+$*_t)):GS(Ye,ry,ly,ey),ka<h&&h<=_p&&(_t=_i(Ye,ry,ly,_l,lc,h),ty=!0),g<ka&&_p<=g&&(_t=_i(Ye,ry,ly,_l,lc,g),ty=!0),!A&&ty&&(j&&(Ye.end=_s+$*_t),l.push(Ye),Ye=US(s)),j&&(_s+=$)}var ny=s.length-3;ry=s[ny],ly=s[ny+1],ey=s[ny+2],h<=(_p=0===_?ry:ly)&&_p<=g&&GS(Ye,ry,ly,ey),ny=Ye.length-3,A&&3<=ny&&(Ye[ny]!==Ye[0]||Ye[ny+1]!==Ye[1])&&GS(Ye,Ye[0],Ye[1],Ye[2]),Ye.length&&l.push(Ye)}function US(s){var l=[];return l.size=s.size,l.start=s.start,l.end=s.end,l}function VI(s,l,h,g,_,A){for(var j=0;j<s.length;j++)$w(s[j],l,h,g,_,A,!1)}function GS(s,l,h,g){s.push(l),s.push(h),s.push(g)}function vD(s,l,h,g,_,A){var j=(A-l)/(g-l);return s.push(A),s.push(h+(_-h)*j),s.push(1),j}function t2(s,l,h,g,_,A){var j=(A-h)/(_-h);return s.push(l+(g-l)*j),s.push(A),s.push(1),j}function HA(s,l){var h=l.buffer/l.extent,g=s,_=RE(s,1,-1-h,h,0,-1,2,l),A=RE(s,1,1-h,2+h,0,-1,2,l);return(_||A)&&(g=RE(s,1,-h,1+h,0,-1,2,l)||[],_&&(g=UA(_,1).concat(g)),A&&(g=g.concat(UA(A,-1)))),g}function UA(s,l){for(var h=[],g=0;g<s.length;g++){var _,A=s[g],j=A.type;if("Point"===j||"MultiPoint"===j||"LineString"===j)_=qS(A.geometry,l);else if("MultiLineString"===j||"Polygon"===j){_=[];for(var $=0;$<A.geometry.length;$++)_.push(qS(A.geometry[$],l))}else if("MultiPolygon"===j)for(_=[],$=0;$<A.geometry.length;$++){for(var _t=[],Ye=0;Ye<A.geometry[$].length;Ye++)_t.push(qS(A.geometry[$][Ye],l));_.push(_t)}h.push(JC(A.id,j,_,A.tags))}return h}function qS(s,l){var h=[];h.size=s.size,void 0!==s.start&&(h.start=s.start,h.end=s.end);for(var g=0;g<s.length;g+=3)h.push(s[g]+l,s[g+1],s[g+2]);return h}function _D(s,l){if(s.transformed)return s;for(var h,g=1<<s.z,_=s.x,A=s.y,j=0;j<s.features.length;j++){var $=s.features[j],_t=$.geometry,Ye=$.type;if($.geometry=[],1===Ye)for(h=0;h<_t.length;h+=2)$.geometry.push(GA(_t[h],_t[h+1],l,g,_,A));else for(h=0;h<_t.length;h++){for(var _i=[],_s=0;_s<_t[h].length;_s+=2)_i.push(GA(_t[h][_s],_t[h][_s+1],l,g,_,A));$.geometry.push(_i)}}return s.transformed=!0,s}function GA(s,l,h,g,_,A){return[Math.round(h*(s*g-_)),Math.round(h*(l*g-A))]}function k3(s,l,h,g,_){for(var A=l===_.maxZoom?0:_.tolerance/((1<<l)*_.extent),j={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:h,y:g,z:l,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},$=0;$<s.length;$++){j.numFeatures++,function(Ja,_l,lc,_p){var ka=_l.geometry,ty=_l.type,ny=[];if("Point"===ty||"MultiPoint"===ty)for(var ry=0;ry<ka.length;ry+=3)ny.push(ka[ry]),ny.push(ka[ry+1]),Ja.numPoints++,Ja.numSimplified++;else if("LineString"===ty)zI(ny,ka,Ja,lc,!1,!1);else if("MultiLineString"===ty||"Polygon"===ty)for(ry=0;ry<ka.length;ry++)zI(ny,ka[ry],Ja,lc,"Polygon"===ty,0===ry);else if("MultiPolygon"===ty)for(var ly=0;ly<ka.length;ly++){var ey=ka[ly];for(ry=0;ry<ey.length;ry++)zI(ny,ey[ry],Ja,lc,!0,0===ry)}if(ny.length){var hy=_l.tags||null;if("LineString"===ty&&_p.lineMetrics){for(var fy in hy={},_l.tags)hy[fy]=_l.tags[fy];hy.mapbox_clip_start=ka.start/ka.size,hy.mapbox_clip_end=ka.end/ka.size}var _y={geometry:ny,type:"Polygon"===ty||"MultiPolygon"===ty?3:"LineString"===ty||"MultiLineString"===ty?2:1,tags:hy};null!==_l.id&&(_y.id=_l.id),Ja.features.push(_y)}}(j,s[$],A,_);var _t=s[$].minX,Ye=s[$].minY,_i=s[$].maxX,_s=s[$].maxY;_t<j.minX&&(j.minX=_t),Ye<j.minY&&(j.minY=Ye),_i>j.maxX&&(j.maxX=_i),_s>j.maxY&&(j.maxY=_s)}return j}function zI(s,l,h,g,_,A){var j=g*g;if(0<g&&l.size<(_?j:g))h.numPoints+=l.length/3;else{for(var $=[],_t=0;_t<l.length;_t+=3)(0===g||l[_t+2]>j)&&(h.numSimplified++,$.push(l[_t]),$.push(l[_t+1])),h.numPoints++;_&&function(Ye,_i){for(var _s=0,Ja=0,_l=Ye.length,lc=_l-2;Ja<_l;lc=Ja,Ja+=2)_s+=(Ye[Ja]-Ye[lc])*(Ye[Ja+1]+Ye[lc+1]);if(0<_s===_i)for(Ja=0,_l=Ye.length;Ja<_l/2;Ja+=2){var _p=Ye[Ja],ka=Ye[Ja+1];Ye[Ja]=Ye[_l-2-Ja],Ye[Ja+1]=Ye[_l-1-Ja],Ye[_l-2-Ja]=_p,Ye[_l-1-Ja]=ka}}($,A),s.push($)}}var z0={maxZoom:14,tolerance:3,extent:4096,buffer:64,lineMetrics:!(XC.deepClone=function(s){return Array.isArray(s)?s.map(XC.deepClone):s}),promoteId:null,generateId:!1};function EV(s,l,h,g,_){var A=Object.assign({},z0,_),j=vN(s,A),$=function(_p){var ka,ty=2,ny=-1,ry=1,ly=0,ey=ES(_p);try{for(ey.s();!(ka=ey.n()).done;){var hy=ka.value;hy.minX<ty&&(ty=hy.minX),hy.maxX>ny&&(ny=hy.maxX),hy.minY<ry&&(ry=hy.minY),hy.maxY>ly&&(ly=hy.maxY)}}catch(fy){ey.e(fy)}finally{ey.f()}return{minX:ty,maxX:ny,minY:ry,maxY:ly}}(j=HA(j,A)),Ye=$.minY,_s=$.maxY,Ja=1<<l,_l=A.buffer/A.extent,lc=1+_l;return j=RE(j,Ja,h-_l,h+lc,0,$.minX,$.maxX,A)||[],_D(k3(j=RE(j,Ja,g-_l,g+lc,1,Ye,_s,A)||[],l,h,g,A),A.extent)}function O3(s,l){this.items=[],this.algorithm=s;var h=void 0===(l=l||{}).sort||l.sort;this.sort=h}O3.prototype={addItem:function(s){this.items.push(s)},normalizeCoordinates:function(){var s=this.items,l=1/0,h=1/0;s.forEach(function(g){var _=g;l=Math.min(l,_.x),h=Math.min(h,_.y)}),s.forEach(function(g){var _=g;_.x-=l,_.y-=h})},getStats:function(){var s=this.items.map(function(A){return A}),l=s.map(function(A){return A.x}),h=s.map(function(A){return A.y}),g=s.map(function(A){return A.x+A.width}),_=s.map(function(A){return A.y+A.height});return{minX:Math.max.apply(Math,l),minY:Math.max.apply(Math,h),maxX:Math.max.apply(Math,g),maxY:Math.max.apply(Math,_)}},getItems:function(){return this.items},processItems:function(){var s=this.items;return this.sort&&(s=this.algorithm.sort(s)),s=this.algorithm.placeItems(s),this.items=s},exportItems:function(){return this.processItems(),this.normalizeCoordinates(),this.items},export:function(){var s=this.exportItems(),l=this.getStats();return{height:l.maxY,width:l.maxX,items:s}}};var R3=O3,dT=[],NE=[],TV=typeof Uint8Array<"u"?Uint8Array:Array,_N=!1;function e2(){_N=!0;for(var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,h=s.length;l<h;++l)dT[l]=s[l],NE[s.charCodeAt(l)]=l;NE["-".charCodeAt(0)]=62,NE["_".charCodeAt(0)]=63}function CV(s,l,h){for(var _,A=[],j=l;j<h;j+=3)A.push(dT[(_=(s[j]<<16)+(s[j+1]<<8)+s[j+2])>>18&63]+dT[_>>12&63]+dT[_>>6&63]+dT[63&_]);return A.join("")}function N1(s){var l;_N||e2();for(var h=s.length,g=h%3,_="",A=[],j=0,$=h-g;j<$;j+=16383)A.push(CV(s,j,$<j+16383?$:j+16383));return 1==g?(_+=dT[(l=s[h-1])>>2],_+=dT[l<<4&63],_+="=="):2==g&&(_+=dT[(l=(s[h-2]<<8)+s[h-1])>>10],_+=dT[l>>4&63],_+=dT[l<<2&63],_+="="),A.push(_),A.join("")}function n2(s,l,h,g,_){var A,j,$=8*_-g-1,_t=(1<<$)-1,Ye=_t>>1,_i=-7,_s=h?_-1:0,Ja=h?-1:1,_l=s[l+_s];for(_s+=Ja,A=_l&(1<<-_i)-1,_l>>=-_i,_i+=$;0<_i;A=256*A+s[l+_s],_s+=Ja,_i-=8);for(j=A&(1<<-_i)-1,A>>=-_i,_i+=g;0<_i;j=256*j+s[l+_s],_s+=Ja,_i-=8);if(0===A)A=1-Ye;else{if(A===_t)return j?NaN:1/0*(_l?-1:1);j+=Math.pow(2,g),A-=Ye}return(_l?-1:1)*j*Math.pow(2,A-g)}function r2(s,l,h,g,_,A){var j,$,_t,Ye=8*A-_-1,_i=(1<<Ye)-1,_s=_i>>1,Ja=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,_l=g?0:A-1,lc=g?1:-1,_p=l<0||0===l&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?($=isNaN(l)?1:0,j=_i):(j=Math.floor(Math.log(l)/Math.LN2),l*(_t=Math.pow(2,-j))<1&&(j--,_t*=2),2<=(l+=1<=j+_s?Ja/_t:Ja*Math.pow(2,1-_s))*_t&&(j++,_t/=2),_i<=j+_s?($=0,j=_i):1<=j+_s?($=(l*_t-1)*Math.pow(2,_),j+=_s):($=l*Math.pow(2,_s-1)*Math.pow(2,_),j=0));8<=_;s[h+_l]=255&$,_l+=lc,$/=256,_-=8);for(j=j<<_|$,Ye+=_;0<Ye;s[h+_l]=255&j,_l+=lc,j/=256,Ye-=8);s[h+_l-lc]|=128*_p}var DV={}.toString,bN=Array.isArray||function(s){return"[object Array]"==DV.call(s)};Zy.TYPED_ARRAY_SUPPORT=void 0===tA.TYPED_ARRAY_SUPPORT||tA.TYPED_ARRAY_SUPPORT;var Kx=mE();function mE(){return Zy.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function gT(s,l){if(mE()<l)throw new RangeError("Invalid typed array length");return Zy.TYPED_ARRAY_SUPPORT?(s=new Uint8Array(l)).__proto__=Zy.prototype:(null===s&&(s=new Zy(l)),s.length=l),s}function Zy(s,l,h){if(!(Zy.TYPED_ARRAY_SUPPORT||this instanceof Zy))return new Zy(s,l,h);if("number"!=typeof s)return i2(this,s,l,h);if("string"==typeof l)throw new Error("If encoding is specified then the first argument must be a string");return HI(this,s)}function i2(s,l,h,g){if("number"==typeof l)throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&l instanceof ArrayBuffer?function(_,A,j,$){if(j<0||A.byteLength<j)throw new RangeError("'offset' is out of bounds");if(A.byteLength<j+($||0))throw new RangeError("'length' is out of bounds");return A=void 0===j&&void 0===$?new Uint8Array(A):void 0===$?new Uint8Array(A,j):new Uint8Array(A,j,$),Zy.TYPED_ARRAY_SUPPORT?(_=A).__proto__=Zy.prototype:_=UI(_,A),_}(s,l,h,g):"string"==typeof l?function(_,A,j){if("string"==typeof j&&""!==j||(j="utf8"),!Zy.isEncoding(j))throw new TypeError('"encoding" must be a valid string encoding');var $=0|GI(A,j),_t=(_=gT(_,$)).write(A,j);return _t!==$&&(_=_.slice(0,_t)),_}(s,l,h):function(_,A){if(yT(A)){var j=0|wN(A.length);return 0===(_=gT(_,j)).length||A.copy(_,0,0,j),_}if(A){if(typeof ArrayBuffer<"u"&&A.buffer instanceof ArrayBuffer||"length"in A)return"number"!=typeof A.length||($=A.length)!=$?gT(_,0):UI(_,A);if("Buffer"===A.type&&bN(A.data))return UI(_,A.data)}var $;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(s,l)}function BI(s){if("number"!=typeof s)throw new TypeError('"size" argument must be a number');if(s<0)throw new RangeError('"size" argument must not be negative')}function HI(s,l){if(BI(l),s=gT(s,l<0?0:0|wN(l)),!Zy.TYPED_ARRAY_SUPPORT)for(var h=0;h<l;++h)s[h]=0;return s}function UI(s,l){var h=l.length<0?0:0|wN(l.length);s=gT(s,h);for(var g=0;g<h;g+=1)s[g]=255&l[g];return s}function wN(s){if(s>=mE())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+mE().toString(16)+" bytes");return 0|s}function yT(s){return null!=s&&s._isBuffer}function GI(s,l){if(yT(s))return s.length;if(typeof ArrayBuffer<"u"&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(s)||s instanceof ArrayBuffer))return s.byteLength;"string"!=typeof s&&(s=""+s);var h=s.length;if(0===h)return 0;for(var g=!1;;)switch(l){case"ascii":case"latin1":case"binary":return h;case"utf8":case"utf-8":case void 0:return WA(s).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*h;case"hex":return h>>>1;case"base64":return TN(s).length;default:if(g)return WA(s).length;l=(""+l).toLowerCase(),g=!0}}function Zx(s,l,h){var g,_,A,j=!1;if((void 0===l||l<0)&&(l=0),l>this.length||((void 0===h||h>this.length)&&(h=this.length),h<=0)||(h>>>=0)<=(l>>>=0))return"";for(s=s||"utf8";;)switch(s){case"hex":return function($,_t,Ye){var _l,_i=$.length;(!_t||_t<0)&&(_t=0),(!Ye||Ye<0||_i<Ye)&&(Ye=_i);for(var _s="",Ja=_t;Ja<Ye;++Ja)_s+=(_l=$[Ja])<16?"0"+_l.toString(16):_l.toString(16);return _s}(this,l,h);case"utf8":case"utf-8":return xN(this,l,h);case"ascii":return function($,_t,Ye){var _i="";Ye=Math.min($.length,Ye);for(var _s=_t;_s<Ye;++_s)_i+=String.fromCharCode(127&$[_s]);return _i}(this,l,h);case"latin1":case"binary":return function($,_t,Ye){var _i="";Ye=Math.min($.length,Ye);for(var _s=_t;_s<Ye;++_s)_i+=String.fromCharCode($[_s]);return _i}(this,l,h);case"base64":return g=this,A=h,0===(_=l)&&A===g.length?N1(g):N1(g.slice(_,A));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function($,_t,Ye){for(var _i=$.slice(_t,Ye),_s="",Ja=0;Ja<_i.length;Ja+=2)_s+=String.fromCharCode(_i[Ja]+256*_i[Ja+1]);return _s}(this,l,h);default:if(j)throw new TypeError("Unknown encoding: "+s);s=(s+"").toLowerCase(),j=!0}}function mT(s,l,h){var g=s[l];s[l]=s[h],s[h]=g}function qA(s,l,h,g,_){if(0===s.length)return-1;if("string"==typeof h?(g=h,h=0):2147483647<h?h=2147483647:h<-2147483648&&(h=-2147483648),h=+h,isNaN(h)&&(h=_?0:s.length-1),h<0&&(h=s.length+h),h>=s.length){if(_)return-1;h=s.length-1}else if(h<0){if(!_)return-1;h=0}if("string"==typeof l&&(l=Zy.from(l,g)),yT(l))return 0===l.length?-1:N3(s,l,h,g,_);if("number"==typeof l)return l&=255,Zy.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?_?Uint8Array.prototype.indexOf.call(s,l,h):Uint8Array.prototype.lastIndexOf.call(s,l,h):N3(s,[l],h,g,_);throw new TypeError("val must be string, number or Buffer")}function N3(s,l,h,g,_){var A=1,j=s.length,$=l.length;if(void 0!==g&&("ucs2"===(g=String(g).toLowerCase())||"ucs-2"===g||"utf16le"===g||"utf-16le"===g)){if(s.length<2||l.length<2)return-1;j/=A=2,$/=2,h/=2}function _t(_l,lc){return 1===A?_l[lc]:_l.readUInt16BE(lc*A)}if(_)for(var Ye=-1,_i=h;_i<j;_i++)if(_t(s,_i)===_t(l,-1===Ye?0:_i-Ye)){if(-1===Ye&&(Ye=_i),_i-Ye+1===$)return Ye*A}else-1!==Ye&&(_i-=_i-Ye),Ye=-1;else for(j<h+$&&(h=j-$),_i=h;0<=_i;_i--){for(var _s=!0,Ja=0;Ja<$;Ja++)if(_t(s,_i+Ja)!==_t(l,Ja)){_s=!1;break}if(_s)return _i}return-1}function qI(s,l,h,g){return $S(function(_){for(var A=[],j=0;j<_.length;++j)A.push(255&_.charCodeAt(j));return A}(l),s,h,g)}function P3(s,l,h,g){return $S(function(_,A){for(var j,$,Ye=[],_i=0;_i<_.length&&!((A-=2)<0);++_i)$=(j=_.charCodeAt(_i))>>8,Ye.push(j%256),Ye.push($);return Ye}(l,s.length-h),s,h,g)}function xN(s,l,h){h=Math.min(s.length,h);for(var g=[],_=l;_<h;){var A,j,$,_t,Ye=s[_],_i=null,_s=239<Ye?4:223<Ye?3:191<Ye?2:1;if(_+_s<=h)switch(_s){case 1:Ye<128&&(_i=Ye);break;case 2:128==(192&(A=s[_+1]))&&127<(_t=(31&Ye)<<6|63&A)&&(_i=_t);break;case 3:j=s[_+2],128==(192&(A=s[_+1]))&&128==(192&j)&&2047<(_t=(15&Ye)<<12|(63&A)<<6|63&j)&&(_t<55296||57343<_t)&&(_i=_t);break;case 4:j=s[_+2],$=s[_+3],128==(192&(A=s[_+1]))&&128==(192&j)&&128==(192&$)&&65535<(_t=(15&Ye)<<18|(63&A)<<12|(63&j)<<6|63&$)&&_t<1114112&&(_i=_t)}null===_i?(_i=65533,_s=1):65535<_i&&(g.push((_i-=65536)>>>10&1023|55296),_i=56320|1023&_i),g.push(_i),_+=_s}return function(Ja){var _l=Ja.length;if(_l<=EN)return String.fromCharCode.apply(String,Ja);for(var lc="",_p=0;_p<_l;)lc+=String.fromCharCode.apply(String,Ja.slice(_p,_p+=EN));return lc}(g)}Zy.poolSize=8192,Zy._augment=function(s){return s.__proto__=Zy.prototype,s},Zy.from=function(s,l,h){return i2(null,s,l,h)},Zy.TYPED_ARRAY_SUPPORT&&(Zy.prototype.__proto__=Uint8Array.prototype,Zy.__proto__=Uint8Array),Zy.alloc=function(s,l,h){return g=null,A=l,j=h,BI(_=s),_<=0||void 0===A?gT(g,_):"string"==typeof j?gT(g,_).fill(A,j):gT(g,_).fill(A);var g,_,A,j},Zy.allocUnsafe=function(s){return HI(null,s)},Zy.allocUnsafeSlow=function(s){return HI(null,s)},Zy.isBuffer=$A,Zy.compare=function(s,l){if(!yT(s)||!yT(l))throw new TypeError("Arguments must be Buffers");if(s===l)return 0;for(var h=s.length,g=l.length,_=0,A=Math.min(h,g);_<A;++_)if(s[_]!==l[_]){h=s[_],g=l[_];break}return h<g?-1:g<h?1:0},Zy.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Zy.concat=function(s,l){if(!bN(s))throw new TypeError('"list" argument must be an Array of Buffers');if(0===s.length)return Zy.alloc(0);if(void 0===l)for(_=l=0;_<s.length;++_)l+=s[_].length;for(var h=Zy.allocUnsafe(l),g=0,_=0;_<s.length;++_){var A=s[_];if(!yT(A))throw new TypeError('"list" argument must be an Array of Buffers');A.copy(h,g),g+=A.length}return h},Zy.byteLength=GI,Zy.prototype._isBuffer=!0,Zy.prototype.swap16=function(){var s=this.length;if(s%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var l=0;l<s;l+=2)mT(this,l,l+1);return this},Zy.prototype.swap32=function(){var s=this.length;if(s%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var l=0;l<s;l+=4)mT(this,l,l+3),mT(this,l+1,l+2);return this},Zy.prototype.swap64=function(){var s=this.length;if(s%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var l=0;l<s;l+=8)mT(this,l,l+7),mT(this,l+1,l+6),mT(this,l+2,l+5),mT(this,l+3,l+4);return this},Zy.prototype.toString=function(){var s=0|this.length;return 0==s?"":0===arguments.length?xN(this,0,s):Zx.apply(this,arguments)},Zy.prototype.equals=function(s){if(!yT(s))throw new TypeError("Argument must be a Buffer");return this===s||0===Zy.compare(this,s)},Zy.prototype.inspect=function(){var s="";return 0<this.length&&(s=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(s+=" ... ")),"<Buffer "+s+">"},Zy.prototype.compare=function(s,l,h,g,_){if(!yT(s))throw new TypeError("Argument must be a Buffer");if(void 0===l&&(l=0),void 0===h&&(h=s?s.length:0),void 0===g&&(g=0),void 0===_&&(_=this.length),l<0||h>s.length||g<0||_>this.length)throw new RangeError("out of range index");if(_<=g&&h<=l)return 0;if(_<=g)return-1;if(h<=l)return 1;if(this===s)return 0;for(var A=(_>>>=0)-(g>>>=0),j=(h>>>=0)-(l>>>=0),$=Math.min(A,j),_t=this.slice(g,_),Ye=s.slice(l,h),_i=0;_i<$;++_i)if(_t[_i]!==Ye[_i]){A=_t[_i],j=Ye[_i];break}return A<j?-1:j<A?1:0},Zy.prototype.includes=function(s,l,h){return-1!==this.indexOf(s,l,h)},Zy.prototype.indexOf=function(s,l,h){return qA(this,s,l,h,!0)},Zy.prototype.lastIndexOf=function(s,l,h){return qA(this,s,l,h,!1)},Zy.prototype.write=function(s,l,h,g){if(void 0===l)g="utf8",h=this.length,l=0;else if(void 0===h&&"string"==typeof l)g=l,h=this.length,l=0;else{if(!isFinite(l))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");l|=0,isFinite(h)?(h|=0,void 0===g&&(g="utf8")):(g=h,h=void 0)}var _=this.length-l;if((void 0===h||_<h)&&(h=_),0<s.length&&(h<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");g=g||"utf8";for(var j,$,Ye,_i,_s=!1;;)switch(g){case"hex":return function(Ja,_l,lc,_p){lc=Number(lc)||0;var ka=Ja.length-lc;(!_p||ka<(_p=Number(_p)))&&(_p=ka);var ty=_l.length;if(ty%2!=0)throw new TypeError("Invalid hex string");ty/2<_p&&(_p=ty/2);for(var ny=0;ny<_p;++ny){var ry=parseInt(_l.substr(2*ny,2),16);if(isNaN(ry))return ny;Ja[lc+ny]=ry}return ny}(this,s,l,h);case"utf8":case"utf-8":return _i=h,$S(WA(s,this.length-(Ye=l)),this,Ye,_i);case"ascii":case"latin1":case"binary":return qI(this,s,l,h);case"base64":return j=l,$=h,$S(TN(s),this,j,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P3(this,s,l,h);default:if(_s)throw new TypeError("Unknown encoding: "+g);g=(""+g).toLowerCase(),_s=!0}},Zy.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var EN=4096;function _b(s,l,h){if(s%1!=0||s<0)throw new RangeError("offset is not uint");if(h<s+l)throw new RangeError("Trying to access beyond buffer length")}function Bx(s,l,h,g,_,A){if(!yT(s))throw new TypeError('"buffer" argument must be a Buffer instance');if(_<l||l<A)throw new RangeError('"value" argument is out of bounds');if(h+g>s.length)throw new RangeError("Index out of range")}function WS(s,l,h,g){l<0&&(l=65535+l+1);for(var _=0,A=Math.min(s.length-h,2);_<A;++_)s[h+_]=(l&255<<8*(g?_:1-_))>>>8*(g?_:1-_)}function o2(s,l,h,g){l<0&&(l=4294967295+l+1);for(var _=0,A=Math.min(s.length-h,4);_<A;++_)s[h+_]=l>>>8*(g?_:3-_)&255}function bD(s,l,h,g){if(h+g>s.length)throw new RangeError("Index out of range");if(h<0)throw new RangeError("Index out of range")}function L3(s,l,h,g,_){return _||bD(s,0,h,4),r2(s,l,h,g,23,4),h+4}function s2(s,l,h,g,_){return _||bD(s,0,h,8),r2(s,l,h,g,52,8),h+8}Zy.prototype.slice=function(s,l){var h=this.length;if((s=~~s)<0?(s+=h)<0&&(s=0):h<s&&(s=h),(l=void 0===l?h:~~l)<0?(l+=h)<0&&(l=0):h<l&&(l=h),l<s&&(l=s),Zy.TYPED_ARRAY_SUPPORT)(_=this.subarray(s,l)).__proto__=Zy.prototype;else for(var g=l-s,_=new Zy(g,void 0),A=0;A<g;++A)_[A]=this[A+s];return _},Zy.prototype.readUIntLE=function(s,l,h){s|=0,l|=0,h||_b(s,l,this.length);for(var g=this[s],_=1,A=0;++A<l&&(_*=256);)g+=this[s+A]*_;return g},Zy.prototype.readUIntBE=function(s,l,h){s|=0,l|=0,h||_b(s,l,this.length);for(var g=this[s+--l],_=1;0<l&&(_*=256);)g+=this[s+--l]*_;return g},Zy.prototype.readUInt8=function(s,l){return l||_b(s,1,this.length),this[s]},Zy.prototype.readUInt16LE=function(s,l){return l||_b(s,2,this.length),this[s]|this[s+1]<<8},Zy.prototype.readUInt16BE=function(s,l){return l||_b(s,2,this.length),this[s]<<8|this[s+1]},Zy.prototype.readUInt32LE=function(s,l){return l||_b(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+16777216*this[s+3]},Zy.prototype.readUInt32BE=function(s,l){return l||_b(s,4,this.length),16777216*this[s]+(this[s+1]<<16|this[s+2]<<8|this[s+3])},Zy.prototype.readIntLE=function(s,l,h){s|=0,l|=0,h||_b(s,l,this.length);for(var g=this[s],_=1,A=0;++A<l&&(_*=256);)g+=this[s+A]*_;return(_*=128)<=g&&(g-=Math.pow(2,8*l)),g},Zy.prototype.readIntBE=function(s,l,h){s|=0,l|=0,h||_b(s,l,this.length);for(var g=l,_=1,A=this[s+--g];0<g&&(_*=256);)A+=this[s+--g]*_;return(_*=128)<=A&&(A-=Math.pow(2,8*l)),A},Zy.prototype.readInt8=function(s,l){return l||_b(s,1,this.length),128&this[s]?-1*(255-this[s]+1):this[s]},Zy.prototype.readInt16LE=function(s,l){l||_b(s,2,this.length);var h=this[s]|this[s+1]<<8;return 32768&h?4294901760|h:h},Zy.prototype.readInt16BE=function(s,l){l||_b(s,2,this.length);var h=this[s+1]|this[s]<<8;return 32768&h?4294901760|h:h},Zy.prototype.readInt32LE=function(s,l){return l||_b(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},Zy.prototype.readInt32BE=function(s,l){return l||_b(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},Zy.prototype.readFloatLE=function(s,l){return l||_b(s,4,this.length),n2(this,s,!0,23,4)},Zy.prototype.readFloatBE=function(s,l){return l||_b(s,4,this.length),n2(this,s,!1,23,4)},Zy.prototype.readDoubleLE=function(s,l){return l||_b(s,8,this.length),n2(this,s,!0,52,8)},Zy.prototype.readDoubleBE=function(s,l){return l||_b(s,8,this.length),n2(this,s,!1,52,8)},Zy.prototype.writeUIntLE=function(s,l,h,g){s=+s,l|=0,h|=0,g||Bx(this,s,l,h,Math.pow(2,8*h)-1,0);var _=1,A=0;for(this[l]=255&s;++A<h&&(_*=256);)this[l+A]=s/_&255;return l+h},Zy.prototype.writeUIntBE=function(s,l,h,g){s=+s,l|=0,h|=0,g||Bx(this,s,l,h,Math.pow(2,8*h)-1,0);var _=h-1,A=1;for(this[l+_]=255&s;0<=--_&&(A*=256);)this[l+_]=s/A&255;return l+h},Zy.prototype.writeUInt8=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,1,255,0),Zy.TYPED_ARRAY_SUPPORT||(s=Math.floor(s)),this[l]=255&s,l+1},Zy.prototype.writeUInt16LE=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,2,65535,0),Zy.TYPED_ARRAY_SUPPORT?(this[l]=255&s,this[l+1]=s>>>8):WS(this,s,l,!0),l+2},Zy.prototype.writeUInt16BE=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,2,65535,0),Zy.TYPED_ARRAY_SUPPORT?(this[l]=s>>>8,this[l+1]=255&s):WS(this,s,l,!1),l+2},Zy.prototype.writeUInt32LE=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,4,4294967295,0),Zy.TYPED_ARRAY_SUPPORT?(this[l+3]=s>>>24,this[l+2]=s>>>16,this[l+1]=s>>>8,this[l]=255&s):o2(this,s,l,!0),l+4},Zy.prototype.writeUInt32BE=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,4,4294967295,0),Zy.TYPED_ARRAY_SUPPORT?(this[l]=s>>>24,this[l+1]=s>>>16,this[l+2]=s>>>8,this[l+3]=255&s):o2(this,s,l,!1),l+4},Zy.prototype.writeIntLE=function(s,l,h,g){var _;s=+s,l|=0,g||Bx(this,s,l,h,(_=Math.pow(2,8*h-1))-1,-_);var A=0,j=1,$=0;for(this[l]=255&s;++A<h&&(j*=256);)s<0&&0===$&&0!==this[l+A-1]&&($=1),this[l+A]=(s/j>>0)-$&255;return l+h},Zy.prototype.writeIntBE=function(s,l,h,g){var _;s=+s,l|=0,g||Bx(this,s,l,h,(_=Math.pow(2,8*h-1))-1,-_);var A=h-1,j=1,$=0;for(this[l+A]=255&s;0<=--A&&(j*=256);)s<0&&0===$&&0!==this[l+A+1]&&($=1),this[l+A]=(s/j>>0)-$&255;return l+h},Zy.prototype.writeInt8=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,1,127,-128),Zy.TYPED_ARRAY_SUPPORT||(s=Math.floor(s)),s<0&&(s=255+s+1),this[l]=255&s,l+1},Zy.prototype.writeInt16LE=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,2,32767,-32768),Zy.TYPED_ARRAY_SUPPORT?(this[l]=255&s,this[l+1]=s>>>8):WS(this,s,l,!0),l+2},Zy.prototype.writeInt16BE=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,2,32767,-32768),Zy.TYPED_ARRAY_SUPPORT?(this[l]=s>>>8,this[l+1]=255&s):WS(this,s,l,!1),l+2},Zy.prototype.writeInt32LE=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,4,2147483647,-2147483648),Zy.TYPED_ARRAY_SUPPORT?(this[l]=255&s,this[l+1]=s>>>8,this[l+2]=s>>>16,this[l+3]=s>>>24):o2(this,s,l,!0),l+4},Zy.prototype.writeInt32BE=function(s,l,h){return s=+s,l|=0,h||Bx(this,s,l,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),Zy.TYPED_ARRAY_SUPPORT?(this[l]=s>>>24,this[l+1]=s>>>16,this[l+2]=s>>>8,this[l+3]=255&s):o2(this,s,l,!1),l+4},Zy.prototype.writeFloatLE=function(s,l,h){return L3(this,s,l,!0,h)},Zy.prototype.writeFloatBE=function(s,l,h){return L3(this,s,l,!1,h)},Zy.prototype.writeDoubleLE=function(s,l,h){return s2(this,s,l,!0,h)},Zy.prototype.writeDoubleBE=function(s,l,h){return s2(this,s,l,!1,h)},Zy.prototype.copy=function(s,l,h,g){if(h=h||0,g||0===g||(g=this.length),l>=s.length&&(l=s.length),0<g&&g<h&&(g=h),g===h||0===s.length||0===this.length)return 0;if((l=l||0)<0)throw new RangeError("targetStart out of bounds");if(h<0||h>=this.length)throw new RangeError("sourceStart out of bounds");if(g<0)throw new RangeError("sourceEnd out of bounds");g>this.length&&(g=this.length),s.length-l<g-h&&(g=s.length-l+h);var _,A=g-h;if(this===s&&h<l&&l<g)for(_=A-1;0<=_;--_)s[_+l]=this[_+h];else if(A<1e3||!Zy.TYPED_ARRAY_SUPPORT)for(_=0;_<A;++_)s[_+l]=this[_+h];else Uint8Array.prototype.set.call(s,this.subarray(h,h+A),l);return A},Zy.prototype.fill=function(s,l,h,g){if("string"==typeof s){var _;if("string"==typeof l?(g=l,l=0,h=this.length):"string"==typeof h&&(g=h,h=this.length),1!==s.length||(_=s.charCodeAt(0))<256&&(s=_),void 0!==g&&"string"!=typeof g)throw new TypeError("encoding must be a string");if("string"==typeof g&&!Zy.isEncoding(g))throw new TypeError("Unknown encoding: "+g)}else"number"==typeof s&&(s&=255);if(l<0||this.length<l||this.length<h)throw new RangeError("Out of range index");if(h<=l)return this;if(l>>>=0,h=void 0===h?this.length:h>>>0,"number"==typeof(s=s||0))for($=l;$<h;++$)this[$]=s;else for(var A=yT(s)?s:WA(new Zy(s,g).toString()),j=A.length,$=0;$<h-l;++$)this[$+l]=A[$%j];return this};var WI=/[^+\/0-9A-Za-z-_]/g;function WA(s,l){var h;l=l||1/0;for(var g=s.length,_=null,A=[],j=0;j<g;++j){if(55295<(h=s.charCodeAt(j))&&h<57344){if(!_){if(56319<h){-1<(l-=3)&&A.push(239,191,189);continue}if(j+1===g){-1<(l-=3)&&A.push(239,191,189);continue}_=h;continue}if(h<56320){-1<(l-=3)&&A.push(239,191,189),_=h;continue}h=65536+(_-55296<<10|h-56320)}else _&&-1<(l-=3)&&A.push(239,191,189);if(_=null,h<128){if(--l<0)break;A.push(h)}else if(h<2048){if((l-=2)<0)break;A.push(h>>6|192,63&h|128)}else if(h<65536){if((l-=3)<0)break;A.push(h>>12|224,h>>6&63|128,63&h|128)}else{if(!(h<1114112))throw new Error("Invalid code point");if((l-=4)<0)break;A.push(h>>18|240,h>>12&63|128,h>>6&63|128,63&h|128)}}return A}function TN(s){return function AV(s){var l,h,g,_;_N||e2();var A=s.length;if(0<A%4)throw new Error("Invalid string. Length must be a multiple of 4");_=new TV(3*A/4-(g="="===s[A-2]?2:"="===s[A-1]?1:0)),l=0<g?A-4:A;for(var j=0,$=0;$<l;$+=4,0)h=NE[s.charCodeAt($)]<<18|NE[s.charCodeAt($+1)]<<12|NE[s.charCodeAt($+2)]<<6|NE[s.charCodeAt($+3)],_[j++]=h>>16&255,_[j++]=h>>8&255,_[j++]=255&h;return 2==g?(h=NE[s.charCodeAt($)]<<2|NE[s.charCodeAt($+1)]>>4,_[j++]=255&h):1==g&&(h=NE[s.charCodeAt($)]<<10|NE[s.charCodeAt($+1)]<<4|NE[s.charCodeAt($+2)]>>2,_[j++]=h>>8&255,_[j++]=255&h),_}(function(l){var h;if((l=((h=l).trim?h.trim():h.replace(/^\s+|\s+$/g,"")).replace(WI,"")).length<2)return"";for(;l.length%4!=0;)l+="=";return l}(s))}function $S(s,l,h,g){for(var _=0;_<g&&!(_+h>=l.length||_>=s.length);++_)l[_+h]=s[_];return _}function $A(s){return null!=s&&(!!s._isBuffer||$I(s)||"function"==typeof(l=s).readFloatLE&&"function"==typeof l.slice&&$I(l.slice(0,0)));var l}function $I(s){return!!s.constructor&&"function"==typeof s.constructor.isBuffer&&s.constructor.isBuffer(s)}var wD=Object.freeze({INSPECT_MAX_BYTES:50,kMaxLength:Kx,Buffer:Zy,SlowBuffer:function(s){return+s!=s&&(s=0),Zy.alloc(+s)},isBuffer:$A}),F3="function"==typeof Object.create?function(s,l){s.super_=l,s.prototype=Object.create(l.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})}:function(s,l){function h(){}s.super_=l,h.prototype=l.prototype,s.prototype=new h,s.prototype.constructor=s};function x0(s,l){var h={seen:[],stylize:A1};return 3<=arguments.length&&(h.depth=arguments[2]),4<=arguments.length&&(h.colors=arguments[3]),CN(l)?h.showHidden=l:l&&function(g,_){if(_&&iA(_))for(var A=Object.keys(_),j=A.length;j--;)g[A[j]]=_[A[j]]}(h,l),XE(h.showHidden)&&(h.showHidden=!1),XE(h.depth)&&(h.depth=2),XE(h.colors)&&(h.colors=!1),XE(h.customInspect)&&(h.customInspect=!0),h.colors&&(h.stylize=AN),u2(h,s,h.depth)}function AN(s,l){var h=x0.styles[l];return h?"\x1b["+x0.colors[h][0]+"m"+s+"\x1b["+x0.colors[h][1]+"m":s}function A1(s,l){return s}function u2(s,l,h){if(s.customInspect&&l&&vT(l.inspect)&&l.inspect!==x0&&(!l.constructor||l.constructor.prototype!==l)){var g=l.inspect(h,s);return YS(g)||(g=u2(s,g,h)),g}var _=function(lc,_p){if(XE(_p))return lc.stylize("undefined","undefined");if(YS(_p)){var ka="'"+JSON.stringify(_p).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return lc.stylize(ka,"string")}return"number"==typeof _p?lc.stylize(""+_p,"number"):CN(_p)?lc.stylize(""+_p,"boolean"):DN(_p)?lc.stylize("null","null"):void 0}(s,l);if(_)return _;var A,j=Object.keys(l),$=(A={},j.forEach(function(lc,_p){A[lc]=!0}),A);if(s.showHidden&&(j=Object.getOwnPropertyNames(l)),xD(l)&&(0<=j.indexOf("message")||0<=j.indexOf("description")))return YA(l);if(0===j.length){if(vT(l))return s.stylize("[Function"+(l.name?": "+l.name:"")+"]","special");if(l2(l))return s.stylize(RegExp.prototype.toString.call(l),"regexp");if(KS(l))return s.stylize(Date.prototype.toString.call(l),"date");if(xD(l))return YA(l)}var _i,lc,_p,ka,_s="",Ja=!1,_l=["{","}"];return Array.isArray(l)&&(Ja=!0,_l=["[","]"]),vT(l)&&(_s=" [Function"+(l.name?": "+l.name:"")+"]"),l2(l)&&(_s=" "+RegExp.prototype.toString.call(l)),KS(l)&&(_s=" "+Date.prototype.toUTCString.call(l)),xD(l)&&(_s=" "+YA(l)),0!==j.length||Ja&&0!=l.length?h<0?l2(l)?s.stylize(RegExp.prototype.toString.call(l),"regexp"):s.stylize("[Object]","special"):(s.seen.push(l),_i=Ja?function(lc,_p,ka,ty,ny){for(var ry=[],ly=0,ey=_p.length;ly<ey;++ly)SN(_p,String(ly))?ry.push(YI(lc,_p,ka,ty,String(ly),!0)):ry.push("");return ny.forEach(function(hy){hy.match(/^\d+$/)||ry.push(YI(lc,_p,ka,ty,hy,!0))}),ry}(s,l,h,$,j):j.map(function(lc){return YI(s,l,h,$,lc,Ja)}),s.seen.pop(),_p=_s,ka=_l,60<(lc=_i).reduce(function(ty,ny){return ny.indexOf("\n"),ty+ny.replace(/\u001b\[\d\d?m/g,"").length+1},0)?ka[0]+(""===_p?"":_p+"\n ")+" "+lc.join(",\n  ")+" "+ka[1]:ka[0]+_p+" "+lc.join(", ")+" "+ka[1]):_l[0]+_s+_l[1]}function YA(s){return"["+Error.prototype.toString.call(s)+"]"}function YI(s,l,h,g,_,A){var j,$,_t=Object.getOwnPropertyDescriptor(l,_)||{value:l[_]};if(_t.get?$=s.stylize(_t.set?"[Getter/Setter]":"[Getter]","special"):_t.set&&($=s.stylize("[Setter]","special")),SN(g,_)||(j="["+_+"]"),$||(s.seen.indexOf(_t.value)<0?-1<($=DN(h)?u2(s,_t.value,null):u2(s,_t.value,h-1)).indexOf("\n")&&($=A?$.split("\n").map(function(Ye){return"  "+Ye}).join("\n").substr(2):"\n"+$.split("\n").map(function(Ye){return"   "+Ye}).join("\n")):$=s.stylize("[Circular]","special")),XE(j)){if(A&&_.match(/^\d+$/))return $;j=(j=JSON.stringify(""+_)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(j=j.substr(1,j.length-2),s.stylize(j,"name")):(j=j.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s.stylize(j,"string"))}return j+": "+$}function CN(s){return"boolean"==typeof s}function DN(s){return null===s}function YS(s){return"string"==typeof s}function XE(s){return void 0===s}function l2(s){return iA(s)&&"[object RegExp]"===ZS(s)}function iA(s){return"object"==typeof s&&null!==s}function KS(s){return iA(s)&&"[object Date]"===ZS(s)}function xD(s){return iA(s)&&("[object Error]"===ZS(s)||s instanceof Error)}function vT(s){return"function"==typeof s}function ED(s){return null===s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||"symbol"==typeof s||void 0===s}function ZS(s){return Object.prototype.toString.call(s)}function SN(s,l){return Object.prototype.hasOwnProperty.call(s,l)}function MN(s,l){if(s===l)return 0;for(var h=s.length,g=l.length,_=0,A=Math.min(h,g);_<A;++_)if(s[_]!==l[_]){h=s[_],g=l[_];break}return h<g?-1:g<h?1:0}x0.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},x0.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var oA,TD=Object.prototype.hasOwnProperty,IN=Object.keys||function(s){var l=[];for(var h in s)TD.call(s,h)&&l.push(h);return l},j3=Array.prototype.slice;function KI(){return void 0!==oA?oA:oA="foo"===function(){}.name}function kN(s){return Object.prototype.toString.call(s)}function V3(s){if(!$A(s)&&"function"==typeof tA.ArrayBuffer){if("function"==typeof ArrayBuffer.isView)return ArrayBuffer.isView(s);if(s)return s instanceof DataView||!!(s.buffer&&s.buffer instanceof ArrayBuffer)}}function xx(s,l){s||Ex(s,!0,l,"==",NN)}var z3=/\s*function\s+([^\(\s]*)\s*/;function ON(s){if(vT(s)){if(KI())return s.name;var l=s.toString().match(z3);return l&&l[1]}}function AD(s){this.name="AssertionError",this.actual=s.actual,this.expected=s.expected,this.operator=s.operator,s.message?(this.message=s.message,this.generatedMessage=!1):(this.message=ZI(RN(this.actual),128)+" "+this.operator+" "+ZI(RN(this.expected),128),this.generatedMessage=!0);var h,g,_,A,j,$=s.stackStartFunction||Ex;Error.captureStackTrace?Error.captureStackTrace(this,$):(h=new Error).stack&&(j=h.stack,g=ON($),0<=(_=j.indexOf("\n"+g))&&(A=j.indexOf("\n",_+1),j=j.substring(A+1)),this.stack=j)}function ZI(s,l){return"string"!=typeof s||s.length<l?s:s.slice(0,l)}function RN(s){if(KI()||!vT(s))return x0(s);var l=ON(s);return"[Function"+(l?": "+l:"")+"]"}function Ex(s,l,h,g,_){throw new AD({message:h,actual:s,expected:l,operator:g,stackStartFunction:_})}function NN(s,l){s||Ex(s,!0,l,"==",NN)}function KA(s,l,h,g){if(s===l)return!0;if($A(s)&&$A(l))return 0===MN(s,l);if(KS(s)&&KS(l))return s.getTime()===l.getTime();if(l2(s)&&l2(l))return s.source===l.source&&s.global===l.global&&s.multiline===l.multiline&&s.lastIndex===l.lastIndex&&s.ignoreCase===l.ignoreCase;if(null!==s&&"object"==typeof s||null!==l&&"object"==typeof l){if(V3(s)&&V3(l)&&kN(s)===kN(l)&&!(s instanceof Float32Array||s instanceof Float64Array))return 0===MN(new Uint8Array(s.buffer),new Uint8Array(l.buffer));if($A(s)!==$A(l))return!1;var _=(g=g||{actual:[],expected:[]}).actual.indexOf(s);return-1!==_&&_===g.expected.indexOf(l)||(g.actual.push(s),g.expected.push(l),function(A,j,$,_t){if(null==A||null==j)return!1;if(ED(A)||ED(j))return A===j;if($&&Object.getPrototypeOf(A)!==Object.getPrototypeOf(j))return!1;var Ye=B3(A),_i=B3(j);if(Ye&&!_i||!Ye&&_i)return!1;if(Ye)return KA(A=j3.call(A),j=j3.call(j),$);var _s,Ja,_l=IN(A),lc=IN(j);if(_l.length!==lc.length)return!1;for(_l.sort(),lc.sort(),Ja=_l.length-1;0<=Ja;Ja--)if(_l[Ja]!==lc[Ja])return!1;for(Ja=_l.length-1;0<=Ja;Ja--)if(!KA(A[_s=_l[Ja]],j[_s],$,_t))return!1;return!0}(s,l,h,g))}return h?s===l:s==l}function B3(s){return"[object Arguments]"==Object.prototype.toString.call(s)}function PN(s,l){if(s&&l){if("[object RegExp]"==Object.prototype.toString.call(l))return l.test(s);try{if(s instanceof l)return 1}catch{}if(!Error.isPrototypeOf(l))return!0===l.call({},s)}}function LN(s,l,h,g){var _;if("function"!=typeof l)throw new TypeError('"block" argument must be a function');"string"==typeof h&&(g=h,h=null),_=function($){var _t;try{$()}catch(Ye){_t=Ye}return _t}(l),g=(h&&h.name?" ("+h.name+").":".")+(g?" "+g:"."),s&&!_&&Ex(_,h,"Missing expected exception"+g);var A="string"==typeof g,j=!s&&_&&!h;if((!s&&xD(_)&&A&&PN(_,h)||j)&&Ex(_,h,"Got unwanted exception"+g),s&&_&&h&&!PN(_,h)||!s&&_)throw _}function XS(){}F3(xx.AssertionError=AD,Error),xx.fail=Ex,xx.ok=NN,xx.equal=function s(l,h,g){l!=h&&Ex(l,h,g,"==",s)},xx.notEqual=function s(l,h,g){l==h&&Ex(l,h,g,"!=",s)},xx.deepEqual=function s(l,h,g){KA(l,h,!1)||Ex(l,h,g,"deepEqual",s)},xx.deepStrictEqual=function s(l,h,g){KA(l,h,!0)||Ex(l,h,g,"deepStrictEqual",s)},xx.notDeepEqual=function s(l,h,g){KA(l,h,!1)&&Ex(l,h,g,"notDeepEqual",s)},xx.notDeepStrictEqual=function s(l,h,g){KA(l,h,!0)&&Ex(l,h,g,"notDeepStrictEqual",s)},xx.strictEqual=function s(l,h,g){l!==h&&Ex(l,h,g,"===",s)},xx.notStrictEqual=function s(l,h,g){l===h&&Ex(l,h,g,"!==",s)},xx.throws=function(s,l,h){LN(!0,s,l,h)},xx.doesNotThrow=function(s,l,h){LN(!1,s,l,h)},xx.ifError=function(s){if(s)throw s};var XI={sort:function(s){return s.sort(function(l,h){return Math.sqrt(Math.pow(l.height,2)+Math.pow(l.width,2))-Math.sqrt(Math.pow(h.height,2)+Math.pow(h.width,2))}),s},placeItems:function(s){var l=0,h=0;return s.forEach(function(g){g.x=l,g.y=h,l+=g.width,h+=g.height}),s}},IV={sort:function(s){return s.sort(function(l,h){return Math.sqrt(Math.pow(l.height,2)+Math.pow(l.width,2))-Math.sqrt(Math.pow(h.height,2)+Math.pow(h.width,2))}),s},placeItems:function(s){var l=0,h=0;return s.forEach(function(g){var _=g.width;g.x=l-_,g.y=h,l-=_,h+=g.height}),s}};XS.prototype={fit:function(s){var l,h,g,_,A=s.length;for(this.root={x:0,y:0,width:0<A?s[0].width:0,height:0<A?s[0].height:0},l=0;l<A;l++)_=(h=this.findNode(this.root,(g=s[l]).width,g.height))?this.splitNode(h,g.width,g.height):this.growNode(g.width,g.height),g.x=_.x,g.y=_.y},findNode:function(s,l,h){return s.used?this.findNode(s.right,l,h)||this.findNode(s.down,l,h):l<=s.width&&h<=s.height?s:null},splitNode:function(s,l,h){return s.used=!0,s.down={x:s.x,y:s.y+h,width:s.width,height:s.height-h},s.right={x:s.x+l,y:s.y,width:s.width-l,height:h},s},growNode:function(s,l){var h=s<=this.root.width,g=l<=this.root.height,A=h&&this.root.width>=this.root.height+l;return g&&this.root.height>=this.root.width+s?this.growRight(s,l):A?this.growDown(s,l):g?this.growRight(s,l):h?this.growDown(s,l):null},growRight:function(s,l){var h;return this.root={used:!0,x:0,y:0,width:this.root.width+s,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:s,height:this.root.height}},(h=this.findNode(this.root,s,l))?this.splitNode(h,s,l):null},growDown:function(s,l){var h;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+l,down:{x:0,y:this.root.height,width:this.root.width,height:l},right:this.root},(h=this.findNode(this.root,s,l))?this.splitNode(h,s,l):null}};var kV=XS,OV={sort:function(s){return s},placeItems:function(s){return function(l,h){h=h||{};var g=new kV,_=h.inPlace||!1,A=(A=l.map(function($){return _?$:{width:$.width,height:$.height,item:$}})).sort(function($,_t){return _t.width*_t.height-$.width*$.height});g.fit(A);var j={width:A.reduce(function($,_t){return Math.max($,_t.x+_t.width)},0),height:A.reduce(function($,_t){return Math.max($,_t.y+_t.height)},0)};_||(j.items=A)}(s,{inPlace:!0}),s}},FN={};function JI(s,l){var h=s||"top-down";return"string"==typeof h&&xx(h=FN[s],"Sorry, the '"+s+"' algorithm could not be loaded."),new R3(h,l)}function c2(s,l){FN[s]=l}JI.PackingSmith=R3,JI.addAlgorithm=c2,JI.algorithms=FN,c2("top-down",{sort:function(s){return s.sort(function(l,h){return l.height-h.height}),s},placeItems:function(s){var l=0;return s.forEach(function(h){h.x=0,h.y=l,l+=h.height}),s}}),c2("left-right",{sort:function(s){return s.sort(function(l,h){return l.width-h.width}),s},placeItems:function(s){var l=0;return s.forEach(function(h){h.x=l,h.y=0,l+=h.width}),s}}),c2("diagonal",XI),c2("alt-diagonal",IV),c2("binary-tree",OV);var JS=JI;function QS(s){var l;try{s.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1)}catch(h){l=h.message}return l}function QI(s,l,h){var g;return s instanceof HTMLImageElement&&((g=s.ownerDocument.createElement("canvas")).width=l,g.height=h,g.getContext("2d").drawImage(s,0,0,l,h),s=g),s}var CD=My.metersToLatLng([My.half_circumference_meters,My.half_circumference_meters]),jN=Math.log(My.tile_size)/Math.LN2,Tx=function(){L_(l,Hy);var s=B1(l);function l(h,g){var _;return D0(this,l),_=s.call(this,h,g),V_.is_worker&&(_._quad_tree=new lT.H.geo.QuadTree,_._marker_quad_tree=new lT.H.geo.QuadTree,_._tree_entries_by_object_id={},_._groups_by_id={},_._layersCache=new lT.H.util.Cache(100)),V_.is_main&&(_._objects_by_id={},_._commands=[],_._sendCommands=NA(_._sendCommands,100,200),_.dispatchUpdate=_.dispatchUpdate.bind(mI(_))),_}return T0(l,[{key:"hasLabeledData",value:function(){return!1}},{key:"onReady",value:function(){this._synced_at=this.provider.getInvalidations().getMark();var h,g,_=this.provider.getRootGroup(),A=_.getObjects(!0),j=[];for(A.push(_),h=A.length;h--;)this._isObjectSupported(g=A[h])&&this._shouldBeStored(g)&&(this._objects_by_id[g.getId()]=g,j.push(g.forWorkerMessage()));this._sendImmediateCommands([{method_name:"addObjects",arguments:[j]}])}},{key:"onProviderUpdate",value:function(h){var g,_,A,j,$=h.target,_t=h.currentTarget.getInvalidations($.type);this._isObjectSupported($)&&(g=this._synced_at,_=$.getId(),_t.isRemove(g)?(delete this._objects_by_id[_],this._commands.push({method_name:"removeObjectsByIds",arguments:[[_],!0]})):_t.isAdd(g)?this._shouldBeStored($)&&(this._objects_by_id[_]=$,this._commands.push({method_name:"addObjects",arguments:[[$.forWorkerMessage()]]})):_t.isSpatial(g)||_t.isZOrder(g)?this._shouldBeStored($)&&(A=[{method_name:"removeObjectsByIds",arguments:[[_],!0]},{method_name:"addObjects",arguments:[[(this._objects_by_id[_]=$).forWorkerMessage()]]}],this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands(A):this._commands.push(A[0],A[1])):_t.isVisual(g)?this._shouldBeStored($)&&(j={method_name:"updateObjectProperties",arguments:[(this._objects_by_id[_]=$).forWorkerMessage()]},this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands([j]):this._commands.push(j)):_t.isVolatility(g)&&(delete this._objects_by_id[_],this._commands.push({method_name:"removeObjectsByIds",arguments:[[_],!0]}),this._shouldBeStored($)&&(this._objects_by_id[_]=$,this._commands.push({method_name:"addObjects",arguments:[[$.forWorkerMessage()]]}))),this._commands.length&&this._sendCommands()),this._synced_at=_t.getMark()}},{key:"_shouldBeStored",value:function(h){return 16===h.type||(!h.getIcon||1===h.getIcon().getState())&&this._hasSameVolatility(h)}},{key:"_hasSameVolatility",value:function(h){return h.getVolatility(!0)===this.has_volatile_data}},{key:"hasPendingCommands",value:function(){return 0<this._commands.length}},{key:"_sendCommands",value:function(){this._sendImmediateCommands(this._commands),this._commands=[]}},{key:"_sendImmediateCommands",value:function(h){h.length&&_0.postMessage(this.worker,this.target_name+".executeCommands",h).then(this.dispatchUpdate)}},{key:"_isObjectSupported",value:function(h){return h.forWorkerMessage&&8!==h.type}},{key:"getSyncedAt",value:function(){return this._synced_at}},{key:"getMapObjectById",value:function(h){return this._objects_by_id[h]}},{key:"getIconBitmapByObjectId",value:function(h,g){var _=this.getMapObjectById(h);if(_){var A=_.getIcon();if(A.uid===g&&1===A.getState()){var j=A.getSize();return QI(A.getBitmap(),j.w,j.h)}}}},{key:"_getRastersForMarkers",value:function(h){for(var g={},_=JS("binary-tree"),A=0;A<h.length;A++){var j=h[A],$=j.properties.icon;g[$.id]||(_.addItem({width:$.size.w,height:$.size.h,meta:{objectId:j.id,id:$.id}}),g[$.id]=!0)}return _.export()}},{key:"fetchFeaturesForTile",value:function(h){var g=[],_=[],A=[],j=[],$=[],_t=this._marker_quad_tree.intersectBoundingBox(My.getTileBoundingBox(h.coords,this.tile_size));h.source_data.error=null;for(var Ye=0;Ye<_t.length;Ye++){var _i={id:_t[Ye].$feature$.id,properties:Object.assign({},_t[Ye].$feature$.properties),geometry:{type:_t[Ye].$feature$.geometry.type,coordinates:VS.deepClone(_t[Ye].$feature$.geometry.coordinates)}};g.push(_i)}_t=this._quad_tree.intersectBoundingBox(My.getTileBoundingBox(h.coords,this.tile_size,100));for(var _s=0;_s<_t.length;_s++){var Ja,_l={id:_t[_s].$feature$.id,properties:Object.assign({},_t[_s].$feature$.properties),geometry:{type:_t[_s].$feature$.geometry.type,coordinates:VS.deepClone(_t[_s].$feature$.geometry.coordinates)}};_l.properties.overlay?_.push(_l):_l.geometry.type.includes("LineString")?A.push(_l):_l.geometry.type.includes("Polygon")&&(j.push(_l),Ja={id:_l.id,properties:_l.properties,geometry:{type:_l.geometry.type,coordinates:VS.deepClone(_l.geometry.coordinates)}},$.push(Ja))}g.sort(l._compareZInfo),j.sort(l._compareZInfo),_.sort(l._compareZInfo);var lc=this.has_volatile_data?4096:0;$.sort(l._compareZInfo);for(var _p=0;_p<$.length;_p++)$[_p].properties.effectiveZIdx=lc++;A.sort(l._compareZInfo);for(var ka=0;ka<A.length;ka++)A[ka].properties.effectiveZIdx=lc++;h.source_data.layers.markers={type:"FeatureCollection",features:g},h.source_data.layers.polylines={type:"FeatureCollection",features:A},h.source_data.layers.polygons={type:"FeatureCollection",features:j},h.source_data.layers.outlines={type:"FeatureCollection",features:$},h.source_data.layers.overlays={type:"FeatureCollection",features:_}}},{key:"tileTexture",value:function(h){var g=h.source_data.layers.overlays;if(g){var _=this.name+"_"+h.coords.key,A=n1.coordinateWithMaxZoom(h.coords,this.max_zoom);return{name:_,filtering:this.filtering,coords:A,width:My.tile_size,height:My.tile_size,overlays_config:g.features[0].properties.overlays_config,source:this.name}}}},{key:"_load",value:function(h){var g=My.wrapTile(h.coords,{x:!0}),_=g.z,A=g.x,j=g.y,$="".concat(_,"_").concat(A,"_").concat(j),_t=this._layersCache.get($),Ye=!1;if(_t)h.source_data.layers=_t;else{this.fetchFeaturesForTile(h);var _i={maxZoom:this.max_zoom,tolerance:1.5,extent:My.tile_scale},_s=h.source_data.layers.overlays;_s.features.length&&delete h.source_data.layers.overlays;var Ja=h.source_data.layers.markers;for(var _l in Ja.features.length&&delete h.source_data.layers.markers,h.source_data.layers){var lc,_p=h.source_data.layers[_l];_p.features.length&&(_i.buffer=_l.includes("lines")?100*My.units_per_pixel:0,lc=EV(_p,_,A,j,_i),h.source_data.layers[_l]=NS(lc))}h.source_data.layers.overlays=this._processOverlays(h,_s);for(var ka=h.source_data.layers.overlays.features.length;ka--;)if(!h.source_data.layers.overlays.features[ka].id){Ye=!0,this._layersCache.drop($);break}h.source_data.layers.markers=this._processMarkers(h,Ja),this._postProcessTile(h),Ye||this._layersCache.add($,h.source_data.layers,1)}return h.rasters=this._getRastersForMarkers(h.source_data.layers.markers.features),Promise.resolve(h)}},{key:"_processMarkers",value:function(h,g){var _=g.features.length;if(_){for(var A=My.unitsPerMeter(h.coords.z),j=My.wrapTile(h.coords,{x:!0}),$=My.metersForTile(j),_t=My.isLastTile(j),Ye=My.wrapMeters(h.min),_i=My.wrapMeters(h.max),_s=function(ty){ax.coordsToMeters(ty);var ny=A0(ty,2),ry=ny[0],ly=ny[1],ey=ry>=Ye.x&&(_t.column||ry<_i.x)&&ly>=_i.y&&(_t.row||!h.coords.y||ly<Ye.y);return ax.metersToTileUnits(A,$,ty),ey},Ja=[],_l=0;_l<_;_l++){var lc,_p=g.features[_l].geometry,ka=!1;"Point"===_p.type?_s(lc=_p.coordinates)?_p.coordinates=lc:ka=!0:"MultiPoint"===_p.type&&(_p.coordinates=_p.coordinates.filter(_s),0===_p.coordinates.length&&(ka=!0)),ka||Ja.push(g.features[_l])}g.features=Ja}return g}},{key:"_processOverlays",value:function(h,g){var _=this;if(!g.features.length)return g;var A={coords:h.coords,min:My.metersForTile(My.wrapTile(h.coords,{x:!0}))},j={coords:h.coords,source_data:{layers:{_default:{type:"FeatureCollection",features:g.features}}}},$=Math.pow(2,h.coords.z+jN);Hy.projectData(j.source_data),Hy.scaleData(j.source_data,A);var _t=g.features.map(function(_i){var _s=_i.geometry.coordinates[0],Ja=_s[0],_l=_s[5===_s.length?2:3],lc=Math.floor(Ja[0]/My.tile_scale*My.tile_size),_p=Math.floor(Ja[1]/My.tile_scale*My.tile_size),ka=Math.floor(_l[0]/My.tile_scale*My.tile_size),ty=Math.floor(_l[1]/My.tile_scale*My.tile_size)-_p,ny=ka<=lc,ry=ny?$-(lc-ka):ka-lc,ly=[];return lc<=My.tile_size&&ly.push([lc,_p,ry,ty]),ny&&0<ka&&ly.push([lc-$,_p,ry,ty]),{id:_i.id,properties:_i.properties,texcoords:ly}}).filter(function(_i){return _._isVisible(_i.properties)&&_.isInMinMaxRange(_i.properties,h.style_zoom)}),Ye=My.tile_scale;return h.pad_scale=this.pad_scale,h.default_winding="CW",g.features=_t.length?[{geometry:{type:"Polygon",coordinates:[[[0,0],[Ye,0],[Ye,Ye],[0,Ye],[0,0]]]},properties:{overlays_config:_t}}]:_t,g}},{key:"executeCommands",value:function(h){for(var g,_=h.length<10,A=0;A<h.length;A++){var j=h[A];j.arguments.push(_);var $=this[j.method_name].apply(this,j.arguments);_&&($&&g?g.mergeRect($,!0,g):$&&(g=$))}return g?g.forWorkerMessage():void 0}},{key:"_getClampedGeoRectForFeature",value:function(h){var g=h.geometry.boundingBox;return new lT.H.geo.Rect(j_.clamp(g[0],-CD[1],CD[1]),g[1],j_.clamp(g[2],-CD[1],CD[1]),g[3])}},{key:"addObjects",value:function(h,g){for(var _,A=1<arguments.length&&void 0!==g&&g,j=0;j<h.length;j++){var $,_t,Ye,_i=h[j];"Group"===_i.type?(_i.$children_ids$={},this._groups_by_id[_i.id]=_i):(l._preprocessGeometry(_i.geometry),$=this._getClampedGeoRectForFeature(_i),A&&(_?_.mergeRect($,!0,_):_=$),(Ye=(_t=-1!==_i.geometry.type.indexOf("Point")?this._marker_quad_tree:this._quad_tree).insertBoundingBox($)).$tree=_t,Ye.$feature$=_i,this._tree_entries_by_object_id[_i.id]=Ye)}for(var _s=0;_s<h.length;_s++){var Ja=h[_s];Ja.properties.parent&&(this._groups_by_id[Ja.properties.parent].$children_ids$[Ja.id]=Ja.id),Ja.properties.ref={effectiveVisibility:this._isVisible(Ja.properties),zInfo:this._getZInfo([],Ja)}}return this._layersCache.removeAll(),_}},{key:"removeObjectsByIds",value:function(h,g,_){for(var A,j=2<arguments.length&&void 0!==_&&_,$=0;$<h.length;$++){var _t,Ye=h[$],_i=void 0,_s=void 0;(_i=this._tree_entries_by_object_id[Ye])?(j&&(_t=this._getClampedGeoRectForFeature(_i.$feature$),A?A.mergeRect(_t,!0,A):A=_t),delete this._groups_by_id[_i.$feature$.properties.parent].$children_ids$[Ye],_i.$tree.remove(_i),delete this._tree_entries_by_object_id[Ye]):(_s=this._groups_by_id[Ye])&&(_s.properties.parent&&delete this._groups_by_id[_s.properties.parent].$children_ids$[Ye],g&&this.removeObjectsByIds(Object.keys(_s.$children_ids$),!0),delete this._groups_by_id[Ye])}return this._layersCache.removeAll(),A}},{key:"updateObjectProperties",value:function(h,g){var _,A=1<arguments.length&&void 0!==g&&g;return"Group"===h.type?(Q1(this._groups_by_id[h.id].properties,h.properties),this._groups_by_id[h.id].properties.ref.effectiveVisibility=this._isVisible(h.properties)):(this._tree_entries_by_object_id[h.id]||this.addObjects([h]),Q1(this._tree_entries_by_object_id[h.id].$feature$.properties,h.properties),this._tree_entries_by_object_id[h.id].$feature$.properties.ref.effectiveVisibility=this._isVisible(h.properties),A&&(_=this._getClampedGeoRectForFeature(h))),_}},{key:"_getZInfo",value:function(h,g){var _=g.properties.zIdx,A=g.properties.sIdx;return h[0]|=void 0!==_,h.splice(1,0,_||0,A<0?g.id:A),0===g.properties.parent?h:this._getZInfo(h,this._groups_by_id[g.properties.parent])}},{key:"_isVisible",value:function(h){var g=h.visible,_=!h.parent||this._isVisible(this._groups_by_id[h.parent].properties);return g&&_}},{key:"isInMinMaxRange",value:function(h,g){var _=h.min<=g&&h.max>=g,A=!h.parent||this.isInMinMaxRange(this._groups_by_id[h.parent].properties,g);return _&&A}},{key:"dispose",value:function(){this._commands=[],kE(h1(l.prototype),"dispose",this).call(this)}}],[{key:"_compareZInfo",value:function(h,g){for(var _,A=h.properties.ref.zInfo,j=g.properties.ref.zInfo,$=A.length,_t=j.length,Ye=Math.min($,_t),_i=1;_i<Ye;_i++)if(_=A[_i]-j[_i])return _;return $-_t}},{key:"_preprocessGeometry",value:function(h){var g=h.type;h.coordinates="Point"===g?l._processPointCoordinates(h.coordinates):"MultiPoint"===g?h.coordinates.map(l._processPointCoordinates):"LineString"===g?l._processLineStringCoordinates(h.coordinates):"MultiLineString"===g?h.coordinates.map(l._processLineStringCoordinates):"Polygon"===g?h.coordinates.map(l._processPolygonCoordinates):"MultiPolygon"===g?h.coordinates.map(l._processMultiPolygonCoordinates):[]}},{key:"_processPointCoordinates",value:function(h){return[h[1],h[0],h[2]]}},{key:"_processLineStringCoordinates",value:function(h){return l._latLngAltArrayToLineString(h,!1)}},{key:"_processPolygonCoordinates",value:function(h){return l._latLngAltArrayToLineString(h,!0)}},{key:"_processMultiPolygonCoordinates",value:function(h){return h.map(l._processPolygonCoordinates)}},{key:"_latLngAltArrayToLineString",value:function(h,g){for(var _=[],A=h.length,j=0;j<A;j+=3)_.push([h[j+1],h[j]]);return g&&_.push([h[1],h[0]]),_}}]),l}();Hy.register(Tx,"ObjectSource");var HN=function(){function s(){D0(this,s),this._map={}}return T0(s,[{key:"set",value:function(l,h,g){var _;this._map[l]?this._map[l].accumulator.add(g):((_=new Set).add(g),this._map[l]={value:h,accumulator:_})}},{key:"get",value:function(l){return this._map[l]&&this._map[l].value}},{key:"delete",value:function(l,h){var g=this._map[l];g&&g.accumulator&&(g.accumulator.delete(h),0===g.accumulator.size&&delete this._map[l])}}]),s}(),_k=function(){L_(l,Hy);var s=B1(l);function l(h,g){var _;return D0(this,l),_=s.call(this,h,g),V_.is_worker||(_._icons=new HN),_}return T0(l,[{key:"onProviderUpdate",value:function(h){h.target instanceof H.map.provider.Tile?this.dispatchUpdate(h.target,h.data):this.dispatchUpdate(void 0,h.data)}},{key:"onReady",value:function(){var h=this.provider;h.setTileCanvasRendering&&h.setTileCanvasRendering(!1),h.providesMarkers()&&(this._onCacheDrop=this._onCacheDrop.bind(this),h.getCache().registerOnDrop(this._onCacheDrop)),this.dispatchUpdate()}},{key:"dispose",value:function(){kE(h1(l.prototype),"dispose",this).call(this);var h=this.provider;h.providesMarkers()&&h.getCache().deRegisterOnDrop(this._onCacheDrop)}},{key:"_onCacheDrop",value:function(h,g){this.provider.cacheFilter(h)&&this._deleteIcons(h,g.data)}},{key:"_deleteIcons",value:function(h,g){for(var _=0,A=g.length;_<A;_++){var j=g[_].getIcon();this._icons.delete(j.uid,h)}}},{key:"getIconBitmapByObjectId",value:function(h,g){var _=this._icons.get(g);return _&&_.getBitmap()}},{key:"requestMarkerTile",value:function(h){var g=this;return new Promise(function(_,A){g.provider?g.provider.requestTileAsPromise(h.x,h.y,h.z,!1).then(function(j){var $,_t,Ye=[];if(j.data)for(_t=($=j.data).length;_t--;){var _i=$[_t],_s=_i.getIcon();g._icons.set(_s.uid,_s,j.key),Ye.push(_i.forWorkerMessage())}_(Ye)}):_([])})}},{key:"requestSpatialTile",value:function(h){var g=this;return new Promise(function(_,A){g.provider?g.provider.requestTileAsPromise(h.x,h.y,h.z,!1).then(function(j){var $,_t=[];if(j.getObjects){$=j.getObjects();for(var Ye=0;Ye<$.length;Ye++){var _i=$[Ye];_t.push({id:_i.getId(),geometries:_i.getGeometriesForTile(j),isClosed:_i.isClosed(),style:_i.getStyle().forWorkerMessage()})}}_(_t)}):_([])})}},{key:"_pointToArray",value:function(h){var g=My.tile_scale/this.tile_size;return[h.x*g,h.y*g]}},{key:"_getGeoJsonMultiPolygon",value:function(h){for(var g=h.geometries,_=g.length,A=[],j={coordinates:A,type:"MultiPolygon"},$=0;$<_;$++){var _t=g[$],Ye=_t.paths,_i=Ye.length,_s=_t.interiorsIndex,Ja=_t.outlinesIndex,_l=Math.min(_s,Ja,_i),lc=void 0,_p=void 0;for(_p=0;_p<_l;_p++)lc=[Ye[_p].map(this._pointToArray,this)],A.push(lc);if(1===_l)for(_l=Math.min(Ja,_i),_p=_s;_p<_l;_p++)lc.push(Ye[_p].map(this._pointToArray,this))}return j}},{key:"_getGeoJsonMultiLineString",value:function(h,g){for(var _=1<arguments.length&&void 0!==g&&g,A={coordinates:[],type:"MultiLineString"},j=h.geometries,$=0;$<j.length;$++)for(var _t=j[$],Ye=_?_t.outlinesIndex:0,_i=_?_t.paths.length:Math.min(_t.interiorsIndex,_t.outlinesIndex,_t.paths.length),_s=Ye;_s<_i;_s++){var Ja=_t.paths[_s].map(this._pointToArray,this);A.coordinates.push(Ja)}return A}},{key:"_getGeoJsonGeometry",value:function(h,g){var _=1===g?this._getGeoJsonMultiPolygon(h):this._getGeoJsonMultiLineString(h,3===g);return _.coordinates.length?_:null}},{key:"_load",value:function(h){var g=this;return new Promise(function(_,A){var j=_0.postMessage(g.target_name+".requestMarkerTile",h.coords).then(g._prepareTileData.bind(g,h)),$=new Promise(function(_t,Ye){_0.postMessage(g.target_name+".requestSpatialTile",h.coords).then(function(_i){for(var _s=[],Ja=[],_l=[],lc=0;lc<_i.length;lc++){var _p,ka=_i[lc],ty=void 0,ny=ka.isClosed?(ty=Ja,1):(ty=_s,2),ry=g._getGeoJsonGeometry(ka,ny);ry&&(_p={id:ka.id,type:"Feature",properties:{height:0,style:ka.style},geometry:ry},2===ny&&(_p.properties.effectiveZIdx=_s.length),ty.push(_p));var ly=g._getGeoJsonGeometry(ka,3);ly&&_l.push({id:ka.id,type:"Feature",properties:{height:0,style:ka.style,effectiveZIdx:_l.length},geometry:ly})}h.source_data.layers.polylines={type:"FeatureCollection",features:_s},h.source_data.layers.polygons={type:"FeatureCollection",features:Ja},h.source_data.layers.outlines={type:"FeatureCollection",features:_l},_t(h)})});Promise.all([j,$]).then(function(_t){g._postProcessTile(h),_(h)})})}},{key:"_prepareTileData",value:function(h,g){var _=My.wrapTile(h.coords,{x:!0,y:!0}),A=My.metersForTile(_);h.source_data.layers={markers:{features:g,type:"FeatureCollection"}};var j={coords:_,min:A},$=h.source_data,_t=JS("binary-tree"),Ye={};for(var _i in $.layers)for(var _s=$.layers[_i].features.length,Ja=0;Ja<_s;Ja++){var _l=$.layers[_i].features[Ja],lc=_l.properties.icon;Ye[lc.id]||(_t.addItem({width:lc.size.w,height:lc.size.h,meta:{objectId:_l.id,id:lc.id}}),Ye[lc.id]=!0),My.transformGeometry(_l.geometry,function(_p){var ka=_p[0];_p[0]=_p[1],_p[1]=ka})}return h.rasters=_t.export(),Hy.projectData(h.source_data),Hy.scaleData(h.source_data,j),h}}]),l}();Hy.register(_k,"ObjectTileSource");var H3=function(){L_(l,jS);var s=B1(l);function l(h,g){var _;return D0(this,l),(_=s.call(this,h,g)).uid_=h.uid,_}return T0(l,[{key:"initialize",value:function(h,g){this.provider=h,this._on_update=g,this._onProviderUpdate=this._onProviderUpdate.bind(this),h.addEventListener("update",this._onProviderUpdate)}},{key:"_onProviderUpdate",value:function(){this._on_update(this.name)}},{key:"tileTexture",value:function(h){return Object.assign(kE(h1(l.prototype),"tileTexture",this).call(this,h),{uid:this.uid_,url:this.uid_+"_"+h.coords.key,coords:h.coords})}},{key:"dispose",value:function(){this.provider.removeEventListener("update",this._onProviderUpdate)}}]),l}();function tM(s,l){var h=(l=this.options=function(_,A){for(var j in A)_[j]=A[j];return _}(Object.create(this.options),l)).debug;if(h&&console.time("preprocess data"),l.maxZoom<0||24<l.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(l.promoteId&&l.generateId)throw new Error("promoteId and generateId cannot be used together.");var g=vN(s,l);this.tiles={},this.tileCoords=[],h&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",l.indexMaxZoom,l.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(g=HA(g,l)).length&&this.splitTile(g,0,0,0),h&&(g.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function tO(s,l,h){return 32*((1<<s)*h+l)+s}ax.register(H3,"RemoteRasterTileSource"),tM.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tM.prototype.splitTile=function(s,l,h,g,_,A,j){for(var $=[s,l,h,g],_t=this.options,Ye=_t.debug;$.length;){g=$.pop(),h=$.pop(),l=$.pop(),s=$.pop();var _i,_s,Ja,_l,lc,_p,ka,ty,ny,ry,ly,ey=1<<l,hy=tO(l,h,g),fy=this.tiles[hy];if(fy||(1<Ye&&console.time("creation"),fy=this.tiles[hy]=k3(s,l,h,g,_t),this.tileCoords.push({z:l,x:h,y:g}),Ye&&(1<Ye&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",l,h,g,fy.numFeatures,fy.numPoints,fy.numSimplified),console.timeEnd("creation")),this.stats[_i="z"+l]=(this.stats[_i]||0)+1,this.total++)),fy.source=s,_){if(l===_t.maxZoom||l===_)continue;var _y=1<<_-l;if(h!==Math.floor(A/_y)||g!==Math.floor(j/_y))continue}else if(l===_t.indexMaxZoom||fy.numPoints<=_t.indexMaxPoints)continue;fy.source=null,0!==s.length&&(1<Ye&&console.time("clipping"),Ja=.5-(_s=.5*_t.buffer/_t.extent),lc=1+_s,ny=_p=ka=ty=null,ry=RE(s,ey,h-_s,h+(_l=.5+_s),0,fy.minX,fy.maxX,_t),ly=RE(s,ey,h+Ja,h+lc,0,fy.minX,fy.maxX,_t),s=null,ry&&(ny=RE(ry,ey,g-_s,g+_l,1,fy.minY,fy.maxY,_t),_p=RE(ry,ey,g+Ja,g+lc,1,fy.minY,fy.maxY,_t),ry=null),ly&&(ka=RE(ly,ey,g-_s,g+_l,1,fy.minY,fy.maxY,_t),ty=RE(ly,ey,g+Ja,g+lc,1,fy.minY,fy.maxY,_t),ly=null),1<Ye&&console.timeEnd("clipping"),$.push(ny||[],l+1,2*h,2*g),$.push(_p||[],l+1,2*h,2*g+1),$.push(ka||[],l+1,2*h+1,2*g),$.push(ty||[],l+1,2*h+1,2*g+1))}},tM.prototype.getTile=function(s,l,h){var g=this.options,_=g.extent,A=g.debug;if(s<0||24<s)return null;var j=1<<s,$=tO(s,l=(l%j+j)%j,h);if(this.tiles[$])return _D(this.tiles[$],_);1<A&&console.log("drilling down to z%d-%d-%d",s,l,h);for(var _t,Ye=s,_i=l,_s=h;!_t&&0<Ye;)Ye--,_i=Math.floor(_i/2),_s=Math.floor(_s/2),_t=this.tiles[tO(Ye,_i,_s)];return _t&&_t.source?(1<A&&console.log("found parent tile z%d-%d-%d",Ye,_i,_s),1<A&&console.time("drilling down"),this.splitTile(_t.source,Ye,_i,_s,s,l,h),1<A&&console.timeEnd("drilling down"),this.tiles[$]?_D(this.tiles[$],_):null):null};var UN={type:"FeatureCollection",features:[]},U3=function(){L_(l,Hy);var s=B1(l);function l(h,g){return D0(this,l),h.tiled=!0,h.url="",s.call(this,h,g)}return T0(l,[{key:"fetchTile",value:function(h,g,_){return this.provider?this.provider.requestTileAsPromise(h,g,_).then(function(A){return A.data}):Promise.resolve(UN)}},{key:"_load",value:function(h){var g=this,_=My.wrapTile(h.coords,{x:!0,y:!0}),A={indexMaxZoom:0,maxZoom:this.max_zoom,tolerance:1.5,extent:My.tile_scale};return _0.postMessage(this.target_name+".fetchTile",_.x,_.y,_.z).then(function(j){for(var $ in h.source_data.layers="FeatureCollection"===j.type?{_default:j}:j,h.source_data.layers){var _t=new tM(h.source_data.layers[$],A).getTile(_.z,_.x,_.y);h.source_data.layers[$]=NS(_t)}return g._postProcessTile(h),h})}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),l}();ax.register(U3,"GeoJSONTileSource");var GN,Ax={layers:{_default:{type:"FeatureCollection",features:[{type:"Point",geometry:{}}]}}},eO=function(){L_(l,ax);var s=B1(l);function l(h,g){return D0(this,l),h.max_zoom=0,s.call(this,h,g)}return T0(l,[{key:"load",value:function(h){return h.source_data="0/0/0"===h.coords.key?Ax:void 0,Promise.resolve(h)}}]),l}();ax.register(eO,"SkyBox");var sA,ZA=GN={draw_label_collision_boxes:!1,draw_label_texture_boxes:!1,suppress_label_fade_in:!1,suppress_snap_animation:!1,show_hidden_labels:!1,layer_stats:!1};function nO(s,l){var h={};return l.forEach(function(g){return h[g]=s[g]}),h}var aA,qN=sA={},WN=0;sA.getContext=function(s,l){var h=!1;null==s&&((s=document.createElement("canvas")).style.position="absolute",s.style.top=0,s.style.left=0,s.style.zIndex=-1,document.body.appendChild(s),h=!0);var g=s.getContext("webgl",l)||s.getContext("experimental-webgl",l);if(!g)throw new Error("Couldn't create WebGL context.");return g._tangram_id=WN++,h?(sA.resize(g,window.innerWidth,window.innerHeight,l.device_pixel_ratio),window.addEventListener("resize",function(){sA.resize(g,window.innerWidth,window.innerHeight,l.device_pixel_ratio)})):sA.resize(g,parseFloat(s.style.width),parseFloat(s.style.height),l.device_pixel_ratio),g},sA.resize=function(s,l,h,g){s.canvas.style.width=l+"px",s.canvas.style.height=h+"px",s.canvas.width=Math.round(l*g),s.canvas.height=Math.round(h*g),s.bindFramebuffer(s.FRAMEBUFFER,null),s.viewport(0,0,s.canvas.width,s.canvas.height)};var C0=aA={};aA.BYTE=5120,aA.UNSIGNED_BYTE=5121,aA.SHORT=5122,aA.UNSIGNED_SHORT=5123,aA.INT=5124,aA.UNSIGNED_INT=5125,aA.FLOAT=5126;var _T,G3=Math.pow(2,16)-1,rO=!1,iO=function(){function s(l){D0(this,s),this.size_=l||1024,this.position_=0,this.ArrayType_=Uint16Array,this.buffer_=new this.ArrayType_(this.size_),this.overflows_=!1}return T0(s,[{key:"push",value:function(l){if(!this.overflows_||rO){if(G3<l){if(this.overflows_=!0,!rO)return;this.ArrayType_===Uint16Array&&(this.ArrayType_=Uint32Array,this.buffer_=new this.ArrayType_(this.buffer_))}this.position_===this.size_&&this.expand_(),this.buffer_[this.position_]=l,this.position_+=1}}},{key:"end",value:function(){if(0===this.position_)return!1;var l=this.buffer_,h=this.position_;return this.buffer_=new this.ArrayType_(this.size_),this.position_=0,this.overflows_=!1,l.subarray(0,h)}},{key:"expand_",value:function(){this.size_=this.size_<<1;var l=new this.ArrayType_(this.size_);l.set(this.buffer_),this.buffer_=l}}]),s}();iO.setElementIndexUint=function(s){rO=s};var oO=(OA(_T={},C0.FLOAT,Float32Array),OA(_T,C0.BYTE,Int8Array),OA(_T,C0.UNSIGNED_BYTE,Uint8Array),OA(_T,C0.INT,Int32Array),OA(_T,C0.UNSIGNED_INT,Uint32Array),OA(_T,C0.SHORT,Int16Array),OA(_T,C0.UNSIGNED_SHORT,Uint16Array),_T),eM=function(){function s(l){var h=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).prealloc,g=void 0===h?500:h;D0(this,s),this.vertex_layout=l,this.vertex_elements=new iO,this.stride=this.vertex_layout.stride,0<s.array_pool.length?(this.vertex_buffer=s.array_pool.pop(),this.byte_length=this.vertex_buffer.byteLength,this.size=Math.floor(this.byte_length/this.stride),$y("trace","VertexData: reused buffer of bytes ".concat(this.byte_length,", ").concat(this.size," vertices"))):(this.size=g,this.byte_length=this.stride*this.size,this.vertex_buffer=new Uint8Array(this.byte_length)),this.offset=0,this.vertex_count=0,this.realloc_count=0,this.setBufferViews(),this.setAddVertexFunction()}return T0(s,[{key:"setBufferViews",value:function(){var l=this;this.views={},this.views[C0.UNSIGNED_BYTE]=this.vertex_buffer,this.vertex_layout.dynamic_attribs.forEach(function(h){null==l.views[h.type]&&(l.views[h.type]=new(0,oO[h.type])(l.vertex_buffer.buffer))})}},{key:"checkBufferSize",value:function(){var l;this.offset+this.stride>this.byte_length&&(this.size=Math.floor(1.5*this.size),this.size-=this.size%4,this.byte_length=this.stride*this.size,(l=new Uint8Array(this.byte_length)).set(this.vertex_buffer),s.array_pool.push(this.vertex_buffer),this.vertex_buffer=l,this.setBufferViews(),this.realloc_count++)}},{key:"setAddVertexFunction",value:function(){this.vertexLayoutAddVertex=this.vertex_layout.getAddVertexFunction()}},{key:"addVertex",value:function(l){this.checkBufferSize(),this.vertexLayoutAddVertex(l,this.views,this.offset),this.offset+=this.stride,this.vertex_count++}},{key:"end",value:function(){return this.vertex_buffer=this.vertex_buffer.subarray(0,this.offset),this.element_buffer=this.vertex_elements.end(),$y("trace","VertexData: ".concat(this.size," vertices total, realloc count ").concat(this.realloc_count)),this}}]),s}();eM.array_pool=[];var bT=function(){function s(l){D0(this,s),this.attribs=l,this.dynamic_attribs=this.attribs.filter(function(Ye){return!Ye.static}),this.components=[],this.index={},this.offset={};for(var h=this.stride=0,g=0,_=0;_<this.attribs.length;_++){var A=this.attribs[_];if(null==A.static){A.offset=this.stride,A.byte_size=A.size;var j=0;switch(A.type){case C0.FLOAT:case C0.INT:case C0.UNSIGNED_INT:A.byte_size*=4,j=2;break;case C0.SHORT:case C0.UNSIGNED_SHORT:A.byte_size*=2,j=1}3&A.byte_size&&(A.byte_size+=4-(3&A.byte_size)),this.stride+=A.byte_size;for(var $=A.offset>>j,_t=0;_t<A.size;_t++)this.components.push({type:A.type,shift:j,offset:$++,index:g++});this.index[A.name]=h,h+=A.size,this.offset[A.name]=A.offset}else A.static=Array.isArray(A.static)?A.static:[A.static],A.method="vertexAttrib".concat(A.static.length,"fv")}}return T0(s,[{key:"enable",value:function(l,h,g){for(var _,A,j=0;j<this.attribs.length;j++)-1!==(A=h.attribute((_=this.attribs[j]).name).location)&&(null==_.static?(s.enabled_attribs[A]&&!g||l.enableVertexAttribArray(A),l.vertexAttribPointer(A,_.size,_.type,_.normalized,this.stride,_.offset),s.enabled_attribs[A]=h):l[_.method]instanceof Function&&(l.enableVertexAttribArray(A),l[_.method](A,_.static),l.disableVertexAttribArray(A),delete s.enabled_attribs[A]));for(A in s.enabled_attribs)this.disableUnusedAttribute(l,A,h)}},{key:"disableUnusedAttribute",value:function(l,h,g){s.enabled_attribs[h]!==g&&(l.disableVertexAttribArray(h),delete s.enabled_attribs[h])}},{key:"createVertexData",value:function(){return new eM(this)}},{key:"getAddVertexFunction",value:function(){return null==this.addVertex&&this.createAddVertexFunction(),this.addVertex}},{key:"createAddVertexFunction",value:function(){var l=II(JSON.stringify(this.attribs));if(null==s.add_vertex_funcs[l]){var h,g=["var t, o;"],_=A_(this.components);_.sort(function(_t,Ye){return _t.type!==Ye.type?_t.type-Ye.type:_t.index-Ye.index});for(var A=0;A<_.length;A++){var j=_[A];h!==j.type&&(g.push("t = vs[".concat(j.type,"];")),g.push("o = off".concat(j.shift?" >> "+j.shift:"",";")),h=j.type),g.push("t[o + ".concat(j.offset,"] = v[").concat(j.index,"];"))}g=g.join("\n");var $=new Function("v","vs","off",g);s.add_vertex_funcs[l]=$}this.addVertex=s.add_vertex_funcs[l]}}]),s}();bT.enabled_attribs={},bT.add_vertex_funcs={};var DD=[{x:0,y:0},{x:My.tile_scale,y:-My.tile_scale}],f2=[0,0,1,1];function uA(s,l,h){var g=DD[0],_=DD[1];return s[0]<=g.x+h&&l[0]<=g.x+h||s[0]>=_.x-h&&l[0]>=_.x-h||s[1]>=g.y-h&&l[1]>=g.y-h||s[1]<=_.y+h&&l[1]<=_.y+h}function wT(s,l){var h=DD[0],g=DD[1];return s[0]<=h.x+(l=l||0)||s[0]>=g.x-l||s[1]>=h.y-l||s[1]<=g.y+l}var YN=SD;function SD(s,l,h){h=h||2;var g,_,A,j,$,_t,Ye,_i=l&&l.length,_s=_i?l[0]*h:s.length,Ja=nM(s,0,_s,h,!0),_l=[];if(!Ja)return _l;if(_i&&(Ja=function(_p,ka,ty,ny){var ry,ly,fy,Iy,Sy,Dy,_y=[];for(ry=0,ly=ka.length;ry<ly;ry++)(fy=nM(_p,ka[ry]*ny,ry<ly-1?ka[ry+1]*ny:_p.length,ny,!1))===fy.next&&(fy.steiner=!0),_y.push(function(Iy){for(var Sy=Iy,Dy=Iy;Sy.x<Dy.x&&(Dy=Sy),(Sy=Sy.next)!==Iy;);return Dy}(fy));for(_y.sort(d2),ry=0;ry<_y.length;ry++)Dy=void 0,(Sy=function(Ny,r0){var Vy,Yy=r0,S0=Ny.x,o_=Ny.y,$0=-1/0;do{if(o_<=Yy.y&&o_>=Yy.next.y){var Q0=Yy.x+(o_-Yy.y)*(Yy.next.x-Yy.x)/(Yy.next.y-Yy.y);if(Q0<=S0&&$0<Q0){if(($0=Q0)===S0){if(o_===Yy.y)return Yy;if(o_===Yy.next.y)return Yy.next}Vy=Yy.x<Yy.next.x?Yy:Yy.next}}Yy=Yy.next}while(Yy!==r0);if(!Vy)return null;if(S0===$0)return Vy.prev;var d_,Y_=Vy,r1=Vy.x,t_=Vy.y,C_=1/0;for(Yy=Vy.next;Yy!==Y_;)S0>=Yy.x&&Yy.x>=r1&&ID(o_<t_?S0:$0,o_,r1,t_,o_<t_?$0:S0,o_,Yy.x,Yy.y)&&((d_=Math.abs(o_-Yy.y)/(S0-Yy.x))<C_||d_===C_&&Yy.x>Vy.x)&&kD(Yy,Ny)&&(Vy=Yy,C_=d_),Yy=Yy.next;return Vy}(Iy=_y[ry],Sy=ty))&&p2(Dy=ZN(Sy,Iy),Dy.next),ty=p2(ty,ty.next);return ty}(s,l,Ja,h)),s.length>80*h){g=A=s[0],_=j=s[1];for(var lc=h;lc<_s;lc+=h)($=s[lc])<g&&(g=$),(_t=s[lc+1])<_&&(_=_t),A<$&&(A=$),j<_t&&(j=_t);Ye=Math.max(A-g,j-_)}return rM(Ja,_l,h,g,_,Ye),_l}function nM(s,l,h,g,_){var A,j;if(_===0<iM(s,l,h,g))for(A=l;A<h;A+=g)j=XN(A,s[A],s[A+1],j);else for(A=h-g;l<=A;A-=g)j=XN(A,s[A],s[A+1],j);return j&&xT(j,j.next)&&(OD(j),j=j.next),j}function p2(s,l){if(!s)return s;l=l||s;var h,g=s;do{if(h=!1,g.steiner||!xT(g,g.next)&&0!==Cx(g.prev,g,g.next))g=g.next;else{if(OD(g),(g=l=g.prev)===g.next)return null;h=!0}}while(h||g!==l);return l}function rM(s,l,h,g,_,A,j){if(s){!j&&A&&function(_i,_s,Ja,_l){for(var lc=_i;null===lc.z&&(lc.z=MD(lc.x,lc.y,_s,Ja,_l)),lc.prevZ=lc.prev,lc.nextZ=lc.next,(lc=lc.next)!==_i;);lc.prevZ.nextZ=null,lc.prevZ=null,function(_p){var ka,ty,ny,ry,ly,ey,hy,fy,_y=1;do{for(ty=_p,ly=_p=null,ey=0;ty;){for(ey++,ny=ty,ka=hy=0;ka<_y&&(hy++,ny=ny.nextZ);ka++);for(fy=_y;0<hy||0<fy&&ny;)0!==hy&&(0===fy||!ny||ty.z<=ny.z)?(ty=(ry=ty).nextZ,hy--):(ny=(ry=ny).nextZ,fy--),ly?ly.nextZ=ry:_p=ry,ry.prevZ=ly,ly=ry;ty=ny}ly.nextZ=null,_y*=2}while(1<ey)}(lc)}(s,g,_,A);for(var $,_t,Ye=s;s.prev!==s.next;)if($=s.prev,_t=s.next,A?function(_i,_s,Ja,_l){var lc=_i.prev,_p=_i,ka=_i.next;if(0<=Cx(lc,_p,ka))return!1;for(var ry=lc.x>_p.x?lc.x>ka.x?lc.x:ka.x:_p.x>ka.x?_p.x:ka.x,ly=lc.y>_p.y?lc.y>ka.y?lc.y:ka.y:_p.y>ka.y?_p.y:ka.y,ey=MD(lc.x<_p.x?lc.x<ka.x?lc.x:ka.x:_p.x<ka.x?_p.x:ka.x,lc.y<_p.y?lc.y<ka.y?lc.y:ka.y:_p.y<ka.y?_p.y:ka.y,_s,Ja,_l),hy=MD(ry,ly,_s,Ja,_l),fy=_i.nextZ;fy&&fy.z<=hy;){if(fy!==_i.prev&&fy!==_i.next&&ID(lc.x,lc.y,_p.x,_p.y,ka.x,ka.y,fy.x,fy.y)&&0<=Cx(fy.prev,fy,fy.next))return!1;fy=fy.nextZ}for(fy=_i.prevZ;fy&&fy.z>=ey;){if(fy!==_i.prev&&fy!==_i.next&&ID(lc.x,lc.y,_p.x,_p.y,ka.x,ka.y,fy.x,fy.y)&&0<=Cx(fy.prev,fy,fy.next))return!1;fy=fy.prevZ}return!0}(s,g,_,A):function(_i){var _s=_i.prev,Ja=_i,_l=_i.next;if(0<=Cx(_s,Ja,_l))return!1;for(var lc=_i.next.next;lc!==_i.prev;){if(ID(_s.x,_s.y,Ja.x,Ja.y,_l.x,_l.y,lc.x,lc.y)&&0<=Cx(lc.prev,lc,lc.next))return!1;lc=lc.next}return!0}(s))l.push($.i/h),l.push(s.i/h),l.push(_t.i/h),OD(s),s=_t.next,Ye=_t.next;else if((s=_t)===Ye){j?1===j?rM(s=function(_i,_s,Ja){var _l=_i;do{var lc=_l.prev,_p=_l.next.next;!xT(lc,_p)&&KN(lc,_l,_l.next,_p)&&kD(lc,_p)&&kD(_p,lc)&&(_s.push(lc.i/Ja),_s.push(_l.i/Ja),_s.push(_p.i/Ja),OD(_l),OD(_l.next),_l=_i=_p),_l=_l.next}while(_l!==_i);return _l}(s,l,h),l,h,g,_,A,2):2===j&&function(_i,_s,Ja,_l,lc,_p){var ry,ly,ka=_i;do{for(var ty=ka.next.next;ty!==ka.prev;){if(ka.i!==ty.i&&(ry=ka).next.i!==(ly=ty).i&&ry.prev.i!==ly.i&&!function(ey,hy){var fy=ey;do{if(fy.i!==ey.i&&fy.next.i!==ey.i&&fy.i!==hy.i&&fy.next.i!==hy.i&&KN(fy,fy.next,ey,hy))return!0;fy=fy.next}while(fy!==ey);return!1}(ry,ly)&&kD(ry,ly)&&kD(ly,ry)&&function(ey,hy){for(var fy=ey,_y=!1,Iy=(ey.x+hy.x)/2,Sy=(ey.y+hy.y)/2;fy.y>Sy!=fy.next.y>Sy&&Iy<(fy.next.x-fy.x)*(Sy-fy.y)/(fy.next.y-fy.y)+fy.x&&(_y=!_y),(fy=fy.next)!==ey;);return _y}(ry,ly)){var ny=ZN(ka,ty);return ka=p2(ka,ka.next),ny=p2(ny,ny.next),rM(ka,_s,Ja,_l,lc,_p),rM(ny,_s,Ja,_l,lc,_p)}ty=ty.next}ka=ka.next}while(ka!==_i)}(s,l,h,g,_,A):rM(p2(s),l,h,g,_,A,1);break}}}function d2(s,l){return s.x-l.x}function MD(s,l,h,g,_){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-h)/_)|s<<8))|s<<4))|s<<2))|s<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-g)/_)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function ID(s,l,h,g,_,A,j,$){return 0<=(_-j)*(l-$)-(s-j)*(A-$)&&0<=(s-j)*(g-$)-(h-j)*(l-$)&&0<=(h-j)*(A-$)-(_-j)*(g-$)}function Cx(s,l,h){return(l.y-s.y)*(h.x-l.x)-(l.x-s.x)*(h.y-l.y)}function xT(s,l){return s.x===l.x&&s.y===l.y}function KN(s,l,h,g){return xT(s,l)&&xT(h,g)||xT(s,g)&&xT(h,l)||0<Cx(s,l,h)!=0<Cx(s,l,g)&&0<Cx(h,g,s)!=0<Cx(h,g,l)}function kD(s,l){return Cx(s.prev,s,s.next)<0?0<=Cx(s,l,s.next)&&0<=Cx(s,s.prev,l):Cx(s,l,s.prev)<0||Cx(s,s.next,l)<0}function ZN(s,l){var h=new sO(s.i,s.x,s.y),g=new sO(l.i,l.x,l.y),_=s.next,A=l.prev;return(s.next=l).prev=s,(h.next=_).prev=h,(g.next=h).prev=g,(A.next=g).prev=A,g}function XN(s,l,h,g){var _=new sO(s,l,h);return g?(_.next=g.next,(_.prev=g).next.prev=_,g.next=_):(_.prev=_).next=_,_}function OD(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function sO(s,l,h){this.i=s,this.x=l,this.y=h,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iM(s,l,h,g){for(var _=0,A=l,j=h-g;A<h;A+=g)_+=(s[j]-s[A])*(s[A+1]+s[j+1]),j=A;return _}SD.deviation=function(s,l,h,g){var _=l&&l.length,j=Math.abs(iM(s,0,_?l[0]*h:s.length,h));if(_)for(var $=0,_t=l.length;$<_t;$++)j-=Math.abs(iM(s,l[$]*h,$<_t-1?l[$+1]*h:s.length,h));var _s=0;for($=0;$<g.length;$+=3){var Ja=g[$]*h,_l=g[$+1]*h,lc=g[$+2]*h;_s+=Math.abs((s[Ja]-s[lc])*(s[1+_l]-s[1+Ja])-(s[Ja]-s[_l])*(s[1+lc]-s[1+Ja]))}return 0===j&&0===_s?0:Math.abs((_s-j)/j)},SD.flatten=function(s){for(var l=s[0][0].length,h={vertices:[],holes:[],dimensions:l},g=0,_=0;_<s.length;_++){for(var A=0;A<s[_].length;A++)for(var j=0;j<l;j++)h.vertices.push(s[_][A][j]);0<_&&h.holes.push(g+=s[_-1].length)}return h};var aO=[0,0,1];function uO(s,l,h,g){var _,A,j,$,_t,Ye=g.texcoord_index,_s=g.texcoord_normalize,Ja=l.vertex_elements;Ye&&(_s=_s||1,A=(_=A0(g.texcoord_scale||f2,4))[0],j=_[1],$=_[2],_t=_[3]);for(var _l,lc=0,_p=s.length,ka=0;ka<_p;ka++){var ty,ny,ry,ly,ey,hy=l.vertex_count,fy=s[ka];Ye&&(ny=(ty=A0(My.findBoundingBox(fy),4))[0],ly=($-A)/(ty[2]-ny),ey=(_t-j)/(ty[3]-(ry=ty[1])));for(var _y=0;_y<fy.length;_y++)for(var Iy=fy[_y],Sy=0;Sy<Iy.length;Sy++){var Dy=Iy[Sy];h[0]=Dy[0],h[1]=Dy[1],Ye&&(h[Ye+0]=((Dy[0]-ny)*ly+A)*_s,h[Ye+1]=((Dy[1]-ry)*ey+j)*_s),l.addVertex(h)}for(var Ny=(_l=YN.flatten(fy),YN(_l.vertices,_l.holes,_l.dimensions)),r0=0;r0<Ny.length;r0++)Ja.push(hy+Ny[r0]);lc+=Ny.length/3}return lc}var oM="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;attribute vec4 a_position;attribute vec4 a_color;\n#ifdef TANGRAM_NORMAL_ATTRIBUTE\nattribute vec3 a_normal;\n#define TANGRAM_NORMAL a_normal\n#else\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nattribute vec2 a_extrude;attribute vec2 a_offset;attribute vec2 a_scaling;uniform float u_v_scale_adjust;\n#endif\nvarying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nattribute vec2 a_texcoord;varying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvoid main(){\n#pragma tangram: setup\n#ifdef TANGRAM_TEXTURE_COORDS\nv_texcoord=a_texcoord;\n#ifdef TANGRAM_EXTRUDE_LINES\nv_texcoord.y*=u_v_scale_adjust;\n#endif\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nvec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.);\n#ifdef TANGRAM_EXTRUDE_LINES\nvec2 extrude=a_extrude.xy;vec2 offset=a_offset.xy;float dz=clamp(u_map_position.z-u_tile_origin.z,0.,4.);dz+=step(1.,dz)*(1.-dz)+mix(0.,2.,clamp((dz-2.)/2.,0.,1.));float mdz=(dz-0.5)*2.;extrude-=extrude*UNPACK_SCALING(a_scaling.x)*mdz;float dwdz=UNPACK_SCALING(a_scaling.y);float sdwdz=sign(step(0.,dwdz)-0.5);offset-=offset*abs(dwdz)*((1.-step(0.,sdwdz))-(dz*-sdwdz));float ssz=exp2(-dz-(u_tile_origin.z-u_tile_origin.w));extrude*=ssz;offset*=ssz;\n#ifdef TANGRAM_BLOCK_WIDTH\nfloat width=1.;\n#pragma tangram: width\nextrude*=width;\n#endif\nposition.xy+=extrude+offset;\n#endif\nv_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);v_color=a_color;\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#if defined(SNAP_TO_PIXEL_GRID)\nsnapToPixelGrid(position);\n#endif\ngl_Position=position;}",JN="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_EXTRUDE_LINES\nuniform bool u_has_line_texture;uniform sampler2D u_texture;uniform float u_texture_ratio;uniform vec4 u_dash_background_color;\n#endif\n#define TANGRAM_NORMAL v_normal\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nvarying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#pragma tangram: utils\nvoid main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_COLOR\ncolor*=sampleRaster();\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nif(u_has_line_texture){vec2 _line_st=vec2(v_texcoord.x,fract(v_texcoord.y/u_texture_ratio));vec4 _line_color=texture2D(u_texture,_line_st);if(_line_color.a<TANGRAM_ALPHA_TEST){\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY)\nif(u_dash_background_color.a==0.){discard;}color=u_dash_background_color;\n#else\ncolor=vec4(u_dash_background_color.rgb,color.a*step(TANGRAM_EPSILON,u_dash_background_color.a));\n#endif\n}else{color*=_line_color;}}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_NORMAL\nnormal=normalize(sampleRaster().rgb*2.-1.);\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\ngl_FragColor=color;}",g2=Object.create(W_);Object.assign(g2,{name:"polygons",built_in:!0,vertex_shader_src:oM,fragment_shader_src:JN,selection:!0,init:function(){W_.init.apply(this,arguments),this.defines.TANGRAM_NORMAL_ATTRIBUTE=!0,this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.texcoords&&(this.defines.TANGRAM_TEXTURE_COORDS=!0)},vertexLayoutForMeshVariant:function(){var s;return this.vertex_layout||(s=[{name:"a_position",size:4,type:C0.SHORT,normalized:!1},{name:"a_normal",size:3,type:C0.BYTE,normalized:!0},{name:"a_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0}],this.texcoords&&s.push({name:"a_texcoord",size:2,type:C0.UNSIGNED_SHORT,normalized:!0}),this.vertex_layout=new bT(s)),this.vertex_layout},_parseFeature:function(s,l,h){var g=this.feature_style;return g.color=this.parseColor(l.color,h),g.color?(g.z=l.z&&by.evalCachedDistanceProperty(l.z,h)||by.defaults.z,g.z*=My.height_scale,g.extrude=by.evalProperty(l.extrude,h),g.extrude&&(!0===g.extrude?(g.height=void 0!==s.properties.height?s.properties.height:by.defaults.height,g.min_height=void 0!==s.properties.min_height?s.properties.min_height:by.defaults.min_height):"number"==typeof g.extrude?(g.height=g.extrude,g.min_height=0):Array.isArray(g.extrude)&&(g.min_height=g.extrude[0],g.height=g.extrude[1]),g.height*=My.height_scale,g.min_height*=My.height_scale),g.tile_edges=l.tile_edges,g):null},_preprocess:function(s){return s.color=by.createColorPropertyCache(s.color),s.z=by.createPropertyCache(s.z,by.parseUnits),s},makeVertexTemplate:function(s){var l=0;return this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=s.z||0,this.vertex_template[l++]=this.scaleOrder(s.order),this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=127,this.vertex_template[l++]=255*s.color[0],this.vertex_template[l++]=255*s.color[1],this.vertex_template[l++]=255*s.color[2],this.vertex_template[l++]=255*s.color[3],this.selection&&(this.vertex_template[l++]=255*s.selection_color[0],this.vertex_template[l++]=255*s.selection_color[1],this.vertex_template[l++]=255*s.selection_color[2],this.vertex_template[l++]=255*s.selection_color[3]),this.texcoords&&(this.vertex_template[l++]=0,this.vertex_template[l++]=0),this.vertex_template},buildPolygons:function(s,l,h,g){var _=this.makeVertexTemplate(l),A={texcoord_index:this.vertex_layout.index.a_texcoord,texcoord_normalize:65535,remove_tile_edges:!l.tile_edges,tile_edge_tolerance:My.tile_scale*g.tile.pad_scale*4,winding:g.winding};return l.extrude&&l.height?function(j,$,_t,Ye,_i,_s,Ja,_l,lc){var _p=lc.remove_tile_edges,ka=lc.tile_edge_tolerance,ty=lc.texcoord_index,ny=lc.texcoord_scale,ry=lc.texcoord_normalize,ly=lc.winding,ey=$+(Ye||0),hy=$+_t;_s[2]=hy;var fy,_y,Iy,Sy,Dy,Ny,r0=uO(j,_i,_s,{texcoord_index:ty,texcoord_scale:ny,texcoord_normalize:ry}),Vy=_i.vertex_elements,Yy=_i.vertex_count;ty&&(ry=ry||1,Ny=[[_y=(fy=A0(ny||f2,4))[0],Dy=fy[3]],[_y,Iy=fy[1]],[Sy=fy[2],Iy],[Sy,Dy]]);for(var S0=j.length,o_=0;o_<S0;o_++)for(var $0=j[o_],Q0=0;Q0<$0.length;Q0++)for(var d_=$0[Q0],Y_=0;Y_<d_.length-1;Y_++)if(!_p||!uA(d_[Y_],d_[Y_+1],ka)){var t_,r1=void 0,C_=[[d_[t_="CCW"===ly?(r1=Y_)+1:(r1=Y_+1,Y_)][0],d_[t_][1],hy],[d_[t_][0],d_[t_][1],ey],[d_[r1][0],d_[r1][1],ey],[d_[r1][0],d_[r1][1],hy]],Ix=l0.normalize([d_[t_][0]-d_[r1][0],d_[t_][1]-d_[r1][1],0]),H1=l0.cross(aO,Ix);_s[Ja+0]=127*H1[0],_s[Ja+1]=127*H1[1],_s[Ja+2]=127*H1[2];for(var px=0;px<C_.length;px++)_s[0]=C_[px][0],_s[1]=C_[px][1],_s[2]=C_[px][2],ty&&(_s[ty+0]=Ny[px][0]*ry,_s[ty+1]=Ny[px][1]*ry),_i.addVertex(_s);Vy.push(Yy+0),Vy.push(Yy+1),Vy.push(Yy+2),Vy.push(Yy+2),Vy.push(Yy+3),Vy.push(Yy+0),Yy+=4,r0+=2}return r0}(s,l.z,l.height,l.min_height,h.vertex_data,_,this.vertex_layout.index.a_normal,0,A):uO(s,h.vertex_data,_,A)}});var QN=[0,0],XA={butt:0,square:1,round:2},Xb={miter:0,bevel:1,round:2},tP=My.tile_scale,JA=[0,0],m2=[1,0],v2=[.5,0];function eP(s,l){if(!(s.length<2)){var h,g,_=l.join_type,A=l.cap_type,j=l.closed_polygon,$=l.remove_tile_edges,_t=l.tile_edge_tolerance,Ye=l.v_scale,_i=l.miter_len_sq,_s=l.crop_by_tile,Ja=null!=l.texcoord_index,_l=0;if(j&&_===Xb.miter){var lc=function(Sy){if(wT(Sy[0]))return 0;for(var Dy=0;Dy<Sy.length;Dy++)if(wT(Sy[Sy.length-1-Dy]))return Sy.length-1-Dy;return 0}(s);if(0!==lc){var _p=function(Sy,Dy){for(var Ny=[],r0=0;r0<Sy.length;r0++){var Vy=(r0+Dy)%Sy.length;0!=Vy&&Ny.push(Sy[Vy])}return Ny.push(Ny[0]),Ny}(s,lc);return l.extra_lines=l.extra_lines||[],void l.extra_lines.push(_p)}}var ka=0,ty=s.length-1,ny=0;for(fy=s[ka],_y=s[ka+1];l0.isEqual(fy,_y);)if(fy=_y,_y=s[1+ ++ka],ny++,ka===s.length-1)return;for(;l0.isEqual(s[ty],s[ty-1]);)if(ny++,0==--ty)return;if(!(s.length<2+ny))if(g=l0.normalize(l0.perp(fy,_y)),$&&uA(fy,_y,_t)){var ry=lO(s,ka,_t);ry&&(l.extra_lines=l.extra_lines||[],l.extra_lines.push(ry))}else{j?(Sy=fy,Dy=h=l0.normalize(l0.perp(s[ty-1],fy)),Ny=g,Vy=l,void 0===(r0=_)||wT(Sy)&&!Vy.crop_by_tile?(m_(Sy,Ny,Ny,1,0,Vy,1),m_(Sy,Ny,Ny,0,0,Vy,-1)):r0===Xb.miter?cO(0,Sy,Dy,Ny,Vy.miter_len_sq,!0,Vy):RD(r0,0,Sy,Dy,Ny,!0,Vy)):(!_s&&wT(fy)||(uM(fy,_l,g,A,!0,l),Ja&&A!==XA.butt&&(_l+=.5*Ye*l.texcoord_width)),m_(fy,g,g,1,_l,l,1),m_(fy,g,g,0,_l,l,-1)),Ja&&(_l+=Ye*l0.length(l0.sub(_y,fy)));for(var ly=ka+1;ly<ty;ly++){var ey=ly,fy=s[ey],_y=s[ly+1];if(!l0.isEqual(fy,_y)){if($&&uA(fy,_y,_t)){m_(fy,g,g,1,_l,l,1),m_(fy,g,g,0,_l,l,-1),lA(1,l);var Iy=lO(s,ey+1,_t);return void(Iy&&(l.extra_lines=l.extra_lines||[],l.extra_lines.push(Iy)))}h=g,g=l0.normalize(l0.perp(fy,_y)),_===Xb.miter?cO(_l,fy,h,g,_i,!1,l):RD(_,_l,fy,h,g,!1,l),Ja&&(_l+=Ye*l0.length(l0.sub(_y,fy)))}}fy=_y,h=g,j?function(Sy,Dy,Ny,r0,Vy,Yy){var S0;wT(Sy)&&!Yy.crop_by_tile?(m_(Sy,Dy,Dy,1,Vy,Yy,1),m_(Sy,Dy,Dy,0,Vy,Yy,-1)):(S0=sM(Dy,Ny),r0===Xb.miter&&l0.lengthSq(S0)>Yy.miter_len_sq&&(r0=Xb.bevel),r0===Xb.miter?(m_(Sy,S0,Dy,1,Vy,Yy,1),m_(Sy,S0,Dy,0,Vy,Yy,-1)):(m_(Sy,Dy,Dy,1,Vy,Yy,1),m_(Sy,Dy,Dy,0,Vy,Yy,-1))),lA(1,Yy)}(fy,h,g=l0.normalize(l0.perp(fy,s[1])),_,_l,l):(m_(fy,h,g,1,_l,l,1),m_(fy,h,g,0,_l,l,-1),lA(1,l),!_s&&wT(fy)||uM(fy,_l,h,A,!1,l))}}var Sy,Dy,Ny,r0,Vy}function lO(s,l,h){for(var g=l;s[g+1]&&uA(s[g],s[g+1],h);)g++;return 2<=s.length-g&&s.slice(g)}function sM(s,l){var h=l0.normalize(l0.add(s,l)),g=2/(1+Math.abs(l0.dot(s,h)));return l0.mult(h,g*g)}function cO(s,l,h,g,_,A,j){var $=sM(h,g);l0.lengthSq($)>_?RD(Xb.bevel,s,l,h,g,A,j):(m_(l,$,$,1,s,j,1),m_(l,$,$,0,s,j,-1),A||lA(1,j))}function RD(s,l,h,g,_,A,j){var $=sM(g,_),_t=0<_[0]*g[1]-_[1]*g[0];null!=j.texcoord_index&&(JA[1]=l,m2[1]=l),_t?(m_(h,$,$,1,l,j,1),m_(h,g,$,0,l,j,-1),A||lA(1,j),aM(h,l0.neg(g),$,l0.neg(_),$,JA,m2,JA,!1,s===Xb.bevel,j),m_(h,$,$,1,l,j,1),m_(h,_,$,0,l,j,-1)):(m_(h,g,$,1,l,j,1),m_(h,$,$,0,l,j,-1),A||lA(1,j),aM(h,g,l0.neg($),_,$,m2,JA,m2,!1,s===Xb.bevel,j),m_(h,_,$,1,l,j,1),m_(h,$,$,0,l,j,-1))}function lA(s,l){for(var h=l.vertex_data.vertex_elements,g=l.vertex_data.vertex_count-2*s-2,_=0;_<s;_++)h.push(g+2*_+2),h.push(g+2*_+1),h.push(g+2*_),h.push(g+2*_+2),h.push(g+2*_+3),h.push(g+2*_+1),l.geom_count+=2}function m_(s,l,h,g,_,A,j){var $=A.vertex_template,_t=A.vertex_data;$[0]=s[0],$[1]=s[1];var Ye=A.half_width*j;$[A.extrude_index+0]=l[0]*Ye,$[A.extrude_index+1]=l[1]*Ye,A.offset&&($[A.offset_index+0]=h[0]*A.offset,$[A.offset_index+1]=h[1]*A.offset),null!=A.texcoord_index&&($[A.texcoord_index+0]=g*A.texcoord_normalize,$[A.texcoord_index+1]=_*A.texcoord_normalize),_t.addVertex($)}var JE=[0,0];function aM(s,l,h,g,_,A,j,$,_t,Ye,_i){for(var _s=l[0]*g[1]-l[1]*g[0],Ja=l0.dot(l,g),_l=Math.atan2(_s,Ja);_l>=Math.PI;)_l-=2*Math.PI;if(Ye)lc=1;else{var lc=function(Sy,Dy){Sy<0&&(Sy=-Sy);var Ny=Dy>10?Math.log2(Dy/5):1;return Math.ceil(Sy/Math.PI*Ny)}(_l,_i.half_width);if(lc<1)return}var _p=_i.vertex_data.vertex_count,ka=_i.vertex_data.vertex_elements;m_(s,h,_,j[0],j[1],_i,1),m_(s,l,_,A[0],A[1],_i,1);var ty,ny,ry=l,ly=null!=_i.texcoord_index;ly&&(_t?ty=l0.sub(A,j):(JE=l0.copy(A),ny=l0.div(l0.sub($,A),lc)));for(var ey,hy=_l/lc,fy=_l<0?-1:1,_y=0<_s?(ey=2,1):(ey=1,2),Iy=0;Iy<lc;Iy++)0===Iy&&_l<0&&(ry=l0.neg(ry)),ry=l0.rot(ry,hy),ly&&(_t?(ty=l0.rot(ty,hy),JE[0]=ty[0]+j[0],JE[1]=ty[1]*_i.texcoord_width*_i.v_scale+j[1]):JE=l0.add(JE,ny)),m_(s,ry,_,JE[0],JE[1],_i,fy),ka.push(_p+Iy+ey),ka.push(_p),ka.push(_p+Iy+_y)}function uM(s,l,h,g,_,A){var j,$=l0.neg(h),_t=null!=A.texcoord_index;switch(g){case XA.square:_?(m_(s,l0.add(h,j=[h[1],-h[0]]),h,1,l,A,1),m_(s,l0.add($,j),h,0,l,A,1),_t&&(l+=.5*A.texcoord_width*A.v_scale),m_(s,h,h,1,l,A,1),m_(s,$,h,0,l,A,1)):(j=[-h[1],h[0]],m_(s,h,h,1,l,A,1),m_(s,$,h,0,l,A,1),_t&&(l+=.5*A.texcoord_width*A.v_scale),m_(s,l0.add(h,j),h,1,l,A,1),m_(s,l0.add($,j),h,0,l,A,1)),lA(1,A);break;case XA.round:var Ye,_i,_s=JA,Ja=m2,_l=v2;_?(Ye=h,_i=$,_t&&(l+=.5*A.texcoord_width*A.v_scale,_s=m2,Ja=JA,_l=v2)):(Ye=$,_i=h),_t&&(JA[1]=l,m2[1]=l,v2[1]=l),aM(s,Ye,QN,_i,h,_s,_l,Ja,!0,!1,A);break;case XA.butt:return}}var hO=[255,255,255,255],fO=[0,0,0,0],cx=Object.create(W_);function q3(s,l,h,g,_,A){for(var j={closed:A,vertex_data:h,vertex_template:g,half_width:l/2,vertex_layout_index:_,geom_count:0},$=0,_t=s.length;$<_t;$++)!function(Ye,_i){if(!(Ye.length<2)){for(var _s=[Ye[0]],Ja=0,_l=[],lc=[],_p=1,ka=Ye.length;_p<ka;_p++){var ty,ny;Ye[_p][0]===Ye[_p-1][0]&&Ye[_p][1]===Ye[_p-1][1]||(_s.push(Ye[_p]),ty=l0.sub(Ye[_p],Ye[_p-1]),ny=l0.length(ty),_l.push(ty),lc.push([Ja,Ja+ny]),Ja+=ny)}if(!(_s.length<2)){var ry=0,ly=_l[_l.length-1],ey=_l[0],hy=_l[1],fy=[0,0];2<_s.length&&(_i.closed&&(fy[0]=l0.signedAngleBetween(ly,ey)),fy[1]=l0.signedAngleBetween(ey,hy));var _y=_s[0],Iy=lc[0];_i.closed?(vE(_y,_i,ry++,Iy,Ja,fy,[ly,ey]),vE(_y,_i,ry++,Iy,Ja,fy,[ly,ey])):(vE(_y,_i,ry++,Iy,Ja,fy,[ey,ey]),vE(_y,_i,ry++,Iy,Ja,fy,[ey,ey]));for(var Sy=1,Dy=_s.length-1;Sy<Dy;Sy++)hy=_l[Sy+1],vE(_y=_s[Sy],_i,ry++,Iy=lc[Sy-1],Ja,fy,[ly=_l[Sy-1],ey=_l[Sy]]),vE(_y,_i,ry++,Iy,Ja,fy,[ly,ey]),pO(_i),Iy=lc[Sy],fy[0]=fy[1],fy[1]=Sy!==Dy-1?l0.signedAngleBetween(ey,hy):_i.closed?l0.signedAngleBetween(ey,_l[0]):0,vE(_y,_i,ry++,Iy,Ja,fy,[ly,ey]),vE(_y,_i,ry++,Iy,Ja,fy,[ly,ey]);_y=_s[_s.length-1],Iy=lc[lc.length-1],ey=_l[_l.length-1],_i.closed?(vE(_y,_i,ry++,Iy,Ja,fy,[ey,_l[0]]),vE(_y,_i,ry++,Iy,Ja,fy,[ey,_l[0]])):(vE(_y,_i,ry++,Iy,Ja,fy,[ey,ey]),vE(_y,_i,ry++,Iy,Ja,fy,[ey,ey])),pO(_i)}}}(s[$],j);return j.geom_count}function pO(s){var l=s.vertex_data.vertex_elements,h=s.vertex_data.vertex_count-4;l.push(2+h),l.push(1+h),l.push(h),l.push(2+h),l.push(3+h),l.push(1+h),s.geom_count+=2}cx.vertex_layouts=[[],[]],cx.dash_textures={},Object.assign(cx,{name:"lines",built_in:!0,vertex_shader_src:oM,fragment_shader_src:JN,selection:!0,init:function(){W_.init.apply(this,arguments),this.styles=this.styles||{},this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_EXTRUDE_LINES=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_TEXTURE_COORDS=!0,this.outline_feature_style={},this.inline_feature_style=this.feature_style},calcDistance:function(s,l){return s&&by.evalCachedDistanceProperty(s,l)||0},calcDistanceNextZoom:function(s,l){l.zoom++;var h=this.calcDistance(s,l);return l.zoom--,h},calcWidth:function(s,l,h){var g=this.calcDistance(s.width,h);if(!(g<0)){var _,A=s.next_width?this.calcDistanceNextZoom(s.next_width,h):g/2;return!(0===g&&0===A||A<0||(l.width_unscaled=g,l.next_width_unscaled=A,s.next_width?(_=.5*(g+(A*=2)),l.width=_*h.units_per_meter_overzoom,l.width_scale=1-A/_):(l.width=g*h.units_per_meter_overzoom,l.width_scale=0),s.texcoords&&(l.texcoord_width=s.inline_texcoord_width?s.inline_texcoord_width:(l.width_unscaled||l.next_width_unscaled)*h.units_per_meter_overzoom/h.tile.overzoom2),0))}},calcOffset:function(s,l,h){var g,_;s.offset_precalc?(l.offset=s.offset_precalc,l.offset_scale=s.offset_scale_precalc):s.offset?(g=this.calcDistance(s.offset,h),s.next_offset?(_=2*this.calcDistanceNextZoom(s.next_offset,h),Math.abs(g)>=Math.abs(_)?(l.offset=g*h.units_per_meter_overzoom,l.offset_scale=0!==g?1-_/g:0):(l.offset=_*h.units_per_meter_overzoom,l.offset_scale=0!=_?-1*(1-g/_):0)):(l.offset=g*h.units_per_meter_overzoom,l.offset_scale=0)):(l.offset=0,l.offset_scale=0),by.evalProperty(s.offset_reverse,h)&&(l.offset*=-1)},_parseFeature:function(s,l,h){var g,_,A=this.feature_style;if(!1!==this.calcWidth(l,A,h)&&(this.calcOffset(l,A,h),A.color=this.parseColor(l.color,h),A.color))return A.variantKey=l.variantKey,A.z=l.z&&by.evalCachedDistanceProperty(l.z||0,h)||by.defaults.z,A.height=s.properties.height||by.defaults.height,A.extrude=by.evalProperty(l.extrude,h),A.extrude&&("number"==typeof A.extrude?A.height=A.extrude:Array.isArray(A.extrude)&&(A.height=A.extrude[1])),A.extrude&&A.height&&(A.z+=A.height),A.z*=My.height_scale,A.height*=My.height_scale,A.cap=by.evalProperty(l.cap,h),A.join=by.evalProperty(l.join,h),A.miter_limit=by.evalProperty(l.miter_limit,h),A.tile_edges=l.tile_edges,A.outline=A.outline||{width:{},next_width:{},preprocessed:!0},l.outline&&!1!==l.outline.visible&&l.outline.color&&l.outline.width?(g=2*this.calcDistance(l.outline.width,h),_=2*this.calcDistanceNextZoom(l.outline.next_width,h),0==g&&0==_||g<0||_<0?(A.outline.width.value=null,A.outline.next_width.value=null,A.outline.color=null,A.outline.inline_texcoord_width=null,A.outline.texcoords=!1):(A.outline.width.value=g+A.width_unscaled,A.outline.next_width.value=_+A.next_width_unscaled,A.outline.inline_texcoord_width=A.texcoord_width,A.outline.offset_precalc=A.offset,A.outline.offset_scale_precalc=A.offset_scale,A.outline.color=l.outline.color,A.outline.cap=l.outline.cap,A.outline.join=l.outline.join,A.outline.miter_limit=l.outline.miter_limit,A.outline.texcoords=l.outline.texcoords,A.outline.style=l.outline.style,A.outline.variantKey=l.outline.variantKey,A.outline.order=l.outline.order?this.parseOrder(l.outline.order,h):A.order,A.outline.order>A.order&&(A.outline.order=A.order),A.outline.order-=.5,A.outline.variant_order=0)):(A.outline.width.value=null,A.outline.next_width.value=null,A.outline.color=null,A.outline.inline_texcoord_width=null),A},_preprocess:function(s,l){var h,g=this.sources[l]?this.sources[l].config.uid:"";return s.color=by.createColorPropertyCache(s.color),s.width=by.createPropertyCache(s.width,by.parseUnits),s.width&&s.width.type!==by.CACHE_TYPE.STATIC&&(s.next_width=by.createPropertyCache(s.width,by.parseUnits)),s.offset=s.offset&&by.createPropertyCache(s.offset,by.parseUnits),s.offset&&s.offset.type!==by.CACHE_TYPE.STATIC&&(s.next_offset=by.createPropertyCache(s.offset,by.parseUnits)),s.z=by.createPropertyCache(s.z,by.parseUnits),s.dash=void 0!==s.dash?s.dash:this.dash,s.dash_key=s.dash&&this.dashTextureKey(s.dash,g),s.dash_background_color=void 0!==s.dash_background_color?s.dash_background_color:this.dash_background_color,s.dash_background_color=s.dash_background_color&&by.parseColor(s.dash_background_color),s.texture_merged=s.dash_key||(void 0!==s.texture?s.texture:this.texture),s.texcoords=this.texcoords||s.texture_merged?1:0,this.addMeshVariantForDraw(this.base,s),s.outline&&(s.outline.style=s.outline.style||this.name,s.outline.color=by.createColorPropertyCache(s.outline.color),s.outline.width=by.createPropertyCache(s.outline.width,by.parseUnits),s.outline.next_width=by.createPropertyCache(s.outline.width,by.parseUnits),s.outline.cap=s.outline.cap||s.cap,s.outline.join=s.outline.join||s.join,s.outline.miter_limit=s.outline.miter_limit||s.miter_limit,s.outline.offset=s.offset,(h=this.styles[s.outline.style])?(s.outline.dash=void 0!==s.outline.dash?s.outline.dash:h.dash,s.outline.texture=void 0!==s.outline.texture?s.outline.texture:h.texture,null!=s.outline.dash?(s.outline.dash_key=s.outline.dash&&this.dashTextureKey(s.outline.dash,g),s.outline.texture_merged=s.outline.dash_key):null===s.outline.dash||null!=s.outline.texture?(s.outline.dash_key=null,s.outline.texture_merged=s.outline.texture):(s.outline.dash=s.dash,s.outline.dash_key=s.outline.dash&&this.dashTextureKey(s.outline.dash,g),s.outline.texture_merged=s.outline.dash_key),s.outline.dash_background_color=void 0!==s.outline.dash_background_color?s.outline.dash_background_color:h.dash_background_color,s.outline.dash_background_color=void 0!==s.outline.dash_background_color?s.outline.dash_background_color:s.dash_background_color,s.outline.dash_background_color=s.outline.dash_background_color&&by.parseColor(s.outline.dash_background_color),s.outline.texcoords=h.texcoords||s.outline.texture_merged?1:0,this.addMeshVariantForDraw(this.base,s.outline)):($y({level:"warn",once:!0},"Layer '".concat(s.layers[s.layers.length-1],"': ")+"line 'outline' specifies non-existent draw style '".concat(s.outline.style,"' (or maybe the style is ")+"defined but is missing a 'base' or has another error), skipping outlines in layer"),s.outline=null)),s},dashTextureKey:function(s,l){return"__dash_"+l+"_"+this.scene_id+"_"+JSON.stringify(s)},getDashTexture:function(s,l){var h,g=this.dashTextureKey(s,this.sources[l].config.uid);null==cx.dash_textures[g]&&(cx.dash_textures[g]=!0,h=function(_,A){var j=1<arguments.length&&void 0!==A?A:{},$=j.dash_color||hO,_t=j.background_color||fO,Ye=_,_i=j.scale||1;Ye.length%2==1&&Array.prototype.push.apply(Ye,Ye);for(var _s=!0,Ja=[],_l=0;_l<Ye.length;_l++){for(var lc=Math.floor(Ye[_l]*_i),_p=0;_p<lc;_p++)Array.prototype.push.apply(Ja,_s?$:_t);_s=!_s}return{pixels:Ja=new Uint8Array(Ja),length:Ja.length/4}}(s,{scale:20}),this.textureManager.create(this.gl,g,{data:h.pixels,height:h.length,width:1,filtering:"nearest"}))},endData:function(s){var l=this;return W_.endData.call(this,s).then(function(h){if(h){h.uniforms.u_has_line_texture=!1,h.uniforms.u_texture=l.textureManager.default,h.uniforms.u_v_scale_adjust=My.tile_scale;var g=[];for(var _ in h.meshes)!function(A){var j,$,_t=h.meshes[A].variant;_t.texture&&((j=h.meshes[A].uniforms=h.meshes[A].uniforms||{}).u_has_line_texture=!0,j.u_texture=_t.texture,j.u_texture_ratio=1,_t.dash&&(j.u_v_scale_adjust=20*My.tile_scale,j.u_dash_background_color=_t.dash_background_color||[0,0,0,0]),_t.dash_key&&null==cx.dash_textures[_t.dash_key]&&(cx.dash_textures[_t.dash_key]=!0,_0.postMessage(l.main_thread_target+".getDashTexture",_t.dash,s.source)),null==l.textureManager.textures[_t.texture]?g.push(l.textureManager.syncTexturesToWorker([_t.texture]).then(function(Ye){var _i=Ye[_t.texture];_i&&(j.u_texture_ratio=_i.height/_i.width)})):j.u_texture_ratio=($=l.textureManager.textures[_t.texture]).height/$.width)}(_);return s.mesh_data[l.name]=h,Promise.all(g).then(function(){return h})}return h})},computeVariantForDraw:function(s){var l=s.offset?1:0;return s.dash_key&&(l+=s.dash_key,s.dash_background_color&&(l+=s.dash_background_color)),s.texture_merged&&(l+=s.texture_merged),l=II(l+="/"+s.texcoords),{key:s.variantKey=l,order:s.variant_order,offset:s.offset?1:0,texcoords:s.texcoords,texture:s.texture_merged,dash:s.dash,dash_key:s.dash_key,dash_background_color:s.dash_background_color}},vertexLayoutForMeshVariant:function(s){return null==cx.vertex_layouts[s.key]&&(cx.vertex_layouts[s.key]=new bT([{name:"a_position",size:4,type:C0.SHORT,normalized:!1},{name:"a_extrude",size:2,type:C0.SHORT,normalized:!1},{name:"a_offset",size:2,type:C0.SHORT,normalized:!1,static:s.offset?null:[0,0]},{name:"a_scaling",size:2,type:C0.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:C0.UNSIGNED_SHORT,normalized:!0,static:s.texcoords?null:[0,0]},{name:"a_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0}])),cx.vertex_layouts[s.key]},makeVertexTemplate:function(s,l){var h=0;return this.vertex_template[h++]=0,this.vertex_template[h++]=0,this.vertex_template[h++]=s.z||0,this.vertex_template[h++]=this.scaleOrder(s.order),this.vertex_template[h++]=0,this.vertex_template[h++]=0,l.variant.offset&&(this.vertex_template[h++]=0,this.vertex_template[h++]=0),this.vertex_template[h++]=1024*s.width_scale,this.vertex_template[h++]=1024*s.offset_scale,l.variant.texcoords&&(this.vertex_template[h++]=0,this.vertex_template[h++]=0),this.vertex_template[h++]=255*s.color[0],this.vertex_template[h++]=255*s.color[1],this.vertex_template[h++]=255*s.color[2],this.vertex_template[h++]=255*s.color[3],this.selection&&(this.vertex_template[h++]=255*s.selection_color[0],this.vertex_template[h++]=255*s.selection_color[1],this.vertex_template[h++]=255*s.selection_color[2],this.vertex_template[h++]=255*s.selection_color[3]),this.vertex_template},buildLines:function(s,l,h,g,_){var A;this.feature_style=this.outline_feature_style,!l.outline||null==l.outline.color||null==l.outline.width.value||(A=this.styles[l.outline.style])&&A.addFeature(g.feature,l.outline,g),this.feature_style=this.inline_feature_style;var j=h.vertex_data,$=j.vertex_layout,_t=this.makeVertexTemplate(l,h);return function(Ye,_i,_s,Ja,_l){var lc,_p,ry=_l.texcoord_index,ly=_l.texcoord_width,ey=_l.texcoord_ratio,hy=_l.texcoord_normalize,Iy=_l.join,Sy=_l.cap,Dy=_l.miter_limit,Yy=Iy?Xb[Iy]:Xb.miter;Yy===Xb.miter&&(lc=(Dy=Dy||3)*Dy),ry&&(hy=hy||1,_p=1/(ly*(ey=ey||1)*tP));for(var S0={closed_polygon:_l.closed_polygon,remove_tile_edges:_l.remove_tile_edges,tile_edge_tolerance:_l.tile_edge_tolerance,miter_len_sq:lc,join_type:Yy,cap_type:Sy?XA[Sy]:XA.butt,vertex_data:_s,vertex_template:Ja,half_width:_i/2,extrude_index:_l.extrude_index,offset_index:_l.offset_index,v_scale:_p,texcoord_index:ry,texcoord_width:ly,texcoord_normalize:hy,offset:_l.offset,geom_count:0,crop_by_tile:_l.crop_by_tile},o_=0;o_<Ye.length;o_++)eP(Ye[o_],S0);if(S0.extra_lines)for(var $0=0;$0<S0.extra_lines.length;$0++)eP(S0.extra_lines[$0],S0);return S0.geom_count}(s,l.width,j,_t,{cap:l.cap,join:l.join,miter_limit:l.miter_limit,extrude_index:$.index.a_extrude,offset_index:$.index.a_offset,texcoord_index:$.index.a_texcoord,texcoord_width:l.texcoord_width,texcoord_normalize:65535,closed_polygon:_&&_.closed_polygon,remove_tile_edges:!l.tile_edges&&_&&_.remove_tile_edges,tile_edge_tolerance:My.tile_scale*g.tile.pad_scale*2,offset:l.offset,crop_by_tile:this.crop_by_tile})},buildPolygons:function(s,l,h,g){for(var _=0,A=0;A<s.length;A++)_+=this.buildLines(s[A],l,h,g,{closed_polygon:!0,remove_tile_edges:!this.crop_by_tile});return _}});var W3=[[1,1],[1,-1],[-1,1],[-1,-1]];function vE(s,l,h,g,_,A,j){var $,_t=l.vertex_template,Ye=l.vertex_data;QE(l,"a_position",s),QE(l,"a_width",l.half_width),l.vertex_layout_index.a_barycentric&&(($=[0,0,0])[h%3]=1,QE(l,"a_barycentric",$)),QE(l,"a_tangents",j[0].concat(j[1])),QE(l,"a_segment",g),QE(l,"a_texcoord",W3[h%4]),QE(l,"a_length",_),QE(l,"a_closed",l.closed?1:0),QE(l,"a_angles",A),Ye.addVertex(_t)}function QE(s,l,h){var g=h.length,_=s.vertex_template,A=s.vertex_layout_index[l],j=0;if(g)for(;j!==g;)_[A+j]=h[j],j++;else _[A+j]=h}function dO(s,l){for(var h=s.reduce(function(Ja,_l){return Ja+_l}),g=0,_=[],A=0,j=s.length;A<=j;A+=2){var $=Math.max(1e-4,s[A%j]),_t=Math.max(1e-4,s[(A+1)%j]);_.push(g,g+$),g+=$+_t}for(var Ye=new Uint8Array(4*l),_i=0,_s=0;_s<l;_s++)!function(Ja){var _l=h*Ja/(l-1),lc=function(ny){for(var ry=ny[0],ly=0,ey=1,hy=ny.length;ey<hy;ey++)ny[ey]<ry&&(ry=ny[ly=ey]);return ly}(_.map(function(ny){return Math.abs(ny-_l)})),_p=void 0,ka=void 0,ty=lc%2==0?(_p=_l<=_[lc]?1:0,ka=_[lc],_[lc+1]):(_p=_l>_[lc]?2:0,ka=_[lc-1],_[lc]);Ye[_i++]=_[lc],Ye[_i++]=_p,Ye[_i++]=ka,Ye[_i++]=ty}(_s);return Ye}var ET=Object.create(W_),ND={round:1,"arrow-tail":2,"arrow-head":3,square:4,butt:5},TT={miter:0,round:1,bevel:2},$3=ND.round,Y3=TT.miter,RV=[0,0],nP="antialias join linecaps miter_limit dash_index dash dash_caps dash_phase".split(" ");Object.assign(ET,{name:"pattern-lines",built_in:!0,vertex_shader_src:"uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform sampler2D u_uniforms;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform vec3 u_map_position;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_index;uniform vec2 u_dash_caps;uniform float u_dash_phase;uniform float u_dash_period;attribute vec4 a_position;attribute vec4 a_color;attribute float a_width;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nattribute vec3 a_barycentric;\n#endif\nattribute vec2 a_normal;attribute float a_length;attribute vec2 a_segment;attribute vec2 a_texcoord;attribute vec2 a_angles;attribute vec4 a_tangents;attribute float a_closed;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#ifndef TANGRAM_HEIGHT_SCALE\nfloat TANGRAM_HEIGHT_SCALE=16.0;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\nconst float PI=3.141592653589793;const float THETA=15.0*PI/180.0;float cross(in vec2 v1,in vec2 v2){return v1.x*v2.y-v1.y*v2.x;}float signed_distance(in vec2 v1,in vec2 v2,in vec2 v3){return cross(v2-v1,v1-v3)/length(v2-v1);}void rotate(in vec2 v,in float angle,out vec2 result){float cosine=cos(angle);float sine=sin(angle);result=vec2(cosine*v.x-sine*v.y,sine*v.x+cosine*v.y);}void main(){\n#pragma tangram: setup\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nfloat linewidth=a_width*2.0;v_angles=a_angles;v_segment=a_segment;v_color=a_color;v_length=a_length;v_texcoord=a_texcoord;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nv_barycentric=a_barycentric;\n#endif\nv_color.a=min(linewidth,v_color.a);linewidth=max(linewidth,1.0);linewidth/=exp2(u_map_position.z-u_tile_origin.w);v_linewidth_and_closed=linewidth*(a_closed>0.0 ?-1.0 : 1.0);if(v_color.a<=0.0){gl_Position=vec4(0.0,0.0,0.0,1.0);return;}float width=ceil(1.25*u_antialias+linewidth)/2.0;vec2 t1=normalize(a_tangents.xy);vec2 t2=normalize(a_tangents.zw);float u=a_texcoord.x;u*=-1.0;float v=a_texcoord.y;vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.0);if(t1!=t2){float angle=a_texcoord.x==1.0 ? a_angles.x : a_angles.y;vec2 t=normalize(t1+t2);vec2 o=vec2(+t.y,-t.x);float segmentLength=a_segment.y-a_segment.x;float magnitude=width/cos(angle/2.0);float sqMagnitude=magnitude*magnitude;float seg1SqMagnitude=dot(a_tangents.xy,a_tangents.xy);float seg2SqMagnitude=dot(a_tangents.zw,a_tangents.zw);if((abs(magnitude)>linewidth)&&(sqMagnitude>=min(seg1SqMagnitude,seg2SqMagnitude))){if(u==1.0){o=vec2(-t2.y,+t2.x);}else{o=vec2(-t1.y,+t1.x);}magnitude=width;angle=0.0;v_angles.x=0.0;v_angles.y=0.0;}if(u_dash_index>0.0){if((abs(angle)>THETA)){position.xy+=v*width*o/cos(angle/2.0);float s=sign(angle);if(angle<0.0){if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==1.0){position.xy-=2.0*width*t1/sin(angle);u-=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==1.0){position.xy+=2.0*width*t2/sin(angle);u+=2.0*width/sin(angle);}}}else{if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==-1.0){position.xy+=2.0*width*t1/sin(angle);u+=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==-1.0){position.xy-=2.0*width*t2/sin(angle);u-=2.0*width/sin(angle);}}}}else{position.xy+=v*width*o/cos(angle/2.0);if(u==+1.0){u=v_segment.y;}else{u=v_segment.x;}}}else{position.xy+=v*o*magnitude;if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);}else{u=v_segment.x-v*width*tan(angle/2.0);}}v_joinIndicator=(segmentLength+v*width*tan(angle/2.0))/segmentLength;}else{v_joinIndicator=-1.0;vec2 o=vec2(+t1.y,-t1.x);position.xy+=v*width*o;if(u==-1.0){u=v_segment.x-width;position.xy-=width*t1;}else{u=v_segment.y+width;position.xy+=width*t2;}}vec2 t;vec2 curr=a_position.xy;if(a_texcoord.x>=0.0){vec2 next=curr+t2*(v_segment.y-v_segment.x);rotate(t1,+a_angles.x/2.0,t);v_miter.x=signed_distance(curr,curr+t,position.xy);rotate(t2,+a_angles.y/2.0,t);v_miter.y=signed_distance(next,next+t,position.xy);}else{vec2 prev=curr-t1*(v_segment.y-v_segment.x);rotate(t1,-a_angles.x/2.0,t);v_miter.x=signed_distance(prev,prev+t,position.xy);rotate(t2,-a_angles.y/2.0,t);v_miter.y=signed_distance(curr,curr+t,position.xy);}v_distances=vec2(u,v*width);v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#endif\ngl_Position=position;}",fragment_shader_src:"uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_dash_atlas;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_phase;uniform float u_dash_period;uniform float u_dash_index;uniform vec2 u_dash_caps;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL v_normal\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\n#pragma tangram: utils\nconst float PI=3.141592653589793;const float HALF_PI=PI/2.0;const float THETA=15.0*PI/180.0;/***Compute distance to cap.*@param{int}type The Type of the cap(see CAP_TYPE in pattern_lines)*@param{float}dx The distance of the pixel from the beginning of the line(not straight distance,but along the legs)*@param{float}dy The distance of the pixel from the midline(see v_distances in vertex shader,aka \xb11*half_line_width)*@param{float}aa_radius The distance from the mid-line from where antialiasing starts.*For example for a linewidth 10px width and 2px filter radius it is 10px/2-2px=3px.*@return{float}distance*/float cap(int type,float dx,float dy,float aa_radius){float dist=0.0;dx=abs(dx);dy=abs(dy);if(type==1)dist=sqrt(dx*dx+dy*dy);else if(type==3)dist=(dx+abs(dy));else if(type==2)dist=max(abs(dy),(aa_radius+dx-abs(dy)));else if(type==4)dist=max(dx,dy);else if(type==5)dist=max(dx+aa_radius,dy);return dist;}/***Compute distance to join.*@param{int}type The type of the join(see JOIN_TYPE in pattern_lines)*@param{vec2}segment Interpolated a_segment attribute from the vertex shader*@param{vec2}texcoord Pair of u/v coordinates to identify the 4 different extruded points of the segment.*@param{vec2}distances 2 component vector where:*x is the distance of the pixel from the beginning of the line(along the legs)*y is the  distance of the pixel from the midline(see v_distances in vertex shader,\xb11*half_line_width)*@param{vec2}miter Miter point coordiante*@param{float}miter_limit The miter limit*@param{float}linewidth The width of the line*@return{float}computed distance*/float join(in int type,in vec2 segment,in vec2 texcoord,in vec2 distances,in vec2 miter,in float miter_limit,in float linewidth){float dx=distances.x;float result=abs(distances.y);if((dx<segment.x)||(dx>segment.y)){if(type==1){float s=dx<segment.x ? segment.x : segment.y;result=max(result,length(distances-vec2(s,0.0)));}else{float m=abs(texcoord.x>=0.0 ? miter.x : miter.y);if(type==2){result=max(result,m);}else if(type==0){result=max(result,m-miter_limit*linewidth/2.0);}}}return result;}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\nif(v_color.a<=0.0){discard;}bool solid=(u_dash_index==0.0);bool closed=v_linewidth_and_closed<0.0;float dx=v_distances.x;float dy=v_distances.y;float linewidth=abs(v_linewidth_and_closed);float aa_radius=linewidth/2.0-u_antialias;float dist=0.0;vec2 linecaps=u_linecaps;vec2 dash_caps=u_dash_caps;float line_start=0.0;float line_stop=v_length;if(solid){dist=abs(dy);bool potentialCap=!closed&&v_joinIndicator<0.0;if(potentialCap&&dx<line_start){dist=cap(int(u_linecaps.x),abs(dx),abs(dy),aa_radius);}else if(potentialCap&&dx>line_stop){dist=cap(int(u_linecaps.y),abs(dx)-line_stop,abs(dy),aa_radius);}else{dist=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);}}else{float segment_start=v_segment.x;float segment_stop=v_segment.y;float segment_center=(segment_start+segment_stop)/2.0;float freq=u_dash_period*linewidth;float dash_phase=u_dash_phase-1e-5;float u=mod(dx+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));float dash_center=float(tex.x)*255.0*linewidth;float dash_type=floor(float(tex.y)*255.0+0.5);float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;float dash_start=dx-u+_start;float dash_stop=dx-u+_stop;if((dash_stop<segment_start)&&(dash_caps.x!=5.0)){float u=mod(segment_start+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_start-u+_start;dash_stop=segment_start-u+_stop;}else if((dash_start>segment_stop)&&(dash_caps.y!=5.0)){float u=mod(segment_stop+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_stop-u+_start;dash_stop=segment_stop-u+_stop;}bool discontinuous=((dx<segment_center)&&abs(v_angles.x)>THETA)||((dx>=segment_center)&&abs(v_angles.y)>THETA);float d_join=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);if(closed){line_start+=linewidth/2.0;line_stop-=linewidth/2.0;}if(dash_stop<=line_start){discard;}if(dash_start>=line_stop){discard;}if(discontinuous){if((dash_start>segment_stop)){discard;}if((dash_stop<segment_start)){discard;}if(dash_caps.x==1.0){if((u>_stop)&&(dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){discard;}}if(dash_caps.y==1.0){if((u<_start)&&(dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){discard;}}if((dash_caps.x!=1.0)&&(dash_caps.x!=5.0)){if((dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){float a=v_angles.x/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(segment_start-dx)*cos_a-dy*sin_a;float y=(segment_start-dx)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.x=4.0;}}if((dash_caps.y!=1.0)&&(dash_caps.y!=5.0)){if((dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){float a=v_angles.y/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(dx-segment_stop)*cos_a-dy*sin_a;float y=(dx-segment_stop)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.y=4.0;}}}if((dx<line_start)&&(dash_start<=line_start)&&(dash_stop>line_start)){dist=cap(int(linecaps.x),dx-line_start,dy,aa_radius);}else if((dx>line_stop)&&(dash_stop>line_stop)&&(dash_start<line_stop)){dist=cap(int(linecaps.y),dx-line_stop,dy,aa_radius);}else if(dash_type==1.0){dist=cap(int(dash_caps.x),abs(dash_center-u),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}else if(dash_type==0.0){dist=abs(dy);}else if(dash_type==2.0){dist=cap(int(dash_caps.y),abs(u-dash_center),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}if((dx>line_start)&&(dx<line_stop)){if((dx<=segment_start)&&(dash_start<=segment_start)&&(dash_stop>=segment_start)){dist=d_join;float angle=HALF_PI+v_angles.x;float f=abs((segment_start-dx)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if((dx>segment_stop)&&(dash_start<=segment_stop)&&(dash_stop>=segment_stop)){dist=d_join;float angle=HALF_PI+v_angles.y;float f=abs((dx-segment_stop)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}dist=dist-aa_radius;if(dist>=0.0){if(u_antialias==0.0){discard;}else{color=vec4(color.rgb,exp(-dist*dist)*color.a);}}\n#ifdef TANGRAM_DEBUG_TRIANGLES\nif(any(lessThan(v_barycentric,vec3(0.0085)))){color=vec4(0.0,1.0,0.0,1.0);}\n#endif\ngl_FragColor=color;}",selection:!0,init:function(){W_.init.apply(this,arguments),this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_DEBUG_TRIANGLES=!1,this.defines.TANGRAM_DEBUG_NO_TEXTURE_FLOAT_SUPPORT=!1,this.styles=this.styles||{},ET.vertex_layouts=[]},calcDistance:function(s,l){return s&&by.evalCachedDistanceProperty(s,l)||0},calcDash:function(s,l){var h=by.evalProperty(s.dash,l),g=0;return h&&((h=Array.isArray(h)&&h.length?h:RV).length%2==1&&(h=h.concat(h)),g=+(g=h.reduce(function(_,A){return _+A}))||0),{dash:h,dash_period:g}},calcWidth:function(s,l,h){var g=this.calcDistance(s.width,h);return!(g<0||(l.width=g*h.units_per_meter_overzoom,0))},getCapType:function(s,l,h){var g=by.evalProperty(s,l);return void 0!==ND[g]?ND[g]:h},_parseFeature:function(s,l,h){if(!1!==this.calcWidth(l,this.feature_style,h)){var g=this.parseColor(l.color,h);if(g&&0!==g[3]){var _=this.getCapType(l.cap,h,$3),A=by.evalProperty(l.join,h),j=+by.evalProperty(l.miter_limit,h),$=this.calcDash(l,h),_t=$.dash,Ye=$.dash_period,_i=Object.assign({color:g,antialias:l.antialias,linecaps:[this.getCapType(l.tail_cap,h,_),this.getCapType(l.head_cap,h,_)],join:void 0!==TT[A]?TT[A]:Y3,miter_limit:0<=j?j:3,dash_index:0===Ye?0:1,dash:_t,dash_caps:[this.getCapType(l.tail_cap,h,_),this.getCapType(l.head_cap,h,_)],dash_phase:+by.evalProperty(l.dash_phase,h)||0,dash_period:Ye},this.feature_style);return _i.z=l.z&&by.evalCachedDistanceProperty(l.z||0,h)||by.defaults.z,_i.z*=My.height_scale,_i.extrude=by.evalProperty(l.extrude,h),_i.extrude&&(!0===_i.extrude?(_i.height=void 0!==s.properties.height?s.properties.height:by.defaults.height,_i.min_height=void 0!==s.properties.min_height?s.properties.min_height:by.defaults.min_height):"number"==typeof _i.extrude?(_i.height=_i.extrude,_i.min_height=0):Array.isArray(_i.extrude)&&(_i.min_height=_i.extrude[0],_i.height=_i.extrude[1]),_i.height*=My.height_scale,_i.min_height*=My.height_scale),this.addMeshVariantForDraw(this.base,_i),_i}}},_preprocess:function(s){s.color=by.createColorPropertyCache(s.color),s.width=by.createPropertyCache(s.width,by.parseUnits),s.width&&s.width.type!==by.CACHE_TYPE.STATIC&&(s.next_width=by.createPropertyCache(s.width,by.parseUnits)),s.z=by.createPropertyCache(s.z,by.parseUnits);var l=+s.antialias;return s.antialias=isNaN(l)?0:l,s},buildRasterTextures:function(s,l){var h=[];for(var g in l.meshes){var _,A=this.getMeshVariantTypeForDraw({variantKey:g}),j=A.uniforms,$=A.pattern;j.u_dash_index&&(_="__dash_"+$.join("_")+"_"+s.key+"_"+s.id,h.push({name:_,data:dO($,1024)}),j.u_dash_atlas=_,l.meshes[g].textures=[_]),l.meshes[g].uniforms=j}return l.uniforms=l.uniforms||{},h.length?_0.postMessage(this.main_thread_target+".loadTextures",h).then(function(_t){return l}):Promise.resolve(l)},loadTextures:function(s){for(var l=[],h=0;h<s.length;h++){var g=s[h],_=(_=this.textureManager.textures[g.name])||this.textureManager.create(this.gl,g.name,{filtering:"nearest",repeat:!0,width:1024,height:1,data:g.data});l.push(_.loading)}return Promise.all(l).then(function(A){return A.map(function(j){return j.retain(),j.name})})},computeVariantForDraw:function(s){var l=function(h){for(var g=[],_=0,A=nP.length;_<A;_++){var j=h[nP[_]];Array.isArray(j)?g.push(j.join("_")):"boolean"==typeof j?g.push(j?1:0):j&&g.push(j.toString())}return g.join("/")}(s);return{key:s.variantKey=l,order:s.variant_order,uniforms:{u_antialias:s.antialias,u_linecaps:s.linecaps,u_linejoin:s.join,u_miter_limit:s.miter_limit,u_dash_index:s.dash_index,u_dash_caps:s.dash_caps,u_dash_phase:s.dash_phase,u_dash_period:s.dash_period},pattern:s.dash}},vertexLayoutForMeshVariant:function(s){var l;return null==ET.vertex_layouts[s.key]&&(l=[{name:"a_position",size:4,type:C0.SHORT,normalized:!1},{name:"a_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_width",size:1,type:C0.FLOAT,normalized:!1},{name:"a_tangents",size:4,type:C0.FLOAT,normalized:!1},{name:"a_segment",size:2,type:C0.FLOAT,normalized:!1},{name:"a_angles",size:2,type:C0.FLOAT,normalized:!1},{name:"a_texcoord",size:2,type:C0.FLOAT,normalized:!0},{name:"a_length",size:1,type:C0.FLOAT,normalized:!1},{name:"a_closed",size:1,type:C0.FLOAT,normalized:!1},{name:"a_selection_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0}],this.defines.TANGRAM_DEBUG_TRIANGLES&&l.push({name:"a_barycentric",size:3,type:C0.SHORT,normalized:!1}),ET.vertex_layouts[s.key]=new bT(l)),ET.vertex_layouts[s.key]},makeVertexTemplate:function(s){var l=0;return this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=s.z+s.height||0,this.vertex_template[l++]=this.scaleOrder(s.order),this.vertex_template[l++]=255*s.color[0],this.vertex_template[l++]=255*s.color[1],this.vertex_template[l++]=255*s.color[2],this.vertex_template[l++]=255*s.color[3],this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.selection&&(this.vertex_template[l++]=255*s.selection_color[0],this.vertex_template[l++]=255*s.selection_color[1],this.vertex_template[l++]=255*s.selection_color[2],this.vertex_template[l++]=255*s.selection_color[3]),this.defines.TANGRAM_DEBUG_TRIANGLES&&(this.vertex_template[l++]=0,this.vertex_template[l++]=0,this.vertex_template[l++]=0),this.vertex_template},buildLines:function(s,l,h,g,_){var A=4<arguments.length&&void 0!==_&&_,j=h.vertex_data,$=j.vertex_layout,_t=this.makeVertexTemplate(l,h);return q3(s,l.width,j,_t,$.index,A)},buildPolygons:function(s,l,h,g){for(var _=0,A=0,j=s.length;A<j;A++)_+=this.buildLines(s[A],l,h,g,!0);return _}});var gO=0,lM={id_prefix:"",nextLabelId:function(){return"".concat(lM.id_prefix,"/").concat(gO++)}};function cM(s){return{priority:s.priority,collide:s.collide,repeat_distance:s.repeat_distance,repeat_group:s.repeat_group,buffer:s.buffer,italic:s.italic}}var hM=["left","top-left","bottom-left"],yO=["right","top-right","bottom-right"],rP=["top","top-left","top-right"],iP=["bottom","bottom-left","bottom-right"],QA={computeOffset:function(s,l,h,g){if(!h||"center"===h)return s;var _=[s[0],s[1]],A=(A=3<arguments.length&&void 0!==g?g:null)||this.default_buffer;return this.isLeftAnchor(h)?(_[0]-=l[0]/2,"left"===h&&(_[0]-=A[0])):this.isRightAnchor(h)&&(_[0]+=l[0]/2,"right"===h&&(_[0]+=A[1])),this.isTopAnchor(h)?(_[1]-=l[1]/2,"top"===h&&(_[1]-=A[2])):this.isBottomAnchor(h)&&(_[1]+=l[1]/2,"bottom"===h&&(_[1]+=A[3])),_},alignForAnchor:function(s){if(s&&"center"!==s){if(this.isLeftAnchor(s))return"right";if(this.isRightAnchor(s))return"left"}return"center"},isLeftAnchor:function(s){return-1<hM.indexOf(s)},isRightAnchor:function(s){return-1<yO.indexOf(s)},isTopAnchor:function(s){return-1<rP.indexOf(s)},isBottomAnchor:function(s){return-1<iP.indexOf(s)},default_buffer:[2.5,2.5,1.5,.75],zero_buffer:[0,0,0,0]};function PD(s,l,h,g,_){var A=[],j=h-s,$=g-l,_t=j_.getLineLength(s,l,h,g),Ye=2*_;if((_i=_t/Ye)<=1)A.push(s+j/2,l+$/2,_);else{var _i,_s=Ye/_t,Ja=j*_s,_l=$*_s;(_i=_t/_/2)%1&&A.push(h-Ja/2,g-_l/2,_),_i|=0;for(var lc=s+Ja/2,_p=l+_l/2;_i--;)A.push(lc,_p,_),lc+=Ja,_p+=_l}return A}var hx=function(){function s(l,h,g,_){D0(this,s),this.id=lM.nextLabelId(),this.position=[l[0],l[1]],void 0!==l[2]&&this.position.push(l[2]),this.size=h,this.layout=_,this.anchor=Array.isArray(this.layout.anchor)?this.layout.anchor[0]:this.layout.anchor,this.placed=null,this.type="point",this.parent=this.layout.parent,this.offset=this.computeOffset(),this.align=this.layout.align||QA.alignForAnchor(this.anchor),this._is_flat=g}return T0(s,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,align:this.align,sides:this.getSides(),breach:!this.inTileBounds(),layout:cM(this.layout)}}},{key:"inTileBounds",value:function(){var l=this.getAABB(),_=l.right,A=l.bottom;return G0.pointInTile([l.left,l.top])&&G0.pointInTile([_,A])}},{key:"isFlat",value:function(){return this._is_flat}},{key:"setAnchor",value:function(l){this._circles=void 0,this._aabb=void 0,this.anchor=l,this.offset=this.computeOffset()}},{key:"computeOffset",value:function(){var l,h=[this.layout.offset[0],this.layout.offset[1]];return this.parent&&(h=QA.computeOffset(h,(l=this.parent).size,l.anchor,QA.zero_buffer),h=QA.computeOffset(h,l.size,this.anchor,QA.zero_buffer),l.offset!==by.zeroPair&&(h===by.zeroPair?h=l.offset:(h[0]+=l.offset[0],h[1]+=l.offset[1]))),QA.computeOffset(h,this.size,this.anchor)}},{key:"getBoundingCircles",value:function(){return this.angle?(this._circles||(A=-(g=(h=this.size[0]/2*(l=this.layout.units_per_pixel))*Math.cos(this.angle)),j=-(_=h*Math.sin(this.angle)),_t=($=A0(this.position,2))[0],Ye=$[1],_+=Ye*=-1,this._circles=PD(g+=_t,_,A+=_t,j+=Ye,this.size[1]/2*l)),this._circles):[];var l,h,g,_,A,j,$,_t,Ye}},{key:"getAABB",value:function(){var l,h,g,_,A;return this._aabb||(this._aabb={left:(_=this.position[0]+this.offset[0]*(l=this.layout.units_per_pixel))-(h=(this.size[0]/2+this.layout.buffer[0])*l),top:(A=this.position[1]-this.offset[1]*l)+(g=(this.size[1]/2+this.layout.buffer[1])*l),right:_+h,bottom:A-g}),this._aabb}},{key:"getSides",value:function(){var l=this.getAABB(),A=(l.top+l.bottom)/2;return[l.left,A,l.right,A]}}]),s}();hx.PLACEMENT={VERTEX:0,MIDPOINT:1,SPACED:2,CENTROID:3};var mO=hx.PLACEMENT;function fM(s,l,h,g){var _=[],A=g.placement,j=Math.max(l[0],l[1])*g.placement_min_length_ratio*g.units_per_pixel;switch(A){case mO.SPACED:var $=function(fy,_y,Iy){var Dy=(Iy.placement_spacing||80)*Iy.units_per_pixel,Ny=function(Y_){for(var r1=0,t_=0;t_<Y_.length-1;t_++)r1+=PE(Y_[t_],Y_[t_+1]);return r1}(fy);if(Ny<=_y)return!1;for(var r0=Math.max(Math.floor(Ny/Dy),1),Vy=[],Yy=[],S0=.5*(Ny-(r0-1)*Dy),o_=0;o_<r0;o_++){var $0=function(Y_,r1,t_,C_){for(var Ix,H1,px=0,FE=0;FE<Y_.length-1;FE++){var _1=Y_[FE],D_=Y_[FE+1],C1=PE(_1,D_);if(!(C1<=t_)&&r1<(px+=C1)){void 0,Ix=[(gx=(px-r1)/PE(Gx=_1,nE=D_))*Gx[0]+(1-gx)*nE[0],gx*Gx[1]+(1-gx)*nE[1]],H1=pM(_1,D_,C_.angle);break}}var Gx,nE,gx;return{position:Ix,angle:H1}}(fy,S0,_y,Iy),Q0=$0.position,d_=$0.angle;null!=Q0&&null!=d_&&(Vy.push(Q0),Yy.push(d_)),S0+=Dy}return{positions:Vy,angles:Yy}}(s,j,g);if(!$)return[];for(var _t=$.positions,Ye=$.angles,_i=0;_i<_t.length;_i++){var _s,Ja=_t[_i],_l=Ye[_i];!0!==g.tile_edges&&wT(Ja)||((_s=new hx(Ja,l,h,g)).angle=_l,_.push(_s))}break;case mO.VERTEX:for(var lc,_p,ka,ty=0;ty<s.length-1;ty++)lc=s[ty],_p=s[ty+1],!0!==g.tile_edges&&wT(lc)||((ka=new hx(lc,l,h,g)).angle=pM(lc,_p,g.angle),_.push(ka));(ka=new hx(_p,l,h,g)).angle=pM(lc,_p,g.angle),_.push(ka);break;case mO.MIDPOINT:for(var ny=0;ny<s.length-1;ny++){var ry,ly=s[ny],ey=s[ny+1],hy=[.5*(ly[0]+ey[0]),.5*(ly[1]+ey[1])];!0!==g.tile_edges&&wT(hy)||(!j||PE(ly,ey)>j)&&((ry=new hx(hy,l,h,g)).angle=pM(ly,ey,g.angle),_.push(ry))}}return _}function pM(s,l,h){var g=2<arguments.length&&void 0!==h?h:0;return"auto"===g?Math.atan2(l[0]-s[0],l[1]-s[1]):g}function PE(s,l){return Math.sqrt(Math.pow(s[0]-l[0],2)+Math.pow(s[1]-l[1],2))}var tC={key:function(s){return[s.style,s.weight,s.family,s.px_size,s.fill,s.stroke,s.stroke_width,s.transform,s.text_wrap,s.max_lines,s.supersample,s.background_color,s.outline_color,s.outline_width,s.padding,G0.device_pixel_ratio].join("/")},defaults:{style:"normal",weight:null,size:"12px",px_size:12,family:"Helvetica",fill:"white",text_wrap:15,max_lines:5,align:"center",stroke:null,stroke_width:0,background_color:null,outline_color:null,outline_width:0,padding:[0,0,0,0]},compute:function(s,l,h){var g={};if(l.font=l.font||this.defaults,g.can_articulate=l.can_articulate,g.fill=l.font.fill&&G0.toCSSColor(by.evalCachedColorProperty(l.font.fill,h))||this.defaults.fill,g.style=l.font.style||this.defaults.style,g.weight=l.font.weight||this.defaults.weight,l.font.family?(g.family=l.font.family,g.family!==this.defaults.family&&(g.family+=", "+this.defaults.family)):g.family=this.defaults.family,g.transform=l.font.transform,g.size=l.font.size||this.defaults.size,g.supersample=l.supersample_text?1.5:1,g.px_size=by.evalCachedProperty(l.font.px_size,h)*g.supersample,0!==g.px_size){l.font.stroke&&l.font.stroke.color&&(g.stroke=G0.toCSSColor(by.evalCachedColorProperty(l.font.stroke.color,h)||this.defaults.stroke),g.stroke_width=by.evalCachedProperty(l.font.stroke.width,h)||this.defaults.stroke_width),g.font_css=this.fontCSS(g);var _=l.text_wrap;return null==_&&"line"!==My.geometryType(s.geometry.type)&&(_=!0),!0===_&&(_=this.defaults.text_wrap),g.text_wrap=_,g.max_lines=l.max_lines||this.defaults.max_lines,g.background_color=l.background&&l.background.color&&!l.can_articulate?G0.toCSSColor(by.evalCachedColorProperty(l.background.color,h)):this.defaults.background_color,g.outline_color=l.outline&&l.outline.color&&!l.can_articulate?G0.toCSSColor(by.evalCachedColorProperty(l.outline.color,h)):this.defaults.outline_color,g.outline_width=l.outline&&l.outline.width&&!l.can_articulate?by.evalCachedProperty(l.outline.width,h):this.defaults.outline_width,g.padding=l.padding&&!l.can_articulate?by.evalCachedProperty(l.padding,h):this.defaults.padding,g}},fontCSS:function(s){return[s.style,s.weight,s.px_size+"px",s.family].filter(function(l){return l}).join(" ")}},Z3=_e(function(s){function l(Ja,_l){document.addEventListener?Ja.addEventListener("scroll",_l,!1):Ja.attachEvent("scroll",_l)}function h(Ja){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(Ja)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function g(Ja,_l){Ja.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+_l+";"}function _(Ja){var _l=Ja.a.offsetWidth,lc=_l+100;return Ja.f.style.width=lc+"px",Ja.c.scrollLeft=lc,Ja.b.scrollLeft=Ja.b.scrollWidth+100,Ja.g!==_l&&(Ja.g=_l,1)}function A(Ja,_l){function lc(){var ka=_p;_(ka)&&ka.a.parentNode&&_l(ka.g)}var _p=Ja;l(Ja.b,lc),l(Ja.c,lc),_(Ja)}function j(Ja,_l){var lc=_l||{};this.family=Ja,this.style=lc.style||"normal",this.weight=lc.weight||"normal",this.stretch=lc.stretch||"normal"}function $(Ja,_l){return[Ja.style,Ja.weight,function(){if(null===_i){var lc=document.createElement("div");try{lc.style.font="condensed 100px sans-serif"}catch{}_i=""!==lc.style.font}return _i}()?Ja.stretch:"","100px",_l].join(" ")}var _t,Ye,_i,_s;_s=_i=Ye=_t=null,j.prototype.load=function(Ja,_l){var lc=this,_p=Ja||"BESbswy",ka=0,ty=_l||3e3,ny=(new Date).getTime();return new Promise(function(ry,ly){var ey,hy,fy;null===_s&&(_s=!!document.fonts),(ey=_s)&&(null===Ye&&(Ye=/OS X.*Version\/10\..*Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),ey=!Ye),ey?(ey=new Promise(function(_y,Iy){!function Sy(){(new Date).getTime()-ny>=ty?Iy():document.fonts.load($(lc,'"'+lc.family+'"'),_p).then(function(Dy){1<=Dy.length?_y():setTimeout(Sy,25)},function(){Iy()})}()}),hy=new Promise(function(_y,Iy){ka=setTimeout(Iy,ty)}),Promise.race([hy,ey]).then(function(){clearTimeout(ka),ry(lc)},function(){ly(lc)})):(fy=function(){function _y(){var Q0;(Q0=-1!=Ny&&-1!=r0||-1!=Ny&&-1!=Vy||-1!=r0&&-1!=Vy)&&((Q0=Ny!=r0&&Ny!=Vy&&r0!=Vy)||(null===_t&&(Q0=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),_t=!!Q0&&(parseInt(Q0[1],10)<536||536===parseInt(Q0[1],10)&&parseInt(Q0[2],10)<=11)),Q0=_t&&(Ny==Yy&&r0==Yy&&Vy==Yy||Ny==S0&&r0==S0&&Vy==S0||Ny==o_&&r0==o_&&Vy==o_)),Q0=!Q0),Q0&&($0.parentNode&&$0.parentNode.removeChild($0),clearTimeout(ka),ry(lc))}var Iy=new h(_p),Sy=new h(_p),Dy=new h(_p),Ny=-1,r0=-1,Vy=-1,Yy=-1,S0=-1,o_=-1,$0=document.createElement("div");$0.dir="ltr",g(Iy,$(lc,"sans-serif")),g(Sy,$(lc,"serif")),g(Dy,$(lc,"monospace")),$0.appendChild(Iy.a),$0.appendChild(Sy.a),$0.appendChild(Dy.a),document.body.appendChild($0),Yy=Iy.a.offsetWidth,S0=Sy.a.offsetWidth,o_=Dy.a.offsetWidth,function Q0(){var d_;(new Date).getTime()-ny>=ty?($0.parentNode&&$0.parentNode.removeChild($0),ly(lc)):(!0!==(d_=document.hidden)&&void 0!==d_||(Ny=Iy.a.offsetWidth,r0=Sy.a.offsetWidth,Vy=Dy.a.offsetWidth,_y()),ka=setTimeout(Q0,50))}(),A(Iy,function(Q0){Ny=Q0,_y()}),g(Iy,$(lc,'"'+lc.family+'",sans-serif')),A(Sy,function(Q0){r0=Q0,_y()}),g(Sy,$(lc,'"'+lc.family+'",serif')),A(Dy,function(Q0){Vy=Q0,_y()}),g(Dy,$(lc,'"'+lc.family+'",monospace'))},document.body?fy():document.addEventListener?document.addEventListener("DOMContentLoaded",function _y(){document.removeEventListener("DOMContentLoaded",_y),fy()}):document.attachEvent("onreadystatechange",function _y(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",_y),fy())}))})},s.exports=j}),X3={fonts_loaded:Promise.resolve(),last_loaded:null,loadFonts:function(s){var l=this,h=JSON.stringify(s)===this.last_loaded;return s&&!h&&function(){var g=[];for(var _ in s)!function(A){Array.isArray(s[A])?s[A].forEach(function(j){return g.push(l.loadFontFace(A,j))}):g.push(l.loadFontFace(A,s[A]))}(_);l.last_loaded=JSON.stringify(s),l.fonts_loaded=Promise.all(g.filter(function(A){return A}))}(),this.fonts_loaded},loadFontFace:function(s,l){if(null!=l&&("object"===T_(l)||"external"===l)){var h={family:s},g=Promise.resolve();"object"===T_(l)&&(Object.assign(h,l),"string"==typeof l.url&&(g=this.injectFontFace(h)));var _=new Z3(s,h);return g.then(function(){return _.load()}).then(function(){$y("debug","Font face '".concat(s,"' is available"),h)},function(){$y("debug","Font face '".concat(s,"' is NOT available"),h)})}},injectFontFace:function(s){var l=this,h=s.family,g=s.url,_=s.weight,A=s.style;void 0===this.supports_native_font_loading&&(this.supports_native_font_loading=void 0!==window.FontFace);var j=Promise.resolve(g);return"blob:"===g.slice(0,5)&&(j=G0.io(g,6e4,"arraybuffer").then(function($){var _t=new Uint8Array($);if(l.supports_native_font_loading)return _t;for(var Ye="",_i=0;_i<_t.length;_i++)Ye+=String.fromCharCode(_t[_i]);return"data:font/opentype;base64,"+btoa(Ye)})),j.then(function($){var _t,Ye,_i;l.supports_native_font_loading?("string"==typeof $?_t=new FontFace(h,"url(".concat(encodeURI($),")"),{weight:_,style:A}):$ instanceof Uint8Array&&(_t=new FontFace(h,$,{weight:_,style:A})),document.fonts.add(_t),$y("trace","Adding FontFace to document.fonts:",_t)):(Ye="\n                    @font-face {\n                        font-family: '".concat(h,"';\n                        font-weight: ").concat(_||"normal",";\n                        font-style: ").concat(A||"normal",";\n                        src: url(").concat(encodeURI($),");\n                    }\n                "),(_i=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(_i),_i.sheet.insertRule(Ye,0),$y("trace","Injecting CSS font face:",Ye))})}},Xx=function(){function s(){D0(this,s),this.vertical_text_buffer=1,this.horizontal_text_buffer=1,this.layout=JS("binary-tree")}return T0(s,[{key:"createCanvas",value:function(l,h){var g=document.createElement("canvas");return l&&h&&(g.width=l,g.height=h),g.style.backgroundColor="transparent",g}},{key:"setFont",value:function(l,h){var g=h.font_css,_=h.fill,A=h.stroke,j=h.stroke_width,_t=h.supersample;this.px_size=h.px_size;var Ye=G0.device_pixel_ratio*_t;A&&0<j&&(l.strokeStyle=A,l.lineWidth=j*Ye),l.fillStyle=_,l.textBaseline="bottom",l.font=g,l.miterLimit=2}},{key:"textSizes",value:function(l,h,g){var _=this;return X3.loadFonts().then(function(){return w1.add({type:"textSizes",run:_.processTextSizesTask.bind(_),texts:h,tile_id:l,cursor:{ctx:g,styles:Object.keys(h),texts:null,style_idx:null,text_idx:null}})})}},{key:"processTextSizesTask",value:function(l){var g=l.cursor,_=l.texts,A=g.ctx;for(g.style_idx=g.style_idx||0;g.style_idx<g.styles.length;){var j=g.styles[g.style_idx];null==g.text_idx&&(g.text_idx=0,g.texts=Object.keys(_[j]));for(var $=_[j],_t=!0;g.text_idx<g.texts.length;){var Ye=g.texts[g.text_idx],_i=$[Ye],_s=_i.text_settings;if(_t&&(this.setFont(A,_s),_t=!1),_i.size=this.textSize(A,j,Ye,_s).size,_s.can_articulate){var Ja=!1,_l=!1;if(J3(Ye)&&(aP(Ye)?Ja=!0:_l=!0),_i.isRTL=Ja,_i.no_curving=_l||lP.test(Ye),_i.vertical_buffer=this.vertical_text_buffer+_s.outline_width+(_s.padding[0]+_s.padding[2])/2,_i.segment_sizes=[],!_i.no_curving){var lc=function(ka,ty){var ny=ty?1:cP;if(ka.length<ny)return[ka];var ry=ka;if(Xx.cache.segment[ry])return Xx.cache.stats.segment_hits++,Xx.cache.segment[ry];var ly=[];if(Q3.exec(ka)){ly=ka.split(t4);for(var ey,hy=-1,fy=0;fy<ly.length-1;fy++)0<fy&&(ey=e4.exec(ly[fy]))&&(ly[fy]=ly[fy].substring(ey[0].length),ly[fy-1]+=ey[0],hy+=ey[0].length),ly[fy]+=ka.slice(hy+=1+ly[fy].length,hy+1);ka=""}for(;ka.length;){for(var _y="",Iy=ka,Sy=0;Sy<ny&&Iy.length;Sy++){var Dy=(AT.exec(Iy)||Iy)[0];_y+=Dy,Iy=Iy.substring(Dy.length)}ly.push(_y),ka=ka.substring(_y.length)}return ty&&ly.reverse(),Xx.cache.stats.segment_misses++,Xx.cache.segment[ry]=ly}(Ye,Ja);_i.segments=lc;for(var _p=0;_p<lc.length;_p++)_i.segment_sizes.push(this.textSize(A,j,lc[_p],_s).size)}}if(g.text_idx++,!w1.shouldContinue(l))return!1}g.text_idx=null,g.style_idx++}return w1.finish(l,{texts:_}),!0}},{key:"textSize",value:function(l,h,g,_){var A=_.transform,j=_.text_wrap,$=_.max_lines,_t=_.stroke_width,Ye=void 0===_t?0:_t,_i=_.supersample,_s=_.padding,Ja=_.outline_width,_l=_.can_articulate;if((s.cache.text[h]=s.cache.text[h]||{})[g])return s.cache.stats.text_hits++,s.cache.text[h][g];s.cache.stats.text_misses++,s.cache.text_count++;var lc=G0.device_pixel_ratio*_i,_p=this.applyTextTransform(g,A),ka=lc*(this.vertical_text_buffer+Ja+(_s[0]+_s[2])/2),ty=lc*(this.horizontal_text_buffer+Ja+Ye+(_s[1]+_s[3])/2),ry=this.px_size+2*lc,ly=n4.parse(_p,j,$,ry,l),ey=ly.height,hy=ly.width,fy=ly.lines,_y=[hy/lc,ey/lc];_l||(_y[0]+=2*ty/lc,_y[1]+=2*ka/lc);var Iy=[hy+2*ty,ey+2*ka];return s.cache.text[h][g]={lines:fy,size:{collision_size:_y,texture_size:Iy,logical_size:[Iy[0]/lc,Iy[1]/lc],line_height:ry}}}},{key:"drawTextMultiLine",value:function(l,h,g,_,A,j){var $=A0(g,2),_t=$[0],Ye=$[1],_i=G0.device_pixel_ratio*A.supersample,_s=A.stroke_width||0,Ja=A.stroke;A.background_color&&(l.fillStyle=A.background_color,l.fillRect(_t,Ye,_.texture_size[0],_.texture_size[1]));var _l=A.outline_width*_i,lc=A.outline_color;_l&&lc&&(l.strokeStyle=lc,l.lineWidth=_l,l.strokeRect(_t+_l/2,Ye+_l/2,_.texture_size[0]-_l,_.texture_size[1]-_l)),(A.background_color||_l&&lc)&&this.setFont(l,A);for(var _p,ka,ty,ny,ry=_.line_height,ly=Ye,ey=0;ey<h.length;ey++)this.drawTextLine(l,h[ey],[_t,ly],_,A,j),ly+=ry;ZA.draw_label_collision_boxes&&(l.save(),_p=_i*(this.horizontal_text_buffer+A.outline_width+_s+(A.padding[1]+A.padding[3])/2),ka=_i*(this.vertical_text_buffer+A.outline_width+(A.padding[0]+A.padding[2])/2),ty=_.collision_size,l.strokeStyle="blue",l.lineWidth=2,l.strokeRect(_t+_p,Ye+ka,_i*ty[0],_i*ty[1]),"curved"===j&&Ja&&0<_s&&l.strokeRect(_t+_.texture_size[0]+_p,Ye+ka,_i*ty[0],_i*ty[1]),l.restore()),ZA.draw_label_texture_boxes&&(l.save(),ny=_.texture_size,l.strokeStyle="green",l.lineWidth=2,l.strokeRect(_t+2,Ye+2,ny[0]-4,ny[1]-4),"curved"===j&&Ja&&0<_s&&l.strokeRect(_t+2+_.texture_size[0],Ye+2,ny[0]-4,ny[1]-4),l.restore())}},{key:"drawTextLine",value:function(l,h,g,_,A,j){var $,_t=A0(g,2),Ye=_t[0],_i=_t[1],_s=A.stroke,Ja=A.stroke_width,_l=void 0===Ja?0:Ja,ka=A.padding,ty=A.outline_width,ny=G0.device_pixel_ratio*A.supersample,ry=(ry=A.align)||"center",ly=_.texture_size,ey=_.line_height,hy=ny*(this.vertical_text_buffer+ty),fy=ny*(this.horizontal_text_buffer+ty+_l),_y=this.applyTextTransform(h.text,A.transform);"left"===ry?$=Ye+fy+ka[3]*ny:"center"===ry?$=Ye+ly[0]/2-h.width/2-(ka[1]-ka[3])*ny/2:"right"===ry&&($=Ye+ly[0]-h.width-fy-ka[1]*ny);var Sy=_i+hy+ey+ka[0]*ny;_s&&0<_l&&l.strokeText(_y,$+("curved"===j?ly[0]:0),Sy),l.fillText(_y,$,Sy)}},{key:"rasterize",value:function(l,h,g,_,A,j){return w1.removeForTile(g),w1.add({type:"rasterizeLabels",run:this.processRasterizeTask.bind(this),cancel:s.returnNoTextures,pause_factor:2,user_moving_view:!1,texts:l,textures:h,texture_prefix:_,gl:A,tile_id:g,texture_manager:j,cursor:{styles:Object.keys(l),texts:null,style_idx:0,text_idx:null,texture_idx:0,texture_names:[]}})}},{key:"processRasterizeTask",value:function(l){if(!w1.shouldContinue(l))return!1;for(var h=l.cursor,g=l.texts,_=l.textures;h.texture_idx<l.textures.length;){for(var A=!1,j=_[h.texture_idx],$=this.createCanvas.apply(this,A_(j.texture_size)),_t=$.getContext("2d");h.style_idx<h.styles.length;){var Ye=h.styles[h.style_idx];null==h.text_idx&&(h.text_idx=0,h.texts=Object.keys(g[Ye]));for(var _i=g[Ye],_s=!0;h.text_idx<h.texts.length;){var Ja=h.texts[h.text_idx],_l=_i[Ja],lc=_l.text_settings;if(_s&&(this.setFont(_t,lc),_s=!1),lc.can_articulate){_l.texcoords=_l.texcoords||{};for(var _p=0;_p<_l.type.length;_p++){var ka=_l.type[_p];switch(ka){case"straight":if(_l.textures[_p]!==h.texture_idx)continue;var ty,ny,ry,ey=_l.isRTL?Ja.split().reverse().join():Ja,hy=j.texcoord_cache[Ye][ey],fy=void 0;hy.texcoord?fy=hy.texcoord:(ty=hy.texture_position,ry=(ny=this.textSize(_t,Ye,ey,lc)).size,this.drawTextMultiLine(_t,ny.lines,ty,ry,lc,ka),fy=l.texture_manager.getTexcoordsForSprite(ty,ry.texture_size,j.texture_size),hy.texcoord=fy),_l.texcoords[ka]={texcoord:fy,texture_id:hy.texture_id};break;case"curved":var _y=_l.segments;_l.texcoords.curved=[],_l.texcoords_stroke=[];for(var Iy,Sy,Dy,Ny,r0,Vy,Yy,o_=0;o_<_y.length;o_++)_l.textures[_p][o_]===h.texture_idx&&(Ny=Dy=void 0,(Sy=j.texcoord_cache[Ye][Iy=_y[o_]]).texcoord&&Sy.texcoord_stroke?(Dy=Sy.texcoord,Ny=Sy.texcoord_stroke):(r0=Sy.texture_position,Yy=(Vy=this.textSize(_t,Ye,Iy,lc)).size,this.drawTextMultiLine(_t,Vy.lines,r0,Yy,lc,ka),Dy=l.texture_manager.getTexcoordsForSprite(r0,Yy.texture_size,j.texture_size),Ny=lc.stroke&&0<lc.stroke_width?l.texture_manager.getTexcoordsForSprite([r0[0]+Yy.texture_size[0],r0[1]],Yy.texture_size,j.texture_size):(A=!0,l.texture_manager.getTexcoordsForSprite([j.texture_size[0],j.texture_size[1]],[0,0],j.texture_size)),Sy.texcoord=Dy,Sy.texcoord_stroke=Ny),_l.texcoords_stroke.push(Ny),_l.texcoords.curved.push({texcoord:Dy,texture_id:Sy.texture_id}))}}}else{var $0=this.textSize(_t,Ye,Ja,lc).lines;for(var Q0 in _l.align)_l.align[Q0].texture_id===h.texture_idx&&(this.drawTextMultiLine(_t,$0,_l.align[Q0].texture_position,_l.size,{stroke:lc.stroke,stroke_width:lc.stroke_width,transform:lc.transform,supersample:lc.supersample,align:Q0,background_color:lc.background_color,outline_width:lc.outline_width,outline_color:lc.outline_color,padding:lc.padding,fill:lc.fill,font_css:lc.font_css,px_size:lc.px_size}),_l.align[Q0].texcoords=l.texture_manager.getTexcoordsForSprite(_l.align[Q0].texture_position,_l.size.texture_size,j.texture_size))}h.text_idx++}h.text_idx=null,h.style_idx++}!0===A&&(_t.fillStyle="rgba(0, 0, 0, 0)",_t.fillRect($.width-1,$.height-1,1,1));var d_=l.texture_prefix+h.texture_idx;l.texture_manager.create(l.gl,d_,{element:$,filtering:"linear",UNPACK_PREMULTIPLY_ALPHA_WEBGL:!0}),h.texture_names.push(d_),h.texture_idx++,h.style_idx=0,$.width=0,$.height=0}return w1.finish(l,h.texture_names),!0}},{key:"setTextureTextPositions",value:function(l){var h={texture_id:0,texcoord_cache:{}},g=[];for(var _ in l){var A=l[_];for(var j in A){var $=A[j],_t=$.text_settings,Ye=_t.can_articulate,_i=_t.stroke,_s=_t.stroke_width;if(Ye){$.textures=[],h.texcoord_cache[_]=h.texcoord_cache[_]||{};for(var Ja=0;Ja<$.type.length;Ja++)switch($.type[Ja]){case"straight":var _l,lc=$.isRTL?j.split().reverse().join():j;h.texcoord_cache[_][lc]||(_l=$.size.texture_size,h.texcoord_cache[_][lc]={},this.placeText(_l[0],_l[1],{can_articulate:Ye,style:_,word:lc})),$.textures[Ja]=h.texture_id;break;case"curved":$.textures[Ja]=[];for(var _p=0;_p<$.segment_sizes.length;_p++){var ka,ty,ny=$.segments[_p];h.texcoord_cache[_][ny]||(ty=(ka=$.segment_sizes[_p].texture_size)[0],_i&&0<_s&&(ty*=2),h.texcoord_cache[_][ny]={},this.placeText(ty,ka[1],{can_articulate:Ye,style:_,word:ny})),$.textures[Ja].push(h.texture_id)}}}else{var ry=$.size.texture_size;this.placeText(ry[0],ry[1],{can_articulate:Ye,text_info:$})}}}var ly=this.layout.export(),ey=ly.items,hy=ly.width,fy=ly.height;h.texcoord_cache={};for(var _y=0,Iy=ey.length;_y<Iy;_y++){var Sy=ey[_y],Dy=Sy.x,Ny=Sy.y;if(Sy.meta.can_articulate){var Yy=Sy.meta,S0=Yy.style,o_=Yy.word;h.texcoord_cache[S0]=h.texcoord_cache[S0]||{},h.texcoord_cache[S0][o_]||(h.texcoord_cache[S0][o_]={texture_id:h.texture_id,texture_position:[Dy,Ny]})}else{var r0=Sy.meta.text_info;for(var Vy in r0.align)r0.align[Vy].texture_id=h.texture_id,r0.align[Vy].texture_position=[Dy,Ny]}}return 0<hy&&0<fy&&(g[h.texture_id]={texture_size:[hy,fy],texcoord_cache:h.texcoord_cache}),g}},{key:"placeText",value:function(l,h,g){this.layout.addItem({width:l+this.vertical_text_buffer,height:h+this.vertical_text_buffer,meta:g})}},{key:"applyTextTransform",value:function(l,h){return"capitalize"===h?l.replace(/\w\S*/g,function(g){return g.charAt(0).toUpperCase()+g.substr(1)}):"uppercase"===h?l.toUpperCase():"lowercase"===h?l.toLowerCase():l}}],[{key:"fontPixelSize",value:function(l){if(null!=l){var h=A0((l="string"==typeof l?l:String(l)).match(s.font_size_re)||[],3),g=h[1],_=h[2];return"em"===(_=_||"px")?g*=16:"pt"===_?g/=.75:"%"===_&&(g/=6.25),(g=by.parsePositiveNumber(g))*G0.device_pixel_ratio}}},{key:"pruneTextCache",value:function(){s.cache.text_count>s.cache.text_count_max&&(s.cache.text={},s.cache.text_count=0,$y("debug","CanvasText: pruning text cache")),Object.keys(s.cache.segment).length>s.cache.segment_count_max&&(s.cache.segment={},$y("debug","CanvasText: pruning segment cache"))}}]),s}();Xx.font_size_re=/((?:[0-9]*\.)?[0-9]+)\s*(px|pt|em|%)?/,Xx.cache={text:{},text_count:0,text_count_max:2e3,segment:{},segment_count_max:2e3,stats:{text_hits:0,text_misses:0,segment_hits:0,segment_misses:0}},Xx.EMPTY_TEXTURES_ARR=[],Xx.returnNoTextures=function(){return Xx.EMPTY_TEXTURES_ARR};var NV=new RegExp("[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]");function J3(s){return NV.test(s)}var oP="\0-/:-@[-`{-\xbf\xd7\xf7\u02b9-\u02ff\u2000-\u2bff\u2010-\u2029\u202c\u202f-\u2bff",sP=new RegExp("["+oP+"]+");function aP(s){return sP.test(s)}var Q3=new RegExp("^["+oP+"\u0600-\u06ff]+"),t4=new RegExp("["+oP+"\u0622-\u0625\u0627\u062f-\u0632\u0648\u0671-\u0677\u0688-\u0699\u06c4-\u06cb\u06cf\u06d2\u06d3\u06ee\u06ef]"),e4=new RegExp("^[\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed]+"),dM="[\u0300-\u036f\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u07a6-\u07b0\u0900-\u0903\u093a-\u094c\u094e\u094f\u0951-\u0957\u0962\u0963\u0981-\u0983\u09bc\u09be-\u09cc\u09d7\u09e2\u09e3\u0a01-\u0a03\u0a3c-\u0a4c\u0a51\u0a81-\u0a83\u0abc\u0abe-\u0acc\u0ae2\u0ae3\u0b01-\u0b03\u0b3c\u0b3e-\u0b4c\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe-\u0bcd\u0bd7\u0c00-\u0c03\u0c3e-\u0c4c\u0c55\u0c56\u0c62\u0c63\u0c81-\u0c83\u0cbc\u0cbe-\u0ccc\u0cd5\u0cd6\u0ce2\u0ce3\u0d01-\u0d03\u0d3e-\u0d4c\u0d4e\u0d57\u0d62\u0d63\u0d82\u0d83\u0dca-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f83\u0f86\u0f87\u0f8d-\u0fbc\u0fc6\u102b-\u1038\u103a-\u103e\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f\u109a-\u109d\u17b4-\u17d1\u17d3\u1a55-\u1a5e\u1a61-\u1a7c\u1dc0-\u1dff\u20d0-\u20ff]",AT=new RegExp("^.(?:"+dM+"+)?([\u094d\u09cd\u0a4d\u0acd\u0b4d\u0c4d\u0ccd\u0d4d\u0f84\u1039\u17d2\u1a60\u1a7f]\\W(?:"+dM+"+)?)*"),_2={Mongolian:"\u1800-\u18af"},uP=Object.keys(_2).map(function(s){return _2[s]}).join(""),lP=new RegExp("["+uP+"]"),cP=2,n4=function(){function s(l){var h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0,g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1/0;D0(this,s),this.width=0,this.height=0,this.lines=[],this.max_lines=h,this.text_wrap=g,this.context=l}return T0(s,[{key:"createLine",value:function(l){return this.lines.length<this.max_lines&&new PV(l,this.text_wrap)}},{key:"push",value:function(l){if(this.lines.length<this.max_lines){var h=this.context.measureText(l.text).width;return(l.width=h)>this.width&&(this.width=Math.ceil(h)),this.lines.push(l),this.height+=l.height,!0}return this.addEllipsis(),!1}},{key:"advance",value:function(l,h){return!!this.push(l)&&this.createLine(h)}},{key:"addEllipsis",value:function(){var l=this.lines[this.lines.length-1],h=Math.ceil(this.context.measureText(s.ellipsis).width);l.append(s.ellipsis),l.width+=h,l.width>this.width&&(this.width=l.width)}},{key:"finish",value:function(l){l?this.push(l):this.addEllipsis()}}],[{key:"parse",value:function(l,h,g,_,A){for(var j="number"==typeof h?l.split(" "):[l],$=new s(A,g,h),_t=$.createLine(_),Ye=0;Ye<j.length;Ye++){for(var _i=j[Ye].split("\n"),_s=0===Ye,Ja=0;Ja<_i.length&&_t;Ja++){var _l=_i[Ja];J3(_l)&&aP(_l[_l.length-1])&&(_l+="\u200f");var lc=_s?_l:" "+_l;if(h&&0<Ye&&_t.exceedsTextwrap(lc)){if(!(_t=$.advance(_t,_)))break;_t.append(_l),_s=!0}else _t.append(lc);Ja<_i.length-1&&(_t=$.advance(_t,_),_s=!0)}Ye===j.length-1&&$.finish(_t)}return $}}]),s}();n4.ellipsis="...";var PV=function(){function s(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;D0(this,s),this.chars=0,this.text="",this.height=Math.ceil(l),this.text_wrap=h}return T0(s,[{key:"append",value:function(l){this.chars+=l.length,this.text+=l}},{key:"exceedsTextwrap",value:function(l){return l.length+this.chars>this.text_wrap}}]),s}(),LV={resetText:function(){this.texts={}},freeText:function(s){delete this.texts[s.id]},parseTextFeature:function(s,l,h,g){var _=this.parseTextSource(s,l,h);if(null!=_&&""!==_){var A=tC.compute(s,l,h);if(A){var j=tC.key(A);this.texts[g.id]=this.texts[g.id]||{};var $=this.texts[g.id][j]=this.texts[g.id][j]||{};if(_ instanceof Object){var _t=[],Ye=_.left+"-"+_.right;for(var _i in _){var _s,Ja=_[_i];Ja&&(_s=this.computeTextLayout({},s,l,h,g,Ja,A,Ye,_i),$[Ja]||($[Ja]={text_settings:A,ref:0}),_t.push({draw:l,text:Ja,text_settings_key:j,layout:_s}))}return 0<_t.length&&_t}var _l=this.computeTextLayout({},s,l,h,g,_,A);return $[_]||($[_]={text_settings:A,ref:0}),{draw:l,text:_,text_settings_key:j,layout:_l}}}},parseTextSource:function(s,l,h){var g,_=l.text_source||"name";if(null!=_&&"object"===T_(_))for(var A in g={},_)g[A]=this.parseTextSourceValue(_[A],s,h);else g=this.parseTextSourceValue(_,s,h);return g},parseTextSourceValue:function(s,l,h){var g;if(Array.isArray(s)){for(var _=0;_<s.length;_++)if("string"==typeof s[_]?g=l.properties[s[_]]:"function"==typeof s[_]&&(g=s[_](h)),g)return g}else"string"==typeof s?g=l.properties[s]:s instanceof Function&&(g=s(h));return g},prepareTextLabels:function(s,l,h){var g=this;return 0===Object.keys(this.texts[s.id]||{}).length?Promise.resolve([]):_0.postMessage(this.main_thread_target+".calcTextSizes",s.id,this.texts[s.id]).then(function(_){var A=_.texts;return s.canceled?($y("trace","Style ".concat(g.name,": stop tile build because tile was canceled: ").concat(s.key,", post-calcTextSizes()")),[]):(g.texts[s.id]=A||[],A?g.buildTextLabels(s,h):(zx.abortTile(s.id),[]))})},collideAndRenderTextLabels:function(s,l,h){var g=this;return this.prepareTextLabels(s,l,h).then(function(_){return 0===_.length?(zx.collide([],l,s.id),Promise.resolve({})):zx.collide(_,l,s.id).then(function(A){if(s.canceled)return $y("trace","stop tile build because tile was canceled: ".concat(s.key,", post-collide()")),{};var j=g.texts[s.id];return null==j||0===A.length?{}:(g.cullTextStyles(j,A),A.forEach(function($){var _t=$.text_settings_key,Ye=j[_t]&&j[_t][$.text];Ye.text_settings.can_articulate?(Ye.type||(Ye.type=[]),-1===Ye.type.indexOf($.label.type)&&Ye.type.push($.label.type)):(Ye.align=Ye.align||{},Ye.align[$.label.align]={})}),{labels:A,texts:j,textures:[]})})})},cullTextStyles:function(s,l){for(var h=0;h<l.length;h++){var g=l[h];s[g.text_settings_key][g.text].ref++}for(var _ in s)for(var A in s[_])s[_][A].ref<1&&delete s[_][A];for(var j in s)0===Object.keys(s[j]).length&&delete s[j]},calcTextSizes:function(s,l){return this._canvas_text||(this._canvas_text=new Xx,this._canvas_ctx_for_sizes=this._canvas_text.createCanvas().getContext("2d")),this._canvas_text.textSizes(s,l,this._canvas_ctx_for_sizes)},preprocessText:function(s){if(s&&s.font&&"object"===T_(s.font))return s.font.fill=by.createPropertyCache(s.font.fill),s.font.stroke&&(s.font.stroke.color=by.createPropertyCache(s.font.stroke.color)),s.background&&s.background.color&&(s.background.color=by.createPropertyCache(s.background.color)),s.outline&&(s.outline.color&&(s.outline.color=by.createPropertyCache(s.outline.color)),s.outline.width&&(s.outline.width=by.createPropertyCache(s.outline.width,by.parsePositiveNumber))),s.padding&&(Array.isArray(s.padding)?2===s.padding.length&&(s.padding=[s.padding[0],s.padding[1],s.padding[0],s.padding[1]]):s.padding=Array(4).fill(s.padding),s.padding=by.createPropertyCache(s.padding,function(l){return l.map(by.parsePositiveNumber)})),s.font.px_size=by.createPropertyCache(s.font.size||tC.defaults.size,Xx.fontPixelSize),s.font.stroke&&null!=s.font.stroke.width&&(s.font.stroke.width=by.createPropertyCache(s.font.stroke.width,by.parsePositiveNumber)),s.offset=by.createPropertyCache(s.offset,function(l){return Array.isArray(l)&&l.map(by.parseNumber)}),s.buffer=by.createPropertyCache(s.buffer,function(l){return(Array.isArray(l)?l:[l,l]).map(by.parsePositiveNumber)}),s.repeat_distance=by.createPropertyCache(s.repeat_distance||My.tile_size,by.parsePositiveNumber),s},computeTextLayout:function(s,l,h,g,_,A,j,$,_t){var Ye=s||{};return(Ye=this.computeLayout(Ye,l,h,g,_)).repeat_distance&&($&&(Ye.repeat_group+="/"+$),Ye.repeat_group+="/"+A),Ye.subdiv=_.overzoom2,Ye.align=h.align,Ye.italic="normal"!==j.style,"right"===_t?Ye.orientation=1:"left"===_t&&(Ye.orientation=-1),Ye}},LE=Math.PI/180,vO=function(){function s(l,h){D0(this,s),this._min_zoom=H.util.constants.DEFAULT_MIN_ZOOM_LEVEL,this._max_zoom=H.util.constants.DEFAULT_MAX_ZOOM_LEVEL,this._viewport=l,this._center_offset=[],this._center_offset_normalized=[],this._viewport_aspect_ratio=1,this._focal_length=[[16,2],[17,2.5],[18,3],[19,4],[20,6]],this._view_matrix=new Float64Array(16),this._projection_matrix=new Float64Array(16),this._heading_matrix=new Float64Array(16),this._tilt_matrix=new Float64Array(16),this._transformation_matrix=new Float64Array(16),this._camera_matrix=new Float64Array(16),this._lookAtData={position:[0,0,0],zoom:0,tile_level:0,tetragon:void 0,bounds:void 0,unpadded_bounds:void 0,distance:void 0,tilt:0,incline:0,heading:180},this._zoom_direction=0,this._horizon=0,this.handleViewportUpdate(!0),h?this.setLookAtData(h):this._updateMatrices(),b0.replaceBlock("camera","\n            uniform mat4 u_projection;\n            uniform vec3 u_eye;\n            uniform vec2 u_center_offset;\n\n            void cameraProjection (inout vec4 position) {\n                position = u_projection * position;\n            }")}return T0(s,[{key:"getZoomForBounds",value:function(l,h,g,_){var A,j=this.clone(),$=this._max_zoom,_t=this._min_zoom,Ye=($-_t)/2,_i=$-Ye,_s=h,Ja=j_.getBBoxCenter(j_.getBBox(l));for(void 0===_s?_s=Ja:(A=Ja[0]-_s[0],Math.abs(A)>My.half_circumference_meters+1e-8&&(_s[0]+=Math.round(A/My.circumference_meters)*My.circumference_meters));.001<Ye;)!function(){j.setLookAtData({zoom:_i,position:_s,tilt:g,heading:_});var _l,lc,ny=j.getLookAtData().bounds;l.every(function(ry){return j_.isPointInsidePolygon(ry,ny)})?_t=_i:(lc=(_l=A0(j_.getBBox(ny),4))[0],_l[2]-lc+1e-8>=My.circumference_meters&&_l[3]-_l[1]+1e-8>=My.circumference_meters?_t=_i:$=_i),_i=$-(Ye=($-_t)/2)}();return _t}},{key:"setZoomConstraints",value:function(l,h){this._min_zoom=l,this._max_zoom=h,this.setLookAtData(this.getLookAtData())}},{key:"setLookAtData",value:function(l,h){var g,_,A,j,$,_t=l.position,Ye=l.zoom;_t===g&&l.bounds!==g&&(_t=j_.getBBoxCenter(j_.getBBox(l.bounds))),Ye===g&&l.bounds!==g&&(Ye=this.getZoomForBounds(l.bounds,_t,l.tilt,l.heading)),h!==g&&(_=_t||this.screenToWorld(h)),Ye!==g&&(Ye=j_.clamp(Ye,this._min_zoom,this._max_zoom),(A=G0.zoomToTileLevel(Ye))!==(j=this._lookAtData.tile_level)&&(this._zoom_direction=j<A?1:-1),this._lookAtData.zoom=Ye,this._lookAtData.tile_level=A),l.tilt!==g&&(this._lookAtData.tilt=l.tilt),l.heading!==g&&(this._lookAtData.heading=l.heading),h!==g?(this._updateMatrices(),$=this.screenToWorld(h),this._lookAtData.position[0]-=$[0]-_[0],this._lookAtData.position[1]-=$[1]-_[1]):_t&&(this._lookAtData.position=_t),this._lookAtData.position[2]=0,this._lookAtData.position[1]=j_.clamp(this._lookAtData.position[1],-My.half_circumference_meters,My.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"getZoomDirection",value:function(){return this._zoom_direction}},{key:"resetZoomDirection",value:function(){this._zoom_direction=0}},{key:"getLookAtData",value:function(){return this._lookAtData}},{key:"handleViewportUpdate",value:function(l){var h=0<arguments.length&&void 0!==l&&l,g=this._viewport,_=g.width,A=g.height;this._viewport_aspect_ratio=_/A;var j=this._viewport.center.x-(_/2<<0),$=this._viewport.center.y-(A/2<<0);this._center_offset[0]=j,this._center_offset[1]=$,this._center_offset_normalized[0]=j/_,this._center_offset_normalized[1]=$/-A,h||(this._updateMatrices(),this._updateVisibleBounds())}},{key:"setupMatrices",value:function(l,h){bx_multiply(l.model_view32,this._view_matrix,l.model),h.uniform("Matrix4fv","u_modelView",l.model_view32),function(s,l){var h=l[0],g=l[1],_=l[2],A=l[3],j=l[4],$=l[5],_t=l[6],Ye=l[7],_i=l[8],_s=l[9],Ja=l[10],_l=l[11],lc=l[12],_p=l[13],ka=l[14],ty=l[15],ny=h*$-g*j,ry=h*_t-_*j,ly=h*Ye-A*j,ey=g*_t-_*$,hy=g*Ye-A*$,fy=_*Ye-A*_t,_y=_i*_p-_s*lc,Iy=_i*ka-Ja*lc,Sy=_i*ty-_l*lc,Dy=_s*ka-Ja*_p,Ny=_s*ty-_l*_p,r0=Ja*ty-_l*ka,Vy=ny*r0-ry*Ny+ly*Dy+ey*Sy-hy*Iy+fy*_y;Vy&&(s[0]=($*r0-_t*Ny+Ye*Dy)*(Vy=1/Vy),s[1]=(_t*Sy-j*r0-Ye*Iy)*Vy,s[2]=(j*Ny-$*Sy+Ye*_y)*Vy,s[3]=(_*Ny-g*r0-A*Dy)*Vy,s[4]=(h*r0-_*Sy+A*Iy)*Vy,s[5]=(g*Sy-h*Ny-A*_y)*Vy,s[6]=(_p*fy-ka*hy+ty*ey)*Vy,s[7]=(ka*ly-lc*fy-ty*ry)*Vy,s[8]=(lc*hy-_p*ly+ty*ny)*Vy)}(l.normal32,l.model_view32),function(s,l){var h=l[0],g=l[1],_=l[2],A=l[3],j=l[4],$=l[5],_t=l[6],Ye=l[7],_i=l[8],_s=_i*j-$*Ye,Ja=-_i*A+$*_t,_l=Ye*A-j*_t,lc=h*_s+g*Ja+_*_l;lc&&(s[0]=_s*(lc=1/lc),s[1]=(-_i*g+_*Ye)*lc,s[2]=($*g-_*j)*lc,s[3]=Ja*lc,s[4]=(_i*h-_*_t)*lc,s[5]=(-$*h+_*A)*lc,s[6]=_l*lc,s[7]=(-Ye*h+g*_t)*lc,s[8]=(j*h-g*A)*lc)}(l.inverse_normal32,l.normal32),h.uniform("Matrix3fv","u_normalMatrix",l.normal32),h.uniform("Matrix3fv","u_inverseNormalMatrix",l.inverse_normal32)}},{key:"_updateMatrices",value:function(){var l=this._viewport.height*My.metersPerPixel(this._lookAtData.zoom),h=G0.interpolate(this._lookAtData.zoom,this._focal_length);this._lookAtData.distance=l/2*h;var g=this._lookAtData.position[0],_=this._lookAtData.position[1];(function(s,l,h,g){var _,A,j,$,_t,Ye,_i,_s,Ja,_l,lc=l[0],_p=l[1],ka=l[2],ty=g[0],ny=g[1],ry=g[2],ly=h[0],ey=h[1],hy=h[2];Math.abs(lc-ly)<1e-6&&Math.abs(_p-ey)<1e-6&&Math.abs(ka-hy)<1e-6?gN(s):(_i=lc-ly,_s=_p-ey,Ja=ka-hy,_=ny*(Ja*=_l=1/Math.sqrt(_i*_i+_s*_s+Ja*Ja))-ry*(_s*=_l),A=ry*(_i*=_l)-ty*Ja,j=ty*_s-ny*_i,(_l=Math.sqrt(_*_+A*A+j*j))?(_*=_l=1/_l,A*=_l,j*=_l):j=A=_=0,$=_s*j-Ja*A,_t=Ja*_-_i*j,Ye=_i*A-_s*_,(_l=Math.sqrt($*$+_t*_t+Ye*Ye))?($*=_l=1/_l,_t*=_l,Ye*=_l):Ye=_t=$=0,s[0]=_,s[1]=$,s[2]=_i,s[3]=0,s[4]=A,s[5]=_t,s[6]=_s,s[7]=0,s[8]=j,s[9]=Ye,s[10]=Ja,s[11]=0,s[12]=-(_*lc+A*_p+j*ka),s[13]=-($*lc+_t*_p+Ye*ka),s[14]=-(_i*lc+_s*_p+Ja*ka),s[15]=1)})(this._view_matrix,_x_fromValues(g,_,0),_x_fromValues(g,_,-1),_x_fromValues(0,1,0)),this._heading_matrix=bx_identity(this._heading_matrix);var A=180-this._lookAtData.heading;A*=LE,this._heading_matrix[0]=Math.cos(A),this._heading_matrix[1]=-Math.sin(A),this._heading_matrix[4]=Math.sin(A),this._heading_matrix[5]=Math.cos(A),this._tilt_matrix=bx_identity(this._tilt_matrix),A=0<(A=this._lookAtData.tilt?this._lookAtData.tilt*LE:0)?-A:A,this._tilt_matrix[5]=Math.cos(A),this._tilt_matrix[6]=Math.sin(A),this._tilt_matrix[9]=-Math.sin(A),this._tilt_matrix[10]=Math.cos(A),bx_multiply(this._transformation_matrix,this._tilt_matrix,this._heading_matrix),bx_multiply(this._view_matrix,this._transformation_matrix,this._view_matrix);var j=2*Math.atan(1/h),$=2*this._lookAtData.distance;this._depth_buffer_adjustment=2/Math.log($),function(s,l,h,g,_){var A=1/Math.tan(l/2),j=1/(g-_);s[0]=A/h,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=A,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=(_+g)*j,s[11]=-1,s[12]=0,s[13]=0,s[14]=2*_*g*j,s[15]=0}(this._projection_matrix,j,this._viewport_aspect_ratio,1,$),this._projection_matrix[8]=2*-this._center_offset_normalized[0],this._projection_matrix[9]=2*-this._center_offset_normalized[1],bx_translate(this._projection_matrix,this._projection_matrix,_x_fromValues(0,0,-this._lookAtData.distance)),this._camera_matrix=bx_multiply(this._camera_matrix,this._projection_matrix,this._view_matrix)}},{key:"_updateVisibleBounds",value:function(){var l,h,g,_,A,j=this._viewport,$=j.width,_t=j.height,Ye=j.padding,_i=this._lookAtData.tilt*Math.PI/180;this._horizon=Math.max((Ye.top+_t)/2-Math.cos(_i)*(Ye.top*(1-Math.sin(_i))+.75*_t),0),this._lookAtData.tetragon=[this.screenToWorld([0,this._horizon]),this.screenToWorld([$,this._horizon]),this.screenToWorld([$,_t]),this.screenToWorld([0,_t])],this._lookAtData.unpadded_bounds=this._clipAgainstGeoBounds(this._lookAtData.tetragon),0===Ye.left&&0===Ye.top&&0===Ye.right&&0===Ye.bottom?this._lookAtData.bounds=this._lookAtData.unpadded_bounds:(l=Ye.left,h=Math.max(this._horizon,Ye.top),g=$-Ye.right,_=_t-Ye.bottom,A=[this.screenToWorld([l,h]),this.screenToWorld([g,h]),this.screenToWorld([g,_]),this.screenToWorld([l,_])],this._lookAtData.bounds=this._clipAgainstGeoBounds(A))}},{key:"_clipAgainstGeoBounds",value:function(l){var h,_t,_i,g=A0(j_.getBBox(l),4),_=My.half_circumference_meters,j=j_.clipPolygon([[(_t=g[0])-1,+_],[(_i=g[2])+1,+_],[_i+1,-_],[_t-1,-_]],l)[0],$=A0(j_.getBBox(j),4),Ye=$[1],_s=$[3];(_i=$[2])-(_t=$[0])>=My.circumference_meters&&(j=[[(h=(_i-_t)/2)-_,_s],[h+_,_s],[h+_,Ye],[h-_,Ye]]);var Ja=[];return j&&(Ja=j_.splitLegs(j,_)),Ja}},{key:"applyPxOffset",value:function(l){var h=A0(l,2),g=h[0],_=h[1],A=Math.PI-this._lookAtData.heading*LE,j=My.metersPerPixel(this._lookAtData.zoom);this._lookAtData.position[0]+=(g*Math.cos(A)+_*Math.sin(A))*j,this._lookAtData.position[1]-=(_*Math.cos(A)-g*Math.sin(A))*j,this._lookAtData.position[1]=j_.clamp(this._lookAtData.position[1],-My.half_circumference_meters,My.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"screenToWorld",value:function(l){var h=A0(l,2),g=h[0],_=h[1],A=this._viewport,j=A.width,$=A.height;return 0===j||0===$?[0,0]:this._clipCoordsToWorldPlaneCoords([2*((g-=j/2)+j/2)/j-1,1-2*((_-=$/2)+$/2)/$,-1,1])}},{key:"_clipToScreenCoords",value:function(l){var h=this._viewport,_=h.height;return[(.5*l[0]+.5)*h.width,_-(.5*l[1]+.5)*_]}},{key:"_isScreenPointInViewPort",value:function(l){var h=this._viewport;return 0<=l[0]&&l[0]<=h.width&&0<=l[1]&&l[1]<=h.height}},{key:"worldToScreen",value:function(l,h){var g,_,A,j,$,_t,Ye=1<arguments.length&&void 0!==h&&h;return l[2]||(l[2]=0),Ye?(g=this._worldToClipCoords(l),$=this._clipToScreenCoords(g)):(_=Math.sign(this._lookAtData.position[0]),A=Math.trunc(this._lookAtData.position[0]/My.circumference_meters+_/2),l[0]+=My.circumference_meters*A,j=this._worldToClipCoords(l),_t=$=this._clipToScreenCoords(j),this._isScreenPointInViewPort($)||(j=this._worldToClipCoords([l[0]+My.circumference_meters,l[1],l[2]]),$=this._clipToScreenCoords(j),this._isScreenPointInViewPort($)||(j=this._worldToClipCoords([l[0]-My.circumference_meters,l[1],l[2]]),$=this._clipToScreenCoords(j)),this._isScreenPointInViewPort($)||($=_t))),$}},{key:"getHorizon",value:function(){return this._horizon}},{key:"_clipCoordsToWorldPlaneCoords",value:function(l){var h=[],g=this._lookAtData.distance,_=this._lookAtData.position,A=[0,0,g,0],j=0,$=g*Math.sin(LE*this._lookAtData.tilt)*Math.cos(LE*this._lookAtData.heading),_t=g*Math.sin(LE*this._lookAtData.tilt)*Math.sin(LE*this._lookAtData.heading),Ye=new Float64Array(16),_i=new Float64Array(16);return bx_invert(Ye,this._projection_matrix),rA_transformMat4(h,l,Ye),h[2]=-1,h[3]=0,bx_invert(_i,this._view_matrix),rA_transformMat4(h,h,_i),function(s,l){var h=l[0],g=l[1],_=l[2],A=l[3],j=h*h+g*g+_*_+A*A;0<j&&(j=1/Math.sqrt(j),s[0]=h*j,s[1]=g*j,s[2]=_*j,s[3]=A*j)}(h,h),rA_transformMat4(A,A,this._transformation_matrix),0!==h[2]&&(j=-A[2]/h[2]),rA_scale(h,h,j),[_[0]+(h[0]+_t),_[1]+(h[1]+$)]}},{key:"_worldToClipCoords",value:function(l){var h=[l[0],l[1],l[2],1];return rA_transformMat4(h,h,this._view_matrix),rA_transformMat4(h,h,this._projection_matrix),rA_scale(h,h,1/h[3]),h}},{key:"setupProgram",value:function(l){l.uniform("Matrix4fv","u_projection",this._projection_matrix),l.uniform("3f","u_eye",[0,0,this._lookAtData.distance]),l.uniform("2fv","u_center_offset",this._center_offset_normalized),l.uniform("1f","u_tilt",this._lookAtData.tilt*LE),l.uniform("1f","u_heading",this._lookAtData.heading*LE),l.uniform("1f","u_near_plane",1),l.uniform("1f","u_depth_buffer_adjustment",this._depth_buffer_adjustment)}},{key:"getTransformationMatrix",value:function(){return this._transformation_matrix}},{key:"getCameraMatrix",value:function(){return this._camera_matrix}},{key:"clone",value:function(){var l=new s(this._viewport,this._lookAtData);return l.setZoomConstraints(this._min_zoom,this._max_zoom),l}},{key:"getViewport",value:function(){return this._viewport}}]),s}();function r4(s){return void 0===s.x?s[0]:s.x}function i4(s){return void 0===s.y?s[1]:s.y}function _O(s,l){return r4(s)-r4(l)}function hP(s,l){return i4(s)-i4(l)}function fP(s){return s.sort(_O)}function pP(s,l){for(var h,g=s[0],_=g,A=0;A<s.length;A+=1)l(h=s[A],g)<0?g=h:0<l(h,_)&&(_=h);return[g,_]}function dP(s,l){return Object.values(l.reduce(function(h,g){var _=g[+s];return h[_]||(h[_]=[]),h[_].push(g),h},{}))}function bO(s,l,h){var g=+s,_=l[g],A=h[g];if(A<_)return[];var j=[l];if(A<_)return j;for(var $=l[(1+g)%2],_t=s?function(_i){return j.push([$,_i])}:function(_i){return j.push([_i,$])},Ye=_+1;Ye<A;Ye+=1)_t(Ye);return j.push(h),j}function LD(s,l){return bO(!1,s,l)}function gP(s,l){return bO(!0,s,l)}function eC(s){var l={},h=[];return s.forEach(function(g){var _=g.key||(Array.isArray(g)?"".concat(g[0],"/").concat(g[1]):"".concat(g.x,"/").concat(g.y));l[_]||(l[_]=!0,h.push(g))}),h}function yP(s){return s.reduce(function(l,h){return l.concat(h)})}function mP(s,l,h){var g=function($,_t,Ye){var _i=A0($,2),_s=_i[0],Ja=_i[1],_l=A0(_t,2),lc=_l[0],_p=_l[1],ka=A0(Ye,2),ty=ka[0],ny=ka[1],ry=_s+(_p-Ja)/(ny-Ja)*(ty-_s);return[[[_s,Ja]].concat(A_(fP([[lc,_p],[ry,_p]]))),[].concat(A_(fP([[lc,_p],[ry,_p]])),[[ty,ny]])]}.apply(void 0,A_([s,l,h].sort(hP))),_=A0(g,2),j=_[1];return eC(function($,_t,Ye){var _i=A0($,2),_s=_i[0],Ja=_i[1],_l=A0(_t,2),_p=_l[1];return wO(_s,_l[0],A0(Ye,1)[0],Ja,_p)}.apply(void 0,A_(_[0])).concat(function($,_t,Ye){var _i=A0($,2),_s=_i[0],Ja=_i[1],_l=A0(_t,1)[0],lc=A0(Ye,2);return wO(lc[0],_s,_l,lc[1],Ja)}.apply(void 0,A_(j))))}function wO(s,l,h,g,_){var A,j,$,_t,Ye,_s,Ja,_l,lc,_p=Math.min(s,l),ka=Math.max(s,h),ty=Math.min(g,_),ny=Math.max(g,_);if(Math.floor(g)===Math.floor(_))return _P(_p,ka,g);if(ny-ty<.125)return A=[ka,ny],$=(j=A0([_p,ty],2))[0],_t=j[1],_s=(Ye=A0(A,2))[1],_l=xO(Ja=vP($,Ye[0]),_t),lc=xO(Ja,_s),_l.concat(lc);function ry(Yy){Sy=Sy.concat(_P(Dy,Ny,Math.floor(Yy))),Dy+=_y,Ny+=Iy}var ly,ey,hy=.125*((ey=ny)-(ly=ty))/(Math.ceil(ey)-Math.floor(ly)),fy=(ny-ty)/hy,_y=(l-s)/fy,Iy=(h-s)/fy,Sy=[],Dy=s,Ny=s;if(g<_)for(var r0=ty;r0<=ny;r0+=hy)ry(r0);else for(var Vy=ny;ty<=Vy;Vy-=hy)ry(Vy);return eC(Sy)}function xO(s,l){return s.map(function(h){return[h,l]})}function vP(s,l){var h=Math.floor(s),g=Math.floor(l);if(g<h)return[];if(h===g)return[h];for(var _=[],A=h;A<=g;A+=1)_.push(A);return _}function _P(s,l,h){return xO(vP(s,l),h)}var s4=function(){function s(l,h){D0(this,s),FA(this),this.scene=l,this.createMatrices(),this.bounds=null,this.center_tile=null,this.panning=!1,this.panning_stop_at=0,this.pan_snap_timer=0,this.user_input_at=0,this.user_input_timeout=50,this.user_input_active=!1,this.size={},this.buffer=0,this.wrap=!1!==h.wrapView,this.preserve_tiles_within_zoom=1,this.lookAtManipulator=new vO(h.viewport),this._viewport=h.viewport,this._offset_buffer=[0,0],this.handleViewportUpdate(!0)}return T0(s,[{key:"update",value:function(){this.pan_snap_timer=(new Date-this.panning_stop_at)/1e3,this.user_input_active=new Date-this.user_input_at<this.user_input_timeout,this.scene.tile_manager.updateTilesVisibilityCounters()}},{key:"handleViewportUpdate",value:function(l){var h=0<arguments.length&&void 0!==l&&l,g=this._viewport,_=g.width,A=g.height;this.size.css={width:_,height:A},this.size.device={width:Math.round(_*G0.device_pixel_ratio),height:Math.round(A*G0.device_pixel_ratio)},this.lookAtManipulator.handleViewportUpdate(),h||this.updateBounds()}},{key:"setLookAtData",value:function(l,h){s._setLookAtDataForManipulator(this.lookAtManipulator,l,h),this.updateBounds()}},{key:"getLookAtData",value:function(l){var h=0<arguments.length&&void 0!==l&&l;return s._getLookAtDataFromManipulator(this.lookAtManipulator,h)}},{key:"getBestLookAtData",value:function(l,h,g){var _=2<arguments.length&&void 0!==g&&g,A=this.lookAtManipulator.clone();return s._setLookAtDataForManipulator(A,l,h),s._getLookAtDataFromManipulator(A,_)}},{key:"getTileLevel",value:function(){return this.lookAtManipulator.getLookAtData().tile_level}},{key:"applyPxOffset",value:function(l){var h=this._offset_buffer;h[0]+=l[0],h[1]+=l[1];var g,_,A=Math.abs(h[0]),j=Math.abs(h[1]);(1<=A||1<=j)&&(g=~~h[0],_=~~h[1],this.lookAtManipulator.applyPxOffset([A<1?0:g,j<1?0:_]),1<=A&&(h[0]-=g),1<=j&&(h[1]-=_),this.updateBounds())}},{key:"setPanning",value:function(l){this.panning=l,this.panning||(this.panning_stop_at=+new Date)}},{key:"markUserInput",value:function(){this.user_input_at=+new Date}},{key:"ready",value:function(){return"number"==typeof this.size.css.width&&"number"==typeof this.size.css.height}},{key:"updateBounds",value:function(){var l,h;this.markUserInput(),this.ready()&&(this.center_tile=My.tileForMeters(this.lookAtManipulator.getLookAtData().position,this.lookAtManipulator.getLookAtData().tile_level),l=this.lookAtManipulator.screenToWorld([0,this.size.css.height]),h=this.lookAtManipulator.screenToWorld([this.size.css.width,0]),this.bounds={sw:{x:l[0],y:l[1]},ne:{x:h[0],y:h[1]}},this.scene.tile_manager.updateTilesForView(!0),this.trigger("move"),this.scene.requestRedraw())}},{key:"getTileGridFlatForBBox",value:function(l,h,g,_,A,j){var $,_t=4<arguments.length&&void 0!==A?A:0,Ye=!(5<arguments.length&&void 0!==j)||j,_i=this.lookAtManipulator.getLookAtData().tile_level,_s=My.tileForMeters([h,l],_i),Ja=My.tileForMeters([_,g],_i);_s.x-=_t,_s.y-=_t,Ja.x+=_t,Ja.y+=_t,!1===Ye&&($=(1<<_i)-1,_s.x=Math.min(Math.max(0,_s.x),$),_s.y=Math.min(Math.max(0,_s.y),$),Ja.x=Math.min(Math.max(0,Ja.x),$),Ja.y=Math.min(Math.max(0,Ja.y),$));for(var _l=[],lc={},_p=_s.x;_p<=Ja.x;_p++)for(var ka=_s.y;ka<=Ja.y;ka++){var ty=n1.coord(My.wrapTile({x:_p,y:ka,z:_i},{x:!Ye,y:!0}));lc[ty.key]||(lc[ty.key]=!0,_l.push(ty))}return _l}},{key:"getTileGridFlat",value:function(){return this.getTileGridFlatForBBox(this.bounds.ne.y,this.bounds.sw.x,this.bounds.sw.y,this.bounds.ne.x,this.buffer,this.wrap)}},{key:"getTileGridDistorted",value:function(){return function o4(s,l,h){function g(_l){return Object.values(My.metersToExactTileCoords(_l,s.tile_level))}var _,A,j,$,_t,Ye,_i,_s,Ja;return eC((_=function P1(s,l){return l<=0?s:eC((h=yP(dP(!1,s).map(function(j){var $=A0(pP(j,hP),2),_t=$[0],Ye=$[1],_s=[Ye[0],Ye[1]+l];return j.concat(gP([_t[0],_t[1]-l],_t),gP(Ye,_s))})),yP(dP(!0,h).map(function(j){var $=A0(pP(j,_O),2),_t=$[0],Ye=$[1],_s=[Ye[0]+l,Ye[1]];return j.concat(LD([_t[0]-l,_t[1]],_t),LD(Ye,_s))}))));var h}(($=g(s.tetragon[0]),_t=g(s.tetragon[1]),Ye=g(s.tetragon[3]),_i=g(s.tetragon[2]),_s=mP(_t,$,Ye),Ja=mP(Ye,_i,_t),eC(_s.concat(Ja))),l),A=s.tile_level,j=h,_.map(function(_l){var lc=A0(_l,2);return n1.coord(My.wrapTile({x:lc[0],y:lc[1],z:A},{x:!j,y:!0}))})))}(this.lookAtManipulator.getLookAtData(),this.buffer,this.wrap)}},{key:"findVisibleTileCoordinates",value:function(){if(!this.bounds)return[];var l=this.lookAtManipulator.getLookAtData();return 0===l.tilt&&180===l.heading?this.getTileGridFlat():this.getTileGridDistorted()}},{key:"createMatrices",value:function(){this.matrices={},this.matrices.model=new Float64Array(16),this.matrices.model32=new Float32Array(16),this.matrices.model_view=new Float64Array(16),this.matrices.model_view32=new Float32Array(16),this.matrices.normal=new Float64Array(9),this.matrices.normal32=new Float32Array(9),this.matrices.inverse_normal32=new Float32Array(9)}},{key:"setupTile",value:function(l,h){l.setupProgram(this.matrices,h),this.lookAtManipulator.setupMatrices(this.matrices,h)}},{key:"setupProgram",value:function(l){var h=this.lookAtManipulator.getLookAtData();l.uniform("2fv","u_resolution",[this.size.device.width,this.size.device.height]),l.uniform("3fv","u_map_position",[h.position[0],h.position[1],Math.trunc(1e5*h.zoom)/1e5]),l.uniform("1f","u_meters_per_pixel",My.metersPerPixel(h.zoom)),l.uniform("1f","u_device_pixel_ratio",G0.device_pixel_ratio),l.uniform("1f","u_view_pan_snap_timer",this.pan_snap_timer),l.uniform("1i","u_view_panning",this.panning),l.uniform("1f","u_horizon",this.lookAtManipulator.getHorizon()/(this.size.css.height/2)),this.lookAtManipulator.setupProgram(l)}},{key:"isAnimating",value:function(){return this.pan_snap_timer<=.5}},{key:"xyToGeo",value:function(l,h){var g=this.lookAtManipulator.screenToWorld([l,h]),_=A0(My.metersToLatLng(g),2);return{lat:_[1],lng:_[0]}}},{key:"geoToPixel",value:function(l){var h=My.latLngToMeters([l.lng,l.lat]);h.push(l.alt||0);var g=this.lookAtManipulator.worldToScreen(h);return{x:Math.floor(g[0]),y:Math.floor(g[1])}}},{key:"geoToMeters",value:function(l){var h=A0(My.latLngToMeters([l.lng,l.lat]),2);return{x:h[0],y:h[1],z:l.alt||0}}},{key:"metersToGeo",value:function(l){var h=A0(My.metersToLatLng([l.x,l.y]),2);return{lat:h[1],lng:h[0],alt:l.z||0}}},{key:"setZoomConstraints",value:function(l,h){this.lookAtManipulator.setZoomConstraints(l,h)}}],[{key:"_setLookAtDataForManipulator",value:function(l,h,g){var _=h.position,_t=h.bounds,Ye={zoom:h.zoom,tilt:h.tilt,heading:h.heading};if(_&&"number"==typeof _.lng&&"number"==typeof _.lat&&(Ye.position=My.latLngToMeters([_.lng,_.lat])),_t){var _i=_t.getExterior().getLatLngAltArray(),_s=_i.length/3,Ja=Array(_s);if(_t.getBoundingBox().isCDB())for(var _l=_i[1],lc=0,_p=0;_p<_s;_p++){var ty=_i[3*_p+1];0<_p&&180<Math.abs(ty-_l)&&(lc+=_l<ty?-360:360),_l=ty,Ja[_p]=My.latLngToMeters([ty+lc,_i[3*_p]])}else for(var ny=0;ny<_s;ny++)Ja[ny]=My.latLngToMeters([_i[3*ny+1],_i[3*ny]]);Ye.bounds=Ja}l.setLookAtData(Ye,g)}},{key:"_getLookAtDataFromManipulator",value:function(l,h){var g=1<arguments.length&&void 0!==h&&h,_=l.getLookAtData(),A=_.heading,j=_.incline,$=_.tilt,_t=_.zoom,Ye=_.position,_i=_.bounds,_s=_.unpadded_bounds,Ja=A0(My.metersToLatLng(Ye),2),_l=Ja[0],lc=Ja[1],_p=new H.geo.LineString;return(g?_s:_i).forEach(function(ka){var ty=My.metersToLatLng(ka);_p.pushLatLngAlt(ty[1],ty[0],0)}),{heading:A,incline:j,tilt:$,zoom:_t,bounds:new H.geo.Polygon(_p),position:{lat:lc,lng:_l,alt:Ye[2]}}}}]),s}(),FD=hx.PLACEMENT,FV=128/Math.PI,jV=16384/Math.PI,Jx=Object.create(W_);Object.assign(Jx,LV),Object.assign(Jx,{name:"points",built_in:!0,vertex_shader_src:"uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform bool u_tile_fade_in;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform bool u_view_panning;uniform float u_tilt;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform float u_heading;uniform float u_near_plane;uniform float u_depth_buffer_adjustment;attribute vec4 a_position;attribute vec4 a_shape;attribute vec4 a_color;attribute vec2 a_texcoord;attribute vec2 a_offset;uniform float u_point_type;attribute float a_is_flat;\n#ifdef TANGRAM_IS_TEXT_STYLE\nattribute vec4 a_offsets_alt;attribute vec4 a_pre_angles_alt;attribute vec4 a_angles_alt;attribute vec4 a_offsets;attribute vec4 a_pre_angles;attribute vec4 a_angles;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nattribute float a_is_stick;attribute float a_stick_height;varying float v_is_stick;\n#endif\nvarying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nattribute float a_outline_edge;attribute vec4 a_outline_color;varying float v_outline_edge;varying vec4 v_outline_color;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#define PI 3.14159265359\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvec2 rotate2D(vec2 _st,float _angle){return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle))*_st;}vec3 rotateX3D(vec3 _st,float _angle){return mat3(1.,0.,0.,0.,cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle))*_st;}vec3 rotateZ3D(vec3 _st,float _angle){return mat3(cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle),0.,0.,0.,1.)*_st;}\n#ifdef TANGRAM_IS_TEXT_STYLE\nfloat mix4linear(float a,float b,float c,float d,float x){return mix(mix(a,b,3.*x),mix(b,mix(c,d,3.*(max(x,.66)-.66)),3.*(clamp(x,.33,.66)-.33)),step(0.33,x));}\n#endif\nvoid main(){\n#pragma tangram: setup\n#ifndef TANGRAM_SHOW_HIDDEN_LABELS\nif(a_shape.w==0.){gl_Position=vec4(0.,0.,0.,1.);return;}\n#else\nif(a_shape.w==0.){v_label_hidden=1.;}else{v_label_hidden=0.;}\n#endif\nv_alpha_factor=1.0;v_color=a_color;v_texcoord=a_texcoord;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nv_outline_color=a_outline_color;v_outline_edge=a_outline_edge;if(u_point_type==TANGRAM_POINT_TYPE_SHADER){v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;float size=abs(a_shape.x/128.);v_texcoord=sign(a_shape.xy)*(size+1.0)/size;size+=2.0;v_aa_offset=2.0/size;}\n#endif\nvec4 position=u_modelView*vec4(a_position.xyz,1.);vec4 shape=vec4(a_shape.xy,0.,0.);vec2 offset=vec2(a_offset.x,-a_offset.y);\n#ifdef TANGRAM_POINT_DRAW_STICK\nv_is_stick=a_is_stick;float scaled_stick_height=(sin(u_tilt+(1.5*PI))+1.0)*a_stick_height;offset.y+=(1.0-a_is_stick)*scaled_stick_height;\n#endif\nfloat zoom=clamp(u_map_position.z-u_tile_origin.z,0.,1.);float theta=a_shape.z/4096.;float heading=u_heading;float delta=(heading-PI);float new_theta=theta-delta;float reversed=abs(new_theta)>PI/2. ? 1. : 0.;if(a_is_flat==1.0){\n#ifdef TANGRAM_IS_TEXT_STYLE\nif(a_offsets[0]!=0.){vec4 angles_scaled;vec4 pre_angles_scaled;vec4 offsets_scaled;if(reversed==1.){offsets_scaled=a_offsets_alt*4.;angles_scaled=(PI/16384.)*a_angles_alt;pre_angles_scaled=(PI/128.)*a_pre_angles_alt;}else{offsets_scaled=a_offsets*4.;angles_scaled=(PI/16384.)*a_angles;pre_angles_scaled=(PI/128.)*a_pre_angles;}float pre_angle=mix4linear(pre_angles_scaled[0],pre_angles_scaled[1],pre_angles_scaled[2],pre_angles_scaled[3],zoom);float angle=mix4linear(angles_scaled[0],angles_scaled[1],angles_scaled[2],angles_scaled[3],zoom);float offset_curve=mix4linear(offsets_scaled[0],offsets_scaled[1],offsets_scaled[2],offsets_scaled[3],zoom);shape.xy=rotate2D(shape.xy,pre_angle+PI*reversed);shape.x+=offset_curve;shape.xy=rotate2D(shape.xy,angle);shape.xy+=rotate2D(offset,theta);}else{shape.xy=rotate2D(shape.xy+offset*256.,theta+(PI*reversed));}\n#else\nshape.xy=rotate2D(shape.xy+offset*256.,theta);\n#endif\nshape.xy/=pow(2.,4.+(u_map_position.z-u_tile_origin.w));shape=u_modelView*shape;position+=shape;}else{shape.xy/=256.;\n#ifdef TANGRAM_POINT_DRAW_STICK\nshape.y*=1.0+(scaled_stick_height-1.0)*a_is_stick;\n#endif\nshape.xy=rotate2D(shape.xy+offset,theta);}\n#ifdef TANGRAM_FADE_IN_RATE\nif(u_tile_fade_in){v_alpha_factor*=clamp(u_visible_time*TANGRAM_FADE_IN_RATE,0.,1.);}\n#endif\n#ifdef TANGRAM_FADE_ON_ZOOM_OUT\nv_alpha_factor*=clamp(1.+TANGRAM_FADE_ON_ZOOM_OUT_RATE*(u_map_position.z-u_tile_origin.z),0.,1.);\n#endif\nv_world_position=u_model*position;v_world_position.xy+=shape.xy*u_meters_per_pixel;v_world_position=wrapWorldPosition(v_world_position);\n#pragma tangram: position\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);/***Due to the precision loss on depth buffer,we had a z-fighting of translucent points when the distance to the camera was big.*For more information about the problem see: https:*For more information about the fix see: https:*position.z=(2.0*log(position.w/u_near_plane)/log(u_far_plane/u_near_plane)-1.0)*position.w;*/position.z=(log(position.w/u_near_plane)*u_depth_buffer_adjustment-1.0)*position.w;\n#endif\nif(a_is_flat!=1.){position.xy+=shape.xy*position.w*2.*u_device_pixel_ratio/u_resolution;}\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_SHADER){position.xy+=sign(shape.xy)*position.w*u_device_pixel_ratio/u_resolution;}\n#endif\nif(!u_view_panning){snapToPixelGrid(position);}gl_Position=position;}",fragment_shader_src:"uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_texture;uniform float u_point_type;uniform bool u_apply_color_blocks;varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nvarying vec4 v_outline_color;varying float v_outline_edge;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nvarying float v_is_stick;\n#endif\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#ifdef TANGRAM_HAS_SHADER_POINTS\nfloat _tangram_antialias(float l,float R){float low=R-v_aa_offset;float high=R+v_aa_offset;return 1.-smoothstep(low,high,l);}\n#endif\nvoid mixTextureColor(inout vec4 color){\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_TEXTURE){color*=texture2D(u_texture,v_texcoord);}else if(u_point_type==TANGRAM_POINT_TYPE_LABEL){color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);}else if(u_point_type==TANGRAM_POINT_TYPE_SHADER){float outline_edge=v_outline_edge;vec4 outlineColor=v_outline_color;float l=length(v_texcoord);float outer_alpha=_tangram_antialias(l,1.);float fill_alpha=_tangram_antialias(l,1.-v_outline_edge*0.5)*color.a;float stroke_alpha=(outer_alpha-_tangram_antialias(l,1.-v_outline_edge))*outlineColor.a;\n#ifdef TANGRAM_BLEND_ADD\ncolor.a=stroke_alpha+fill_alpha;color.rgb=color.rgb*fill_alpha+outlineColor.rgb*stroke_alpha;\n#else\ncolor.a=stroke_alpha+fill_alpha*(1.-stroke_alpha);color.rgb=mix(color.rgb*fill_alpha,outlineColor.rgb,stroke_alpha)/max(color.a,0.001);\n#endif\n}\n#else\ncolor=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);\n#endif\nif(u_apply_color_blocks){\n#pragma tangram: color\n#pragma tangram: filter\n}color.a*=v_alpha_factor;\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nif(v_label_hidden>0.){color.a*=0.5;color.rgb=vec3(1.,0.,0.);}\n#endif\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY) && !defined(TANGRAM_BLEND_ADD)\nif(color.a<TANGRAM_ALPHA_TEST){discard;}\n#endif\n}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;\n#ifdef TANGRAM_POINT_DRAW_STICK\nif(v_is_stick==0.0){mixTextureColor(color);}\n#else\nmixTextureColor(color);\n#endif\ngl_FragColor=color;}",selection:!0,collision:!0,blend:"overlay",init:function(s){var l=0<arguments.length&&void 0!==s?s:{};W_.init.call(this,l),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!0,this.defines.TANGRAM_POINT_TYPE_TEXTURE=1,this.defines.TANGRAM_POINT_TYPE_LABEL=2,this.defines.TANGRAM_POINT_TYPE_SHADER=3,this.defines.TANGRAM_POINT_DRAW_STICK=!!this.stick,this.collision_group_points=this.name+"-points",this.collision_group_text=this.name+"-text",this.reset()},setupDefines:function(){"overlay"!==this.blend&&(this.defines.TANGRAM_LAYER_ORDER=!0),this.defines.TANGRAM_FADE_ON_ZOOM_OUT=!0,this.defines.TANGRAM_FADE_ON_ZOOM_OUT_RATE=2,ZA.suppress_label_fade_in||this.suppress_fade?(this.fade_in_time=0,this.defines.TANGRAM_FADE_IN_RATE=null):(this.fade_in_time=.15,this.defines.TANGRAM_FADE_IN_RATE=1/this.fade_in_time),ZA.suppress_snap_animation||(this.defines.TANGRAM_VIEW_PAN_SNAP_RATE=2),ZA.show_hidden_labels&&(this.defines.TANGRAM_SHOW_HIDDEN_LABELS=!0)},reset:function(){this.queues={},this.resetText(),this.texture_missing_sprites={}},addFeature:function(s,l,h){var g,_,A,j=h.tile,$={};if($.color=this.parseColor(l.color,h),$.texture=l.texture,$.label_texture=null,$.color||$.texture){if(this.hasSprites($)){if(!(g=this.parseSprite($,l,h)))return;$.texcoords=g.texcoords}if($.size=l.size,$.size){if($.size=by.evalCachedPointSizeProperty(l.size,g,h),null==$.size)return void $y({level:"warn",once:!0},"Layer '".concat(l.layers[l.layers.length-1],"': ")+"'size' includes % and/or ratio-based scaling (".concat(JSON.stringify(l.size.value),"); ")+"these can only applied to sprites, but no sprite was specified, skipping features in layer");"number"==typeof $.size&&($.size=[$.size,$.size])}else $.size=g&&g.css_size||[16,16];l.outline&&($.outline_width=by.evalCachedProperty(l.outline.width,h)||by.defaults.outline.width,$.outline_color=this.parseColor(l.outline.color,h)),$.outline_edge_pct=0,$.outline_width&&$.outline_color&&($.size[0]+=_=$.outline_width,$.size[1]+=_,$.outline_edge_pct=_/Math.min($.size[0],$.size[1])*2),$.size[0]=Math.min($.size[0],256),$.size[1]=Math.min($.size[1],256),$.placement=l.placement,$.placement_min_length_ratio=by.evalCachedProperty(l.placement_min_length_ratio,h),$.placement===FD.SPACED&&l.placement_spacing&&($.placement_spacing=by.evalCachedProperty(l.placement_spacing,h)),$.angle=by.evalProperty(l.angle,h)||0,$.elevate_by_altitude=!!l.elevate_by_altitude,$.z=l.z?j_.clamp(by.evalCachedDistanceProperty(l.z,h),0,32767):by.defaults.z,$.flat=l.flat,$.tile_edges=l.tile_edges,this.computeLayout($,s,l,h,j),l.stick&&!$.flat&&(A=by.parseNumber(by.evalProperty(l.stick.height,h)),$.stick={color:this.parseColor(l.stick.color,h)||by.defaults.color,height:A?Math.max(A,0):0});var _t=l.text&&!1!==by.evalProperty(l.text.visible,h)&&this.parseTextFeature(s,l.text,h,j);Array.isArray(_t)&&$y({level:"warn",once:!(_t=null)},"Layer '".concat(l.layers[l.layers.length-1],"': ")+"cannot use boundary labels (e.g. 'text_source: { left: ..., right: ... }') for 'text' labels attached to 'points'; "+"provided 'text_source' value was ".concat(JSON.stringify(l.text.text_source))),_t&&(_t.layout.parent=$,_t.layout.priority=l.text.priority?Math.max(_t.layout.priority,$.priority+.5):$.priority+.5,_t.layout.move_into_tile=!1,zx.addStyle(this.collision_group_text,j.id)),this.queueFeature({feature:s,draw:l,context:h,style:$,text_feature:_t},j),zx.addStyle(this.collision_group_points,j.id)}},hasSprites:function(s){return s.texture&&this.textureManager.textures[s.texture]&&this.textureManager.textures[s.texture].sprites},getSpriteInfo:function(s,l){var h=this.textureManager.textures[s.texture].sprites[l]&&this.textureManager.getSpriteInfo(s.texture,l);return l&&!h?(this.texture_missing_sprites[s.texture]=this.texture_missing_sprites[s.texture]||{},this.texture_missing_sprites[s.texture][l]||($y("debug","Style: in style '".concat(this.name,"', could not find sprite '").concat(l,"' for texture '").concat(s.texture,"'")),this.texture_missing_sprites[s.texture][l]=!0)):h&&(h.sprite=l),h},parseSprite:function(s,l,h){var g=by.evalProperty(l.sprite,h);return this.getSpriteInfo(s,g)||this.getSpriteInfo(s,l.sprite_default)},queueFeature:function(s,l){this.tile_data[l.id]&&this.queues[l.id]||this.startData(l),this.queues[l.id]=this.queues[l.id]||[],this.queues[l.id].push(s)},endData:function(s){var l=this;if(s.canceled)return $y("trace","Style ".concat(this.name,": stop tile build because tile was canceled: ").concat(s.key)),Promise.resolve();var h=this.queues[s.id];delete this.queues[s.id];var g=[],_=[];return h.forEach(function(A){for(var j=A.style,$=A.feature,Ye=l.buildLabels(j.size,$.geometry,j),_i=0;_i<Ye.length;_i++){var _s,Ja=Ye[_i],_l={feature:$,draw:A.draw,context:A.context,style:j,label:Ja};_.push(_l),A.text_feature&&(g.push(_s={feature:$,draw:A.text_feature.draw,context:A.context,text:A.text_feature.text,text_settings_key:A.text_feature.text_settings_key,layout:A.text_feature.layout,point_label:Ja,linked:_l}),A.draw.text.optional||(_l.linked=_s))}}),Promise.all([zx.collide(_,this.collision_group_points,s.id).then(function(A){A.forEach(function(j){l.feature_style=j.style,l.feature_style.label=j.label,l.feature_style.linked=j.linked,W_.addFeature.call(l,j.feature,j.draw,j.context)})}),this.collideAndRenderTextLabels(s,this.collision_group_text,g)]).then(function(A){var j=A0(A,2)[1],$=j.labels,_t=j.texts;return $&&_t&&$.forEach(function(Ye){var _i=Ye.text_settings_key,_s=_t[_i]&&_t[_i][Ye.text],Ja=l.feature_style;Ja.label=Ye.label,Ja.linked=Ye.linked,Ja.size=_s.size.logical_size,Ja.angle=0,Ye.label.text_data={text_info:_s,text_settings_key:_i,text:Ye.text},Ja.label_texture=l.textureManager.default,W_.addFeature.call(l,Ye.feature,Ye.draw,Ye.context)}),l.freeText(s),W_.endData.call(l,s)})},_preprocess:function(s){s.color=by.createColorPropertyCache(s.color),s.texture=void 0!==s.texture?s.texture:this.texture,s.outline&&(s.outline.color=by.createColorPropertyCache(s.outline.color),s.outline.width=by.createPropertyCache(s.outline.width,by.parsePositiveNumber)),s.z=by.createPropertyCache(s.z,by.parseUnits);try{s.size=by.createPointSizePropertyCache(s.size)}catch(l){return $y({level:"warn",once:!0},"Layer '".concat(s.layers[s.layers.length-1],"': ")+"".concat(l," (").concat(JSON.stringify(s.size),"), skipping features in layer")),null}return s.offset=by.createPropertyCache(s.offset,function(l){return Array.isArray(l)&&l.map(by.parseNumber)}),s.buffer=by.createPropertyCache(s.buffer,function(l){return(Array.isArray(l)?l:[l,l]).map(by.parsePositiveNumber)}),s.repeat_distance=by.createPropertyCache(s.repeat_distance,by.parseNumber),null==s.repeat_group&&(s.repeat_group=s.layers.join("-")),s.placement=FD[s.placement&&s.placement.toUpperCase()],null==s.placement&&(s.placement=FD.VERTEX),s.placement_spacing=null!=s.placement_spacing?s.placement_spacing:80,s.placement_spacing=by.createPropertyCache(s.placement_spacing,by.parsePositiveNumber),s.placement_min_length_ratio=null!=s.placement_min_length_ratio?s.placement_min_length_ratio:1,s.placement_min_length_ratio=by.createPropertyCache(s.placement_min_length_ratio,by.parsePositiveNumber),s.angle="number"==typeof s.angle?s.angle*Math.PI/180:s.angle||0,s.text=this.preprocessText(s.text),s.text&&(s.text.variantKey=s.variantKey,s.text.group=s.group,s.text.layers=s.layers,s.text.order=s.order,s.text.repeat_group=s.text.repeat_group||s.repeat_group,s.text.anchor=s.text.anchor||this.default_anchor,s.text.optional="boolean"==typeof s.text.optional&&s.text.optional,s.text.interactive=s.text.interactive||s.interactive),s.stick&&(s.stick.color=by.createColorPropertyCache(s.stick.color)),s},default_anchor:["bottom","top","right","left"],computeLayout:function(s,l,h,g,_){var A=s||{};A.id=l,A.units_per_pixel=_.units_per_pixel||1,A.collide=!1!==h.collide,A.anchor=h.anchor,A.offset=by.evalCachedProperty(h.offset,g)||by.zeroPair,A.buffer=by.evalCachedProperty(h.buffer,g)||by.zeroPair,A.repeat_distance=by.evalCachedProperty(h.repeat_distance,g),A.repeat_distance&&(A.repeat_distance*=A.units_per_pixel,A.repeat_scale=1,A.repeat_group="function"==typeof h.repeat_group?h.repeat_group(g):h.repeat_group);var j=h.priority;return null!=j?"function"==typeof j&&(j=j(g)):j=4294967295,A.priority=j,A},buildTextLabels:function(s,l){for(var h=[],g=0;g<l.length;g++){var _=l[g];_.label=new hx(_.point_label.position,this.texts[s.id][_.text_settings_key][_.text].size.collision_size,_.point_label.isFlat(),_.layout),h.push(_)}return h},buildLabels:function(s,l,h){var g=!!h.flat,_=[];if("Point"===l.type)_.push(new hx(l.coordinates,s,g,h));else if("MultiPoint"===l.type)for(var A=l.coordinates,j=0;j<A.length;++j)_.push(new hx(A[j],s,g,h));else if("LineString"===l.type)for(var _t=fM(l.coordinates,s,g,h),Ye=0;Ye<_t.length;++Ye)_.push(_t[Ye]);else if("MultiLineString"===l.type)for(var _i=l.coordinates,_s=0;_s<_i.length;_s++)for(var Ja=fM(_i[_s],s,g,h),_l=0;_l<Ja.length;++_l)_.push(Ja[_l]);else if("Polygon"===l.type)if(h.placement===FD.CENTROID){var lc=My.centroid(l.coordinates);_.push(new hx(lc,s,g,h))}else for(var _p=l.coordinates,ka=0;ka<_p.length;ka++)for(var ty=fM(_p[ka],s,g,h),ny=0;ny<ty.length;++ny)_.push(ty[ny]);else if("MultiPolygon"===l.type)if(h.placement===FD.CENTROID){var ry=My.multiCentroid(l.coordinates);_.push(new hx(ry,s,g,h))}else for(var ly=l.coordinates,ey=0;ey<ly.length;ey++)for(var hy=ly[ey],fy=0;fy<hy.length;fy++)for(var _y=fM(hy[fy],s,g,h),Iy=0;Iy<_y.length;++Iy)_.push(_y[Iy]);return _},makeVertexTemplate:function(s,l){var g=s.color||by.defaults.color,_=l.vertex_data.vertex_layout;return this.fillVertexTemplate(_,"a_position",0,{size:2}),this.fillVertexTemplate(_,"a_position",s.z||0,{size:1,offset:2}),this.fillVertexTemplate(_,"a_position",this.scaleOrder(s.order),{size:1,offset:3}),this.fillVertexTemplate(_,"a_shape",0,{size:4}),this.fillVertexTemplate(_,"a_shape",s.label.layout.collide?0:1,{size:1,offset:3}),this.fillVertexTemplate(_,"a_texcoord",0,{size:2}),this.fillVertexTemplate(_,"a_offset",0,{size:2}),this.fillVertexTemplate(_,"a_color",l0.mult(g,255),{size:4}),this.defines.TANGRAM_HAS_SHADER_POINTS&&l.variant.shader_point&&(this.fillVertexTemplate(_,"a_outline_color",l0.mult(s.outline_color||by.defaults.outline.color,255),{size:4}),this.fillVertexTemplate(_,"a_outline_edge",s.outline_edge_pct||by.defaults.outline.width,{size:1})),this.selection&&this.fillVertexTemplate(_,"a_selection_color",l0.mult(s.selection_color,255),{size:4}),this.fillVertexTemplate(_,"a_is_flat",0,{size:1}),this.defines.TANGRAM_POINT_DRAW_STICK&&s.stick&&(this.fillVertexTemplate(_,"a_is_stick",0,{size:1}),this.fillVertexTemplate(_,"a_stick_height",s.stick.height,{size:1})),this.vertex_template},buildQuad:function(s,l,h,g,_,A,j,$,_t,Ye,_i,_s,Ja,_l,lc,_p,ka,ty,ny){return l[0]<=0||l[1]<=0?0:function(ry,ly,ey,hy){var fy,_y,Iy,Sy,Dy,Ny,nE,r0=hy.quad,Vy=hy.offset,Yy=hy.offsets,S0=hy.offsets_alt,o_=hy.pre_angles,$0=hy.pre_angles_alt,Q0=hy.angle,d_=hy.angles,Y_=hy.angles_alt,r1=hy.is_flat,t_=hy.elevate_by_altitude,C_=hy.build_stick_points,Ix=hy.color,H1=hy.stick_color,px=hy.curve,_1=hy.texcoord_normalize,D_=hy.pre_angles_normalize,C1=hy.angles_normalize,Gx=hy.offsets_normalize,dx=r0[0]/2*(nE=(nE=hy.quad_normalize)||1),gA=r0[1]/2*nE,gx=[[-dx,-gA],[dx,-gA],[dx,gA],[-dx,gA]],kx=ly.vertex_elements,d1=ly.vertex_count,Yw=ly.vertex_layout.index,jE=Yw.a_texcoord,wE=Yw.a_position,U1=Yw.a_shape,M2=Yw.a_offset,rC=Yw.a_offsets,iC=Yw.a_offsets_alt,$D=Yw.a_pre_angles,X_=Yw.a_pre_angles_alt,rE=Yw.a_angles,iE=Yw.a_angles_alt,PM=Yw.a_is_flat,F1=Yw.a_is_stick,S_=Yw.a_color;jE&&(_1=_1||1,Ny=[[_y=(fy=A0(hy.texcoord_scale||f2,4))[0],Iy=fy[1]],[Sy=fy[2],Iy],[Sy,Dy=fy[3]],[_y,Dy]]);for(var eT=0,f0=ry.length,OT=0;OT<f0;OT++){var oE=ry[OT];if(C_){for(var oC=.5*nE,RT=+nE,I2=[[-oC,0],[+oC,0],[+oC,RT],[-oC,RT]],sE=0;sE<4;sE++)jE&&(ey[jE+0]=Ny[sE][0]*_1,ey[jE+1]=Ny[sE][1]*_1),ey[wE+0]=oE[0],ey[wE+1]=oE[1],t_&&(ey[wE+2]=j_.clamp(oE[2],0,32767)),ey[U1+0]=I2[sE][0],ey[U1+1]=I2[sE][1],ey[U1+2]=0,ey[S_+0]=H1[0],ey[S_+1]=H1[1],ey[S_+2]=H1[2],ey[S_+3]=H1[3],ey[F1+0]=255,ly.addVertex(ey);kx.push(d1+0),kx.push(d1+1),kx.push(d1+2),kx.push(d1+2),kx.push(d1+3),kx.push(d1+0),d1+=4,eT+=2}for(var nT=0;nT<4;nT++)jE&&(ey[jE+0]=Ny[nT][0]*_1,ey[jE+1]=Ny[nT][1]*_1),ey[wE+0]=oE[0],ey[wE+1]=oE[1],t_&&(ey[wE+2]=j_.clamp(oE[2],0,32767)),ey[U1+0]=gx[nT][0],ey[U1+1]=gx[nT][1],ey[U1+2]=Q0,ey[S_+0]=Ix[0],ey[S_+1]=Ix[1],ey[S_+2]=Ix[2],ey[S_+3]=Ix[3],ey[M2+0]=Vy[0],ey[M2+1]=Vy[1],ey[PM+0]=r1?255:0,C_&&(ey[F1+0]=0),px&&(ey[$D+0]=D_*o_[0],ey[$D+1]=D_*o_[1],ey[$D+2]=D_*o_[2],ey[$D+3]=D_*o_[3],ey[rE+0]=C1*d_[0],ey[rE+1]=C1*d_[1],ey[rE+2]=C1*d_[2],ey[rE+3]=C1*d_[3],ey[rC+0]=Gx*Yy[0],ey[rC+1]=Gx*Yy[1],ey[rC+2]=Gx*Yy[2],ey[rC+3]=Gx*Yy[3],S0&&(ey[iC+0]=Gx*S0[0],ey[iC+1]=Gx*S0[1],ey[iC+2]=Gx*S0[2],ey[iC+3]=Gx*S0[3],ey[X_+0]=D_*$0[0],ey[X_+1]=D_*$0[1],ey[X_+2]=D_*$0[2],ey[X_+3]=D_*$0[3],ey[iE+0]=C1*Y_[0],ey[iE+1]=C1*Y_[1],ey[iE+2]=C1*Y_[2],ey[iE+3]=C1*Y_[3])),ly.addVertex(ey);kx.push(d1+0),kx.push(d1+1),kx.push(d1+2),kx.push(d1+2),kx.push(d1+3),kx.push(d1+0),d1+=4,eT+=2}return eT}(s,lc,_p,{quad:l,quad_normalize:256,offset:$,offsets:_t,offsets_alt:Ye,pre_angles:A,pre_angles_alt:j,angle:4096*h,angles:g,angles_alt:_,is_flat:Ja,elevate_by_altitude:_l,build_stick_points:ka,stick_color:ka&&l0.mult(ty,255),color:l0.mult(ny||by.defaults.color,255),curve:_s,texcoord_scale:_i,texcoord_normalize:65535,pre_angles_normalize:FV,angles_normalize:jV,offsets_normalize:64})},build:function(s,l,h){var g=s.label;return"curved"===g.type?this.buildCurvedLabel(g,s,l,h):this.buildStraightLabel(g,s,l,h)},buildStraightLabel:function(s,l,h,g){var _,A=this.makeVertexTemplate(l,h),j=s.angle||l.angle,$="point"!==s.type?(_=l.size[s.type],f2):(_=l.size,l.texcoords||f2);h.uniforms=h.uniforms||{},l.label_texture?(h.uniforms.u_texture=l.label_texture,h.uniforms.u_point_type=2,h.uniforms.u_apply_color_blocks=!1):(l.texture?(h.uniforms.u_texture=l.texture,h.uniforms.u_point_type=1):(h.uniforms.u_texture=this.textureManager.default,h.uniforms.u_point_type=3),h.uniforms.u_apply_color_blocks=!0);var Ye=this.defines.TANGRAM_POINT_DRAW_STICK&&!l.label_texture&&l.stick&&0<l.stick.height,_i=this.buildQuad([s.position],_,j,null,null,null,null,s.offset,null,null,$,!1,s.isFlat(),l.elevate_by_altitude,h.vertex_data,A,Ye,Ye&&l.stick.color,l.color);return this.trackLabel(s,l.linked&&l.linked.label.id,h,_i,g,Ye),_i},buildCurvedLabel:function(s,l,h,g){for(var _=this.makeVertexTemplate(l,h),A=s.angle,j=0,$=0;$<2;$++)for(var _t=0;_t<s.num_segments;_t++){var Ye=l.size[s.type][_t],_i=f2,_s=this.getTileMesh(g.tile,this.getMeshVariantTypeForDraw(l));_s.uniforms=_s.uniforms||{},_s.uniforms.u_texture=l.label_texture,_s.uniforms.u_point_type=2,_s.uniforms.u_apply_color_blocks=!1;var ty=s.num_segments-_t-1,ey=this.buildQuad([s.position],Ye,A,s.angles[_t],s.alt_angles[ty],s.pre_angles[_t],s.alt_pre_angles[ty],s.offset||[0,0],s.offsets[_t],s.alt_offsets[ty],_i,!0,s.isFlat(),l.elevate_by_altitude,_s.vertex_data,_,!1,!1,l.color);j+=ey,this.trackLabel(s,l.linked&&l.linked.label.id,h,ey,g,!1)}return j},trackLabel:function(s,l,h,g,_,A){var j=5<arguments.length&&void 0!==A&&A;h.labels=h.labels||{},h.labels.collision=h.labels.collision||{},h.labels["non-collision"]=h.labels["non-collision"]||{};var $=s.layout.collide?h.labels.collision:h.labels["non-collision"];$[s.id]=$[s.id]||{container:{label:s.text_data?Object.assign(s.toJSON(),{text_data:s.text_data}):s.toJSON(),linked:l},ranges:[]};var _t=2*g,Ye=h.vertex_data.offset-h.vertex_data.stride*_t;$[s.id].ranges.push([Ye,_t,j])},buildLines:function(s,l,h,g){return this.build(l,h,g)},buildPoints:function(s,l,h,g){return this.build(l,h,g)},buildPolygons:function(s,l,h,g){return this.build(l,h,g)},vertexLayoutForMeshVariant:function(s){var l;return this.vertex_layout||(l=[{name:"a_position",size:4,type:C0.SHORT,normalized:!1},{name:"a_shape",size:4,type:C0.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:C0.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:C0.SHORT,normalized:!1},{name:"a_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_outline_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0,static:[0,0,0,0]},{name:"a_outline_edge",size:1,type:C0.FLOAT,normalized:!1,static:0},{name:"a_selection_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:C0.UNSIGNED_BYTE,normalized:!0}],this.defines&&this.defines.TANGRAM_POINT_DRAW_STICK&&l.push({name:"a_is_stick",size:1,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_stick_height",size:1,type:C0.FLOAT,normalized:!1}),this.vertex_layout=new bT(l),(l=l.map(function(h){return Object.assign({},h)})).forEach(function(h){"a_outline_color"!==h.name&&"a_outline_edge"!==h.name||(h.static=null)}),this.vertex_layout_shader_point=new bT(l)),s.shader_point?this.vertex_layout_shader_point:this.vertex_layout},computeVariantForDraw:function(s){var l=s.label_texture||s.texture||this.default_mesh_variant.key;return{key:l,shader_point:l===this.default_mesh_variant.key,order:s.label_texture?1:0}},makeMesh:function(s,l,h){var g=2<arguments.length&&void 0!==h?h:{};return g=Object.assign({},g,{fade_in_time:this.fade_in_time}),W_.makeMesh.call(this,s,l,g)}});var b2=[0,.33,.66,.99],EO=function(s,l,h,g,_){for(var A=[{type:"straight",tolerance:_.no_curving?1.8:1.5},{type:"curved"},{type:"straight",tolerance:2.3}],j=0;j<A.length;j++){var $=A[j],_t=void 0;if("straight"===$.type?_t=new bP(l,h,g,_,$.tolerance):"curved"===$.type&&!_.no_curving&&2<h.length&&(_t=new a4(s,h,g,_)),_t&&!_t.throw_away)return _t}return!1},jD=function(){function s(l,h){D0(this,s),this.id=lM.nextLabelId(),this.layout=h,this.position=[],this.angle=0,this.offset=h.offset.slice(),this.unit_scale=this.layout.units_per_pixel,this.type="",this.throw_away=!1,this._is_flat=l,this._circles=void 0,this.placed=null}return T0(s,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,angle:this.angle,breach:this.breach,layout:cM(this.layout),circles:this.getBoundingCircles()}}},{key:"inTileBounds",value:function(){var l=this.getAABB(),_=l.right,A=l.bottom;return G0.pointInTile([l.left,l.top])&&G0.pointInTile([_,A])}},{key:"getAABBForSegment",value:function(l,h,g,_){var A,j=this.unit_scale,$=h/2,_t=g/2,Ye=A0(l,2),_i=Ye[0],_s=Ye[1];0===this.offset[0]&&0===this.offset[1]||(_i+=(A=l0.rot(this.offset,this.angle))[0]*j,_s-=A[1]*j);var Ja=[[Math.cos(_),-Math.sin(_)],[Math.sin(_),Math.cos(_)]],_l=l0.multMatrix(Ja,[-$,-_t]),lc=l0.multMatrix(Ja,[$,-_t]),_p=l0.multMatrix(Ja,[$,_t]),ka=l0.multMatrix(Ja,[-$,_t]);return{left:_i+Math.min(_l[0],lc[0],_p[0],ka[0]),top:_s+Math.max(_l[1],lc[1],_p[1],ka[1]),right:_i+Math.max(_l[0],lc[0],_p[0],ka[0]),bottom:_s+Math.min(_l[1],lc[1],_p[1],ka[1])}}},{key:"isFlat",value:function(){return this._is_flat}},{key:"getBoundingCircles",value:function(){}},{key:"getAABB",value:function(){}}],[{key:"splitLineByOrientation",value:function(l){for(var h=[l[0]],g=0,_=0,A=0,j=h,$=!1,_t=1;_t<l.length;_t++){var Ye=l[_t],_i=l[_t-1],_s=l0.length(l0.sub(Ye,_i));Ye[0]>_i[0]?1===A?(h.push(Ye),_<(g+=_s)&&(j=h,_=g,$=!1)):(h=[_i,Ye],_<(g=_s)&&(j=h,_=g,$=!1),A=1):Ye[0]<_i[0]?-1===A?(h.unshift(Ye),_<(g+=_s)&&(j=h,_=g,$=!0)):(h=[Ye,_i],_<(g=_s)&&(j=h,_=g,$=!0),A=-1):(-1===A?h.unshift(Ye):(h.push(Ye),A=1),_<(g+=_s)&&(j=h,_=g,$=-1===A))}return[j,$]}}]),s}(),bP=function(){L_(l,jD);var s=B1(l);function l(h,g,_,A,j){var $;return D0(this,l),($=s.call(this,_,A)).type="straight",$.size=h,$.throw_away=!$.fit(h,g,A,j),$}return T0(l,[{key:"fit",value:function(h,g,_,A){var j,$=this.unit_scale,_t=A0(jD.splitLineByOrientation(g),2);g=_t[0],j=_t[1],"number"==typeof _.orientation&&(this.offset[1]+=1.2*(h[1]-_.vertical_buffer),j&&(this.offset[1]*=-1),-1===_.orientation&&(this.offset[1]*=-1));for(var Ye=TO(g),_i=h[0]*$,_s=0;_s<g.length-1;_s++)for(var Ja=g[_s],_l=0,lc=0,_p=_s+1,ka=void 0;_p<g.length;){var ny=g[_p],ry=yM(g[_p-1],ny);if(_p!==_s+1&&(_l+=function(ey,hy){var fy,_y;for(_y=hy<ey?(fy=hy,ey):(fy=ey,hy);_y-fy>Math.PI;)fy+=2*Math.PI;return Math.abs(_y-fy)}(ry,ka)),.1<Math.abs(_l))break;if(_i/(lc+=Ye[_p-1])<A){var ly=l0.mult(l0.add(Ja,ny),.5);return this.angle=-ry,Math.abs(this.angle-Math.PI/2)<.01&&(this.angle=-Math.PI/2,"number"==typeof _.orientation&&(this.offset[1]*=-1)),this.position=ly,this.breach=!this.inTileBounds(),!0}ka=ry,_p++}return!1}},{key:"getBoundingCircles",value:function(){var h,g,_,A,j,$,_t,Ye,_i,_s,Ja,_l,lc;return this._circles||(j=-(_=(g=this.size[0]/2*(h=this.unit_scale))*Math.cos(this.angle)),$=-(A=g*Math.sin(this.angle)),_t=this.offset[0]*h,Ye=this.offset[1]*h,_s=(_i=A0(this.position,2))[0],Ja=_i[1],Ja*=-1,_t&&(l0.normalize(_l=[_,A]),_l[0]*=_t,_l[1]*=_t,_s+=_l[0],Ja+=_l[1]),Ye&&(l0.normalize(lc=[A,-_]),lc[0]*=Ye,lc[1]*=Ye,_s-=lc[0],Ja-=lc[1]),this._circles=PD(_+=_s,A+=Ja,j+=_s,$+=Ja,this.size[1]/2*h)),this._circles}},{key:"getAABB",value:function(){var h,g,_;return this._aabb||(this._aabb=this.getAABBForSegment(this.position,((g=this.size)[0]+2*(_=this.layout.buffer)[0])*(h=this.unit_scale),(g[1]+2*_[1])*h,this.angle)),this._aabb}}]),l}(),a4=function(){L_(l,jD);var s=B1(l);function l(h,g,_,A){var j;return D0(this,l),(j=s.call(this,_,A)).type="curved",j.positions=[],j.angles=[],j._aabbs=[],j.pre_angles=[],j.offsets=[],j.num_segments=h.length,j.sizes=h,j.alt_angles=[],j.alt_pre_angles=[],j.alt_offsets=[],j.throw_away=!j.fit(j.sizes,g,A),j}return T0(l,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,breach:this.breach,layout:cM(this.layout),circles:this.getBoundingCircles()}}},{key:"fit",value:function(h,g,_){var A,j=this.unit_scale,$=Math.max.apply(Math,A_(h.map(function(_1){return _1[1]}))),_t=$*j,Ye=A0(jD.splitLineByOrientation(g),2);g=Ye[0],A=Ye[1],"number"==typeof _.orientation&&(this.offset[1]+=1.2*($-_.vertical_buffer),A&&(this.offset[1]*=-1),-1===_.orientation&&(this.offset[1]*=-1));var _i=TO(g),_s=h.map(function(_1){return _1[0]*j}),Ja=_i.reduce(function(_1,D_){return _1+D_},0),_l=_s.reduce(function(_1,D_){return _1+D_},0);if(Ja<_l)return!1;var lc=g.length-1;if(lc<2)return!1;var _p=l.curvaturePlacement(g,Ja,_i,_l,0,lc);if(-1===_p||lc-_p<2)return!1;this.position=g[_p];for(var ty=0;ty<_s.length;ty++){this.positions[ty]=[],this.offsets[ty]=[],this.angles[ty]=[],this.pre_angles[ty]=[];for(var ny=0;ny<b2.length;ny++){var ry=b2[ny],ly=A0(l.scaleLine(ry,g),2),fy=l.placeAtIndex(_p,ly[0],ly[1],_s),_y=fy.positions,Sy=fy.angles,Dy=fy.pre_angles,Ny=fy.offsets.map(function(D_){return Math.sqrt(D_[0]*D_[0]+D_[1]*D_[1])/j});if(0===ry){this.angle=1/Sy.length*Sy.reduce(function(D_,C1){return D_+C1});for(var r0=0;r0<_y.length;r0++)this._aabbs.push(this.getAABBForSegment(_y[r0],_s[r0],_t,Dy[r0]+Sy[r0]))}this.positions[ty].push(_y[ty]),this.offsets[ty].push(Ny[ty]),this.angles[ty].push(Sy[ty]),this.pre_angles[ty].push(Dy[ty])}}_s=h.slice().reverse().map(function(D_){return D_[0]*j});for(var $0=0;$0<_s.length;$0++){this.alt_offsets[$0]=[],this.alt_angles[$0]=[],this.alt_pre_angles[$0]=[];for(var Q0=0;Q0<b2.length;Q0++){var d_=b2[Q0],Y_=A0(l.scaleLine(d_,g),2),r1=Y_[0],C_=l.placeAtIndex(_p,r1,Y_[1],_s),H1=C_.angles,px=C_.pre_angles,FE=C_.offsets.map(function(D_){return Math.sqrt(D_[0]*D_[0]+D_[1]*D_[1])/j});0===d_&&(this.alt_angle=1/H1.length*H1.reduce(function(D_,C1){return D_+C1})),this.alt_offsets[$0].push(FE[$0]),this.alt_angles[$0].push(H1[$0]),this.alt_pre_angles[$0].push(px[$0])}}return!0}},{key:"getBoundingCircles",value:function(){if(!this._circles){for(var h=[],g=this.unit_scale,_=0;_<this.positions.length;_++){var A=this.sizes[_],j=this.angles[_][0],$=this.positions[_][0],_t=A[0]/2*g,Ye=_t*Math.cos(j),_i=_t*Math.sin(j),_s=-Ye,Ja=-_i,_l=A0($,2),lc=_l[0],_p=_l[1],ka=PD(Ye+=lc,_i+=_p*=-1,_s+=lc,Ja+=_p,A[1]/2*g);Array.prototype.push.apply(h,ka)}this._circles=h}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){for(var _=1/0,A=-1/0,j=-1/0,$=1/0,h=0;h<this._aabbs.length;h++){var g=this._aabbs[h];_=Math.min(_,g.left),A=Math.max(A,g.top),j=Math.max(j,g.right),$=Math.min($,g.bottom)}this._aabb={left:_,top:A,right:j,bottom:$}}return this._aabb}}],[{key:"curvaturePlacement",value:function(h,g,_,A,j,$){$=$||h.length-1;for(var _t=[],Ye=(j=j||0)+1;Ye<$;Ye++){var _s=h[Ye],Ja=h[Ye+1],_l=l0.perp(_s,h[Ye-1]),lc=l0.perp(Ja,_s),_p=l0.angleBetween(_l,lc);1<_p&&(_p=1/0),_t.push(_p)}_t.push(1/0);for(var ka=[],ty=[],ny=j,ry=0,ly=0;ly<j;ly++)ry+=_[ly];for(;ry+A<g;){for(var ey=ry+A,hy=ry,fy=ny,_y=0;fy<$&&hy+_[fy]<ey&&(_y+=_t[fy])!==1/0;)hy+=_[fy],fy++;if(0===_y)return ny;var Iy=_y/(fy-ny);ka.push(_y),ty.push(Iy),ry+=_[ny],ny++}if(0===ka.length)return-1;var Sy=Math.min.apply(null,ka),Dy=ty[ka.indexOf(Sy)];return Sy<1.3&&Dy<.4?ka.indexOf(Sy):-1}},{key:"scaleLine",value:function(h,g){var _=[g[0]],A=[];return g.forEach(function(j,$){var _t,Ye;$!==g.length-1&&(_t=l0.sub(g[$+1],g[$]),Ye=l0.mult(_t,1+h),_.push(l0.add(_[$],Ye)),A.push(l0.length(Ye)))}),[_,A]}},{key:"placeAtIndex",value:function(h,g,_,A){var j=g[h],$=A0(l.getIndicesAndOffsets(h,_,A),2),_t=$[0],_i=l.getPositionsFromIndicesAndOffsets(g,_t,$[1]),_s=A0(l.getAnglesFromIndicesAndOffsets(j,_t,g,_i),3);return{positions:_i,offsets:_s[0],angles:_s[1],pre_angles:_s[2]}}},{key:"getIndicesAndOffsets",value:function(h,g,_){for(var A=_.length,j=[],$=[],_t=0,Ye=0,_i=0;_t<A;){for(var _s=_[_t];_t<A&&Ye+.5*_s<=_i+g[h];)$.push(Ye-_i+.5*_s),j.push(h),Ye+=_s,_s=_[++_t];_i+=g[h],h++}return[j,$]}},{key:"getPositionsFromIndicesAndOffsets",value:function(h,g,_){for(var A=[],j=0;j<g.length;j++){var $=g[j],_t=_[j],Ye=yM(h[$],h[$+1]),_i=l0.rot([_t,0],Ye),_s=l0.add(h[$],_i);A.push(_s)}return A}},{key:"getAnglesFromIndicesAndOffsets",value:function(h,g,_,A){for(var _t=[],Ye=[],_i=[],_s=0;_s<A.length;_s++){var Ja,_l,_p=g[_s],ka=l0.sub(A[_s],h),ty=-l0.angle(ka),ny=-yM(_[_p],_[_p+1])-ty;0<_s&&(Ja=_t[_s-1],_l=Ye[_s-1],Math.abs(ty-Ja)>Math.PI&&(ty+=Ja<ty?-2*Math.PI:2*Math.PI),Math.abs(_l-ny)>Math.PI&&(ny+=_l<ny?-2*Math.PI:2*Math.PI)),_t.push(ty),Ye.push(ny),_i.push(ka)}return[_i,_t,Ye]}}]),l}();function yM(s,l){var h=l0.sub(l,s);return l0.angle(h)}function TO(s){for(var l=[],h=0;h<s.length-1;h++){var g=s[h],_=s[h+1],A=Math.hypot(g[0]-_[0],g[1]-_[1]);l.push(A)}return l}var VD=Object.create(Jx);Object.assign(VD,{name:"text",super:Jx,built_in:!0,init:function(s){var l=0<arguments.length&&void 0!==s?s:{};W_.init.call(this,l),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!1,this.defines.TANGRAM_IS_TEXT_STYLE=!0,this.reset()},makeVertexTemplate:function(s,l){this.super.makeVertexTemplate.apply(this,arguments);var h=l.vertex_data.vertex_layout;return this.fillVertexTemplate(h,"a_pre_angles",0,{size:4}),this.fillVertexTemplate(h,"a_offsets",0,{size:4}),this.fillVertexTemplate(h,"a_angles",0,{size:4}),this.fillVertexTemplate(h,"a_offsets_alt",0,{size:4}),this.fillVertexTemplate(h,"a_pre_angles_alt",0,{size:4}),this.fillVertexTemplate(h,"a_angles_alt",0,{size:4}),this.vertex_template},reset:function(){this.queues={},this.resetText()},addFeature:function(s,l,h){var g=this,_=h.tile,A=s.geometry.type;l.can_articulate="LineString"===A||"MultiLineString"===A,l.supersample_text="LineString"===A||"MultiLineString"===A;var j=this.parseTextFeature(s,l,h,_);j&&(j instanceof Array?j.forEach(function($){$.feature=s,$.context=h,$.layout.vertex=!1,g.queueFeature($,_)}):(j.feature=s,j.context=h,j.layout.vertex=!1,this.queueFeature(j,_)),zx.addStyle(this.name,_.id))},endData:function(s){var l=this,h=this.queues[s.id];return delete this.queues[s.id],this.collideAndRenderTextLabels(s,this.name,h).then(function(g){var _=g.labels,A=g.texts;return _&&A&&(l.texts[s.id]=A,_.forEach(function(j){var $=j.text_settings_key,_t=l.texts[s.id][$]&&l.texts[s.id][$][j.text],Ye=l.feature_style;Ye.label=j.label,j.label.text_data={text_info:_t,text_settings_key:$,text:j.text},Ye.label_texture=l.textureManager.default,_t.text_settings.can_articulate?(Ye.size={},"straight"===j.label.type?Ye.size.straight=_t.size.logical_size:Ye.size.curved=_t.segment_sizes.map(function(_i){return _i.logical_size})):Ye.size=_t.size.logical_size,W_.addFeature.call(l,j.feature,j.draw,j.context)})),l.freeText(s),W_.endData.call(l,s).then(function(j){if(j){for(var $ in j.meshes)j.meshes[$].uniforms.u_apply_color_blocks=!0;s.mesh_data[l.name]=j}return j})})},_preprocess:function(s){return this.preprocessText(s)},buildTextLabels:function(s,l){for(var h=[],g=0;g<l.length;g++){var _,$,A=l[g],j=this.texts[s.id][A.text_settings_key][A.text];A.layout.vertical_buffer=j.vertical_buffer,$=j.text_settings.can_articulate?(_=j.segment_sizes.map(function(_i){return _i.collision_size}),A.layout.no_curving=j.no_curving,this.buildLabels(_,A.feature.geometry,A.layout,j.size.collision_size)):this.buildLabels(j.size.collision_size,A.feature.geometry,A.layout);for(var _t=0;_t<$.length;_t++){var Ye=Object.create(A);Ye.label=$[_t],h.push(Ye)}}return h},buildLabels:function(s,l,h,g){var _,A,j="Point"!==l.type,$=[];if("LineString"===l.type)Array.prototype.push.apply($,this.buildLineLabels(l.coordinates,s,j,h,g));else if("MultiLineString"===l.type)for(var _t=l.coordinates,Ye=0;Ye<_t.length;++Ye)Array.prototype.push.apply($,this.buildLineLabels(_t[Ye],s,j,h,g));else if("Point"===l.type)$.push(new hx(l.coordinates,s,j,h));else if("MultiPoint"===l.type)for(var _i=l.coordinates,_s=0;_s<_i.length;++_s)$.push(new hx(_i[_s],s,j,h));else"Polygon"===l.type?(_=My.centroid(l.coordinates),$.push(new hx(_,s,j,h))):"MultiPolygon"===l.type&&(A=My.multiCentroid(l.coordinates),$.push(new hx(A,s,j,h)));return $},buildLineLabels:function(s,l,h,g,_){var A,j=[],$=Math.min(g.subdiv,s.length-1);if(1<$)for(var _t=(s.length-1)/$,Ye=0;Ye<$;Ye++){var _i=Math.floor(Ye*_t),_s=Math.floor((Ye+1)*_t)+1,Ja=s.slice(_i,_s),_l=EO(l,_,Ja,h,g);_l&&j.push(_l)}return j.length<$&&(A=EO(l,_,s,h,g))&&j.push(A),j},vertexLayoutForMeshVariant:function(){return this.vertex_layout||(this.vertex_layout=new bT([{name:"a_position",size:4,type:C0.SHORT,normalized:!1},{name:"a_shape",size:4,type:C0.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:C0.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:C0.SHORT,normalized:!1},{name:"a_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_angles",size:4,type:C0.SHORT,normalized:!1},{name:"a_offsets",size:4,type:C0.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles",size:4,type:C0.BYTE,normalized:!1},{name:"a_selection_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_offsets_alt",size:4,type:C0.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles_alt",size:4,type:C0.BYTE,normalized:!1},{name:"a_angles_alt",size:4,type:C0.SHORT,normalized:!1}])),this.vertex_layout},getMeshVariantTypeForDraw:Jx.getMeshVariantTypeForDraw}),VD.texture_id=0;var u4=Object.create(g2);Object.assign(u4,{name:"raster",super:g2,built_in:!0,init:function(){this.raster=this.raster||"color",this.super.init.apply(this,arguments),this.selection=!1,this.defines.SNAP_TO_PIXEL_GRID=!0},_preprocess:function(s){return s.color=s.color||by.defaults.color,this.super._preprocess.apply(this,arguments)}});var wP=Object.create(Jx);Object.assign(wP,{name:"custom_icons",collision:!1,init:function(s){var l=0<arguments.length&&void 0!==s?s:{};Jx.init.call(this,l)},loadTexture:function(s,l,h){var g,_=s.width,A=s.height,j=s.items,$=document.createElement("canvas"),_t=G0.device_pixel_ratio,Ye=this.sources[l],_i={sprites:{}};if($.width=_*_t,$.height=A*_t,Ye){var _s,Ja=j.length,_l=$.getContext("2d");for(_l.scale(_t,_t);_s=j[--Ja];){var lc,_p=Ye.getIconBitmapByObjectId(_s.meta.objectId,_s.meta.id);_p&&((lc=QS(_p))?$y("error",lc):(_l.drawImage(_p,_s.x,_s.y,_s.width,_s.height),_i.sprites[_s.meta.id]=[_s.x,_s.y,_s.width,_s.height]))}}return _i.element=$,(g=this.textureManager.create(this.gl,h,_i)).retain(),g.loading.then(function(ka){return ka.name})},buildRasterTextures:function(s,l){return _0.postMessage(this.main_thread_target+".loadTexture",s.rasters,s.source,s.texture_name).then(function(h){return l.textures.push(h),l})},addFeature:function(s,l,h){var g=h.tile.rasters,_={};g.items.forEach(function($){_[$.meta.id]=[$.x,$.y,$.width,$.height]});var A="".concat(h.tile.source,"_dyn_").concat(h.tile.coords.key,"_").concat(this.generation,"_").concat(h.tile.id);l.texture=h.tile.texture_name=A;var j=Object.assign({},AO,{name:A,width:g.width,height:g.height,sprites:_,manager:this.textureManager});YC.prototype.calculateSprites.apply(j),this.textureManager.textures[A]=j,Jx.addFeature.apply(this,arguments),delete this.textureManager.textures[A]}});var AO={filtering:"linear",density:1,valid:!0,power_of_2:!1,texcoords:{},sizes:{},css_sizes:{},aspects:{}},CO=Object.create(g2);Object.assign(CO,{name:"overlays",super:g2,init:function(s){var l=0<arguments.length&&void 0!==s?s:{};this.selection=l.selection||!0,this.raster=this.raster||"color",this.super.init.apply(this,arguments)},setupRasters:function(){if(!V_.is_main)return!1;if(this.super.setupRasters.call(this))return!0;var s=!1;for(var l in this.sources)if(this.sources[l]instanceof Tx){s=!0;break}return!!s&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",mN,"Raster"),!0)},loadTextures:function(s,l){var h,g,_,A=this.sources[l],j=s.name;if(s.overlays_config.forEach(function(Ye){var _i,_s=Ye.texcoords,_l=A.getMapObjectById(Ye.id),lc=_l.getBitmap();lc&&((_i=QS(lc=QI(lc,lc.width,lc.height)))?$y("error",_i):(h||((h=document.createElement("canvas")).width=s.width,h.height=s.height,g=h.getContext("2d")),g.save(),g.globalAlpha=_l.getOpacity(),_s.forEach(function(_p){return g.drawImage(lc,_p[0],_p[1],_p[2],_p[3])}),g.restore(),_=!0))}),_){s.element=h;var $={};return $[j]=s,this.super.loadTextures.call(this,$)}var _t=this.textureManager.textures[this.textureManager.default];return Promise.resolve([{name:_t.name,width:_t.width,height:_t.height,loaded:_t.loaded}])},buildRasterTextures:function(s,l){var h=this.sources[s.source].tileTexture(s);return h?_0.postMessage(this.main_thread_target+".loadTextures",h,s.source).then(function(g){if(!g||g.length<1)return l;if(g.some(function(A){return!A.loaded}))return null;var _=g[0].name;return l.uniforms=l.uniforms||{},l.textures=l.textures||[],l.uniforms.u_raster=_,l.uniforms.u_raster_offset=[0,0,1],l.textures.push(_),l}):Promise.resolve(l)}});var DO=Object.create(W_),tT=[-1,0,1,0,-1,1,-1,1,1,0,1,1,-1,0,1,0,-1,1,-1,1,1,0,1,1];Object.assign(DO,{name:"skybox",built_in:!0,vertex_shader_src:"uniform float u_horizon;uniform float u_tilt;uniform float u_zoom;attribute vec2 a_position;attribute float a_is_sky;attribute float a_is_top;attribute vec4 a_color;varying vec4 v_color;const float SIN_THRESHOLD_ANGLE=0.96126069082;void main(){v_color=a_color;float sin_tilt=sin(u_tilt);float sky_bottom_alpha=1.-max(sin_tilt-SIN_THRESHOLD_ANGLE,0.)*3.;if((a_position.y==1.&&a_is_sky==0.)||(a_position.y==0.&&a_is_sky==1.)){v_color.w=sky_bottom_alpha;}float fog_height=max((22.-u_zoom)*0.04,0.)*(sin_tilt-.7);float position_z=u_zoom<17. ? .942 : .9418;gl_Position=vec4(a_position.x,a_is_sky*(a_position.y+a_is_top)+1.0-u_horizon-(1.0-a_is_sky)*(1.0-a_position.y)*fog_height,position_z,1.0);}",fragment_shader_src:"varying vec4 v_color;void main(void){gl_FragColor=v_color;}",selection:!1,blend:"inlay",blend_order:1,init:function(){W_.init.apply(this,arguments),this.selection=!1},_preprocess:function(s){return s.color={top:by.createColorPropertyCache(s.color.zenith),bottom:by.createColorPropertyCache(s.color.horizon),fog:by.createColorPropertyCache(s.color.fog)},s},vertexLayoutForMeshVariant:function(){return this.vertex_layout||(this.vertex_layout=new bT([{name:"a_position",size:2,type:C0.FLOAT,normalized:!1},{name:"a_is_sky",size:1,type:C0.FLOAT,normalized:!0},{name:"a_color",size:4,type:C0.UNSIGNED_BYTE,normalized:!0},{name:"a_is_top",size:1,type:C0.FLOAT,normalized:!0}])),this.vertex_layout},makeVertexTemplate:function(){var s=0;return this.vertex_template[s++]=0,this.vertex_template[1]=0,this.vertex_template},parseFeature:function(s,l,h){var g=this.feature_style;return l.color&&l.color.top&&l.color.bottom&&(g.color_top=this.parseColor(l.color.top,h),g.color_bottom=this.parseColor(l.color.bottom,h),g.color_fog=this.parseColor(l.color.fog||"white",h),Array.isArray(g.color_fog)&&(g.color_fog=g.color_fog.slice(),g.color_fog[3]=0)),g},buildGeometry:function(s,l,h){for(var g=this.makeVertexTemplate(l),_=h.vertex_data,A=h.vertex_data.vertex_layout,j=_.vertex_layout.index.a_position,$={top:l.color_top,bottom:l.color_bottom},_t={top:l.color_bottom,bottom:l.color_fog},Ye=0,_i=tT.length-1;Ye<_i;Ye+=2){g[j+0]=tT[Ye],g[j+1]=tT[Ye+1];var _s=Ye<12,Ja=0<tT[Ye+1],_l=_s?$:_t;this.fillVertexTemplate(A,"a_is_sky",_s?1:0,{size:1}),this.fillVertexTemplate(A,"a_is_top",Ja?1:0,{size:1}),this.fillVertexTemplate(A,"a_color",l0.mult(Ja?_l.top:_l.bottom,255),{size:4}),_.addVertex(g)}return 4}});var xP=function(){function s(){D0(this,s),this.styles={},this.base_styles={},this.register(Object.create(g2)),this.register(Object.create(cx)),this.register(Object.create(ET)),this.register(Object.create(Jx)),this.register(Object.create(VD)),this.register(Object.create(u4)),this.register(Object.create(wP)),this.register(Object.create(CO)),this.register(Object.create(DO))}return T0(s,[{key:"init",value:function(){b0.removeBlock("global"),b0.removeBlock("setup"),b0.addBlock("global","#ifdef TANGRAM_VERTEX_SHADER\nvec4 modelPosition(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE*exp2(u_tile_origin.z-u_tile_origin.w),1.)+vec4(0.,1.,0.,0.);}vec4 modelPositionBaseZoom(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE,1.)+vec4(0.,1.,0.,0.);}\n#endif\nvec4 worldPosition(){return v_world_position;}\n#ifdef TANGRAM_VERTEX_SHADER\nvec4 wrapWorldPosition(vec4 world_position){\n#if defined(TANGRAM_WORLD_POSITION_WRAP)\nvec2 anchor=u_tile_origin.xy-mod(u_tile_origin.xy,TANGRAM_WORLD_POSITION_WRAP);world_position.xy-=anchor;\n#endif\nreturn world_position;}\n#endif\n#if defined(TANGRAM_VERTEX_SHADER)\nvec3 worldNormal(){return TANGRAM_NORMAL;}\n#elif defined(TANGRAM_FRAGMENT_SHADER)\nvec3 worldNormal(){return u_inverseNormalMatrix*TANGRAM_NORMAL;}\n#endif\n"),b0.addBlock("global","void applyLayerOrder(float layer,inout vec4 position){position.z-=layer*TANGRAM_LAYER_DELTA*position.w;}"),b0.addBlock("global","\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nattribute vec4 a_selection_color;varying vec4 v_selection_color;uniform vec4 u_selection_discard0;uniform vec4 u_selection_discard1;uniform vec4 u_selection_discard2;uniform vec4 u_selection_discard3;uniform vec4 u_selection_discard4;uniform vec4 u_selection_discard5;uniform vec4 u_selection_discard6;uniform vec4 u_selection_discard7;uniform vec4 u_selection_discard8;uniform vec4 u_selection_discard9;\n#endif\n"),b0.addBlock("global","uniform float u_view_pan_snap_timer;void snapToPixelGrid(inout vec4 position){vec2 position_fract=fract((((position.xy/position.w)+1.)*.5)*u_resolution);vec2 position_snap=position.xy+((step(0.5,position_fract)-position_fract)*position.w*2./u_resolution);\n#ifdef TANGRAM_VIEW_PAN_SNAP_RATE\nposition.xy=mix(position.xy,position_snap,clamp(u_view_pan_snap_timer*TANGRAM_VIEW_PAN_SNAP_RATE,0.,1.));\n#else\nposition.xy=position_snap;\n#endif\n}"),b0.replaceBlock("utils","#ifndef UTILS\n#define UTILS\nbool isLocalSpacePixelOutsideTile(vec4 pixel_local_space_position,float tile_scale){return pixel_local_space_position.x<0.||pixel_local_space_position.x>=tile_scale||pixel_local_space_position.y>0.||pixel_local_space_position.y<=-tile_scale;}\n#endif\n"),b0.replaceBlock("setup","\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nif(a_selection_color.rgb==vec3(0.)||a_selection_color==u_selection_discard0||a_selection_color==u_selection_discard1||a_selection_color==u_selection_discard2||a_selection_color==u_selection_discard3||a_selection_color==u_selection_discard4||a_selection_color==u_selection_discard5||a_selection_color==u_selection_discard6||a_selection_color==u_selection_discard7||a_selection_color==u_selection_discard8||a_selection_color==u_selection_discard9){gl_Position=vec4(0.,0.,0.,1.);return;}v_selection_color=a_selection_color;\n#endif\n"),b0.defines.TANGRAM_EPSILON=1e-5,b0.defines.TANGRAM_LAYER_DELTA=1/16384,b0.defines.TANGRAM_TILE_SCALE="vec3(".concat(My.tile_scale,"., ").concat(My.tile_scale,"., u_meters_per_pixel * ").concat(My.tile_size,".)"),b0.defines.TANGRAM_HEIGHT_SCALE=My.height_scale,b0.defines.TANGRAM_ALPHA_TEST=.1,cx.dash_textures={}}},{key:"destroy",value:function(l){var h=this;Object.keys(this.styles).forEach(function(g){var _=h.styles[g];_.gl===l&&($y("trace","StyleManager.destroy: destroying render style ".concat(_.name)),_.base&&h.remove(_.name),_.destroy())})}},{key:"register",value:function(l){this.styles[l.name]=l,this.base_styles[l.name]=l}},{key:"remove",value:function(l){delete this.styles[l]}},{key:"mix",value:function(l,h){if(l.mixed)return l;l.mixed={};var g=[];l.mix&&(Array.isArray(l.mix)?g.push.apply(g,A_(l.mix)):g.push(l.mix),(g=g.map(function(A){return h[A]}).filter(function(A){return A&&A!==l})).forEach(function(A){return l.mixed[A.name]=!0})),g.push(l),l.animated=g.some(function(A){return A&&A.animated}),l.texcoords=g.some(function(A){return A&&A.texcoords}),l.base=g.map(function(A){return A.base}).filter(function(A){return A}).pop(),l.lighting=g.map(function(A){return A.lighting}).filter(function(A){return null!=A}).pop(),l.texture=g.map(function(A){return A.texture}).filter(function(A){return A}).pop(),l.raster=g.map(function(A){return A.raster}).filter(function(A){return null!=A}).pop(),l.dash=g.map(function(A){return A.dash}).filter(function(A){return null!=A}).pop(),l.dash_background_color=g.map(function(A){return A.dash_background_color}).filter(function(A){return null!=A}).pop(),g.some(function(A){return A.hasOwnProperty("blend")&&A.blend})&&(l.blend=g.map(function(A){return A.hasOwnProperty("blend")&&A.blend}).filter(function(A){return A}).pop()),l.blend_order=g.map(function(A){return A.blend_order}).filter(function(A){return null!=A}).pop(),l.defines=Object.assign.apply(Object,[{}].concat(A_(g.map(function(A){return A.defines}).filter(function(A){return A})))),l.material=Object.assign.apply(Object,[{}].concat(A_(g.map(function(A){return A.material}).filter(function(A){return A}))));var _=g.map(function(A){return A.draw}).filter(function(A){return A});return 0<_.length&&(l.draw=Q1.apply(void 0,[{}].concat(A_(_)))),this.mixShaders(l,h,g),l}},{key:"mixShaders",value:function(l,h,g){var _={},A=g.map(function(_i){return _i.shaders}).filter(function(_i){return _i});if(_.defines=Object.assign.apply(Object,[{}].concat(A_(A.map(function(_i){return _i.defines}).filter(function(_i){return _i})))),_.uniforms={},_._uniforms=l.shaders&&l.shaders.uniforms||{},_._uniform_scopes={},g.filter(function(_i){return _i.shaders&&_i.shaders.uniforms}).forEach(function(_i){for(var _s in _i.shaders.uniforms)!function(Ja){_._uniform_scopes[Ja]=_i.name,Object.defineProperty(_.uniforms,Ja,{enumerable:!0,configurable:!0,get:function(){return void 0!==_._uniforms[Ja]?_._uniforms[Ja]:h[_._uniform_scopes[Ja]].shaders.uniforms!==_.uniforms?h[_._uniform_scopes[Ja]].shaders.uniforms[Ja]:void 0},set:function(_l){_._uniforms[Ja]=_l}})}(_s)}),_.extensions=Object.keys(A.map(function(_i){return _i.extensions}).filter(function(_i){return _i}).reduce(function(_i,_s){return"string"==typeof _s?_i[_s]=!0:_s.forEach(function(Ja){return _i[Ja]=!0}),_i},{})||{}),l.shaders&&l.shaders.blocks)for(var j in l.shaders.block_scopes=l.shaders.block_scopes||{},l.shaders.blocks){var $,_t=l.shaders.blocks[j];l.shaders.block_scopes[j]=l.shaders.block_scopes[j]||[],Array.isArray(_t)?($=l.shaders.block_scopes[j]).push.apply($,A_(_t.map(function(){return l.name}))):l.shaders.block_scopes[j].push(l.name)}var Ye={};return A.forEach(function(_i){if(_i.blocks){_.blocks=_.blocks||{},_.block_scopes=_.block_scopes||{};var _s={};for(var Ja in _i.blocks){var _l=_i.blocks[Ja],lc=_i.block_scopes[Ja];_.blocks[Ja]=_.blocks[Ja]||[],_.block_scopes[Ja]=_.block_scopes[Ja]||[],_l=Array.isArray(_l)?_l:[_l],lc=Array.isArray(lc)?lc:[lc];for(var _p=0;_p<_l.length;_p++)Ye[lc[_p]]||(_s[lc[_p]]=!0,_.blocks[Ja].push(_l[_p]),_.block_scopes[Ja].push(lc[_p]))}Object.assign(Ye,_s)}}),Object.assign(l.mixed,Ye),l.shaders=_,l}},{key:"create",value:function(l,h,g){var _=2<arguments.length&&void 0!==g?g:{},A=Q1({},h);return A.name=l,(A=this.mix(A,_)).base&&this.base_styles[A.base]?this.styles[l]=A=Object.assign(Object.create(this.base_styles[A.base]),A):A.base=null,A}},{key:"build",value:function(l){var h=this,g=Object.keys(l).sort(function(j,$){return h.inheritanceDepth(j,l)-h.inheritanceDepth($,l)});for(var _ in this.styles)this.base_styles[_]?this.styles[_].reset():delete this.styles[_];var A={};return g.forEach(function(j){A[j]=h.create(j,l[j],A)}),this.styles}},{key:"initStyles",value:function(l){var h=0<arguments.length&&void 0!==l?l:{};for(var g in this.styles)this.styles[g].init(h)}},{key:"inheritanceDepth",value:function(l,h){for(var g=this,_=0;;){var A=h[l];if(!A||!A.mix)break;if(_++,Array.isArray(A.mix)){_+=Math.max.apply(Math,A_(A.mix.map(function(j){if(l!==j)return g.inheritanceDepth(j,h)})));break}if(l===A.mix)break;l=A.mix}return _}}]),s}();function mM(s){return null==s}var f1={isNothing:mM,isObject:function(s){return"object"==typeof s&&null!==s},toArray:function(s){return Array.isArray(s)?s:mM(s)?[]:[s]},repeat:function(s,l){for(var h="",g=0;g<l;g+=1)h+=s;return h},isNegativeZero:function(s){return 0===s&&Number.NEGATIVE_INFINITY===1/s},extend:function(s,l){var h,g,_,A;if(l)for(h=0,g=(A=Object.keys(l)).length;h<g;h+=1)s[_=A[h]]=l[_];return s}};function SO(s,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name="YAMLException",this.reason=s,this.mark=l,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():"")}((SO.prototype=Object.create(Error.prototype)).constructor=SO).prototype.toString=function(s){var l=this.name+": ";return l+=this.reason||"(unknown reason)",!s&&this.mark&&(l+=" "+this.mark.toString()),l};var Dx=SO;function w2(s,l,h,g,_){this.name=s,this.buffer=l,this.position=h,this.line=g,this.column=_}w2.prototype.getSnippet=function(s,l){var h,g,_,A,j;if(!this.buffer)return null;for(s=s||4,l=l||75,h="",g=this.position;0<g&&-1==="\0\r\n\x85\u2028\u2029".indexOf(this.buffer.charAt(g-1));)if(--g,this.position-g>l/2-1){h=" ... ",g+=5;break}for(_="",A=this.position;A<this.buffer.length&&-1==="\0\r\n\x85\u2028\u2029".indexOf(this.buffer.charAt(A));)if((A+=1)-this.position>l/2-1){_=" ... ",A-=5;break}return j=this.buffer.slice(g,A),f1.repeat(" ",s)+h+j+_+"\n"+f1.repeat(" ",s+this.position-g+h.length)+"^"},w2.prototype.toString=function(s){var l,h="";return this.name&&(h+='in "'+this.name+'" '),h+="at line "+(this.line+1)+", column "+(this.column+1),s||(l=this.getSnippet())&&(h+=":\n"+l),h};var cA=w2,EP=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],MO=["scalar","sequence","mapping"],_w=function(s,l){var h,g;if(l=l||{},Object.keys(l).forEach(function(_){if(-1===EP.indexOf(_))throw new Dx('Unknown option "'+_+'" is met in definition of "'+s+'" YAML type.')}),this.tag=s,this.kind=l.kind||null,this.resolve=l.resolve||function(){return!0},this.construct=l.construct||function(_){return _},this.instanceOf=l.instanceOf||null,this.predicate=l.predicate||null,this.represent=l.represent||null,this.defaultStyle=l.defaultStyle||null,this.styleAliases=(g={},null!==(h=l.styleAliases||null)&&Object.keys(h).forEach(function(_){h[_].forEach(function(A){g[String(A)]=_})}),g),-1===MO.indexOf(this.kind))throw new Dx('Unknown kind "'+this.kind+'" is specified for "'+s+'" YAML type.')};function IO(s,l,h){var g=[];return s.include.forEach(function(_){h=IO(_,l,h)}),s[l].forEach(function(_){h.forEach(function(A,j){A.tag===_.tag&&g.push(j)}),h.push(_)}),h.filter(function(_,A){return-1===g.indexOf(A)})}function nC(s){this.include=s.include||[],this.implicit=s.implicit||[],this.explicit=s.explicit||[],this.implicit.forEach(function(l){if(l.loadKind&&"scalar"!==l.loadKind)throw new Dx("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}),this.compiledImplicit=IO(this,"implicit",[]),this.compiledExplicit=IO(this,"explicit",[]),this.compiledTypeMap=function(){var l,h,g={};function _(A){g[A.tag]=A}for(l=0,h=arguments.length;l<h;l+=1)arguments[l].forEach(_);return g}(this.compiledImplicit,this.compiledExplicit)}nC.DEFAULT=null,nC.create=function(s,l){var h,g;switch(arguments.length){case 1:h=nC.DEFAULT,g=s;break;case 2:h=s,g=l;break;default:throw new Dx("Wrong number of arguments for Schema.create function")}if(h=f1.toArray(h),g=f1.toArray(g),!h.every(function(_){return _ instanceof nC}))throw new Dx("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!g.every(function(_){return _ instanceof _w}))throw new Dx("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new nC({include:h,explicit:g})};var _E=nC,kO=new _E({explicit:[new _w("tag:yaml.org,2002:str",{kind:"scalar",construct:function(s){return null!==s?s:""}}),new _w("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(s){return null!==s?s:[]}}),new _w("tag:yaml.org,2002:map",{kind:"mapping",construct:function(s){return null!==s?s:{}}})]}),l4=new _w("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(s){if(null===s)return!0;var l=s.length;return 1===l&&"~"===s||4===l&&("null"===s||"Null"===s||"NULL"===s)},construct:function(){return null},predicate:function(s){return null===s},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"}),c4=new _w("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(s){if(null===s)return!1;var l=s.length;return 4===l&&("true"===s||"True"===s||"TRUE"===s)||5===l&&("false"===s||"False"===s||"FALSE"===s)},construct:function(s){return"true"===s||"True"===s||"TRUE"===s},predicate:function(s){return"[object Boolean]"===Object.prototype.toString.call(s)},represent:{lowercase:function(s){return s?"true":"false"},uppercase:function(s){return s?"TRUE":"FALSE"},camelcase:function(s){return s?"True":"False"}},defaultStyle:"lowercase"}),h4=new _w("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(s){if(null===s)return!1;var l,h,g,_,A=s.length,j=0,$=!1;if(!A)return!1;if("-"!==(l=s[j])&&"+"!==l||(l=s[++j]),"0"===l){if(j+1===A)return!0;if("b"===(l=s[++j])){for(j++;j<A;j++)if("_"!==(l=s[j])){if("0"!==l&&"1"!==l)return!1;$=!0}return $}if("x"===l){for(j++;j<A;j++)if("_"!==(l=s[j])){if(!(48<=(g=s.charCodeAt(j))&&g<=57||65<=g&&g<=70||97<=g&&g<=102))return!1;$=!0}return $}for(;j<A;j++)if("_"!==(l=s[j])){if(!(48<=(h=s.charCodeAt(j))&&h<=55))return!1;$=!0}return $}for(;j<A;j++)if("_"!==(l=s[j])){if(":"===l)break;if(!(48<=(_=s.charCodeAt(j))&&_<=57))return!1;$=!0}return!!$&&(":"!==l||/^(:[0-5]?[0-9])+$/.test(s.slice(j)))},construct:function(s){var l,h,g=s,_=1,A=[];return-1!==g.indexOf("_")&&(g=g.replace(/_/g,"")),"-"!==(l=g[0])&&"+"!==l||("-"===l&&(_=-1),l=(g=g.slice(1))[0]),"0"===g?0:"0"===l?"b"===g[1]?_*parseInt(g.slice(2),2):"x"===g[1]?_*parseInt(g,16):_*parseInt(g,8):-1!==g.indexOf(":")?(g.split(":").forEach(function(j){A.unshift(parseInt(j,10))}),g=0,h=1,A.forEach(function(j){g+=j*h,h*=60}),_*g):_*parseInt(g,10)},predicate:function(s){return"[object Number]"===Object.prototype.toString.call(s)&&s%1==0&&!f1.isNegativeZero(s)},represent:{binary:function(s){return"0b"+s.toString(2)},octal:function(s){return"0"+s.toString(8)},decimal:function(s){return s.toString(10)},hexadecimal:function(s){return"0x"+s.toString(16).toUpperCase()}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),OO=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)\\.[0-9_]*(?:[eE][-+][0-9]+)?|\\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),f4=/^[-+]?[0-9]+e/,RO=new _E({include:[kO],implicit:[l4,c4,h4,new _w("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(s){return null!==s&&!!OO.test(s)},construct:function(s){var l,h=s.replace(/_/g,"").toLowerCase(),g="-"===h[0]?-1:1,_=[];return 0<="+-".indexOf(h[0])&&(h=h.slice(1)),".inf"===h?1==g?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===h?NaN:0<=h.indexOf(":")?(h.split(":").forEach(function(A){_.unshift(parseFloat(A,10))}),h=0,l=1,_.forEach(function(A){h+=A*l,l*=60}),g*h):g*parseFloat(h,10)},predicate:function(s){return"[object Number]"===Object.prototype.toString.call(s)&&(s%1!=0||f1.isNegativeZero(s))},represent:function(s,l){var h;if(isNaN(s))switch(l){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===s)switch(l){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===s)switch(l){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(f1.isNegativeZero(s))return"-0.0";return h=s.toString(10),f4.test(h)?h.replace("e",".e"):h},defaultStyle:"lowercase"})]}),TP=new _E({include:[RO]}),NO=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$"),VV=new _w("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(s){return null!==s&&null!==NO.exec(s)},construct:function(s){var l,h,g,_,A,j,$,_t=0,Ye=null,_i=NO.exec(s);if(null===_i)throw new Error("Date resolve error");if(l=+_i[1],h=_i[2]-1,g=+_i[3],!_i[4])return new Date(Date.UTC(l,h,g));if(_=+_i[4],A=+_i[5],j=+_i[6],_i[7]){for(_t=_i[7].slice(0,3);_t.length<3;)_t+="0";_t=+_t}return _i[9]&&(Ye=6e4*(60*+_i[10]+ +(_i[11]||0)),"-"===_i[9]&&(Ye=-Ye)),$=new Date(Date.UTC(l,h,g,_,A,j,_t)),Ye&&$.setTime($.getTime()-Ye),$},instanceOf:Date,represent:function(s){return s.toISOString()}}),p4=new _w("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(s){return"<<"===s||null===s}}),hA=wD.Buffer,PO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",x2=new _w("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(s){if(null===s)return!1;for(var l,h=0,g=s.length,_=PO,A=0;A<g;A++)if(!(64<(l=_.indexOf(s.charAt(A))))){if(l<0)return!1;h+=6}return h%8==0},construct:function(s){for(var l,h=s.replace(/[\r\n=]/g,""),g=h.length,_=PO,A=0,j=[],$=0;$<g;$++)$%4==0&&$&&(j.push(A>>16&255),j.push(A>>8&255),j.push(255&A)),A=A<<6|_.indexOf(h.charAt($));return 0==(l=g%4*6)?(j.push(A>>16&255),j.push(A>>8&255),j.push(255&A)):18==l?(j.push(A>>10&255),j.push(A>>2&255)):12==l&&j.push(A>>4&255),hA?new hA(j):j},predicate:function(s){return hA&&hA.isBuffer(s)},represent:function(s){for(var l,h="",g=0,_=s.length,A=PO,j=0;j<_;j++)j%3==0&&j&&(h+=A[g>>18&63],h+=A[g>>12&63],h+=A[g>>6&63],h+=A[63&g]),g=(g<<8)+s[j];return 0==(l=_%3)?(h+=A[g>>18&63],h+=A[g>>12&63],h+=A[g>>6&63],h+=A[63&g]):2==l?(h+=A[g>>10&63],h+=A[g>>4&63],h+=A[g<<2&63],h+=A[64]):1==l&&(h+=A[g>>2&63],h+=A[g<<4&63],h+=A[64],h+=A[64]),h}}),Qx=Object.prototype.hasOwnProperty,d4=Object.prototype.toString,zV=new _w("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(s){if(null===s)return!0;for(var l,h,g,_=[],A=s,j=0,$=A.length;j<$;j+=1){if(g=!1,"[object Object]"!==d4.call(l=A[j]))return!1;for(h in l)if(Qx.call(l,h)){if(g)return!1;g=!0}if(!g||-1!==_.indexOf(h))return!1;_.push(h)}return!0},construct:function(s){return null!==s?s:[]}}),AP=Object.prototype.toString,CT=new _w("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(s){if(null===s)return!0;for(var l,h,g=s,_=new Array(g.length),A=0,j=g.length;A<j;A+=1){if("[object Object]"!==AP.call(l=g[A])||1!==(h=Object.keys(l)).length)return!1;_[A]=[h[0],l[h[0]]]}return!0},construct:function(s){if(null===s)return[];for(var l,h,g=s,_=new Array(g.length),A=0,j=g.length;A<j;A+=1)l=g[A],h=Object.keys(l),_[A]=[h[0],l[h[0]]];return _}}),g4=Object.prototype.hasOwnProperty,E2=new _E({include:[TP],implicit:[VV,p4],explicit:[x2,zV,CT,new _w("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(s){if(null===s)return!0;var l,h=s;for(l in h)if(g4.call(h,l)&&null!==h[l])return!1;return!0},construct:function(s){return null!==s?s:{}}})]}),zD=new _w("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(s){return void 0===s},represent:function(){return""}}),y4=new _w("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(s){if(null===s||0===s.length)return!1;var l=s,h=/\/([gim]*)$/.exec(s),g="";return!("/"===l[0]&&(h&&(g=h[1]),3<g.length||"/"!==l[l.length-g.length-1]))},construct:function(s){var l=s,h=/\/([gim]*)$/.exec(s),g="";return"/"===l[0]&&(h&&(g=h[1]),l=l.slice(1,l.length-g.length-1)),new RegExp(l,g)},predicate:function(s){return"[object RegExp]"===Object.prototype.toString.call(s)},represent:function(s){var l="/"+s.source+"/";return s.global&&(l+="g"),s.multiline&&(l+="m"),s.ignoreCase&&(l+="i"),l}});try{var BD=function(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}()}catch{typeof window<"u"&&(BD=window.esprima)}var LO=new _w("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(s){if(null===s)return!1;try{var h=BD.parse("("+s+")",{range:!0});return!("Program"!==h.type||1!==h.body.length||"ExpressionStatement"!==h.body[0].type||"FunctionExpression"!==h.body[0].expression.type)}catch{return!1}},construct:function(s){var l,h="("+s+")",g=BD.parse(h,{range:!0}),_=[];if("Program"!==g.type||1!==g.body.length||"ExpressionStatement"!==g.body[0].type||"FunctionExpression"!==g.body[0].expression.type)throw new Error("Failed to resolve function");return g.body[0].expression.params.forEach(function(A){_.push(A.name)}),l=g.body[0].expression.body.range,new Function(_,h.slice(l[0]+1,l[1]-1))},predicate:function(s){return"[object Function]"===Object.prototype.toString.call(s)},represent:function(s){return s.toString()}}),vM=_E.DEFAULT=new _E({include:[E2],explicit:[zD,y4,LO]}),DT=Object.prototype.hasOwnProperty,v4=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,T2=/[\x85\u2028\u2029]/,MT=/[,\[\]\{\}]/,MP=/^(?:!|!!|![a-z\-]+!)$/i,IP=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function IT(s){return 10===s||13===s}function A2(s){return 9===s||32===s}function Sx(s){return 9===s||32===s||10===s||13===s}function HD(s){return 44===s||91===s||93===s||123===s||125===s}function jO(s){return 48===s?"\0":97===s?"\x07":98===s?"\b":116===s||9===s?"\t":110===s?"\n":118===s?"\v":102===s?"\f":114===s?"\r":101===s?"\x1b":32===s?" ":34===s?'"':47===s?"/":92===s?"\\":78===s?"\x85":95===s?"\xa0":76===s?"\u2028":80===s?"\u2029":""}for(var _4=new Array(256),VO=new Array(256),C2=0;C2<256;C2++)_4[C2]=jO(C2)?1:0,VO[C2]=jO(C2);function kP(s,l){this.input=s,this.filename=l.filename||null,this.schema=l.schema||vM,this.onWarning=l.onWarning||null,this.legacy=l.legacy||!1,this.json=l.json||!1,this.listener=l.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=s.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function OP(s,l){return new Dx(l,new cA(s.filename,s.input,s.position,s.line,s.position-s.lineStart))}function J0(s,l){throw OP(s,l)}function Hx(s,l){s.onWarning&&s.onWarning.call(null,OP(s,l))}var RP={YAML:function(s,l,h){var g,_,A;null!==s.version&&J0(s,"duplication of %YAML directive"),1!==h.length&&J0(s,"YAML directive accepts exactly one argument"),null===(g=/^([0-9]+)\.([0-9]+)$/.exec(h[0]))&&J0(s,"ill-formed argument of the YAML directive"),_=parseInt(g[1],10),A=parseInt(g[2],10),1!==_&&J0(s,"unacceptable YAML version of the document"),s.version=h[0],s.checkLineBreaks=A<2,1!==A&&2!==A&&Hx(s,"unsupported YAML version of the document")},TAG:function(s,l,h){var g,_;2!==h.length&&J0(s,"TAG directive accepts exactly two arguments"),_=h[1],MP.test(g=h[0])||J0(s,"ill-formed tag handle (first argument) of the TAG directive"),DT.call(s.tagMap,g)&&J0(s,'there is a previously declared suffix for "'+g+'" tag handle'),IP.test(_)||J0(s,"ill-formed tag prefix (second argument) of the TAG directive"),s.tagMap[g]=_}};function kT(s,l,h,g){var _,A,j,$;if(l<h){if($=s.input.slice(l,h),g)for(_=0,A=$.length;_<A;_+=1)9===(j=$.charCodeAt(_))||32<=j&&j<=1114111||J0(s,"expected valid JSON character");else v4.test($)&&J0(s,"the stream contains non-printable characters");s.result+=$}}function NP(s,l,h,g){var _,A,j,$;for(f1.isObject(h)||J0(s,"cannot merge mappings; the provided source object is unacceptable"),j=0,$=(_=Object.keys(h)).length;j<$;j+=1)DT.call(l,A=_[j])||(l[A]=h[A],g[A]=!0)}function D2(s,l,h,g,_,A){var j,$;if(_=String(_),null===l&&(l={}),"tag:yaml.org,2002:merge"===g)if(Array.isArray(A))for(j=0,$=A.length;j<$;j+=1)NP(s,l,A[j],h);else NP(s,l,A,h);else s.json||DT.call(h,_)||!DT.call(l,_)||J0(s,"duplicated mapping key"),l[_]=A,delete h[_];return l}function zO(s){var l=s.input.charCodeAt(s.position);10===l?s.position++:13===l?(s.position++,10===s.input.charCodeAt(s.position)&&s.position++):J0(s,"a line break is expected"),s.line+=1,s.lineStart=s.position}function L1(s,l,h){for(var g=0,_=s.input.charCodeAt(s.position);0!==_;){for(;A2(_);)_=s.input.charCodeAt(++s.position);if(l&&35===_)for(;10!==(_=s.input.charCodeAt(++s.position))&&13!==_&&0!==_;);if(!IT(_))break;for(zO(s),_=s.input.charCodeAt(s.position),g++,s.lineIndent=0;32===_;)s.lineIndent++,_=s.input.charCodeAt(++s.position)}return-1!==h&&0!==g&&s.lineIndent<h&&Hx(s,"deficient indentation"),g}function UD(s){var l=s.position,h=s.input.charCodeAt(l);return 45!==h&&46!==h||h!==s.input.charCodeAt(l+1)||h!==s.input.charCodeAt(l+2)||0!==(h=s.input.charCodeAt(l+=3))&&!Sx(h)?void 0:1}function BO(s,l){1===l?s.result+=" ":1<l&&(s.result+=f1.repeat("\n",l-1))}function PP(s,l){var h,g,_=s.tag,A=s.anchor,j=[],$=!1;for(null!==s.anchor&&(s.anchorMap[s.anchor]=j),g=s.input.charCodeAt(s.position);0!==g&&45===g&&Sx(s.input.charCodeAt(s.position+1));)if($=!0,s.position++,L1(s,!0,-1)&&s.lineIndent<=l)j.push(null),g=s.input.charCodeAt(s.position);else if(h=s.line,W0(s,l,3,!1,!0),j.push(s.result),L1(s,!0,-1),g=s.input.charCodeAt(s.position),(s.line===h||s.lineIndent>l)&&0!==g)J0(s,"bad indentation of a sequence entry");else if(s.lineIndent<l)break;return!!$&&(s.tag=_,s.anchor=A,s.kind="sequence",s.result=j,!0)}function W0(s,l,h,g,_){var A,j,$,_t,Ye,_i,_s,Ja,_l=1,lc=!1,_p=!1;if(null!==s.listener&&s.listener("open",s),s.tag=null,s.anchor=null,s.kind=null,s.result=null,A=j=$=4===h||3===h,g&&L1(s,!0,-1)&&(lc=!0,s.lineIndent>l?_l=1:s.lineIndent===l?_l=0:s.lineIndent<l&&(_l=-1)),1===_l)for(;function(ka){var ty,ny,ry,ly=!1,ey=!1,hy=ka.input.charCodeAt(ka.position);if(33===hy){if(null!==ka.tag&&J0(ka,"duplication of a tag property"),60===(hy=ka.input.charCodeAt(++ka.position))?(ly=!0,hy=ka.input.charCodeAt(++ka.position)):33===hy?(ey=!0,ny="!!",hy=ka.input.charCodeAt(++ka.position)):ny="!",ty=ka.position,ly){for(;0!==(hy=ka.input.charCodeAt(++ka.position))&&62!==hy;);ka.position<ka.length?(ry=ka.input.slice(ty,ka.position),hy=ka.input.charCodeAt(++ka.position)):J0(ka,"unexpected end of the stream within a verbatim tag")}else{for(;0!==hy&&!Sx(hy);)33===hy&&(ey?J0(ka,"tag suffix cannot contain exclamation marks"):(ny=ka.input.slice(ty-1,ka.position+1),MP.test(ny)||J0(ka,"named tag handle cannot contain such characters"),ey=!0,ty=ka.position+1)),hy=ka.input.charCodeAt(++ka.position);ry=ka.input.slice(ty,ka.position),MT.test(ry)&&J0(ka,"tag suffix cannot contain flow indicator characters")}return ry&&!IP.test(ry)&&J0(ka,"tag name cannot contain such characters: "+ry),ly?ka.tag=ry:DT.call(ka.tagMap,ny)?ka.tag=ka.tagMap[ny]+ry:"!"===ny?ka.tag="!"+ry:"!!"===ny?ka.tag="tag:yaml.org,2002:"+ry:J0(ka,'undeclared tag handle "'+ny+'"'),1}}(s)||function(ka){var ty,ny=ka.input.charCodeAt(ka.position);if(38===ny){for(null!==ka.anchor&&J0(ka,"duplication of an anchor property"),ny=ka.input.charCodeAt(++ka.position),ty=ka.position;0!==ny&&!Sx(ny)&&!HD(ny);)ny=ka.input.charCodeAt(++ka.position);return ka.position===ty&&J0(ka,"name of an anchor node must contain at least one character"),ka.anchor=ka.input.slice(ty,ka.position),1}}(s);)L1(s,!0,-1)?(lc=!0,$=A,s.lineIndent>l?_l=1:s.lineIndent===l?_l=0:s.lineIndent<l&&(_l=-1)):$=!1;if($=$&&(lc||_),1!==_l&&4!==h||(_s=1===h||2===h?l:l+1,Ja=s.position-s.lineStart,1===_l?$&&(PP(s,Ja)||function(ka,ty,ny){var ry,ly,ey,hy,fy=ka.tag,_y=ka.anchor,Iy={},Sy={},Dy=null,Ny=null,r0=null,Vy=!1,Yy=!1;for(null!==ka.anchor&&(ka.anchorMap[ka.anchor]=Iy),hy=ka.input.charCodeAt(ka.position);0!==hy;){if(ry=ka.input.charCodeAt(ka.position+1),ey=ka.line,63!==hy&&58!==hy||!Sx(ry)){if(!W0(ka,ny,2,!1,!0))break;if(ka.line===ey){for(hy=ka.input.charCodeAt(ka.position);A2(hy);)hy=ka.input.charCodeAt(++ka.position);if(58===hy)Sx(hy=ka.input.charCodeAt(++ka.position))||J0(ka,"a whitespace character is expected after the key-value separator within a block mapping"),Vy&&(D2(ka,Iy,Sy,Dy,Ny,null),Dy=Ny=r0=null),ly=Vy=!(Yy=!0),Dy=ka.tag,Ny=ka.result;else{if(!Yy)return ka.tag=fy,ka.anchor=_y,1;J0(ka,"can not read an implicit mapping pair; a colon is missed")}}else{if(!Yy)return ka.tag=fy,ka.anchor=_y,1;J0(ka,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===hy?(Vy&&(D2(ka,Iy,Sy,Dy,Ny,null),Dy=Ny=r0=null),ly=Vy=Yy=!0):Vy?ly=!(Vy=!1):J0(ka,"incomplete explicit mapping pair; a key node is missed"),ka.position+=1,hy=ry;if((ka.line===ey||ka.lineIndent>ty)&&(W0(ka,ty,4,!0,ly)&&(Vy?Ny=ka.result:r0=ka.result),Vy||(D2(ka,Iy,Sy,Dy,Ny,r0),Dy=Ny=r0=null),L1(ka,!0,-1),hy=ka.input.charCodeAt(ka.position)),ka.lineIndent>ty&&0!==hy)J0(ka,"bad indentation of a mapping entry");else if(ka.lineIndent<ty)break}return Vy&&D2(ka,Iy,Sy,Dy,Ny,null),Yy&&(ka.tag=fy,ka.anchor=_y,ka.kind="mapping",ka.result=Iy),Yy}(s,Ja,_s))||function(ka,ty){var ny,ry,ly,ey,hy,fy,_y,Iy,Sy,Dy=!0,Ny=ka.tag,r0=ka.anchor,Vy={},Yy=ka.input.charCodeAt(ka.position);if(91===Yy)fy=!(ly=93),ry=[];else{if(123!==Yy)return;ly=125,fy=!0,ry={}}for(null!==ka.anchor&&(ka.anchorMap[ka.anchor]=ry),Yy=ka.input.charCodeAt(++ka.position);0!==Yy;){if(L1(ka,!0,ty),(Yy=ka.input.charCodeAt(ka.position))===ly)return ka.position++,ka.tag=Ny,ka.anchor=r0,ka.kind=fy?"mapping":"sequence",ka.result=ry,1;Dy||J0(ka,"missed comma between flow collection entries"),Sy=null,ey=hy=!1,63===Yy&&Sx(ka.input.charCodeAt(ka.position+1))&&(ey=hy=!0,ka.position++,L1(ka,!0,ty)),ny=ka.line,W0(ka,ty,1,!1,!0),Iy=ka.tag,_y=ka.result,L1(ka,!0,ty),Yy=ka.input.charCodeAt(ka.position),!hy&&ka.line!==ny||58!==Yy||(ey=!0,Yy=ka.input.charCodeAt(++ka.position),L1(ka,!0,ty),W0(ka,ty,1,!1,!0),Sy=ka.result),fy?D2(ka,ry,Vy,Iy,_y,Sy):ry.push(ey?D2(ka,null,Vy,Iy,_y,Sy):_y),L1(ka,!0,ty),44===(Yy=ka.input.charCodeAt(ka.position))?(Dy=!0,Yy=ka.input.charCodeAt(++ka.position)):Dy=!1}J0(ka,"unexpected end of the stream within a flow collection")}(s,_s)?_p=!0:(j&&function(ka,ty){var ny,ry,ly,ey,hy=1,fy=!1,_y=ty,Iy=0,Sy=!1,Dy=ka.input.charCodeAt(ka.position);if(124===Dy)ry=!1;else{if(62!==Dy)return;ry=!0}for(ka.kind="scalar",ka.result="";0!==Dy;)if(43===(Dy=ka.input.charCodeAt(++ka.position))||45===Dy)1===hy?hy=43===Dy?3:2:J0(ka,"repeat of a chomping mode identifier");else{if(!(0<=(ly=48<=(ey=Dy)&&ey<=57?ey-48:-1)))break;0==ly?J0(ka,"bad explicit indentation width of a block scalar; it cannot be less than one"):fy?J0(ka,"repeat of an indentation width identifier"):(_y=ty+ly-1,fy=!0)}if(A2(Dy)){for(;A2(Dy=ka.input.charCodeAt(++ka.position)););if(35===Dy)for(;!IT(Dy=ka.input.charCodeAt(++ka.position))&&0!==Dy;);}for(;0!==Dy;){for(zO(ka),ka.lineIndent=0,Dy=ka.input.charCodeAt(ka.position);(!fy||ka.lineIndent<_y)&&32===Dy;)ka.lineIndent++,Dy=ka.input.charCodeAt(++ka.position);if(!fy&&ka.lineIndent>_y&&(_y=ka.lineIndent),IT(Dy))Iy++;else{if(ka.lineIndent<_y){3===hy?ka.result+=f1.repeat("\n",Iy):1===hy&&fy&&(ka.result+="\n");break}for(ry?A2(Dy)?(Sy=!0,ka.result+=f1.repeat("\n",Iy+1)):Sy?(Sy=!1,ka.result+=f1.repeat("\n",Iy+1)):0===Iy?fy&&(ka.result+=" "):ka.result+=f1.repeat("\n",Iy):ka.result+=f1.repeat("\n",fy?Iy+1:Iy),fy=!0,Iy=0,ny=ka.position;!IT(Dy)&&0!==Dy;)Dy=ka.input.charCodeAt(++ka.position);kT(ka,ny,ka.position,!1)}}return 1}(s,_s)||function(ka,ty){var ny,ry,ly=ka.input.charCodeAt(ka.position);if(39===ly){for(ka.kind="scalar",ka.result="",ka.position++,ny=ry=ka.position;0!==(ly=ka.input.charCodeAt(ka.position));)if(39===ly){if(kT(ka,ny,ka.position,!0),39!==(ly=ka.input.charCodeAt(++ka.position)))return 1;ny=ry=ka.position,ka.position++}else IT(ly)?(kT(ka,ny,ry,!0),BO(ka,L1(ka,!1,ty)),ny=ry=ka.position):ka.position===ka.lineStart&&UD(ka)?J0(ka,"unexpected end of the document within a single quoted scalar"):(ka.position++,ry=ka.position);J0(ka,"unexpected end of the stream within a single quoted scalar")}}(s,_s)||function b4(s,l){var h,g,_,A,j,$,_t,Ye,_i,_s=s.input.charCodeAt(s.position);if(34===_s){for(s.kind="scalar",s.result="",s.position++,h=g=s.position;0!==(_s=s.input.charCodeAt(s.position));){if(34===_s)return kT(s,h,s.position,!0),s.position++,1;if(92===_s){if(kT(s,h,s.position,!0),IT(_s=s.input.charCodeAt(++s.position)))L1(s,!1,l);else if(_s<256&&_4[_s])s.result+=VO[_s],s.position++;else if(0<(j=120===(_i=_s)?2:117===_i?4:85===_i?8:0)){for(_=j,A=0;0<_;_--)Ye=void 0,0<=(j=48<=(_t=_s=s.input.charCodeAt(++s.position))&&_t<=57?_t-48:97<=(Ye=32|_t)&&Ye<=102?Ye-97+10:-1)?A=(A<<4)+j:J0(s,"expected hexadecimal character");s.result+=($=A)<=65535?String.fromCharCode($):String.fromCharCode(55296+($-65536>>10),56320+($-65536&1023)),s.position++}else J0(s,"unknown escape sequence");h=g=s.position}else IT(_s)?(kT(s,h,g,!0),BO(s,L1(s,!1,l)),h=g=s.position):s.position===s.lineStart&&UD(s)?J0(s,"unexpected end of the document within a double quoted scalar"):(s.position++,g=s.position)}J0(s,"unexpected end of the stream within a double quoted scalar")}}(s,_s)?_p=!0:function(ka){var ty,ny,ry=ka.input.charCodeAt(ka.position);if(42===ry){for(ry=ka.input.charCodeAt(++ka.position),ty=ka.position;0!==ry&&!Sx(ry)&&!HD(ry);)ry=ka.input.charCodeAt(++ka.position);return ka.position===ty&&J0(ka,"name of an alias node must contain at least one character"),ny=ka.input.slice(ty,ka.position),ka.anchorMap.hasOwnProperty(ny)||J0(ka,'unidentified alias "'+ny+'"'),ka.result=ka.anchorMap[ny],L1(ka,!0,-1),1}}(s)?(_p=!0,null===s.tag&&null===s.anchor||J0(s,"alias node should not have any properties")):function(ka,ty,ny){var ry,ly,ey,hy,fy,_y,Iy,Sy=ka.kind,Dy=ka.result,Ny=ka.input.charCodeAt(ka.position);if(!Sx(Ny)&&!HD(Ny)&&35!==Ny&&38!==Ny&&42!==Ny&&33!==Ny&&124!==Ny&&62!==Ny&&39!==Ny&&34!==Ny&&37!==Ny&&64!==Ny&&96!==Ny&&(63!==Ny&&45!==Ny||!(Sx(ry=ka.input.charCodeAt(ka.position+1))||ny&&HD(ry)))){for(ka.kind="scalar",ka.result="",ly=ey=ka.position,hy=!1;0!==Ny;){if(58===Ny){if(Sx(ry=ka.input.charCodeAt(ka.position+1))||ny&&HD(ry))break}else if(35===Ny){if(Sx(ka.input.charCodeAt(ka.position-1)))break}else{if(ka.position===ka.lineStart&&UD(ka)||ny&&HD(Ny))break;if(IT(Ny)){if(fy=ka.line,_y=ka.lineStart,Iy=ka.lineIndent,L1(ka,!1,-1),ka.lineIndent>=ty){hy=!0,Ny=ka.input.charCodeAt(ka.position);continue}ka.position=ey,ka.line=fy,ka.lineStart=_y,ka.lineIndent=Iy;break}}hy&&(kT(ka,ly,ey,!1),BO(ka,ka.line-fy),ly=ey=ka.position,hy=!1),A2(Ny)||(ey=ka.position+1),Ny=ka.input.charCodeAt(++ka.position)}if(kT(ka,ly,ey,!1),ka.result)return 1;ka.kind=Sy,ka.result=Dy}}(s,_s,1===h)&&(_p=!0,null===s.tag&&(s.tag="?")),null!==s.anchor&&(s.anchorMap[s.anchor]=s.result)):0===_l&&(_p=$&&PP(s,Ja))),null!==s.tag&&"!"!==s.tag)if("?"===s.tag){for(_t=0,Ye=s.implicitTypes.length;_t<Ye;_t+=1)if((_i=s.implicitTypes[_t]).resolve(s.result)){s.result=_i.construct(s.result),s.tag=_i.tag,null!==s.anchor&&(s.anchorMap[s.anchor]=s.result);break}}else DT.call(s.typeMap,s.tag)?(_i=s.typeMap[s.tag],null!==s.result&&_i.kind!==s.kind&&J0(s,"unacceptable node kind for !<"+s.tag+'> tag; it should be "'+_i.kind+'", not "'+s.kind+'"'),_i.resolve(s.result)?(s.result=_i.construct(s.result),null!==s.anchor&&(s.anchorMap[s.anchor]=s.result)):J0(s,"cannot resolve a node with !<"+s.tag+"> explicit tag")):J0(s,"unknown tag !<"+s.tag+">");return null!==s.listener&&s.listener("close",s),null!==s.tag||null!==s.anchor||_p}function Mx(s,l){l=l||{},0!==(s=String(s)).length&&(10!==s.charCodeAt(s.length-1)&&13!==s.charCodeAt(s.length-1)&&(s+="\n"),65279===s.charCodeAt(0)&&(s=s.slice(1)));var h=new kP(s,l);for(h.input+="\0";32===h.input.charCodeAt(h.position);)h.lineIndent+=1,h.position+=1;for(;h.position<h.length-1;)!function(g){var _,A,j,$,_t=g.position,Ye=!1;for(g.version=null,g.checkLineBreaks=g.legacy,g.tagMap={},g.anchorMap={};0!==($=g.input.charCodeAt(g.position))&&(L1(g,!0,-1),$=g.input.charCodeAt(g.position),!(0<g.lineIndent||37!==$));){for(Ye=!0,$=g.input.charCodeAt(++g.position),_=g.position;0!==$&&!Sx($);)$=g.input.charCodeAt(++g.position);for(j=[],(A=g.input.slice(_,g.position)).length<1&&J0(g,"directive name must not be less than one character in length");0!==$;){for(;A2($);)$=g.input.charCodeAt(++g.position);if(35===$){for(;0!==($=g.input.charCodeAt(++g.position))&&!IT($););break}if(IT($))break;for(_=g.position;0!==$&&!Sx($);)$=g.input.charCodeAt(++g.position);j.push(g.input.slice(_,g.position))}0!==$&&zO(g),DT.call(RP,A)?RP[A](g,A,j):Hx(g,'unknown document directive "'+A+'"')}L1(g,!0,-1),0===g.lineIndent&&45===g.input.charCodeAt(g.position)&&45===g.input.charCodeAt(g.position+1)&&45===g.input.charCodeAt(g.position+2)?(g.position+=3,L1(g,!0,-1)):Ye&&J0(g,"directives end mark is expected"),W0(g,g.lineIndent-1,4,!1,!0),L1(g,!0,-1),g.checkLineBreaks&&T2.test(g.input.slice(_t,g.position))&&Hx(g,"non-ASCII line breaks are interpreted as content"),g.documents.push(g.result),g.position===g.lineStart&&UD(g)?46===g.input.charCodeAt(g.position)&&(g.position+=3,L1(g,!0,-1)):g.position<g.length-1&&J0(g,"end of the stream or a document separator is expected")}(h);return h.documents}function HO(s,l,h){for(var g=Mx(s,h),_=0,A=g.length;_<A;_+=1)l(g[_])}function UO(s,l){var h=Mx(s,l);if(0!==h.length){if(1===h.length)return h[0];throw new Dx("expected a single document in the stream, but found more")}}var bM={loadAll:HO,load:UO,safeLoadAll:function(s,l,h){HO(s,l,f1.extend({schema:E2},h))},safeLoad:function(s,l){return UO(s,f1.extend({schema:E2},l))}},LP=Object.prototype.toString,GO=Object.prototype.hasOwnProperty,$O={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},zP=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function S4(s){this.schema=s.schema||vM,this.indent=Math.max(1,s.indent||2),this.skipInvalid=s.skipInvalid||!1,this.flowLevel=f1.isNothing(s.flowLevel)?-1:s.flowLevel,this.styleMap=function(l,h){var g,_,A,j,$,_t,Ye;if(null===h)return{};for(g={},A=0,j=(_=Object.keys(h)).length;A<j;A+=1)$=_[A],_t=String(h[$]),"!!"===$.slice(0,2)&&($="tag:yaml.org,2002:"+$.slice(2)),(Ye=l.compiledTypeMap[$])&&GO.call(Ye.styleAliases,_t)&&(_t=Ye.styleAliases[_t]),g[$]=_t;return g}(this.schema,s.styles||null),this.sortKeys=s.sortKeys||!1,this.lineWidth=s.lineWidth||80,this.noRefs=s.noRefs||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function BP(s,l){for(var h,g=f1.repeat(" ",l),_=0,A=-1,j="",$=s.length;_<$;)_=-1===(A=s.indexOf("\n",_))?(h=s.slice(_),$):(h=s.slice(_,A+1),A+1),h.length&&"\n"!==h&&(j+=g),j+=h;return j}function YO(s,l){return"\n"+f1.repeat(" ",s.indent*l)}function EM(s){this.source=s,this.result="",this.checkpoint=0}function KO(s,l){if(""===s)return s;for(var h,g,_=/[^\s] [^\s]/g,A="",j=0,$=0,_t=_.exec(s);_t;)l<(h=_t.index)-$&&(A&&(A+="\n"),A+=s.slice($,g=j!==$?j:h),$=g+1),j=h+1,_t=_.exec(s);return A&&(A+="\n"),A+($!==j&&s.length-$>l?s.slice($,j)+"\n"+s.slice(j+1):s.slice($))}function HP(s){return!(32<=s&&s<=126||133===s||160<=s&&s<=55295||57344<=s&&s<=65533||65536<=s&&s<=1114111)}function ZO(s,l,h){for(var g,_,A,j=h?s.explicitTypes:s.implicitTypes,$=0,_t=j.length;$<_t;$+=1)if(((_=j[$]).instanceOf||_.predicate)&&(!_.instanceOf||"object"==typeof l&&l instanceof _.instanceOf)&&(!_.predicate||_.predicate(l))){if(s.tag=h?_.tag:"?",_.represent){if(A=s.styleMap[_.tag]||_.defaultStyle,"[object Function]"===LP.call(_.represent))g=_.represent(l,A);else{if(!GO.call(_.represent,A))throw new Dx("!<"+_.tag+'> tag resolver accepts not "'+A+'" style');g=_.represent[A](l,A)}s.dump=g}return 1}}function pA(s,l,h,g,_,A){s.tag=null,s.dump=h,ZO(s,h,!1)||ZO(s,h,!0);var j=LP.call(s.dump);g=g&&(s.flowLevel<0||s.flowLevel>l);var $,_t,Ye="[object Object]"===j||"[object Array]"===j;if(Ye&&(_t=-1!==($=s.duplicates.indexOf(h))),(null!==s.tag&&"?"!==s.tag||_t||2!==s.indent&&0<l)&&(_=!1),_t&&s.usedDuplicates[$])s.dump="*ref_"+$;else{if(Ye&&_t&&!s.usedDuplicates[$]&&(s.usedDuplicates[$]=!0),"[object Object]"===j)g&&0!==Object.keys(s.dump).length?(function(_i,_s,Ja,_l){var lc,_p,ka,ty,ny,ry,ly="",ey=_i.tag,hy=Object.keys(Ja);if(!0===_i.sortKeys)hy.sort();else if("function"==typeof _i.sortKeys)hy.sort(_i.sortKeys);else if(_i.sortKeys)throw new Dx("sortKeys must be a boolean or a function");for(lc=0,_p=hy.length;lc<_p;lc+=1)ry="",_l&&0===lc||(ry+=YO(_i,_s)),ty=Ja[ka=hy[lc]],pA(_i,_s+1,ka,!0,!0,!0)&&((ny=null!==_i.tag&&"?"!==_i.tag||_i.dump&&1024<_i.dump.length)&&(_i.dump&&10===_i.dump.charCodeAt(0)?ry+="?":ry+="? "),ry+=_i.dump,ny&&(ry+=YO(_i,_s)),pA(_i,_s+1,ty,!0,ny)&&(_i.dump&&10===_i.dump.charCodeAt(0)?ry+=":":ry+=": ",ly+=ry+=_i.dump));_i.tag=ey,_i.dump=ly||"{}"}(s,l,s.dump,_),_t&&(s.dump="&ref_"+$+s.dump)):(function(_i,_s,Ja){for(var _l,lc,_p,ka="",ty=_i.tag,ny=Object.keys(Ja),ry=0,ly=ny.length;ry<ly;ry+=1)_p="",0!==ry&&(_p+=", "),lc=Ja[_l=ny[ry]],pA(_i,_s,_l,!1,!1)&&(1024<_i.dump.length&&(_p+="? "),_p+=_i.dump+": ",pA(_i,_s,lc,!1,!1)&&(ka+=_p+=_i.dump));_i.tag=ty,_i.dump="{"+ka+"}"}(s,l,s.dump),_t&&(s.dump="&ref_"+$+" "+s.dump));else if("[object Array]"===j)g&&0!==s.dump.length?(function(_i,_s,Ja,_l){for(var lc="",_p=_i.tag,ka=0,ty=Ja.length;ka<ty;ka+=1)pA(_i,_s+1,Ja[ka],!0,!0)&&(_l&&0===ka||(lc+=YO(_i,_s)),lc+="- "+_i.dump);_i.tag=_p,_i.dump=lc||"[]"}(s,l,s.dump,_),_t&&(s.dump="&ref_"+$+s.dump)):(function(_i,_s,Ja){for(var _l="",lc=_i.tag,_p=0,ka=Ja.length;_p<ka;_p+=1)pA(_i,_s,Ja[_p],!1,!1)&&(0!==_p&&(_l+=", "),_l+=_i.dump);_i.tag=lc,_i.dump="["+_l+"]"}(s,l,s.dump),_t&&(s.dump="&ref_"+$+" "+s.dump));else{if("[object String]"!==j){if(s.skipInvalid)return;throw new Dx("unacceptable kind of an object to dump "+j)}"?"!==s.tag&&function M4(s,l,h,g){var _,A,j,$,_t,Ye,_i,_s,Ja,_l,lc,_p,ka,ty,ny,ry,ly,ey,hy,fy,_y;if(0!==l.length)if(-1===zP.indexOf(l)){for(_=!0,45!==(A=l.length?l.charCodeAt(0):0)&&63!==A&&64!==A&&96!==A||(_=!1),_t=$=(j=32===A||32===l.charCodeAt(l.length-1))||-1<s.flowLevel&&s.flowLevel<=h?(j&&(_=!1),!1):!g,Ye=!0,_i=new EM(l),_s=!1,_l=Ja=0,-1===(_p=s.lineWidth)&&(_p=9007199254740991),(lc=s.indent*h)<40?_p-=lc:_p=40,ty=0;ty<l.length;ty++){if(ka=l.charCodeAt(ty),_){if(9!==(_y=ka)&&10!==_y&&13!==_y&&44!==_y&&91!==_y&&93!==_y&&123!==_y&&125!==_y&&35!==_y&&38!==_y&&42!==_y&&33!==_y&&124!==_y&&62!==_y&&39!==_y&&34!==_y&&37!==_y&&58!==_y&&!$O[_y]&&!HP(_y))continue;_=!1}Ye&&39===ka&&(Ye=!1),ny=$O[ka],ry=HP(ka),(ny||ry)&&(10!==ka&&34!==ka&&39!==ka?_t=$=!1:10===ka&&(Ye=!(_s=!0),0<ty&&32===l.charCodeAt(ty-1)&&($=_t=!1),$&&(ly=ty-Ja,Ja=ty,_l<ly&&(_l=ly))),34!==ka&&(Ye=!1),_i.takeUpTo(ty),_i.escapeChar())}if(_&&function(Iy,Sy){for(var Dy=0,Ny=Iy.implicitTypes.length;Dy<Ny;Dy+=1)if(Iy.implicitTypes[Dy].resolve(Sy))return 1}(s,l)&&(_=!1),ey="",($||_t)&&(hy=0,10===l.charCodeAt(l.length-1)&&(hy+=1,10===l.charCodeAt(l.length-2)&&(hy+=1)),0===hy?ey="-":2===hy&&(ey="+")),(_t&&_l<_p||null!==s.tag)&&($=!1),_s||(_t=!1),_)s.dump=l;else if(Ye)s.dump="'"+l+"'";else if($)fy=function(Iy,Sy){var Dy,Ny="",r0=0,Vy=Iy.length,Yy=/\n+$/.exec(Iy);for(Yy&&(Vy=Yy.index+1);r0<Vy;)r0=Vy<(Dy=Iy.indexOf("\n",r0))||-1===Dy?(Ny&&(Ny+="\n\n"),Ny+=KO(Iy.slice(r0,Vy),Sy),Vy):(Ny&&(Ny+="\n\n"),Ny+=KO(Iy.slice(r0,Dy),Sy),Dy+1);return Yy&&"\n"!==Yy[0]&&(Ny+=Yy[0]),Ny}(l,_p),s.dump=">"+ey+"\n"+BP(fy,lc);else if(_t)ey||(l=l.replace(/\n$/,"")),s.dump="|"+ey+"\n"+BP(l,lc);else{if(!_i)throw new Error("Failed to dump scalar value");_i.finish(),s.dump='"'+_i.result+'"'}}else s.dump="'"+l+"'";else s.dump="''"}(s,s.dump,l,A)}null!==s.tag&&"?"!==s.tag&&(s.dump="!<"+s.tag+"> "+s.dump)}return 1}function I4(s,l){var h=new S4(l=l||{});return h.noRefs||function XO(s,l){var h,g,_=[],A=[];for(function j($,_t,Ye){var _i,_s,Ja;if(null!==$&&"object"==typeof $)if(-1!==(_s=_t.indexOf($)))-1===Ye.indexOf(_s)&&Ye.push(_s);else if(_t.push($),Array.isArray($))for(_s=0,Ja=$.length;_s<Ja;_s+=1)j($[_s],_t,Ye);else for(_s=0,Ja=(_i=Object.keys($)).length;_s<Ja;_s+=1)j($[_i[_s]],_t,Ye)}(s,_,A),h=0,g=A.length;h<g;h+=1)l.duplicates.push(_[A[h]]);l.usedDuplicates=new Array(g)}(s,h),pA(h,0,s,!0,!0)?h.dump+"\n":""}EM.prototype.takeUpTo=function(s){var l;if(s<this.checkpoint)throw(l=new Error("position should be > checkpoint")).position=s,l.checkpoint=this.checkpoint,l;return this.result+=this.source.slice(this.checkpoint,s),this.checkpoint=s,this},EM.prototype.escapeChar=function(){var s=this.source.charCodeAt(this.checkpoint),l=$O[s]||function(h){var g,_,A=h.toString(16).toUpperCase();if(h<=255)g="x",_=2;else if(h<=65535)g="u",_=4;else{if(!(h<=4294967295))throw new Dx("code point within a string may not be greater than 0xFFFFFFFF");g="U",_=8}return"\\"+g+f1.repeat("0",_-A.length)+A}(s);return this.result+=l,this.checkpoint+=1,this},EM.prototype.finish=function(){this.source.length>this.checkpoint&&this.takeUpTo(this.source.length)};var TM={dump:I4,safeDump:function(s,l){return I4(s,f1.extend({schema:E2},l))}};function AM(s){return function(){throw new Error("Function "+s+" is deprecated and cannot be used.")}}var k4={Type:_w,Schema:_E,FAILSAFE_SCHEMA:kO,JSON_SCHEMA:RO,CORE_SCHEMA:TP,DEFAULT_SAFE_SCHEMA:E2,DEFAULT_FULL_SCHEMA:vM,load:bM.load,loadAll:bM.loadAll,safeLoad:bM.safeLoad,safeLoadAll:bM.safeLoadAll,dump:TM.dump,safeDump:TM.safeDump,YAMLException:Dx,MINIMAL_SCHEMA:kO,SAFE_SCHEMA:E2,DEFAULT_SCHEMA:vM,scan:AM("scan"),parse:AM("parse"),compose:AM("compose"),addConstructor:AM("addConstructor")},Xy=function(){function s(l,h){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;D0(this,s),this.url=l,this.path=!h||EI(h)&&!EI(this.url)?BC(this.url):h,this.path_for_parent=h||this.path,this.parent=g,this.container=null,this.parent&&(this.parent.container?this.container=this.parent.container:this.parent.isContainer()&&(this.container=this.parent))}return T0(s,[{key:"load",value:function(){return l=this.url,new Promise(function(h,g){"string"==typeof l?G0.io(l).then(function(_){try{var A=function(j){var $;try{$=k4.safeLoad(j,{json:!0})}catch(_t){throw _t}return $}(_);h(A)}catch(j){g(j)}},g):(l=Object.assign({},l),h(l))});var l}},{key:"resourceFor",value:function(l){return{url:this.urlFor(l),path:this.pathFor(l),type:this.typeFor(l)}}},{key:"urlFor",value:function(l){return qD(l)?l:EI(l)&&this.container?this.parent.urlFor(this.path_for_parent+l):function(h,g){if(!h||!EI(h))return h;var _,A="/"!==h[0];return g?(_=document.createElement("a")).href=g:_=window.location,A?BC(_.href)+h:(_.origin||_.protocol+"//"+_.host)+h}(l,this.path)}},{key:"pathFor",value:BC},{key:"typeFor",value:function(l){var h=(l=l.split("/").pop()).lastIndexOf(".");if(-1<h)return l.substring(h+1)}},{key:"isContainer",value:function(){return!1}}]),s}();function qD(s){return!(!s||"global."!==s.slice(0,7))}function UP(s){return null!=s}function eE(s){return"("+s+")"}function Ux(s){return"$"===s[0]?"context['"+s.substring(1)+"']":"context.feature.properties['"+s+"']"}function JO(s,l){return eE(("string"==typeof(h=l)?'"'+h+'"':h)+" === "+Ux(s));var h}function GP(s,l){return eE(s.filter(UP).map(function(h){return eE(h.join(" && "))}).join(" "+l+" "))}function WD(s,l,h){return l&&0<l.length?GP(l.map(function(g){return bE(g,h)}),"||"):"true"}function bE(s,l){var h=[];if("function"==typeof s)return[eE(s.toString()+"(context)")];if(Array.isArray(s))return[WD(0,s,l)];if(null==s)return["true"];for(var g,_,A,j,$,_t,Ye,_i,_s=Object.keys(s),Ja=0;Ja<_s.length;Ja++){var _l=_s[Ja],lc=s[_l],_p=T_(lc);if("string"===_p||"number"===_p)h.push(JO(_l,lc));else if("boolean"===_p)h.push((_i=lc,eE(Ux(_l)+(_i?" != ":" == ")+"null")));else if("not"===_l)h.push("!"+eE(bE(lc,l).join(" && ")));else if("any"===_l)h.push(WD(0,lc,l));else if("all"===_l)h.push(function(ka,ty){return ka&&0<ka.length?GP(ka.map(function(ny){return bE(ny,ty)}),"&&"):"true"}(lc,l));else if("none"===_l)h.push("!"+eE(WD(0,lc,l)));else if(Array.isArray(lc))h.push(function(ka,ty){return eE(ty.map(function(ny){return JO(ka,ny)}).join(" || "))}(_l,lc));else if("object"===_p&&null!=lc)(lc.max||lc.min)&&h.push((g=_l,Ye=_t=$=j=void 0,_t=[],Ye=(A=l)&&"function"==typeof A.rangeTransform&&A.rangeTransform,(_=lc).max&&(j=Ye?Ye(_.max):_.max,_t.push(Ux(g)+" < "+j)),_.min&&($=Ye?$=Ye(_.min):_.min,_t.push(Ux(g)+" >= "+$)),eE(_t.join(" && "))));else{if(null!=lc)throw new Error("Unknown Query syntax: "+lc);h.push(" true ")}}return 0===_s.length?["true"]:h}function CM(s,l){return null==s?function(){return!0}:new Function("context","return "+eE(bE(s,l).join(" && "))+";")}var qP=["filter","draw","visible","enabled","data"],fx={},WV=["any","all","not","none"],DM=function(){function s(l){var h,g=l.layer,_=l.name,A=l.parent,j=l.draw,$=l.visible,_t=l.enabled,Ye=l.filter,_i=l.styles;if(D0(this,s),this.id=s.id++,this.config_data=g.data,this.parent=A,this.name=_,this.full_name=this.parent?this.parent.full_name+":"+this.name:this.name,this.draw=j,this.filter=Ye,this.styles=_i,this.is_built=!1,_t=void 0===_t?$:_t,this.enabled=(!this.parent||!1!==this.parent.visible)&&!1!==_t,this.draw)for(var _s in this.draw)this.draw[_s]=this.draw[_s]??{},"object"!==T_(this.draw[_s])?(h="Draw group '".concat(_s,"' for layer ").concat(this.full_name," is invalid, must be an object, "),$y("warn",h+="but was set to `".concat(_s,": ").concat(this.draw[_s],"` instead")),delete this.draw[_s]):this.draw[_s].layer_name=this.full_name}return T0(s,[{key:"build",value:function(){$y("trace","Building layer '".concat(this.full_name,"'")),this.buildFilter(),this.buildDraw(),this.is_built=!0}},{key:"buildDraw",value:function(){var h;this.draw=G0.stringsToFunctions(this.draw,by.wrapFunction),this.calculatedDraw=(h=[],this.parent&&h.push.apply(h,A_(this.parent.calculatedDraw||[])),h.push(this.draw),h)}},{key:"buildFilter",value:function(){this.filter_original=this.filter,this.filter=G0.stringsToFunctions(this.filter,by.wrapFunction);var l=T_(this.filter);if(null==this.filter||"object"===l||"function"===l)try{this.buildZooms(),this.buildPropMatches(),this.filter=null!=this.filter&&("function"==typeof this.filter||0<Object.keys(this.filter).length)?CM(this.filter,IM):null}catch(_){var h="Filter for layer ".concat(this.full_name," is invalid, `filter: ").concat(JSON.stringify(this.filter),"` ");$y("warn",h+="failed with error '".concat(_.message,"', stack trace: ").concat(_.stack))}else{var g="Filter for layer ".concat(this.full_name," is invalid, filter value must be an object or function, ");$y("warn",g+="but was set to `filter: ".concat(this.filter,"` instead"))}}},{key:"buildZooms",value:function(){var l=this.filter&&this.filter.$zoom,h=T_(l);if(null!=l&&"function"!==h){if(this.zooms={},"number"===h)this.zooms[l]=!0;else if(Array.isArray(l))for(var g=0;g<l.length;g++)this.zooms[l[g]]=!0;else if("object"===h&&(null!=l.min||null!=l.max))for(var A=l.max||25,j=l.min||0;j<A;j++)this.zooms[j]=!0;delete this.filter.$zoom}}},{key:"buildPropMatches",value:function(){var l=this;this.filter&&!Array.isArray(this.filter)&&"function"!=typeof this.filter&&Object.keys(this.filter).forEach(function(h){if(-1===WV.indexOf(h)){var g=l.filter[h],_=T_(g),A=Array.isArray(g);if(!A&&"string"!==_&&"number"!==_)return;"$"===h[0]?(l.context_prop_matches=l.context_prop_matches||[],l.context_prop_matches.push([h.substring(1),A?g:[g]])):(l.feature_prop_matches=l.feature_prop_matches||[],l.feature_prop_matches.push([h,A?g:[g]])),delete l.filter[h]}})}},{key:"doPropMatches",value:function(l){if(this.feature_prop_matches)for(var h=0;h<this.feature_prop_matches.length;h++){var g=this.feature_prop_matches[h],_=l.feature.properties[g[0]];if(null==_||-1===g[1].indexOf(_))return!1}if(this.context_prop_matches)for(var A=0;A<this.context_prop_matches.length;A++){var j=this.context_prop_matches[A],$=l[j[0]];if(null==$||-1===j[1].indexOf($))return!1}return!0}},{key:"doesMatch",value:function(l){if(!this.enabled||(this.is_built||this.build(),null!=this.zooms&&!this.zooms[l.zoom])||!this.doPropMatches(l))return!1;var h;if(this.filter instanceof Function)try{h=this.filter(l)}catch(_){var g="Filter for this ".concat(this.full_name,": `filter: ").concat(this.filter_original,"` ");$y("error",g+="failed with error '".concat(_.message,"', stack trace: ").concat(_.stack),l.feature)}else h=null==this.filter;return!!h&&(this.children_to_parse&&(function(_,A,j){for(var $ in A){var _t,Ye=A[$];"object"!==T_(Ye)||Array.isArray(Ye)?(_t="Layer value must be an object: cannot create layer '".concat($,": ").concat(JSON.stringify(Ye),"'"),_t+=", under parent layer '".concat(_.full_name,"'."),j[_.name]&&(_t+=" The parent name '".concat(_.name,"' is also the name of a style, did you mean to create a 'draw' group"),_.parent&&(_t+=" under '".concat(_.parent.name,"'")),_t+=" instead?"),$y("warn",_t)):OM($,Ye,_,j)}}(this,this.children_to_parse,this.styles),delete this.children_to_parse),!0)}}]),s}();DM.id=0;var O4,SM=function(){L_(l,DM);var s=B1(l);function l(h){var g;return D0(this,l),(g=s.call(this,h)).is_leaf=!0,g}return l}(),MM=function(){L_(l,DM);var s=B1(l);function l(h){var g;return D0(this,l),(g=s.call(this,h)).is_tree=!0,g.layers=h.layers||[],g}return T0(l,[{key:"addLayer",value:function(h){this.layers.push(h)}},{key:"buildDrawGroups",value:function(h){var g=[],_=[];if(function lc(_p,ka,ty,ny){var ry=!1;if(0!==ka.length){for(var ly=0;ly<ka.length;ly++){var ey=ka[ly];ey.is_leaf?ey.doesMatch(_p)&&(ry=!0,ty.push(ey),ny.push(ey.id)):ey.is_tree&&ey.doesMatch(_p)&&(ry=!0,lc(_p,ey.layers,ty,ny)||(ty.push(ey),ny.push(ey.id)))}return ry}}(h,[this],g,_),0<g.length){var A=function(lc){if(1<lc.length){for(var _p=lc[0],ka=1;ka<lc.length;ka++)_p+="/"+lc[ka];return _p}return lc[0]}(_);if(void 0===fx[A]){for(var j=g.map(function(lc){return lc&&!1!==lc.visible&&lc.calculatedDraw}),$={},_t=0;_t<j.length;_t++){var Ye=j[_t];if(Ye)for(var _i=0;_i<Ye.length;_i++){var _s=Ye[_i];for(var Ja in _s)$[Ja]=!0}}for(var _l in $)fx[A]=fx[A]||{},fx[A][_l]=function(lc,_p){for(var ka,ty=0,ny=0;ny<lc.length;ny++)lc[ny].length>ty&&(ty=lc[ny].length);if(0===ty)return null;for(var ry={visible:!0},ly=0;ly<ty;ly++)!function(ey){ka=[],lc.forEach(function(hy){hy[ey]&&hy[ey][_p]&&-1===ka.indexOf(hy[ey][_p])&&ka.push(hy[ey][_p])}),0!==ka.length&&(ka.sort(function(hy,fy){return(hy&&hy.layer_name)>(fy&&fy.layer_name)?1:-1}),Q1.apply(void 0,[ry].concat(A_(ka))),delete ry.layer_name)}(ly);return!1===ry.visible?null:ry}(j,_l),fx[A][_l]?(fx[A][_l].key=A+"/"+_l,fx[A][_l].layers=g.map(function(lc){return lc&&lc.full_name}),fx[A][_l].group=_l):delete fx[A][_l];fx[A]&&0===Object.keys(fx[A]).length&&(fx[A]=null)}return fx[A]}}}]),l}(),IM={rangeTransform:function(s){return"string"==typeof s&&"px2"===s.trim().slice(-3)?"".concat(parseFloat(s)," * context.meters_per_pixel_sq"):s}};function kM(s){return-1<qP.indexOf(s)}function OM(s,l,h,g){var A={name:s,layer:l=l??{},parent:h,styles:g},j=A0(function(Ja){var _l={},lc={};for(var _p in Ja)kM(_p)?_l[_p]=Ja[_p]:lc[_p]=Ja[_p];return[_l,lc]}(l),2),$=j[0],_t=j[1],Ye=0===Object.keys(_t).length,_s=new(Ye&&null!=h?SM:MM)(Object.assign(A,$));return _s.enabled&&(h&&h.addLayer(_s),_s.children_to_parse=Ye?null:_t),_s}var R4=/^global\.(.+)$/,dA=O4={loadScene:function(s,l){var h=this,g=1<arguments.length&&void 0!==l?l:{},_=g.path,A=g.type,j=[];return this.loadSceneRecursive({url:s,path:_,type:A},null,j).then(function($){return h.finalize($)}).then(function($){var _t=$.config,Ye=$.bundle;return _t?(0<j.length&&j.forEach(function(_i){var _s="Failed to import scene: ".concat(_i.url);$y("error",_s,_i),h.trigger("error",{type:"scene_import",message:_s,error:_i,url:_i.url})}),{config:_t,bundle:Ye}):Promise.reject(j[0])})},loadSceneRecursive:function(s,l,h){var g=this,_=s.url,A=s.path,j=2<arguments.length&&void 0!==h?h:[];if(!_)return Promise.resolve({});var $=new Xy(_,A,l);return $.load().then(function(_t){if(null==_t.import)return g.normalize(_t,$),{config:_t,bundle:$};Array.isArray(_t.import)||(_t.import=[_t.import]);var Ye=[];return _t.import.forEach(function(_i){"object"===T_(_i)&&(_i=TI(new Blob([JSON.stringify(_i)]))),Ye.push($.resourceFor(_i))}),delete _t.import,Promise.all(Ye.map(function(_i){return g.loadSceneRecursive(_i,$,j)})).then(function(_i){_i.forEach(function(Ja){return g.normalize(Ja.config,Ja.bundle)});var _s=_i.map(function(Ja){return Ja.config});return _t=Q1.apply(void 0,A_(_s).concat([_t])),g.normalize(_t,$),{config:_t,bundle:$}})}).catch(function(_t){return _t.url=_,j.push(_t),{}})},normalize:function(s,l){return this.normalizeDataSources(s,l),this.normalizeFonts(s,l),this.normalizeTextures(s,l),this.hoistTextures(s,l),{config:s,bundle:l}},normalizeDataSources:function(s,l){for(var h in s.sources=s.sources||{},s.sources)this.normalizeDataSource(s.sources[h],l);return s},normalizeDataSource:function(s,l){if(s.url&&(s.url=l.urlFor(s.url)),s.scripts)for(var h in Array.isArray(s.scripts)&&(s.scripts=s.scripts.reduce(function(g,_){return g[_]=_,g},{})),s.scripts)s.scripts[h]=l.urlFor(s.scripts[h]);return s},normalizeFonts:function(s,l){for(var h in s.fonts=s.fonts||{},s.fonts){var g;Array.isArray(s.fonts[h])?s.fonts[h].forEach(function(_){_.url=_.url&&l.urlFor(_.url)}):(g=s.fonts[h]).url=g.url&&l.urlFor(g.url)}return s},normalizeTextures:function(s,l){if(s.textures=s.textures||{},s.textures)for(var h in s.textures){var g=s.textures[h];g.url&&(g.url=l.urlFor(g.url))}},hoistTextures:function(s,l){var h=this;if(s.styles)for(var g in s.styles)!function(_s){var Ja=s.styles[_s],_l=Ja.texture;"string"!=typeof _l||s.textures[_l]||(Ja.texture=h.hoistTexture(_l,s,l)),Ja.material&&["emission","ambient","diffuse","specular","normal"].forEach(function(lc){var _p=null!=Ja.material[lc]&&Ja.material[lc].texture;"string"!=typeof _p||s.textures[_p]||(Ja.material[lc].texture=h.hoistTexture(_p,s,l))})}(g);if(this.hoistStyleShaderUniformTextures(s,l,{include_globals:!1}),s.layers)for(var _=[s.layers];0<_.length;){var A=_.pop();if("object"===T_(A)&&!Array.isArray(A))for(var j in A)if("draw"===j){var $,_t,Ye=A[j];for(var _i in Ye)Ye[_i].texture&&("string"!=typeof($=Ye[_i].texture)||s.textures[$]||(Ye[_i].texture=this.hoistTexture($,s,l))),Ye[_i].outline&&Ye[_i].outline.texture&&("string"!=typeof(_t=Ye[_i].outline.texture)||s.textures[_t]||(Ye[_i].outline.texture=this.hoistTexture(_t,s,l)))}else{if(kM(j))continue;_.push(A[j])}}},hoistStyleShaderUniformTextures:function(s,l,h){var g=this,_=h.include_globals;if(s.styles)for(var A in s.styles){var j=s.styles[A];j.shaders&&j.shaders.uniforms&&lx.parseUniforms(j.shaders.uniforms).forEach(function($){var Ye=$.value,_i=$.key,_s=$.uniforms;"sampler2D"!==$.type||"string"!=typeof Ye||s.textures[Ye]||!_&&qD(Ye)||(_s[_i]=g.hoistTexture(Ye,s,l))})}},hoistTexture:function(s,l,h){var g=qD(s),_=g?s:h.urlFor(s),A=g?"texture-".concat(_):_;return l.textures[A]={url:_},A},applyGlobalProperties:function(s){if(!s.global||0===Object.keys(s.global).length)return s;var l=function h(g){var _=1<arguments.length&&void 0!==arguments[1]?arguments[1]:".",A=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,j=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};for(var $ in A=A?A+_:"",g){var _t=A+$,Ye=g[$];"object"!==T_(j[_t]=Ye)||Array.isArray(Ye)||h(Ye,_,_t,j)}return j}(s.global);return function h(g){if("string"==typeof g){var _=function $(_t,Ye,_i){var _s=2<arguments.length&&void 0!==_i?_i:[];if(-1<_s.indexOf(_t))$y({level:"warn",once:!0},"Global properties: cyclical reference detected",_s);else{_s.push(_t);var Ja=R4.exec(_t);if(Ja){var _l=Ja[1];if(_l){var lc=Ye[_l];if(void 0!==lc)return"string"==typeof lc&&R4.exec(lc)?$(lc,Ye,_s):lc;$y({level:"warn",once:!0},"Global property not found: "+_t)}else $y({level:"warn",once:!0},"Invalid global property reference: "+_t)}}}(g,l);void 0!==_&&(g=_)}else if(Array.isArray(g))for(var A=0;A<g.length;A++)g[A]=h(g[A]);else if("object"===T_(g))for(var j in g)g[j]=h(g[j]);return g}(s)},finalize:function(s){var l=s.config,h=s.bundle;return l?(l.global=l.global||{},l.scene=l.scene||{},l.cameras=l.cameras||{},l.lights=l.lights||{},l.styles=l.styles||{},l.layers=l.layers||{},l.camera&&(l.cameras.default=l.camera),0===Object.keys(l.cameras).length&&(l.cameras.default={}),0!==Object.keys(l.lights).length&&!Object.keys(l.lights).every(function(g){return!1===l.lights[g].visible})||(l.lights.default_light={type:"directional"}),{config:l,bundle:h}):{}}};FA(O4);var N4=function(){function s(){D0(this,s),this.coords={},this.max_proxy_descendant_depth=6,this.max_proxy_ancestor_depth=10}return T0(s,[{key:"sourceTiles",value:function(l,h){return this.coords[l.key]&&this.coords[l.key].sources&&this.coords[l.key].sources[h.name]}},{key:"addTile",value:function(l){var h=l.coords.key,g=this.coords[h];(g=g||(this.coords[h]={descendants:0})).sources||(g.sources={}),g.sources[l.source.name]||(g.sources[l.source.name]={});for(var _=(g.sources[l.source.name][l.style_zoom]=l).coords.z-1;0<=_;_--){var A=n1.coordinateAtZoom(l.coords,_);this.coords[A.key]||(this.coords[A.key]={descendants:0}),this.coords[A.key].descendants++}}},{key:"removeTile",value:function(l){var h=this.sourceTiles(l.coords,l.source),g=l.coords.key;h&&(delete h[l.style_zoom],0===Object.keys(h).length&&(delete this.coords[g].sources[l.source.name],0===Object.keys(this.coords[g].sources).length&&(delete this.coords[g].sources,0===this.coords[g].descendants&&delete this.coords[g])));for(var _=l.coords.z-1;0<=_;_--){var A=n1.coordinateAtZoom(l.coords,_);this.coords[A.key]&&0<this.coords[A.key].descendants&&(this.coords[A.key].descendants--,0!==this.coords[A.key].descendants||this.coords[A.key].sources||delete this.coords[A.key])}}},{key:"getAncestor",value:function(l,h){var g=l.coords,_=l.style_zoom,A=l.source,j=1<arguments.length&&void 0!==h?h:1;if(!(j>this.max_proxy_ancestor_depth)){if(_>A.max_coord_zoom){var $=this.sourceTiles(g,A);if($)for(var _t=_-1;_t>=A.max_coord_zoom;_t--)if($[_t]&&$[_t].loaded)return $[_t];_=A.max_coord_zoom}_--;var Ye=n1.coordinateAtZoom(g,g.z-1),_i=this.sourceTiles(Ye,A);return _i&&_i[_]&&_i[_].loaded?_i[_]:0<Ye.z?this.getAncestor({coords:Ye,style_zoom:_,source:A},j+1):void 0}}},{key:"getDescendants",value:function(l,h){var g=l.coords,_=l.style_zoom,A=l.source,j=1<arguments.length&&void 0!==h?h:1,$=[];if(_>=A.max_coord_zoom){var _t=this.sourceTiles(g,A);if(_t)for(var Ye=Math.max(My.default_view_max_zoom,_+this.max_proxy_descendant_depth),_i=_+1;_i<=Ye;_i++)if(_t[_i]&&_t[_i].loaded)return $.push(_t[_i]),$;return $}if(this.coords[g.key]&&0<this.coords[g.key].descendants){_++;for(var _s=n1.childrenForCoordinate(g),Ja=0;Ja<_s.length;Ja++){var _l=_s[Ja],lc=this.sourceTiles(_l,A);lc&&lc[_]&&lc[_].loaded?$.push(lc[_]):j<=this.max_proxy_descendant_depth&&_l.z<=A.max_coord_zoom&&$.push.apply($,A_(this.getDescendants({coords:_l,source:A,style_zoom:_},j+1)))}}return $}}]),s}(),P4=function(){function s(l,h,g,_){D0(this,s),Object.assign(this,l),this.placed=null,this._tile=_;var A=My.unitsPerMeter(_.coords.z)*Math.pow(2,g-_.style_zoom);this.layout=Object.assign({},l.layout),this.layout.repeat_scale=.75,this.layout.repeat_distance=this.layout.repeat_distance||0,this.layout.repeat_distance/=A,this.position=My.tileSpaceToMeters(this.position,_.coords.z,_.min),this._worldToScreen=h,this._screenSpaceBoundingBox=void 0,this._boundingCircles=void 0}return T0(s,[{key:"getTile",value:function(){return this._tile}},{key:"isFlat",value:function(){return this.is_flat}},{key:"getScreenSpaceBoundingBox",value:function(){var l,h,g;return this._screenSpaceBoundingBox||((l=this._worldToScreen(this.position,!0))[0]+=this.offset[0],l[1]+=this.offset[1],this._screenSpaceBoundingBox={left:l[0]-(h=this.size[0]/2+this.layout.buffer[0]),bottom:l[1]+(g=this.size[1]/2+this.layout.buffer[1]),right:l[0]+h,top:l[1]-g}),this._screenSpaceBoundingBox}},{key:"getBoundingCircles",value:function(){return this._boundingCircles||(this._boundingCircles="point"===this.type?this._convertSidesToScreenSpaceCircles():this._convertCirclesToScreenSpace()),this._boundingCircles}},{key:"_convertSidesToScreenSpaceCircles",value:function(){var l=this._tile.coords.z,h=this._tile.min,g=My.tileSpaceToMeters([this.sides[0],this.sides[1]],l,h),_=My.tileSpaceToMeters([this.sides[2],this.sides[3]],l,h),A=A0(this._worldToScreen(g,!0),2),j=A[0],$=A[1],_t=A0(this._worldToScreen(_,!0),2);return PD(j,$,_t[0],_t[1],this.size[1]/2+this.layout.buffer[1])}},{key:"_convertCirclesToScreenSpace",value:function(){for(var l=[],h=this.circles,g=this._tile.coords.z,_=this._tile.min,A=0;A<h.length-2;A+=3){var j=My.tileSpaceToMeters([h[A],-h[A+1]],g,_),$=h[A+2]/My.unitsPerMeter(g),_t=[j[0]+$,j[1]],Ye=this._worldToScreen(j,!0),_i=this._worldToScreen(_t,!0),_s=j_.getLineLength(Ye[0],Ye[1],_i[0],_i[1]);l.push(Ye[0],Ye[1],_s)}return l}}]),s}(),RM={},F4={},WP=120===new Uint8Array(new Uint32Array([305419896]).buffer)[0];function j4(s,l,h,g,_){var A=s.container,$=A.linked,_t=s.ranges;return{label:new P4(A.label,h,g,_),linked:$,ranges:_t,mesh:l}}var $P=function(){function s(l){D0(this,s),this.textureManager=ZE(l),this.tiles={},this.meshes=[],this.containers=[]}return T0(s,[{key:"insertLabel",value:function(l,h){var g=l.label.text_data,_=g.text_settings_key,A=g.text,j=g.text_info;this.containers.push(l);var $=this._ensureTextSection(h,_);$[A]?l.label.text_data.text_info=$[A]:$[A]=j}},{key:"trackMesh",value:function(l){-1===this.meshes.indexOf(l)&&this.meshes.push(l)}},{key:"updateMeshes",value:function(){var l=this;return this.containers.forEach(function(h){var g,_,A,j,$,Ye,_i,_s;h.label.text_data&&(g=h.label.getTile(),(_=h.mesh).valid?(A=h.label.type,j=h.label.text_data.text_info,l.tiles[g.id]&&l.tiles[g.id].textures&&(_.uniforms.u_texture=$=l.tiles[g.id].textures[0],-1===_.textures.indexOf($)&&_.textures.push($),"point"===A||"straight"===A?l.setTexCoords(_,h,"point"===A?j.align[h.label.align].texcoords:j.texcoords[A].texcoord):"curved"===A&&(Ye=j.segments.length,_i=j.texcoords_stroke,_s=j.texcoords.curved,l.setTexCoords(_,h,function(_l){return _l<Ye?_i[_l]:_s[_l-Ye].texcoord})))):l.tiles[g.id]&&l.tiles[g.id].textures&&l.textureManager.release(l.tiles[g.id].textures[0]))}),this.meshes}},{key:"setTexCoords",value:function(l,h,g){var _,A,j,$,_t,Ye,_i=g instanceof Function;_i||(A=(_=A0(g,4))[0],Ye=[[A,j=_[1]],[$=_[2],j],[$,_t=_[3]],[A,_t]]);var _s=l.vertex_layout.stride,Ja=new DataView(l.vertex_data.buffer),_l=l.vertex_layout.offset.a_texcoord;h.ranges.forEach(function(lc,_p){var ka,ty,ny,ry,ly,ey=A0(lc,3),hy=ey[0],fy=ey[1],_y=ey[2];_i&&(ty=(ka=A0(g(_p),4))[0],Ye=[[ty,ny=ka[1]],[ry=ka[2],ny],[ry,ly=ka[3]],[ty,ly]]);for(var Iy=_y?fy/2:0;Iy<fy;Iy++){var Sy=Ye[Iy%4],Dy=hy+Iy*_s;Ja.setUint16(Dy+_l,65535*Sy[0],WP),Ja.setUint16(Dy+_l+2,65535*Sy[1],WP)}})}},{key:"createTextures",value:function(l){var h=this;return Promise.all(Object.values(this.tiles).map(function(g){var _=g.id;return h._createTexturesForTile(l,g.texts,"labels-".concat(g.key,"-").concat(_),_,h.textureManager).then(function($){$.length&&($.forEach(function(_t){h.textureManager.retain(_t),1<h.textureManager.getRetainCount(_t)&&h.textureManager.release(_t)}),h.tiles[_].textures=$)})}))}},{key:"_createTexturesForTile",value:function(l,h,g,_,A){var j=new Xx,$=j.setTextureTextPositions(h);return j.rasterize(h,$,_,g,l,A)}},{key:"_ensureTile",value:function(l){var h=l.id;return this.tiles[h]||(this.tiles[h]={id:h,key:l.key,texts:{}}),this.tiles[h]}},{key:"_ensureTextSection",value:function(l,h){var g=this._ensureTile(l).texts;return g[h]||(g[h]={}),g[h]}}]),s}(),YP=function(){function s(l){var A,h=this,g=l.scene,_=l.view;D0(this,s),this._scene=g,this._view=_,this._visible_tiles={},this._pyramid=new N4,this._visible_coords={},this._building_tiles=null,this._renderable_tiles=[],this._active_styles=[],this._tile_visibility_counters={},this._update_labels_on_queue_check=!1,this._all_visible_tiles_are_cached=!1,this._debouncedUpdateLabels=NA(this._updateLabels.bind(this),100,200),this._main_thread_target=["TileManager",this._scene.id].join("_"),_0.addTarget(this._main_thread_target,this),this._keepCoordinate=this._keepCoordinate.bind(this),this._removeTilesFilter=this._removeTilesFilter.bind(this),this._removeCachedTilesFilter=this._removeCachedTilesFilter.bind(this),this._is_labeled=!1,this._tile_cache=new H.util.Cache((A=.1,navigator&&navigator.deviceMemory?A=5*navigator.deviceMemory/100:window&&window.screen&&(A=window.screen.width/512*window.screen.height/512*.03*3,A=Math.min(A,1)),1024*A*1024*1024),function(A,j,$){h._visible_tiles[A]&&h._visible_tiles[A]===j||j.destroy()})}return T0(s,[{key:"destroy",value:function(){this._tile_cache.removeAll(),this.forEachVisibleTile(function(l){return l.destroy()}),this._visible_tiles={},this._pyramid=null,this._visible_coords={},this._scene=null,this._view=null}},{key:"keepTile",value:function(l){this._visible_tiles[l.key]=l,this._pyramid.addTile(l)}},{key:"hasTile",value:function(l){return void 0!==this._visible_tiles[l]}},{key:"_forgetTile",value:function(l){var h,g;this.hasTile(l)&&(this._pyramid.removeTile(h=this._visible_tiles[l]),delete this._visible_tiles[l],h.loaded?this._tile_cache.add(h.key,h,function(_){var A=0;for(var j in _.meshes)for(var $=_.meshes[j],_t=0;_t<$.length;_t++){var Ye=$[_t];A+=Ye.buffer_size;for(var _i=0;_i<Ye.textures.length;_i++)A+=_.textureManager.getByteLength(Ye.textures[_i])}return A}(h)):(g=this._tile_cache.get(h.key))?this._tile_cache.drop(g.key):h.destroy(),this._tileBuildStop(h))}},{key:"removeTile",value:function(l){this._forgetTile(l),this._scene.requestRedraw()}},{key:"forEachVisibleTile",value:function(l){for(var h in this._visible_tiles)l(this._visible_tiles[h])}},{key:"removeTiles",value:function(l){for(var h in this._visible_tiles)l(this._visible_tiles[h])&&this.removeTile(h)}},{key:"removeCachedTiles",value:function(l){var h=this;this._tile_cache.forEach(function(g,_){l(_)&&h._tile_cache.drop(g)})}},{key:"updateTilesForView",value:function(l){var h=0<arguments.length&&void 0!==l&&l;this._visible_coords={};for(var g=this._view.findVisibleTileCoordinates(),_=0;_<g.length;_++){var A=g[_];this._visible_coords[A.key]=A}this.updateTileStates(h)}},{key:"updateTileStates",value:function(l){var h=0<arguments.length&&void 0!==l&&l;for(var g in this._all_visible_tiles_are_cached=!0,this._visible_coords)this._keepCoordinate(g,h);this._all_visible_tiles_are_cached&&(this._is_labeled=!1,this._debouncedUpdateLabels()),this._tile_cache.removeAll(this._removeCachedTilesFilter),this._updateProxyTiles(),this.removeTiles(this._removeTilesFilter),this._updateRenderableTiles(),this._updateActiveStyles()}},{key:"_removeTilesFilter",value:function(l){if(l.style_zoom===this._view.lookAtManipulator.getLookAtData().tile_level){if(this._visible_coords[l.coords.key])return!1;for(var h in this._visible_coords)if(n1.isDescendant(l.coords,this._visible_coords[h]))return!1}return!l.isProxy()}},{key:"_updateLabels",value:function(){var h=this;this._building_tiles&&0!==Object.keys(this._building_tiles).length||(Xx.pruneTextCache(),function(s,l,h,g,_,A){F4=RM,RM={};var j={},$={},_t=[],Ye=h.worldToScreen.bind(h),_i=new $P(A);for(var _s in s.forEach(function(ka){for(var ty in ka.meshes)ka.meshes[ty].forEach(function(ny){if(ny.labels){for(var ry in _i.trackMesh(ny),ny.labels["non-collision"]){var ly=j4(ny.labels["non-collision"][ry],ny,Ye,l,ka);ly.label.text_data&&_i.insertLabel(ly,ka)}for(var ey in ny.labels.collision){var hy;j[ey]||(hy=j4(ny.labels.collision[ey],ny,Ye,l,ka),j[ey]=hy.label,$[ey]=hy)}}})}),$){var Ja=$[_s];Ja.linked&&(Ja.linked=$[Ja.linked]),_t.push(Ja)}var _l=h.getViewport();return zx.startTile("main",{apply_repeat_groups:!0,return_hidden:!0,grid_index:new pN(_l.width,_l.height,30)}),zx.addStyle("main","main"),zx.collide(_t,"main","main").then(function(ka){return ka.forEach(function(ty){var ny,ry,ly,ey,hy,fy,_y=ty.mesh,Iy=ty.label.getTile();_y.valid&&(!(ny=0)!==ty.show||g&&ty.label.breach&&!F4[ty.label.id]||(ny=1),ny&&(RM[ty.label.id]=!0),ty.label.text_data&&_i.insertLabel(ty,Iy),ry=_y.vertex_layout.offset.a_shape,ly=_y.vertex_layout.stride,hy=(ey=_y.vertex_layout.attribs.find(function(Sy){return"a_shape"===Sy.name})).byte_size/ey.size,ry+=3*hy,fy=!0,ty.ranges.forEach(function(Sy){if(fy){for(var Dy=0;Dy<Sy[1];Dy++){if(_y.vertex_data[Sy[0]+Dy*ly+ry]===ny)return void(fy=!1);_y.vertex_data[Sy[0]+Dy*ly+ry]=ny}_i.trackMesh(_y)}}))}),_i.createTextures(_).then(function(){return _i.updateMeshes()})}).then(function(ka){ka.forEach(function(ty){return ty.valid&&ty.upload()}),s.forEach(function(ty){ty.labeled=!0}),_t=[],$={},j={}})}(this._renderable_tiles.sort(V4),function(g,_){var A=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,j=Math.pow(10,A);return Math.round(Math.floor(g*_)/_*j)/j}(this._view.lookAtManipulator.getLookAtData().zoom,2),this._view.lookAtManipulator,this.isLoadingVisibleTiles(),this._scene.gl,this._scene.id).then(function(){h._is_labeled=!w1.hasPendingTasks(),h._scene.immediateRedraw(),h._update_labels_on_queue_check=!1}))}},{key:"_updateProxyTiles",value:function(){var l,h=this,g=this._view.lookAtManipulator.getZoomDirection();0!==g&&(l=!1,this.forEachVisibleTile(function(_){var A;if(_.setProxyFor(null),1===g)_.built||(A=h._pyramid.getAncestor(_))&&(A.setProxyFor(_),l=!0);else if(-1===g&&!_.built)for(var j=h._pyramid.getDescendants(_),$=0;$<j.length;$++)j[$].setProxyFor(_),l=!0}),l||this._view.lookAtManipulator.resetZoomDirection())}},{key:"getRenderableTiles",value:function(){return this._renderable_tiles}},{key:"_updateRenderableTiles",value:function(){for(var l in this._renderable_tiles=[],this._visible_tiles){var h=this._visible_tiles[l],g=this._tile_cache.get(l);h.loaded?(this._renderable_tiles.push(h),g&&g!==h&&this._tile_cache.drop(l)):g&&(g.generation===this._scene.generation?this._renderable_tiles.push(g):this._tile_cache.drop(l))}return this._renderable_tiles}},{key:"getWorkerForTile",value:function(l,h){return h.has_volatile_data?this._scene.getWorkers(1)[0]:h.tiled?this._scene.getWorkers(0)[Math.abs(l.x+l.y+l.z)%this._scene.num_workers]:this._scene.getWorkers(0)[h.id%this._scene.num_workers]}},{key:"getActiveStyles",value:function(){return this._active_styles}},{key:"_updateActiveStyles",value:function(){for(var l=this._renderable_tiles,h={},g=0;g<l.length;g++)Object.keys(l[g].meshes).forEach(function(A){return h[A]=!0});return this._active_styles=Object.keys(h),this._active_styles}},{key:"isLoadingVisibleTiles",value:function(){var l=!1;for(var h in this._visible_tiles)if(!this._visible_tiles[h].built){l=!0;break}return l}},{key:"updateTilesVisibilityCounters",value:function(){var l=this;Object.keys(this._visible_coords).forEach(function(_){_ in l._tile_visibility_counters||(l._tile_visibility_counters[_]=0)});var h=Object.keys(this._tile_visibility_counters),g=[];h.forEach(function(_){_ in l._visible_coords?(l._tile_visibility_counters[_]++,30<=l._tile_visibility_counters[_]&&g.push(l._visible_coords[_])):(l._tile_visibility_counters[_]--,l._tile_visibility_counters[_]<=0&&delete l._tile_visibility_counters[_])}),g.length&&this.loadCoordinates(g)}},{key:"loadCoordinates",value:function(l){var h=this;l.sort(function(g,_){var A=h._view.lookAtManipulator.getLookAtData().position,j=My.metersPerTile(g.z)/2,$=My.metersForTile(g);$.x+=j,$.y-=j;var _t=My.metersForTile(_);_t.x+=j,_t.y-=j;var Ye=Math.abs(A[0]-$.x)+Math.abs(A[1]-$.y),_i=Math.abs(A[0]-_t.x)+Math.abs(A[1]-_t.y);return(g.center_dist=Ye)<(_.center_dist=_i)?-1:_i===Ye?0:1}),l.forEach(function(g){return h.loadCoordinate(g)})}},{key:"_keepCoordinate",value:function(l,h){var g=1<arguments.length&&void 0!==h&&h,_=this._visible_coords[l];if(_.z===this._view.center_tile.z)for(var A in this._scene.sources){var j,$,_t,Ye=this._scene.sources[A];Ye.builds_geometry_tiles&&Ye.includesTile(_,this._view.lookAtManipulator.getLookAtData().tile_level)&&(j=n1.normalizedKey(_,Ye,this._view.lookAtManipulator.getLookAtData().tile_level))&&!this.hasTile(j)&&(($=g&&this._tile_cache.get(j))||(this._all_visible_tiles_are_cached=!1),_t=$||new n1({source:Ye,coords:_,worker:this.getWorkerForTile(_,Ye),style_zoom:G0.zoomToTileLevel(_.z),view:this._view,sceneId:this._scene.id}),"ObjectSource"===Ye.config.type&&(_t.syncedAt=Ye.getSyncedAt()),this.keepTile(_t))}}},{key:"loadCoordinate",value:function(l){if(l.z===this._view.center_tile.z)for(var h in this._scene.sources){var g,_=this._scene.sources[h];_.builds_geometry_tiles&&_.includesTile(l,this._view.lookAtManipulator.getLookAtData().tile_level)&&(g=n1.normalizedKey(l,_,this._view.lookAtManipulator.getLookAtData().tile_level),this.hasTile(g)&&this.buildTile(this._visible_tiles[g]))}}},{key:"buildTile",value:function(l,h){this._building_tiles&&this._building_tiles[l.key]||l.built&&l.generation===this._scene.generation||(this._tileBuildStart(l.key),l.build(this._scene.generation,h))}},{key:"buildTileStylesCompleted",value:function(l){var h=l.tile,g=l.progress;if(null==this._visible_tiles[h.key])n1.abortBuild(h,this._scene.id);else if(h.generation!==this._scene.generation)n1.abortBuild(h,this._scene.id);else{if(h.id<this._visible_tiles[h.key].id)return void n1.abortBuild(h,this._scene.id);h=this._visible_tiles[h.key].merge(h),g.done&&(h.built=!0),h.buildMeshes(this._scene.styles,g),this.updateTileStates(),this._scene.requestRedraw()}g.done&&this._tileBuildStop(h)}},{key:"buildTileError",value:function(l){this._forgetTile(l.key),n1.abortBuild(l,this._scene.id)}},{key:"_tileBuildStart",value:function(l){this._is_labeled=!1,this._building_tiles=this._building_tiles||{},this._building_tiles[l]=!0}},{key:"_tileBuildStop",value:function(l){this._building_tiles&&(l.source&&l.source.hasLabeledData()&&(this._update_labels_on_queue_check=!0),delete this._building_tiles[l.key],w1.removeForTile(l.id),this.checkBuildQueue())}},{key:"isReady",value:function(){return this._is_labeled&&!this.isLoadingVisibleTiles()}},{key:"checkBuildQueue",value:function(){this._building_tiles&&0!==Object.keys(this._building_tiles).length||(this._building_tiles=null,this._update_labels_on_queue_check?this._updateLabels():(this._is_labeled=!w1.hasPendingTasks(),this._scene.immediateRedraw()))}},{key:"_removeCachedTilesFilter",value:function(l,h){var g=h.source;return!this._visible_tiles[l]&&(h.generation!==this._scene.generation||"ObjectSource"===g.config.type&&g.getSyncedAt()>h.syncedAt)}}]),s}();function V4(s,l){var h=s.coords,g=l.coords;return h.z-g.z||h.x-g.x||h.y-g.y}function NM(s){D0(this,NM),this.defaults={},this.defaults.culling=!0,this.defaults.culling_face=s.BACK,this.defaults.blending=!1,this.defaults.blending_src=s.ONE_MINUS_SRC_ALPHA,this.defaults.blending_dst=s.ONE_MINUS_SRC_ALPHA,this.defaults.blending_src_alpha=s.ONE,this.defaults.blending_dst_alpha=s.ONE_MINUS_SRC_ALPHA,this.defaults.depth_write=!0,this.defaults.depth_test=!0,s.depthFunc(s.LESS),this.culling=new QO({cull:this.defaults.culling,face:this.defaults.culling_face},function(l){l.cull?(s.enable(s.CULL_FACE),s.cullFace(l.face)):s.disable(s.CULL_FACE)}),this.blending=new QO({blend:this.defaults.blending,src:this.defaults.blending_src,dst:this.defaults.blending_dst,src_alpha:this.defaults.blending_src_alpha,dst_alpha:this.defaults.blending_dst_alpha},function(l){l.blend?(s.enable(s.BLEND),l.src_alpha&&l.dst_alpha?s.blendFuncSeparate(l.src,l.dst,l.src_alpha,l.dst_alpha):s.blendFunc(l.src,l.dst)):s.disable(s.BLEND)}),this.depth_write=new QO({depth_write:this.defaults.depth_write},function(l){s.depthMask(l.depth_write)}),this.depth_test=new QO({depth_test:this.defaults.depth_test},function(l){l.depth_test?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST)})}var QO=function(){function s(l,h){D0(this,s),h(l),this.value=l,this.setup=h}return T0(s,[{key:"get",value:function(){return this.value}},{key:"set",value:function(l){JSON.stringify(this.value)!==JSON.stringify(l)&&(this.setup(l),this.value=l)}}]),s}(),$V=function(){function s(){D0(this,s),this.canvas=null,this.gl=null,this.screenshot_canvas=null,this.screenshot_context=null,this.queue_screenshot=null,this.video_capture=null}return T0(s,[{key:"setCanvas",value:function(l,h){this.canvas=l,this.gl=h}},{key:"screenshot",value:function(l){var h=this,g=(0<arguments.length&&void 0!==l?l:{}).background;return null!=this.queue_screenshot||(this.queue_screenshot={background:g},this.queue_screenshot.promise=new Promise(function(_,A){h.queue_screenshot.resolve=_,h.queue_screenshot.reject=A})),this.queue_screenshot.promise}},{key:"completeScreenshot",value:function(){if(null!=this.queue_screenshot){var l=this.canvas.width,h=this.canvas.height,g=new Uint8Array(l*h*4);this.gl.readPixels(0,0,l,h,this.gl.RGBA,this.gl.UNSIGNED_BYTE,g);for(var _=(_=this.queue_screenshot.background)&&"transparent"!==_?by.parseColor(_).slice(0,3).map(function(ry){return 255*ry}):null,A=new Uint8ClampedArray(l*h*4),j=0;j<h;j++)for(var $=0;$<l;$++){var _t=4*((h-j-1)*l+$),Ye=4*(j*l+$),_i=g[3+_t];A[0+Ye]=255*g[0+_t]/_i,A[1+Ye]=255*g[1+_t]/_i,A[2+Ye]=255*g[2+_t]/_i,A[3+Ye]=_i,_&&(A[0+Ye]=A[0+Ye]*(_i/=255)+_[0]*(1-_i),A[1+Ye]=A[1+Ye]*_i+_[1]*(1-_i),A[2+Ye]=A[2+Ye]*_i+_[2]*(1-_i),A[3+Ye]=255)}this.screenshot_canvas=this.screenshot_canvas||document.createElement("canvas");var _s=this.screenshot_canvas;_s.width=l,_s.height=h,this.screenshot_context=this.screenshot_context||_s.getContext("2d");var Ja=this.screenshot_context,_l=new ImageData(A,l,h);Ja.putImageData(_l,0,0);for(var lc=_s.toDataURL("image/png"),_p=atob(lc.slice(22)),ka=new Uint8Array(_p.length),ty=0;ty<_p.length;++ty)ka[ty]=_p.charCodeAt(ty);var ny=new Blob([ka],{type:"image/png"});this.queue_screenshot.resolve({url:lc,blob:ny,type:"png"}),this.queue_screenshot=null}}},{key:"startVideoCapture",value:function(){var l=this;if("function"!=typeof window.MediaRecorder||!this.canvas||"function"!=typeof this.canvas.captureStream)return $y("warn","Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser"),!1;if(this.video_capture)return $y("warn","Video capture already in progress, call Scene.stopVideoCapture() first"),!1;try{var h=this.video_capture={};h.chunks=[],h.stream=this.canvas.captureStream(),h.options={mimeType:"video/webm"},h.media_recorder=new MediaRecorder(h.stream,h.options),h.media_recorder.ondataavailable=function(g){var _,A;0<g.data.size&&h.chunks.push(g.data),h.resolve&&(A=TI(_=new Blob(h.chunks,{type:h.options.mimeType})),h.stream&&(h.stream.getTracks()||[]).forEach(function(j){j.stop(),h.stream.removeTrack(j)}),h.stream=null,h.media_recorder=null,l.video_capture=null,h.resolve({url:A,blob:_,type:"webm"}))},h.media_recorder.start()}catch(g){return this.video_capture=null,$y("error","Scene video capture failed",g),!1}return!0}},{key:"stopVideoCapture",value:function(){var l=this;return this.video_capture?(this.video_capture.promise=new Promise(function(h,g){l.video_capture.resolve=h,l.video_capture.reject=g}),this.video_capture.media_recorder.stop(),this.video_capture.promise):($y("warn","No scene video capture in progress, call Scene.startVideoCapture() first"),Promise.resolve({}))}}]),s}(),KP=function(){function s(){D0(this,s),this.sources={},this.styles={},this.layers={},this.tiles={},this._isConfigured=!1}return T0(s,[{key:"init",value:function(l,h,g,_,A,j,$){return this.setMeshVariantMaxLife($),this.scene_id=l,this.textureManager=ZE(l),this._worker_id=h,$y.setLevel(g),G0.device_pixel_ratio=_,iO.setElementIndexUint(A),wx.setPrefix(this._worker_id),this._style_manager=new xP,this._importExternalScripts(j),lM.id_prefix=h,this._isConfigured=!1,h}},{key:"dispose",value:function(){this._last_config_sources=null,this._config_sources=null,this.sources=null,this._style_manager=null,this.styles=null,this.layers=null,this.tiles=null}},{key:"_importExternalScripts",value:function(l){var h;0!==l.length&&($y("debug","loading custom data source scripts in worker:",l),h=Object.getOwnPropertyNames(window),importScripts.apply(void 0,A_(l)),Object.getOwnPropertyNames(window).forEach(function(g){-1===h.indexOf(g)&&(self[g]=window[g])}))}},{key:"updateConfig",value:function(l,h){var j=l.config,_=l.generation,A=l.introspection;for(var $ in j=JSON.parse(j),Object.assign(GN,h),this._generation=_,this._isConfigured=!1,j.layers)j.layers[$]&&(j.layers[$].data=G0.stringsToFunctions(j.layers[$].data));this.global=G0.stringsToFunctions(j.global),this._createDataSources(j),j.styles=G0.stringsToFunctions(j.styles,by.wrapFunction),this.styles=this._style_manager.build(j.styles),self.is_fake_worker=V_.is_main,this._style_manager.initStyles({generation:this._generation,styles:this.styles,sources:this.sources,introspection:A,id:this.scene_id}),delete self.is_fake_worker,this.layers=function(_t,Ye){fx={};var _i={};for(var _s in _t){var Ja=_t[_s];Ja&&(_i[_s]=OM(_s,Ja,null,Ye))}return _i}(j.layers,this._style_manager.styles),this._configuring=this._syncTextures(j.textures)}},{key:"setMeshVariantMaxLife",value:function(l){this.meshVariantMaxLife=l}},{key:"_createDataSources",value:function(l){var h=this;this._last_config_sources=this._config_sources||{},this._config_sources=l.sources;var g=this.sources,_=[];for(var A in l.sources=G0.stringsToFunctions(l.sources),this.sources={},self.is_fake_worker=V_.is_main,l.sources)if(JSON.stringify(this._last_config_sources[A])!==JSON.stringify(l.sources[A])){var j=void 0;try{j=ax.create(Object.assign({},l.sources[A],{name:A}),this.sources)}catch($){$y("error","Error creating source.",$.message,l.sources[A]);continue}j&&(this.sources[A]=j,_.push(A))}else this.sources[A]=g[A];delete self.is_fake_worker,_.forEach(function($){for(var _t in h.tiles)h.tiles[_t].source===$&&delete h.tiles[_t]})}},{key:"awaitConfiguration",value:function(){return this._configuring}},{key:"_onConfig",value:function(l){var h=this;if((this._isConfigured=!0)!==l.loaded)l.loading=!0,l.loaded=!1,l.error=null,this._loadTileSourceData(l).then(function(){if(h.getTile(l.id)){l.loading=!1,l.loaded=!0;try{n1.buildGeometry(l,h)}catch(g){l.error=g.toString(),_0.postMessage("TileManager_".concat(h.scene_id,".buildTileError"),n1.slice(l))}}else $y("trace","stop tile build after data source load because tile was removed. Key: ".concat(l.key,", id: ").concat(l.id))},function(g){l.loading=!1,l.loaded=!1,l.error=g.stack,$y("error","tile load error for tile with key ".concat(l.key," and id ").concat(l.id,": ").concat(l.error)),_0.postMessage("TileManager_".concat(h.scene_id,".buildTileError"),n1.slice(l))});else{$y("trace","used worker cache for tile with key ".concat(l.key," and id ").concat(l.id));try{n1.buildGeometry(l,this)}catch(g){l.error=g.toString(),_0.postMessage("TileManager_".concat(this.scene_id,".buildTileError"),n1.slice(l))}}}},{key:"buildTile",value:function(l){var h,g=l.tile,_=this.getTile(g.id);_&&_.loading||(g=this.tiles[g.id]=Object.assign(_||{},g),this._isConfigured?this._onConfig(g):(h=this).awaitConfiguration().then(function(){return h._onConfig(g)}))}},{key:"_loadTileSourceData",value:function(l){return this.sources[l.source]?this.sources[l.source].load(l):(l.source_data={},Promise.resolve(l))}},{key:"getTile",value:function(l){return this.tiles[l]}},{key:"removeTile",value:function(l){var h=this.tiles[l];null!=h&&(!0===h.loading&&($y("trace","cancel tile load for tile id ".concat(l)),h.loading=!1,n1.cancel(h)),delete this.tiles[l],$y("trace","remove tile from cache, tile id: ".concat(l)))}},{key:"queryFeatures",value:function(l){var h=this,g=l.filter,_=l.visible,A=l.geometry,$=[],_t=l.tile_ids.map(function(Ye){return h.tiles[Ye]}).filter(function(Ye){return Ye});return null!=g&&(g=-1<["{","["].indexOf(g[0])?JSON.parse(g):g,g=G0.stringsToFunctions(g,by.wrapFunction)),g=CM(g,IM),_t.forEach(function(Ye){for(var _i in Ye.source_data.layers)!function(_s){Ye.source_data.layers[_s].features.forEach(function(Ja){var _l,lc;!0===_&&Ja.generation!==h._generation||!1===_&&Ja.generation===h._generation||((_l=by.getFeatureParseContext(Ja,Ye,h.global)).source=Ye.source,_l.layer=_s,g(_l)&&(lc={type:Ja.type,properties:Ja.properties},!0===A&&(lc.geometry=My.copyGeometry(Ja.geometry),My.tileSpaceToLatlng(lc.geometry,Ye.coords.z,Ye.min)),$.push(lc)))})}(_i)}),$}},{key:"resetFeatureSelection",value:function(){wx.reset()}},{key:"_syncTextures",value:function(l){var h=[];return l&&h.push.apply(h,A_(Object.keys(l))),$y("trace","sync textures to worker:",h),0<h.length?this.textureManager.syncTexturesToWorker(h):Promise.resolve()}},{key:"profile",value:function(l){console.profile("worker ".concat(this._worker_id,": ").concat(l))}},{key:"profileEnd",value:function(l){console.profileEnd("worker ".concat(this._worker_id,": ").concat(l))}},{key:"terminate",value:function(){this.dispose()}}]),s}();(V_.is_worker||self.H&&self.H.DEBUG)&&_0.addTarget("self",new KP);var ZP=function(){function s(l,h){D0(this,s),h=h||{},FA(this),this.id=s.id++,this.textureManager=ZE(this.id),this.initialized=!1,this.initializing=null,this.sources={},this.view=new s4(this,h),this.tile_manager=new YP({scene:this,view:this.view}),this.num_workers=h.numWorkers||2,!0===h.disableVertexArrayObjects&&(VA.disabled=!0),G0.device_pixel_ratio=h.devicePixelRatio,this.config=null,this.config_source=l,this.config_bundle=null,this.last_valid_config_source=null,this.styles=null,this.style_manager=new xP,this.building=null,this.dirty=!0,h.preUpdate&&this.subscribe({pre_update:h.preUpdate}),h.postUpdate&&this.subscribe({post_update:h.postUpdate}),this.render_loop=!h.disableRenderLoop,this.render_loop_active=!1,this.render_loop_stop=!1,this.render_count=0,this.last_render_count=0,this.render_count_changed=!1,this.frame=0,this.last_main_render=-1,this.last_selection_render=-1,this.media_capture=new $V,this.selection=null,this.introspection=!0===h.introspection,this.viewport=h.viewport,this.adjustMeshVariantMaxLife(),this.container=h.container,this.canvas=null,this.contextOptions=h.webGLContextOptions,this.lights=null,this.background=null,this.createListeners(),this.updating=0,this.generation=s.generation,this.last_complete_generation=s.generation,this.log_level=h.logLevel||"warn",$y.setLevel(this.log_level),$y.reset()}return T0(s,[{key:"load",value:function(l,h){var g=this,_=0<arguments.length&&void 0!==l?l:null,A=1<arguments.length&&void 0!==h?h:{};return this.initializing||($y.reset(),this.updating++,this.initialized=!1,this.initial_build_time=null,(A="string"==typeof A?{base_path:A}:A).blocking=void 0===A.blocking||A.blocking,!1!==this.render_loop&&this.setupRenderLoop(),this.createCanvas(),this.textureManager.destroy(this.gl),this.initializing=this.loadScene(_,A).then(function(){return g.createWorkers()}).then(function(){g.resetFeatureSelection();var j="object"===T_(g.config_source)||g.hasSubscribersFor("load"),$=g.updateConfig({serialize_funcs:j,normalize:!1,load_event:!0,fade_in:!0});if(!0===A.blocking)return $}).then(function(){g.updating--,g.initializing=null,g.initialized=!0,g.last_valid_config_source=g.config_source,g.last_valid_options={base_path:A.base_path,file_type:A.file_type},g.requestRedraw()}).catch(function(j){var $,_t;if(g.initializing=null,g.updating=0,_t="YAMLException"===j.name?($="yaml","Error parsing scene YAML"):"Error initializing scene",g.trigger("error",{type:$,message:_t,error:j,url:g.config_source}),_t="Scene.load() failed to load ".concat(g.config_source,": ").concat(j.message),g.last_valid_config_source)return $y("warn",_t,j),$y("info","Scene.load() reverting to last valid configuration"),g.load(g.last_valid_config_source,g.last_valid_base_path);throw $y("error",_t,j),j})),this.initializing}},{key:"destroy",value:function(){var l;this.initialized=!1,this.render_loop_stop=!0,this.destroyListeners(),this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.container=null,this.selection&&this.selection.destroy(),this.gl&&(this.textureManager.destroy(this.gl),this.style_manager.destroy(this.gl),this.styles={},b0.reset(),(l=this.gl.getExtension("WEBGL_lose_context"))&&l.loseContext(),this.gl=null),this.sources={},this.tile_manager.destroy(),this.tile_manager=null,this.destroyWorkers(),$y.reset()}},{key:"createCanvas",value:function(){if(!this.canvas){this.container=this.container||document.body,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top=0,this.canvas.style.left=0,this.container.style.backgroundColor="transparent",this.container.appendChild(this.canvas);try{this.gl=qN.getContext(this.canvas,Object.assign({alpha:!0,premultipliedAlpha:!1,stencil:!0,device_pixel_ratio:G0.device_pixel_ratio},this.contextOptions)),navigator.appVersion.includes("iPhone")&&this.gl.depthRange(.994,1)}catch{throw new Error("Couldn't create WebGL context. Your browser may not support WebGL, or it's turned off? Visit http://webglreport.com/ for more info.")}this.handleViewportUpdate(),VA.init(this.gl),this.render_states=new NM(this.gl),this.media_capture.setCanvas(this.canvas,this.gl)}}},{key:"getWorkerUrl",value:function(){var l,h;if(void 0!==o&&(h="("+o+")()",m&&""!==f&&(h+="\n//# sourceMappingURL="+m.slice(0,m.lastIndexOf("/")+1)+f),l=TI(new Blob([h],{type:"application/javascript"}))),!l)throw new Error("Couldn't find internal Tangram source variable (may indicate the library did not build correctly)");return l}},{key:"updateExternalScripts",value:function(){var l=A_(this.external_scripts||[]),h=[];if(this.config.scene.scripts)for(var g in this.config.scene.scripts)-1===h.indexOf(this.config.scene.scripts[g])&&h.push(this.config.scene.scripts[g]);for(var _ in this.config.sources){var A=this.config.sources[_];if(A.scripts)for(var j in A.scripts)-1===h.indexOf(A.scripts[j])&&h.push(A.scripts[j])}return this.external_scripts=h,!(this.external_scripts.length===l.length&&this.external_scripts.every(function($,_t){return $===l[_t]}))}},{key:"createWorkers",value:function(){return this.updateExternalScripts()&&this.destroyWorkers(),this._workers?Promise.resolve():this.makeWorkers(this.getWorkerUrl())}},{key:"makeWorkers",value:function(l){var h=this,g=!!this.gl.getExtension("OES_element_index_uint"),_=[];this._workers=[];for(var A=0;A<this.num_workers;A++)!function(){var $=new Worker(l);h._workers[A]=$,_0.addWorker($),$y("debug","Scene.makeWorkers: initializing worker ".concat(A));var _t=A;_.push(_0.postMessage($,"self.init",h.id,A,h.log_level,G0.device_pixel_ratio,g,h.external_scripts,h.meshVariantMaxLife).then(function(Ye){return $y("debug","Scene.makeWorkers: initialized worker ".concat(Ye)),Ye},function(Ye){return $y("error","Scene.makeWorkers: failed to initialize worker ".concat(_t,":"),Ye),Promise.reject(Ye)}))}();var j=new KP;return this._workers.push(j),_.push(j.init(this.id,A,this.log_level,G0.device_pixel_ratio,g,[],this.meshVariantMaxLife)),this.next_worker=0,Promise.all(_).then(function(){var $;$y.setWorkers(h._workers.slice(0,h.num_workers)),$=l,void 0===zC&&"function"!=typeof(zC=window.URL&&window.URL.revokeObjectURL||window.webkitURL&&window.webkitURL.revokeObjectURL)&&(zC=null,$y("warn","window.URL.revokeObjectURL (or vendor prefix) not found, unable to create local blob URLs")),zC&&zC($)})}},{key:"getWorkers",value:function(l){return this._workers.filter(function(h){switch(l){case 0:return h instanceof Worker;case 1:return h instanceof KP;default:return!0}})}},{key:"destroyWorkers",value:function(){this.selection=null,Array.isArray(this._workers)&&($y.setWorkers(null),this._workers.forEach(function(l){l.terminate()}),this._workers=null)}},{key:"ready",value:function(){return!(!this.view.ready()||0===Object.keys(this.sources).length)}},{key:"handleViewportUpdate",value:function(){var l=this.viewport,h=l.width,g=l.height;0<h&&0<g&&(this.dirty=!0,this.view.handleViewportUpdate(),this.gl&&qN.resize(this.gl,h,g,G0.device_pixel_ratio)),this.adjustMeshVariantMaxLife()&&this.syncMeshVariantMaxLife()}},{key:"adjustMeshVariantMaxLife",value:function(){var l=this.viewport,_=G0.device_pixel_ratio,j=Math.max(Math.ceil(l.width/_/256*(l.height/_/256)*2),8);if(this.meshVariantMaxLife!==j)return this.meshVariantMaxLife=j,!0}},{key:"syncMeshVariantMaxLife",value:function(){this._workers&&_0.postMessage(this._workers,"self.setMeshVariantMaxLife",this.meshVariantMaxLife)}},{key:"requestRedraw",value:function(){this.dirty=!0}},{key:"immediateRedraw",value:function(){this.dirty=!0,this.update()}},{key:"renderLoop",value:function(){this.render_loop_active=!0,this.initialized&&this.update(),w1.setState({user_moving_view:this.view.user_input_active}),w1.processAll(),this.render_loop_stop?(this.render_loop_stop=!1,this.render_loop_active=!1):window.requestAnimationFrame(this.renderLoop.bind(this))}},{key:"setupRenderLoop",value:function(){var l=this;this.render_loop_active||setTimeout(function(){l.renderLoop()},0)}},{key:"update",value:function(){var l=this.dirty,h=!!this.selection&&this.selection.hasPendingRequests(),g=!(!1===l&&!1===h||!1===this.initialized||0<this.updating||!1===this.ready());return this.trigger("pre_update",g),this.view.update(),g&&(this.dirty=!1,this.render({main:l,selection:h}),this.updateViewComplete(),this.media_capture.completeScreenshot(),this.trigger("post_update",g),!0!==this.animated&&!this.view.isAnimating()||(this.dirty=!0),this.frame++,$y("trace","Scene.render()"),!0)}},{key:"render",value:function(l){var h=this,g=l.main,_=l.selection,A=this.gl;if(Object.keys(this.lights).forEach(function(j){return h.lights[j].update()}),g&&(this.render_count=this.renderPass(),this.last_main_render=this.frame),_){if(this.view.panning||this.view.user_input_active)return void this.selection.clearPendingRequests();(this.last_selection_render<this.last_main_render||this.selection.has_dirty_buffer)&&(this.selection.bind(),this.renderPass("selection_program",{allow_blend:!1}),A.bindFramebuffer(A.FRAMEBUFFER,null),A.viewport(0,0,this.canvas.width,this.canvas.height),A.clearColor.apply(A,A_(this.background.color)),this.last_selection_render=this.frame,this.selection.has_dirty_buffer=!1),this.selection.read(this.tile_manager.getRenderableTiles()),this.selection.has_dirty_buffer&&this.render({main:!1,selection:_})}return this.render_count_changed=!1,this.render_count!==this.last_render_count&&(this.render_count_changed=!0),this.last_render_count=this.render_count,!0}},{key:"renderPass",value:function(l,h){var g=this,_=0<arguments.length&&void 0!==l?l:"program",A=this.gl,j=null==(j=(1<arguments.length&&void 0!==h?h:{}).allow_blend)||j;this.clearFrame();for(var $,_t=W_.sortByBlendOrderWithinLayers(this.tile_manager.getActiveStyles().map(function(ty){return g.styles[ty]}).filter(function(ty){return ty})),Ye=0,_i=0,_s=0;_s<_t.length;_s++){var Ja,_l,lc=_t[_s],_p=_i-(Ja=parseInt(lc.name));(lc.clean_depth||_p)&&(this.render_states.depth_write.value.depth_write?A.clear(A.DEPTH_BUFFER_BIT):(A.depthMask(!0),A.clear(A.DEPTH_BUFFER_BIT),A.depthMask(!1)),_p&&(_i=Ja)),lc.blend!==$&&(_l=Object.assign({},W_.render_states[lc.blend],{blend:j&&lc.blend}),this.setRenderState(_l));var ka="translucent"===lc.blend&&"program"===_;ka&&(this.gl.colorMask(!1,!1,!1,!1),this.renderStyle(lc.name,_),this.gl.colorMask(!0,!0,!0,!0),this.gl.depthFunc(this.gl.EQUAL),this.gl.enable(this.gl.STENCIL_TEST),this.gl.clear(this.gl.STENCIL_BUFFER_BIT),this.gl.stencilFunc(this.gl.EQUAL,this.gl.ZERO,255),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.INCR)),Ye+=this.renderStyle(lc.name,_),ka&&(this.gl.disable(this.gl.STENCIL_TEST),this.gl.depthFunc(this.gl.LESS)),$=lc.blend}return Ye}},{key:"renderStyle",value:function(l,h){for(var g,_=this,A=this.styles[l],j=!0,$=0,_t=this.tile_manager.getRenderableTiles(),Ye=Math.max.apply(Math,A_(_t.map(function(Ja){return Ja.meshes[l]?Math.max.apply(Math,A_(Ja.meshes[l].map(function(_l){return _l.variant.order}))):-1}))),_i=0;_i<Ye+1;_i++){var _s=function(Ja){for(var _l=0;_l<_t.length;_l++){var lc=_t[_l];if(null!=lc.meshes[l]&&lc.shouldProxyForStyle(l))for(var _p=lc.meshes[l].filter(function(ry){return ry.variant.order===Ja}),ka=0,ty=_p.length;ka<ty;ka+=1){var ny=_p[ka];if(!0===j&&(j=!1,!(g=_.setupStyle(A,h))))return{v:0};_.view.setupTile(lc,g),_.selection.setupDiscards(g),A.render(ny)&&_.requestRedraw(),$+=ny.geometry_count}}}(_i);if("object"===T_(_s))return _s.v}return $}},{key:"setupStyle",value:function(l,h){var g;try{if(!(g=l.getProgram(h)))return}catch{return void this.trigger("warning",{type:"styles",message:"Error compiling style ".concat(l.name),style:l,shader_errors:l.program&&l.program.shader_errors})}for(var _ in g.use(),l.setup(),this.view.setupProgram(g),this.lights)this.lights[_].setupProgram(g);return g}},{key:"clearFrame",value:function(){this.initialized&&(this.render_states.depth_write.set({depth_write:!0}),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT))}},{key:"setRenderState",value:function(l){var h,g,_=0<arguments.length&&void 0!==l?l:{},A=_.depth_test,j=_.depth_write,$=_.cull_face,_t=_.blend;this.initialized&&(h=this.render_states,j=!1!==j&&h.defaults.depth_write,$=!1!==$&&h.defaults.culling,_t=_t??h.defaults.blending,g=this.gl,h.depth_test.set({depth_test:A=!1!==A&&h.defaults.depth_test}),h.depth_write.set({depth_write:j}),h.culling.set({cull:$,face:h.defaults.culling_face}),_t&&"opaque"!==_t?"overlay"===_t||"inlay"===_t||"translucent"===_t?h.blending.set({blend:!0,src:g.SRC_ALPHA,dst:g.ONE_MINUS_SRC_ALPHA,src_alpha:g.ONE,dst_alpha:g.ONE_MINUS_SRC_ALPHA}):"add"===_t?h.blending.set({blend:!0,src:g.ONE,dst:g.ONE}):"multiply"===_t&&h.blending.set({blend:!0,src:g.ZERO,dst:g.SRC_COLOR}):h.blending.set({blend:!1}))}},{key:"getFeatureAt",value:function(l,h,g){var A=h.radius;this.initialized?this.selection.getFeatureAt({x:l.x/this.view.size.css.width,y:l.y/this.view.size.css.height},{radius:A=0<A?{x:A/this.view.size.css.width,y:A/this.view.size.css.height}:null,top_most_only:h.top_most_only},g):$y("debug","Scene.getFeatureAt() called before scene was initialized")}},{key:"queryFeatures",value:function(l){var h=0<arguments.length&&void 0!==l?l:{},g=h.unique,_=void 0===g||g,A=h.group_by,j=void 0===A?null:A,$=h.visible,_t=void 0===$?null:$,Ye=h.geometry,_i=void 0!==Ye&&Ye,_s=G0.serializeWithFunctions(_s=h.filter),Ja=this.tile_manager.getRenderableTiles().map(function(_l){return _l.id});return _0.postMessage(this._workers,"self.queryFeatures",{filter:_s,visible:_t,geometry:_i,tile_ids:Ja}).then(function(_l){var lc=[],_p={},ka={},ty=(_="string"==typeof _?[_]:_)&&function(ry){return JSON.stringify(Array.isArray(_)?nO(ry,_):ry)},ny=(j=("string"==typeof j||Array.isArray(j))&&j)&&function(ry){return Array.isArray(j)?JSON.stringify(nO(ry,j)):ry[j]};return _l.forEach(function(ry){return ry.forEach(function(ly){if(ty){var ey=ty(ly);if(_p[ey])return;_p[ey]=!0}var hy;ny?(hy=ny(ly.properties),ka[hy]=ka[hy]||[],ka[hy].push(ly)):lc.push(ly)})}),ny?ka:lc})}},{key:"loadScene",value:function(l,h){var g=this,_=0<arguments.length&&void 0!==l?l:null,A=1<arguments.length&&void 0!==h?h:{},j=A.base_path,$=A.file_type;return this.config_source=_||this.config_source,this.base_path=BC("string"==typeof this.config_source?j||this.config_source:j),this.config_path=this.base_path,dA.loadScene(this.config_source,{path:this.base_path,type:$}).then(function(_t){var _i=_t.bundle;return g.config=_t.config,g.config_bundle=_i,g.config})}},{key:"createDataSources",value:function(){var l=this,h=[],g=Object.keys(this.sources),_=0;for(var A in this.config.sources){var j=this.config.sources[A],$=this.sources[A];try{var _t=Object.assign({},j,{name:A,id:_++});if(this.sources[A]=ax.create(_t,this.sources),!this.sources[A])throw{}}catch(Ja){delete this.sources[A];var Ye="Could not create data source: ".concat(Ja.message);$y("warn","Scene: ".concat(Ye),j),this.trigger("warning",{type:"sources",source:j,message:Ye})}ax.sameConfig(this.sources[A],$)||h.push(A)}for(var _i in g.forEach(function(Ja){l.config.sources[Ja]||(delete l.sources[Ja],h.push(Ja))}),0<h.length&&this.tile_manager.removeTiles(function(Ja){return-1<h.indexOf(Ja.source.name)}),this.config.layers){var _s=this.config.layers[_i];!1!==_s.enabled&&_s.data&&this.sources[_s.data.source]&&(this.sources[_s.data.source].builds_geometry_tiles=!0)}}},{key:"loadTextures",value:function(){var l=this;return this.textureManager.createFromObject(this.gl,this.config.textures).then(function(){return l.textureManager.createDefault(l.gl)})}},{key:"updateStyles",value:function(){if(!this.initialized&&!this.initializing)throw new Error("Scene.updateStyles() called before scene was initialized");for(var l in this.styles=this.style_manager.build(this.config.styles),this.style_manager.initStyles(this),this.styles)this.styles[l].setGL(this.gl);this.dirty=!0}},{key:"createLights",value:function(){for(var l in this.lights={},this.config.lights){var h;this.config.lights[l]&&"object"===T_(this.config.lights[l])&&((h=this.config.lights[l]).name=l.replace("-","_"),h.visible=!1!==h.visible,h.visible&&(this.lights[h.name]=R1.create(this.view,h)))}R1.inject(this.lights)}},{key:"setBackground",value:function(){var l,h=this.config.scene.background;this.background={},h&&h.color&&(this.background.color=by.parseColor(h.color)),this.background.color||(this.background.color=[0,0,0,0]),this.canvas.style.backgroundColor=1===this.background.color[3]?"rgba(".concat(this.background.color.map(function(g){return Math.floor(255*g)}).join(", "),")"):"transparent",(l=this.gl).clearColor.apply(l,A_(this.background.color))}},{key:"setIntrospection",value:function(l){var h=this;return l!==this.introspection?(this.introspection=l||!1,this.updating++,this.updateConfig({normalize:!1}).then(function(){return h.updating--})):Promise.resolve()}},{key:"updateConfig",value:function(l){var h=0<arguments.length&&void 0!==l?l:{},g=h.load_event,_=void 0!==g&&g,A=h.serialize_funcs,j=h.normalize,$=void 0===j||j;this.generation=++s.generation,this.updating++,this.config=dA.applyGlobalProperties(this.config),$?dA.normalize(this.config,this.config_bundle):(dA.hoistStyleShaderUniformTextures(this.config,this.config_bundle,{include_globals:!0}),dA.normalizeTextures(this.config,this.config_bundle)),this.trigger(_?"load":"update",{config:this.config}),this.style_manager.init(),this.createLights(),this.createDataSources(),this.loadTextures(),this.setBackground(),X3.loadFonts(this.config.fonts),this.updateStyles();var _t=this.syncConfigToWorker({serialize_funcs:A});return this.updating--,this.view.updateBounds(),this.requestRedraw(),_t}},{key:"syncConfigToWorker",value:function(l){var h=(0<arguments.length&&void 0!==l?l:{}).serialize_funcs,g=void 0===h||h?G0.serializeWithFunctions(this.config):JSON.stringify(this.config);return _0.postMessage(this._workers,"self.updateConfig",{config:g,generation:this.generation,introspection:this.introspection},ZA)}},{key:"createListeners",value:function(){var l=this;this.listeners={},this.listeners.view={move:function(){return l.trigger("move")}},this.view.subscribe(this.listeners.view),this.listeners.texture={update:function(){return l.dirty=!0},warning:function(h){return l.trigger("warning",Object.assign({type:"textures"},h))}},this.textureManager.subscribe(this.listeners.texture),this.listeners.scene_loader={error:function(h){return l.trigger("error",Object.assign({type:"scene"},h))}},dA.subscribe(this.listeners.scene_loader)}},{key:"destroyListeners",value:function(){this.unsubscribeAll(),this.view.unsubscribe(this.listeners.view),this.textureManager.unsubscribe(this.listeners.texture),dA.unsubscribe(this.listeners.scene_loader),this.listeners=null}},{key:"resetFeatureSelection",value:function(){this.selection?this._workers&&_0.postMessage(this._workers,"self.resetFeatureSelection"):this.selection=new wx(this.gl,this.id)}},{key:"updateViewComplete",value:function(){(this.render_count_changed||this.generation!==this.last_complete_generation)&&this.tile_manager.isReady()&&(this.last_complete_generation=this.generation,this.trigger("view_complete"))}},{key:"resetViewComplete",value:function(){this.last_complete_generation=null}},{key:"screenshot",value:function(l){var h=(0<arguments.length&&void 0!==l?l:{}).background,g=void 0===h?"white":h;return this.requestRedraw(),this.media_capture.screenshot({background:g})}},{key:"pixelRatio",value:function(){return G0.device_pixel_ratio}},{key:"startVideoCapture",value:function(){return this.requestRedraw(),this.media_capture.startVideoCapture()}},{key:"stopVideoCapture",value:function(){return this.media_capture.stopVideoCapture()}},{key:"_profile",value:function(l){console.profile("main thread: ".concat(l)),_0.postMessage(this._workers,"self.profile",l)}},{key:"_profileEnd",value:function(l){console.profileEnd("main thread: ".concat(l)),_0.postMessage(this._workers,"self.profileEnd",l)}},{key:"getCameraMatrix",value:function(){return this.view.lookAtManipulator.getCameraMatrix()}},{key:"animated",get:function(){var l=this;return void 0!==this.config.scene.animated?this.config.scene.animated:this.tile_manager.getActiveStyles().some(function(h){return l.styles[h]&&l.styles[h].animated})}}],[{key:"create",value:function(l,h){return new s(l,1<arguments.length&&void 0!==h?h:{})}}]),s}();ZP.id=0,ZP.generation=0;var YV=function(){L_(l,YC);var s=B1(l);function l(h,g,_){var A=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};D0(this,l);var j=Math.pow(2,A.coords.z),$=Math.abs(Math.floor(A.coords.x/j)),_t=Math.abs(j*$-Math.abs(A.coords.x)),Ye=A.coords;return A.coords={x:_t,y:Ye.y,z:Ye.z},s.call(this,h,g,_,A)}return T0(l,[{key:"load",value:function(h){var g=this;if(!h||!h.uid)return kE(h1(l.prototype),"load",this).call(this,h);var _=h.coords,A=new Uint8Array([0,0,0,0]);return this.loading=new Promise(function(j,$){var _t=H.map.DataModel.invoke(h.uid,"requestTileAsPromise",[_.x,_.y,_.z])||null;_t?_t.then(function(Ye){var _i=Ye.data;g.loaded=!0,!_i||_i instanceof ArrayBuffer||"IMG"!==_i.tagName.toUpperCase()&&"CANVAS"!==_i.tagName.toUpperCase()?g.setData(1,1,A,{filtering:"nearest"}):g.setElement(_i,h)},function(){g.loaded=!1}).then(j,function(Ye){return $(Ye)}):$(new Error("Unable to invoke on target "+h.uid))}),this.loading}}]),l}();jA.register(YV,function(s){return s&&s.uid}),self.H=self.H||{},self.H.gl={DataSource:ax,Geo:My,MathUtils:j_,Scene:ZP,Task:w1,Tile:n1,WorkerBroker:_0,log:$y,SceneLoader:dA,yaml:k4}}()};e()}(),this.H=this.H||{},this.H.venues=function(e){function o(_d,ba){var Ni,ga;ba=(ba=void 0===ba?{}:ba).insertAt,_d&&typeof document<"u"&&(Ni=document.head||document.getElementsByTagName("head")[0],(ga=document.createElement("style")).type="text/css","top"===ba&&Ni.firstChild?Ni.insertBefore(ga,Ni.firstChild):Ni.appendChild(ga),ga.styleSheet?ga.styleSheet.cssText=_d:ga.appendChild(document.createTextNode(_d)))}function f(_d,_r){var Ni,ga=Object.keys(_d);return Object.getOwnPropertySymbols&&(Ni=Object.getOwnPropertySymbols(_d),_r&&(Ni=Ni.filter(function(ba){return Object.getOwnPropertyDescriptor(_d,ba).enumerable})),ga.push.apply(ga,Ni)),ga}function m(_d){for(var _r=1;_r<arguments.length;_r++){var Ni=null!=arguments[_r]?arguments[_r]:{};_r%2?f(Object(Ni),!0).forEach(function(ga){pd(_d,ga,Ni[ga])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_d,Object.getOwnPropertyDescriptors(Ni)):f(Object(Ni)).forEach(function(ga){Object.defineProperty(_d,ga,Object.getOwnPropertyDescriptor(Ni,ga))})}return _d}function w(){w=function(){return _d};var _d={},_r=Object.prototype,Ni=_r.hasOwnProperty,ga=(e0="function"==typeof Symbol?Symbol:{}).iterator||"@@iterator",ba=e0.asyncIterator||"@@asyncIterator",_h=e0.toStringTag||"@@toStringTag";function gg(Ly,Qy,n0){return Object.defineProperty(Ly,Qy,{value:n0,enumerable:!0,configurable:!0,writable:!0}),Ly[Qy]}try{gg({},"")}catch{gg=function(Qy,n0,Gy){return Qy[n0]=Gy}}function oy(Ly,u_,n0,__){var g0,N0,w0,E0;return u_=u_&&u_.prototype instanceof vy?u_:vy,u_=Object.create(u_.prototype),__=new By(__||[]),u_._invoke=(g0=Ly,N0=n0,w0=__,E0="suspendedStart",function(b_,U_){if("executing"===E0)throw new Error("Generator is already running");if("completed"===E0){if("throw"===b_)throw U_;return{value:void 0,done:!0}}for(w0.method=b_,w0.arg=U_;;){var V0=w0.delegate;if(V0&&(V0=function q0(a1,B0){var M1=a1.iterator[B0.method];if(void 0===M1){if(B0.delegate=null,"throw"===B0.method){if(a1.iterator.return&&(B0.method="return",B0.arg=void 0,q0(a1,B0),"throw"===B0.method))return cy;B0.method="throw",B0.arg=new TypeError("The iterator does not provide a 'throw' method")}return cy}return"throw"===(M1=uy(M1,a1.iterator,B0.arg)).type?(B0.method="throw",B0.arg=M1.arg,B0.delegate=null,cy):(M1=M1.arg)?M1.done?(B0[a1.resultName]=M1.value,B0.next=a1.nextLoc,"return"!==B0.method&&(B0.method="next",B0.arg=void 0),B0.delegate=null,cy):M1:(B0.method="throw",B0.arg=new TypeError("iterator result is not an object"),B0.delegate=null,cy)}(V0,w0))){if(V0===cy)continue;return V0}if("next"===w0.method)w0.sent=w0._sent=w0.arg;else if("throw"===w0.method){if("suspendedStart"===E0)throw E0="completed",w0.arg;w0.dispatchException(w0.arg)}else"return"===w0.method&&w0.abrupt("return",w0.arg);if(E0="executing","normal"===(V0=uy(g0,N0,w0)).type){if(E0=w0.done?"completed":"suspendedYield",V0.arg===cy)continue;return{value:V0.arg,done:w0.done}}"throw"===V0.type&&(E0="completed",w0.method="throw",w0.arg=V0.arg)}}),u_}function uy(Ly,Qy,n0){try{return{type:"normal",arg:Ly.call(Qy,n0)}}catch(Gy){return{type:"throw",arg:Gy}}}_d.wrap=oy;var cy={};function vy(){}function Ty(){}function Ay(){}var e0,s0,ky=(gg(e0={},ga,function(){return this}),(s0=(s0=Object.getPrototypeOf)&&s0(s0(qy([]))))&&s0!==_r&&Ni.call(s0,ga)&&(e0=s0),Ay.prototype=vy.prototype=Object.create(e0));function u0(Ly){["next","throw","return"].forEach(function(Qy){gg(Ly,Qy,function(n0){return this._invoke(Qy,n0)})})}function t0(Ly,Qy){var n0;this._invoke=function(Gy,g0){function N0(){return new Qy(function(w0,E0){!function u_(a1,b_,U_,V0){var q0;if("throw"!==(a1=uy(Ly[a1],Ly,b_)).type)return(b_=(q0=a1.arg).value)&&"object"==typeof b_&&Ni.call(b_,"__await")?Qy.resolve(b_.__await).then(function(B0){u_("next",B0,U_,V0)},function(B0){u_("throw",B0,U_,V0)}):Qy.resolve(b_).then(function(B0){q0.value=B0,U_(q0)},function(B0){return u_("throw",B0,U_,V0)});V0(a1.arg)}(Gy,g0,w0,E0)})}return n0=n0?n0.then(N0,N0):N0()}}function Fy(Ly){var Qy={tryLoc:Ly[0]};1 in Ly&&(Qy.catchLoc=Ly[1]),2 in Ly&&(Qy.finallyLoc=Ly[2],Qy.afterLoc=Ly[3]),this.tryEntries.push(Qy)}function jy(Ly){var Qy=Ly.completion||{};Qy.type="normal",delete Qy.arg,Ly.completion=Qy}function By(Ly){this.tryEntries=[{tryLoc:"root"}],Ly.forEach(Fy,this),this.reset(!0)}function qy(Ly){if(Ly){var Qy,n0=Ly[ga];if(n0)return n0.call(Ly);if("function"==typeof Ly.next)return Ly;if(!isNaN(Ly.length))return Qy=-1,(n0=function Gy(){for(;++Qy<Ly.length;)if(Ni.call(Ly,Qy))return Gy.value=Ly[Qy],Gy.done=!1,Gy;return Gy.value=void 0,Gy.done=!0,Gy}).next=n0}return{next:h0}}function h0(){return{value:void 0,done:!0}}return gg(ky,"constructor",Ty.prototype=Ay),gg(Ay,"constructor",Ty),Ty.displayName=gg(Ay,_h,"GeneratorFunction"),_d.isGeneratorFunction=function(Ly){return!!(Ly="function"==typeof Ly&&Ly.constructor)&&(Ly===Ty||"GeneratorFunction"===(Ly.displayName||Ly.name))},_d.mark=function(Ly){return Object.setPrototypeOf?Object.setPrototypeOf(Ly,Ay):(Ly.__proto__=Ay,gg(Ly,_h,"GeneratorFunction")),Ly.prototype=Object.create(ky),Ly},_d.awrap=function(Ly){return{__await:Ly}},u0(t0.prototype),gg(t0.prototype,ba,function(){return this}),_d.AsyncIterator=t0,_d.async=function(Ly,Qy,n0,Gy,g0){void 0===g0&&(g0=Promise);var N0=new t0(oy(Ly,Qy,n0,Gy),g0);return _d.isGeneratorFunction(Qy)?N0:N0.next().then(function(w0){return w0.done?w0.value:N0.next()})},u0(ky),gg(ky,_h,"Generator"),gg(ky,ga,function(){return this}),gg(ky,"toString",function(){return"[object Generator]"}),_d.keys=function(Ly){var Qy,n0=[];for(Qy in Ly)n0.push(Qy);return n0.reverse(),function Gy(){for(;n0.length;){var g0=n0.pop();if(g0 in Ly)return Gy.value=g0,Gy.done=!1,Gy}return Gy.done=!0,Gy}},_d.values=qy,By.prototype={constructor:By,reset:function(Ly){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(jy),!Ly)for(var Qy in this)"t"===Qy.charAt(0)&&Ni.call(this,Qy)&&!isNaN(+Qy.slice(1))&&(this[Qy]=void 0)},stop:function(){this.done=!0;var Ly=this.tryEntries[0].completion;if("throw"===Ly.type)throw Ly.arg;return this.rval},dispatchException:function(Ly){if(this.done)throw Ly;var Qy=this;function n0(u_,__){return N0.type="throw",N0.arg=Ly,Qy.next=u_,__&&(Qy.method="next",Qy.arg=void 0),!!__}for(var Gy=this.tryEntries.length-1;0<=Gy;--Gy){var g0=this.tryEntries[Gy],N0=g0.completion;if("root"===g0.tryLoc)return n0("end");if(g0.tryLoc<=this.prev){var w0=Ni.call(g0,"catchLoc"),E0=Ni.call(g0,"finallyLoc");if(w0&&E0){if(this.prev<g0.catchLoc)return n0(g0.catchLoc,!0);if(this.prev<g0.finallyLoc)return n0(g0.finallyLoc)}else if(w0){if(this.prev<g0.catchLoc)return n0(g0.catchLoc,!0)}else{if(!E0)throw new Error("try statement without catch or finally");if(this.prev<g0.finallyLoc)return n0(g0.finallyLoc)}}}},abrupt:function(Ly,Qy){for(var n0=this.tryEntries.length-1;0<=n0;--n0){var Gy=this.tryEntries[n0];if(Gy.tryLoc<=this.prev&&Ni.call(Gy,"finallyLoc")&&this.prev<Gy.finallyLoc){var g0=Gy;break}}var N0=(g0=g0&&("break"===Ly||"continue"===Ly)&&g0.tryLoc<=Qy&&Qy<=g0.finallyLoc?null:g0)?g0.completion:{};return N0.type=Ly,N0.arg=Qy,g0?(this.method="next",this.next=g0.finallyLoc,cy):this.complete(N0)},complete:function(Ly,Qy){if("throw"===Ly.type)throw Ly.arg;return"break"===Ly.type||"continue"===Ly.type?this.next=Ly.arg:"return"===Ly.type?(this.rval=this.arg=Ly.arg,this.method="return",this.next="end"):"normal"===Ly.type&&Qy&&(this.next=Qy),cy},finish:function(Ly){for(var Qy=this.tryEntries.length-1;0<=Qy;--Qy){var n0=this.tryEntries[Qy];if(n0.finallyLoc===Ly)return this.complete(n0.completion,n0.afterLoc),jy(n0),cy}},catch:function(Ly){for(var Qy=this.tryEntries.length-1;0<=Qy;--Qy){var n0,Gy,g0=this.tryEntries[Qy];if(g0.tryLoc===Ly)return"throw"===(n0=g0.completion).type&&(Gy=n0.arg,jy(g0)),Gy}throw new Error("illegal catch attempt")},delegateYield:function(Ly,Qy,n0){return this.delegate={iterator:qy(Ly),resultName:Qy,nextLoc:n0},"next"===this.method&&(this.arg=void 0),cy}},_d}function k(_d){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(_r){return typeof _r}:function(_r){return _r&&"function"==typeof Symbol&&_r.constructor===Symbol&&_r!==Symbol.prototype?"symbol":typeof _r})(_d)}function Y(_d,_r,Ni,ga,ba,_h,gg){try{var oy=_d[_h](gg),uy=oy.value}catch(cy){return void Ni(cy)}oy.done?_r(uy):Promise.resolve(uy).then(ga,ba)}function _e(_d,_r){if(!(_d instanceof _r))throw new TypeError("Cannot call a class as a function")}function _o(_d,_r){for(var Ni=0;Ni<_r.length;Ni++){var ga=_r[Ni];ga.enumerable=ga.enumerable||!1,ga.configurable=!0,"value"in ga&&(ga.writable=!0),Object.defineProperty(_d,ga.key,ga)}}function _u(_d,_r,Ni){return _r&&_o(_d.prototype,_r),Ni&&_o(_d,Ni),Object.defineProperty(_d,"prototype",{writable:!1}),_d}function pd(_d,_r,Ni){return _r in _d?Object.defineProperty(_d,_r,{value:Ni,enumerable:!0,configurable:!0,writable:!0}):_d[_r]=Ni,_d}function iy(_d,_r){if("function"!=typeof _r&&null!==_r)throw new TypeError("Super expression must either be null or a function");_d.prototype=Object.create(_r&&_r.prototype,{constructor:{value:_d,writable:!0,configurable:!0}}),Object.defineProperty(_d,"prototype",{writable:!1}),_r&&gy(_d,_r)}function sy(_d){return(sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_r){return _r.__proto__||Object.getPrototypeOf(_r)})(_d)}function gy(_d,_r){return(gy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Ni,ga){return Ni.__proto__=ga,Ni})(_d,_r)}function wy(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ey(_d,_r,Ni){return(Ey=wy()?Reflect.construct.bind():function(ga,ba,_h){var gg=[null];return gg.push.apply(gg,ba),ba=new(Function.bind.apply(ga,gg)),_h&&gy(ba,_h.prototype),ba}).apply(null,arguments)}function Jy(_d){if(void 0===_d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _d}function _m(_d){var _r=wy();return function(){var Ni,ga=sy(_d);if(Ni=_r?(Ni=sy(this).constructor,Reflect.construct(ga,arguments,Ni)):ga.apply(this,arguments),ga=this,Ni&&("object"==typeof Ni||"function"==typeof Ni))return Ni;if(void 0!==Ni)throw new TypeError("Derived constructors may only return object or undefined");return Jy(ga)}}function y0(){return(y0=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(_d,_r,Ni){var ga=function(ba,_h){for(;!Object.prototype.hasOwnProperty.call(ba,_h)&&null!==(ba=sy(ba)););return ba}(_d,_r);if(ga)return(ga=Object.getOwnPropertyDescriptor(ga,_r)).get?ga.get.call(arguments.length<3?_d:Ni):ga.value}).apply(this,arguments)}function Oy(_d,_r){return function(Ni){if(Array.isArray(Ni))return Ni}(_d)||function(Ni,ga){var ba=null==Ni?null:typeof Symbol<"u"&&Ni[Symbol.iterator]||Ni["@@iterator"];if(null!=ba){var _h,gg,oy=[],uy=!0,cy=!1;try{for(ba=ba.call(Ni);!(uy=(_h=ba.next()).done)&&(oy.push(_h.value),!ga||oy.length!==ga);uy=!0);}catch(vy){cy=!0,gg=vy}finally{try{uy||null==ba.return||ba.return()}finally{if(cy)throw gg}}return oy}}(_d,_r)||I0(_d,_r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K0(_d){return function(_r){if(Array.isArray(_r))return p1(_r)}(_d)||function(_r){if(typeof Symbol<"u"&&null!=_r[Symbol.iterator]||null!=_r["@@iterator"])return Array.from(_r)}(_d)||I0(_d)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I0(_d,_r){if(_d){if("string"==typeof _d)return p1(_d,_r);var Ni=Object.prototype.toString.call(_d).slice(8,-1);return"Map"===(Ni="Object"===Ni&&_d.constructor?_d.constructor.name:Ni)||"Set"===Ni?Array.from(_d):"Arguments"===Ni||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ni)?p1(_d,_r):void 0}}function p1(_d,_r){(null==_r||_r>_d.length)&&(_r=_d.length);for(var Ni=0,ga=new Array(_r);Ni<_r;Ni++)ga[Ni]=_d[Ni];return ga}o(".H_l_right .venues-ui__drawings .trigger.button--active .arrow {\n  transform: rotate(90deg);\n}\n.H_l_right .venues-ui__drawings .drawings {\n  right: 45px;\n  left: initial;\n}");var N_=function(){iy(_r,H.map.Feature);var _d=_m(_r);function _r(Ni){var ga;return _e(this,_r),(ga=_d.call(this)).id=Ni.id,ga.model=Ni,ga}return _u(_r,[{key:"getData",value:function(){return this.model}},{key:"getAddress",value:function(){return this.model.getInternalAddress()}},{key:"getCenter",value:function(){var Ni=(ga=Oy(this.model.getCenter(),2))[0],ga=ga[1];return new H.geo.Point(ga,Ni)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"toGeoJSON",value:function(){return this.model.toJSON()}},{key:"getLevel",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getLevel().getDrawing().getParentEventTarget()}}]),_r}(),q1=function(){iy(_r,H.map.Feature);var _d=_m(_r);function _r(Ni){var ga;return _e(this,_r),(ga=_d.call(this)).id=Ni.id,ga.model=Ni,ga}return _u(_r,[{key:"getData",value:function(){return this.model}},{key:"getBoundingBox",value:function(){return Ey(H.geo.Rect,K0(this.model.getBoundingBox()))}},{key:"getCenter",value:function(){var Ni=(ga=Oy(this.model.getCenter(),2))[0],ga=ga[1];return new H.geo.Point(ga,Ni)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getLevel",value:function(Ni){return this.getLevels().find(function(ga){return ga.getIdentifier()===Ni})}},{key:"getLevels",value:function(){var Ni=this.getData().getLevels().map(function(ga){return ga.getIdentifier()});return this.getVenue().getLevels().filter(function(ga){return-1!==Ni.indexOf(ga.id)})}},{key:"getMainLevel",value:function(){return this.getLevel(this.model.getMainLevel().getIdentifier())}},{key:"getVenue",value:function(){return this.getParentEventTarget()}}]),_r}(),Uw=function(){iy(_r,H.map.Feature);var _d=_m(_r);function _r(Ni){var ga;return _e(this,_r),(ga=_d.call(this)).id=Ni.id,ga.model=Ni,ga}return _u(_r,[{key:"getGeometry",value:function(Ni){return this.getGeometries().find(function(ga){return ga.getIdentifier()===Ni})}},{key:"getGeometries",value:function(){var Ni=this.getData().getGeometries().map(function(ga){return ga.getIdentifier()});return this.getDrawing().getVenue().getGeometries().filter(function(ga){return-1!==Ni.indexOf(ga.id)})}},{key:"getData",value:function(){return this.model}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getShortName",value:function(){return this.model.getShortName()}},{key:"getZIndex",value:function(){return this.model.getZIndex()}},{key:"isMain",value:function(){return this.model.isMain()}},{key:"getDrawing",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getDrawing().getParentEventTarget()}}]),_r}();function K_(_d,_r,Ni,ga){for(var ba,_h=ga,gg=Ni-_r>>1,oy=Ni-_r,uy=_d[_r],cy=_d[_r+1],vy=_d[Ni],Ty=_d[Ni+1],Ay=_r+3;Ay<Ni;Ay+=3){var e0=(s0=_d[Ay],ky=_d[Ay+1],h0=void 0,By=void 0,qy=void 0,qy=(jy=Ty)-(t0=cy),0==(By=(Fy=vy)-(u0=uy))&&0===qy||(1<(h0=((s0-u0)*By+(ky-t0)*qy)/(By*By+qy*qy))?(u0=Fy,t0=jy):0<h0&&(u0+=By*h0,t0+=qy*h0)),(By=s0-u0)*By+(qy=ky-t0)*qy);_h<e0?(ba=Ay,_h=e0):e0===_h&&(e0=Math.abs(Ay-gg))<oy&&(ba=Ay,oy=e0)}var s0,ky,u0,t0,Fy,jy,h0,By,qy;ga<_h&&(3<ba-_r&&K_(_d,_r,ba,ga),_d[ba+2]=_h,3<Ni-ba&&K_(_d,ba,Ni,ga))}function F_(ba,oy,Ni,ga){var _h=ba={id:void 0===ba?null:ba,type:oy,geometry:Ni,tags:ga,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},gg=_h.geometry;if("Point"===(oy=_h.type)||"MultiPoint"===oy||"LineString"===oy)Px(_h,gg);else if("Polygon"===oy||"MultiLineString"===oy)for(var uy=0;uy<gg.length;uy++)Px(_h,gg[uy]);else if("MultiPolygon"===oy)for(uy=0;uy<gg.length;uy++)for(var cy=0;cy<gg[uy].length;cy++)Px(_h,gg[uy][cy]);return ba}function Px(_d,_r){for(var Ni=0;Ni<_r.length;Ni+=3)_d.minX=Math.min(_d.minX,_r[Ni]),_d.minY=Math.min(_d.minY,_r[Ni+1]),_d.maxX=Math.max(_d.maxX,_r[Ni]),_d.maxY=Math.max(_d.maxY,_r[Ni+1])}function S1(_d,_r,Ni,ga){if(_r.geometry){var ba=_r.geometry.coordinates,_h=_r.geometry.type,gg=Math.pow(Ni.tolerance/((1<<Ni.maxZoom)*Ni.extent),2),oy=[],uy=_r.id;if(Ni.promoteId?uy=_r.properties[Ni.promoteId]:Ni.generateId&&(uy=ga||0),"Point"===_h)zE(ba,oy);else if("MultiPoint"===_h)for(var cy=0;cy<ba.length;cy++)zE(ba[cy],oy);else if("LineString"===_h)fE(ba,oy,gg,!1);else if("MultiLineString"===_h){if(Ni.lineMetrics){for(cy=0;cy<ba.length;cy++)fE(ba[cy],oy=[],gg,!1),_d.push(F_(uy,"LineString",oy,_r.properties));return}mC(ba,oy,gg,!1)}else if("Polygon"===_h)mC(ba,oy,gg,!0);else{if("MultiPolygon"!==_h){if("GeometryCollection"!==_h)throw new Error("Input data is not a valid GeoJSON object.");for(cy=0;cy<_r.geometry.geometries.length;cy++)S1(_d,{id:uy,geometry:_r.geometry.geometries[cy],properties:_r.properties},Ni,ga);return}for(cy=0;cy<ba.length;cy++){var vy=[];mC(ba[cy],vy,gg,!0),oy.push(vy)}}_d.push(F_(uy,_h,oy,_r.properties))}}function zE(_d,_r){_r.push(G2(_d[0])),_r.push(i1(_d[1])),_r.push(0)}function fE(_d,_r,Ni,ga){for(var ba,_h,gg=0,oy=0;oy<_d.length;oy++){var uy=G2(_d[oy][0]),cy=i1(_d[oy][1]);_r.push(uy),_r.push(cy),_r.push(0),0<oy&&(gg+=ga?(ba*cy-uy*_h)/2:Math.sqrt(Math.pow(uy-ba,2)+Math.pow(cy-_h,2))),ba=uy,_h=cy}var vy=_r.length-3;_r[2]=1,K_(_r,0,vy,Ni),_r[2+vy]=1,_r.size=Math.abs(gg),_r.start=0,_r.end=_r.size}function mC(_d,_r,Ni,ga){for(var ba=0;ba<_d.length;ba++){var _h=[];fE(_d[ba],_h,Ni,ga),_r.push(_h)}}function G2(_d){return _d/360+.5}function i1(_d){return _d=Math.sin(_d*Math.PI/180),(_d=.5-.25*Math.log((1+_d)/(1-_d))/Math.PI)<0?0:1<_d?1:_d}function Lx(_d,_r,Ni,ga,ba,_h,gg,oy){if(ga/=_r,(Ni/=_r)<=_h&&gg<ga)return _d;if(gg<Ni||ga<=_h)return null;for(var uy=[],cy=0;cy<_d.length;cy++){var vy=_d[cy],Ty=vy.geometry,Ay=vy.type,e0=0===ba?vy.minX:vy.minY,s0=0===ba?vy.maxX:vy.maxY;if(Ni<=e0&&s0<ga)uy.push(vy);else if(!(s0<Ni||ga<=e0)){var ky=[];if("Point"===Ay||"MultiPoint"===Ay){h0=qy=t0=void 0;for(var u0=Ty,t0=ky,Fy=Ni,jy=ga,By=ba,qy=0;qy<u0.length;qy+=3){var h0=u0[qy+By];Fy<=h0&&h0<=jy&&(t0.push(u0[qy]),t0.push(u0[qy+1]),t0.push(u0[qy+2]))}}else if("LineString"===Ay)Fx(Ty,ky,Ni,ga,ba,!1,oy.lineMetrics);else if("MultiLineString"===Ay)CE(Ty,ky,Ni,ga,ba,!1);else if("Polygon"===Ay)CE(Ty,ky,Ni,ga,ba,!0);else if("MultiPolygon"===Ay)for(var Ly=0;Ly<Ty.length;Ly++){var Qy=[];CE(Ty[Ly],Qy,Ni,ga,ba,!0),Qy.length&&ky.push(Qy)}if(ky.length)if(oy.lineMetrics&&"LineString"===Ay)for(Ly=0;Ly<ky.length;Ly++)uy.push(F_(vy.id,Ay,ky[Ly],vy.tags));else"LineString"!==Ay&&"MultiLineString"!==Ay||(1===ky.length?(Ay="LineString",ky=ky[0]):Ay="MultiLineString"),"Point"!==Ay&&"MultiPoint"!==Ay||(Ay=3===ky.length?"Point":"MultiPoint"),uy.push(F_(vy.id,Ay,ky,vy.tags))}}return uy.length?uy:null}function Fx(_d,_r,Ni,ga,ba,_h,gg){for(var oy,uy,cy=vC(_d),vy=0===ba?q2:W2,Ty=_d.start,Ay=0;Ay<_d.length-3;Ay+=3){var jy=_d[Ay],By=_d[Ay+1],qy=_d[Ay+2],e0=_d[Ay+3],s0=_d[Ay+4],ky=0===ba?jy:By,u0=0===ba?e0:s0,t0=!1;gg&&(oy=Math.sqrt(Math.pow(jy-e0,2)+Math.pow(By-s0,2))),ky<Ni?Ni<u0&&(uy=vy(cy,jy,By,e0,s0,Ni),gg&&(cy.start=Ty+oy*uy)):ga<ky?u0<ga&&(uy=vy(cy,jy,By,e0,s0,ga),gg&&(cy.start=Ty+oy*uy)):W1(cy,jy,By,qy),u0<Ni&&Ni<=ky&&(uy=vy(cy,jy,By,e0,s0,Ni),t0=!0),ga<u0&&ky<=ga&&(uy=vy(cy,jy,By,e0,s0,ga),t0=!0),!_h&&t0&&(gg&&(cy.end=Ty+oy*uy),_r.push(cy),cy=vC(_d)),gg&&(Ty+=oy)}var Fy=_d.length-3;jy=_d[Fy],By=_d[1+Fy],qy=_d[2+Fy],Ni<=(ky=0===ba?jy:By)&&ky<=ga&&W1(cy,jy,By,qy),Fy=cy.length-3,_h&&3<=Fy&&(cy[Fy]!==cy[0]||cy[1+Fy]!==cy[1])&&W1(cy,cy[0],cy[1],cy[2]),cy.length&&_r.push(cy)}function vC(_d){var _r=[];return _r.size=_d.size,_r.start=_d.start,_r.end=_d.end,_r}function CE(_d,_r,Ni,ga,ba,_h){for(var gg=0;gg<_d.length;gg++)Fx(_d[gg],_r,Ni,ga,ba,_h,!1)}function W1(_d,_r,Ni,ga){_d.push(_r),_d.push(Ni),_d.push(ga)}function q2(_d,_r,Ni,ga,ba,_h){return ga=(_h-_r)/(ga-_r),_d.push(_h),_d.push(Ni+(ba-Ni)*ga),_d.push(1),ga}function W2(_d,_r,Ni,ga,ba,_h){return _d.push(_r+(ga-_r)*(ba=(_h-Ni)/(ba-Ni))),_d.push(_h),_d.push(1),ba}function o1(_d,_r){for(var Ni=[],ga=0;ga<_d.length;ga++){var ba=_d[ga],_h=ba.type;if("Point"===_h||"MultiPoint"===_h||"LineString"===_h)gg=G_(ba.geometry,_r);else if("MultiLineString"===_h||"Polygon"===_h)for(var gg=[],oy=0;oy<ba.geometry.length;oy++)gg.push(G_(ba.geometry[oy],_r));else if("MultiPolygon"===_h)for(gg=[],oy=0;oy<ba.geometry.length;oy++){for(var uy=[],cy=0;cy<ba.geometry[oy].length;cy++)uy.push(G_(ba.geometry[oy][cy],_r));gg.push(uy)}Ni.push(F_(ba.id,_h,gg,ba.tags))}return Ni}function G_(_d,_r){var Ni=[];Ni.size=_d.size,void 0!==_d.start&&(Ni.start=_d.start,Ni.end=_d.end);for(var ga=0;ga<_d.length;ga+=3)Ni.push(_d[ga]+_r,_d[ga+1],_d[ga+2]);return Ni}function _C(_d,_r){if(!_d.transformed){for(var Ni,ga=1<<_d.z,ba=_d.x,_h=_d.y,gg=0;gg<_d.features.length;gg++){var oy=_d.features[gg],uy=oy.geometry,cy=oy.type;if(oy.geometry=[],1===cy)for(Ni=0;Ni<uy.length;Ni+=2)oy.geometry.push(r_(uy[Ni],uy[Ni+1],_r,ga,ba,_h));else for(Ni=0;Ni<uy.length;Ni++){for(var vy=[],Ty=0;Ty<uy[Ni].length;Ty+=2)vy.push(r_(uy[Ni][Ty],uy[Ni][Ty+1],_r,ga,ba,_h));oy.geometry.push(vy)}}_d.transformed=!0}return _d}function r_(_d,_r,Ni,ga,ba,_h){return[Math.round(Ni*(_d*ga-ba)),Math.round(Ni*(_r*ga-_h))]}function bC(_d,_r,Ni,ga,ba){for(var _h=_r===ba.maxZoom?0:ba.tolerance/((1<<_r)*ba.extent),gg={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ni,y:ga,z:_r,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},oy=0;oy<_d.length;oy++){gg.numFeatures++,jy=Fy=t0=u0=ky=s0=e0=jy=uy=void 0;var uy=gg,cy=_d[oy],vy=_h,jy=ba,Ty=cy.geometry,Ay=cy.type,e0=[];if("Point"===Ay||"MultiPoint"===Ay)for(var s0=0;s0<Ty.length;s0+=3)e0.push(Ty[s0]),e0.push(Ty[s0+1]),uy.numPoints++,uy.numSimplified++;else if("LineString"===Ay)lS(e0,Ty,uy,vy,!1,!1);else if("MultiLineString"===Ay||"Polygon"===Ay)for(s0=0;s0<Ty.length;s0++)lS(e0,Ty[s0],uy,vy,"Polygon"===Ay,0===s0);else if("MultiPolygon"===Ay)for(var ky=0;ky<Ty.length;ky++){var u0=Ty[ky];for(s0=0;s0<u0.length;s0++)lS(e0,u0[s0],uy,vy,!0,0===s0)}if(e0.length){var t0=cy.tags||null;if("LineString"===Ay&&jy.lineMetrics){for(var Fy in t0={},cy.tags)t0[Fy]=cy.tags[Fy];t0.mapbox_clip_start=Ty.start/Ty.size,t0.mapbox_clip_end=Ty.end/Ty.size}jy={geometry:e0,type:"Polygon"===Ay||"MultiPolygon"===Ay?3:"LineString"===Ay||"MultiLineString"===Ay?2:1,tags:t0},null!==cy.id&&(jy.id=cy.id),uy.features.push(jy)}var By=_d[oy].minY,qy=_d[oy].maxX,h0=_d[oy].maxY;(jy=_d[oy].minX)<gg.minX&&(gg.minX=jy),By<gg.minY&&(gg.minY=By),qy>gg.maxX&&(gg.maxX=qy),h0>gg.maxY&&(gg.maxY=h0)}return gg}function lS(_d,_r,Ni,ga,ba,_h){var gg=ga*ga;if(0<ga&&_r.size<(ba?gg:ga))Ni.numPoints+=_r.length/3;else{for(var oy=[],uy=0;uy<_r.length;uy+=3)(0===ga||_r[uy+2]>gg)&&(Ni.numSimplified++,oy.push(_r[uy]),oy.push(_r[uy+1])),Ni.numPoints++;if(ba){for(var cy=oy,vy=(ba=_h,0),Ty=0,Ay=cy.length,e0=Ay-2;Ty<Ay;e0=Ty,Ty+=2)vy+=(cy[Ty]-cy[e0])*(cy[Ty+1]+cy[e0+1]);if(0<vy===ba)for(Ty=0,Ay=cy.length;Ty<Ay/2;Ty+=2){var s0=cy[Ty],ky=cy[Ty+1];cy[Ty]=cy[Ay-2-Ty],cy[Ty+1]=cy[Ay-1-Ty],cy[Ay-2-Ty]=s0,cy[Ay-1-Ty]=ky}}_d.push(oy)}}function BE(uy,_r){var ga,ba,_h,gg,oy,Ni=(_r=this.options=function(cy,vy){for(var Ty in vy)cy[Ty]=vy[Ty];return cy}(Object.create(this.options),_r)).debug;if(Ni&&console.time("preprocess data"),_r.maxZoom<0||24<_r.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(_r.promoteId&&_r.generateId)throw new Error("promoteId and generateId cannot be used together.");uy=function(cy,vy){var Ty=[];if("FeatureCollection"===cy.type)for(var Ay=0;Ay<cy.features.length;Ay++)S1(Ty,cy.features[Ay],vy,Ay);else S1(Ty,"Feature"===cy.type?cy:{geometry:cy},vy);return Ty}(uy,_r),this.tiles={},this.tileCoords=[],Ni&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",_r.indexMaxZoom,_r.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),gg=Lx(_h=ga=uy,1,-1-(ba=_r.buffer/_r.extent),ba,0,-1,2,_r),oy=Lx(ga,1,1-ba,2+ba,0,-1,2,_r),(gg||oy)&&(_h=Lx(ga,1,-ba,1+ba,0,-1,2,_r)||[],gg&&(_h=o1(gg,1).concat(_h)),oy&&(_h=_h.concat(o1(oy,-1)))),(uy=_h).length&&this.splitTile(uy,0,0,0),Ni&&(uy.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $2(_d,_r,Ni){return 32*((1<<_d)*Ni+_r)+_d}function cS(_d,_r,gg,ga,ba){var _h;return(_h=[])[0]=(_d[0]/ba+gg)/(_r=1<<_r),_h[1]=(_d[1]/ba+ga)/_r,ba=(_d=gg={x:_h[0],y:_h[1]}).x,_d=_d.y,ba=360*(ba-.5),ga=Math.exp(Math.PI*(.5-_d)/.25)-1,_d=Math.exp(Math.PI*(.5-_d)/.25)+1,[ba,180*Math.asin(ga/_d)/Math.PI]}BE.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},BE.prototype.splitTile=function(_d,_r,Ni,ga,ba,_h,gg){for(var oy=[_d,_r,Ni,ga],uy=this.options,cy=uy.debug;oy.length;){ga=oy.pop(),Ni=oy.pop(),_r=oy.pop(),_d=oy.pop();var vy,Ty,Ay,e0,s0,ky,u0,t0,Fy,jy=1<<_r,By=$2(_r,Ni,ga),qy=this.tiles[By];if(qy||(1<cy&&console.time("creation"),qy=this.tiles[By]=bC(_d,_r,Ni,ga,uy),this.tileCoords.push({z:_r,x:Ni,y:ga}),cy&&(1<cy&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",_r,Ni,ga,qy.numFeatures,qy.numPoints,qy.numSimplified),console.timeEnd("creation")),this.stats[By="z"+_r]=(this.stats[By]||0)+1,this.total++)),qy.source=_d,ba){if(_r===uy.maxZoom||_r===ba)continue;if(By=1<<ba-_r,Ni!==Math.floor(_h/By)||ga!==Math.floor(gg/By))continue}else if(_r===uy.indexMaxZoom||qy.numPoints<=uy.indexMaxPoints)continue;qy.source=null,0!==_d.length&&(1<cy&&console.time("clipping"),vy=.5-(By=.5*uy.buffer/uy.extent),Ay=1+By,u0=e0=s0=ky=null,t0=Lx(_d,jy,Ni-By,Ni+(Ty=.5+By),0,qy.minX,qy.maxX,uy),Fy=Lx(_d,jy,Ni+vy,Ni+Ay,0,qy.minX,qy.maxX,uy),_d=null,t0&&(u0=Lx(t0,jy,ga-By,ga+Ty,1,qy.minY,qy.maxY,uy),e0=Lx(t0,jy,ga+vy,ga+Ay,1,qy.minY,qy.maxY,uy),t0=null),Fy&&(s0=Lx(Fy,jy,ga-By,ga+Ty,1,qy.minY,qy.maxY,uy),ky=Lx(Fy,jy,ga+vy,ga+Ay,1,qy.minY,qy.maxY,uy),Fy=null),1<cy&&console.timeEnd("clipping"),oy.push(u0||[],_r+1,2*Ni,2*ga),oy.push(e0||[],_r+1,2*Ni,2*ga+1),oy.push(s0||[],_r+1,2*Ni+1,2*ga),oy.push(ky||[],_r+1,2*Ni+1,2*ga+1))}},BE.prototype.getTile=function(_d,_r,Ni){var ga=(ba=this.options).extent,ba=ba.debug;if(_d<0||24<_d)return null;var _h=$2(_d,_r=(_r%(_h=1<<_d)+_h)%_h,Ni);if(this.tiles[_h])return _C(this.tiles[_h],ga);1<ba&&console.log("drilling down to z%d-%d-%d",_d,_r,Ni);for(var gg,oy=_d,uy=_r,cy=Ni;!gg&&0<oy;)oy--,uy=Math.floor(uy/2),cy=Math.floor(cy/2),gg=this.tiles[$2(oy,uy,cy)];return gg&&gg.source?(1<ba&&console.log("found parent tile z%d-%d-%d",oy,uy,cy),1<ba&&console.time("drilling down"),this.splitTile(gg.source,oy,uy,cy,_d,_r,Ni),1<ba&&console.timeEnd("drilling down"),this.tiles[_h]?_C(this.tiles[_h],ga):null):null};var jx_POINT="Point",jx_POLYGON="Polygon",jx_MULTI_POINT="MultiPoint",jx_MULTI_LINESTRING="MultiLineString",jx_MULTI_POLYGON="MultiPolygon",KR={fillColor:"#e0e0e0",outlineColor:"#829DB4",outlineWidth:1},Y2={fillColor:"#F2F285",outlineColor:"#0088BF",outlineWidth:1.2},q_={FOOTPRINT:"FOOTPRINT",ICON:"ICON",TEXT:"TEXT",VECTOR:"VECTOR"},xA=function(_d){return 0<(_d=function(_r){for(var Ni=0,ga=_r.length,ba=0;ba<ga-1;ba+=1){var _h=_r[ba],gg=_r[ba+1];Ni+=_h[0]*gg[1]-gg[0]*_h[1]}return Ni+(_r[ga-1][0]*_r[0][1]-_r[0][0]*_r[ga-1][1])}(_d))?"CW":_d<0?"CCW":void 0};!function(_d){function _r(ba){if(ga[ba])return ga[ba].exports;var _h=ga[ba]={i:ba,l:!1,exports:{}};return Ni[ba].call(_h.exports,_h,_h.exports,_r),_h.l=!0,_h.exports}var Ni,ga;_d.exports=(Ni=[function(ba,_h,Ty){function oy(Ay){return(oy="function"==typeof Symbol&&"symbol"==k(Symbol.iterator)?function(e0){return k(e0)}:function(e0){return e0&&"function"==typeof Symbol&&e0.constructor===Symbol&&e0!==Symbol.prototype?"symbol":k(e0)})(Ay)}var uy=Ty(1),cy=(Ty=Ty(7)).get,vy=Ty.isArray;Ty=function(){function Ay(t0,q0){var jy=void 0===(jy=q0.location)?0:jy,By=void 0===(By=q0.distance)?100:By,qy=void 0===(qy=q0.threshold)?.6:qy,h0=void 0===(h0=q0.maxPatternLength)?32:h0,Ly=void 0!==(Ly=q0.caseSensitive)&&Ly,Qy=void 0===(Qy=q0.tokenSeparator)?/ +/g:Qy,n0=void 0!==(n0=q0.findAllMatches)&&n0,Gy=void 0===(Gy=q0.minMatchCharLength)?1:Gy,g0=void 0===(g0=q0.id)?null:g0,N0=void 0===(N0=q0.keys)?[]:N0,w0=void 0===(w0=q0.shouldSort)||w0,E0=void 0===(E0=q0.getFn)?cy:E0,u_=void 0===(u_=q0.sortFn)?function(a1,B0){return a1.score-B0.score}:u_,__=void 0!==(__=q0.tokenize)&&__,b_=void 0!==(b_=q0.matchAllTokens)&&b_,U_=void 0!==(U_=q0.includeMatches)&&U_,V0=void 0!==(V0=q0.includeScore)&&V0;if(q0=void 0!==(q0=q0.verbose)&&q0,!(this instanceof Ay))throw new TypeError("Cannot call a class as a function");this.options={location:jy,distance:By,threshold:qy,maxPatternLength:h0,isCaseSensitive:Ly,tokenSeparator:Qy,findAllMatches:n0,minMatchCharLength:Gy,id:g0,keys:N0,includeMatches:U_,includeScore:V0,shouldSort:w0,getFn:E0,sortFn:u_,verbose:q0,tokenize:__,matchAllTokens:b_},this.setCollection(t0),this._processKeys(N0)}for(var e0=Ay.prototype,s0=[{key:"setCollection",value:function(t0){return this.list=t0}},{key:"_processKeys",value:function(t0){if(this._keyWeights={},this._keyNames=[],t0.length&&"string"==typeof t0[0])for(var Fy=0,jy=t0.length;Fy<jy;Fy+=1){var By=t0[Fy];this._keyWeights[By]=1,this._keyNames.push(By)}else{for(var qy=null,h0=null,Ly=0,Qy=0,n0=t0.length;Qy<n0;Qy+=1){var Gy=t0[Qy];if(!Gy.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var g0=Gy.name;if(this._keyNames.push(g0),!Gy.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');if((Gy=Gy.weight)<0||1<Gy)throw new Error('"weight" property in key must bein the range of [0, 1)');h0=null==h0?Gy:Math.max(h0,Gy),qy=null==qy?Gy:Math.min(qy,Gy),Ly+=this._keyWeights[g0]=Gy}if(1<Ly)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(jy){var Fy=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{limit:!1},By=(this._log('---------\nSearch pattern: "'.concat(jy,'"')),jy=this._prepareSearchers(jy),this._search(By=jy.tokenSearchers,jy=jy.fullSearcher));return this._computeScore(By),this.options.shouldSort&&this._sort(By),Fy.limit&&"number"==typeof Fy.limit&&(By=By.slice(0,Fy.limit)),this._format(By)}},{key:"_prepareSearchers",value:function(){var t0=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",Fy=[];if(this.options.tokenize)for(var jy=t0.split(this.options.tokenSeparator),By=0,qy=jy.length;By<qy;By+=1)Fy.push(new uy(jy[By],this.options));return{tokenSearchers:Fy,fullSearcher:new uy(t0,this.options)}}},{key:"_search",value:function(){var t0=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],Fy=1<arguments.length?arguments[1]:void 0,jy=this.list,By={},qy=[];if("string"==typeof jy[0])for(var h0=0,Ly=jy.length;h0<Ly;h0+=1)this._analyze({key:"",value:jy[h0],record:h0,index:h0},{resultMap:By,results:qy,tokenSearchers:t0,fullSearcher:Fy});else for(var Qy=0,n0=jy.length;Qy<n0;Qy+=1)for(var Gy=jy[Qy],g0=0,N0=this._keyNames.length;g0<N0;g0+=1){var w0=this._keyNames[g0];this._analyze({key:w0,value:this.options.getFn(Gy,w0),record:Gy,index:Qy},{resultMap:By,results:qy,tokenSearchers:t0,fullSearcher:Fy})}return qy}},{key:"_analyze",value:function(Qy,Fy){var N0,jy=this,By=Qy.key,qy=Qy.arrayIndex,n0=void 0===(N0=Fy.tokenSearchers)?[]:N0,Gy=Fy.fullSearcher,g0=void 0===(N0=Fy.resultMap)?{}:N0,w0=void 0===(N0=Fy.results)?[]:N0;!function E0(u_,__,b_,U_){if(null!=__)if("string"==typeof __){var V0=!1,q0=-1,a1=0,B0=(jy._log("\nKey: ".concat(""===By?"--":By)),Gy.search(__));if(jy._log('Full text: "'.concat(__,'", score: ').concat(B0.score)),jy.options.tokenize){for(var M1=__.split(jy.options.tokenSeparator),KT=M1.length,$x=[],u1=0,ZT=n0.length;u1<ZT;u1+=1){var DA=n0[u1];jy._log('\nPattern: "'.concat(DA.pattern,'"'));for(var H0=!1,z1=0;z1<KT;z1+=1){var y_=M1[z1],I1=DA.search(y_),k1={};I1.isMatch?(k1[y_]=I1.score,H0=V0=!0,$x.push(I1.score)):(k1[y_]=1,jy.options.matchAllTokens||$x.push(1)),jy._log('Token: "'.concat(y_,'", score: ').concat(k1[y_]))}H0&&(a1+=1)}q0=$x[0];for(var IE=$x.length,T1=1;T1<IE;T1+=1)q0+=$x[T1];jy._log("Token score average:",q0/=IE)}var K1=B0.score,o0=(jy._log("Score average:",K1=-1<q0?(K1+q0)/2:K1),!jy.options.tokenize||!jy.options.matchAllTokens||a1>=n0.length);jy._log("\nCheck Matches: ".concat(o0)),(V0||B0.isMatch)&&o0&&(o0={key:By,arrayIndex:u_,value:__,score:K1},jy.options.includeMatches&&(o0.matchedIndices=B0.matchedIndices),(u_=g0[U_])?u_.output.push(o0):(g0[U_]={item:b_,output:[o0]},w0.push(g0[U_])))}else if(vy(__))for(var X0=0,l1=__.length;X0<l1;X0+=1)E0(X0,__[X0],b_,U_)}(void 0===qy?-1:qy,Qy.value,Qy.record,Qy=Qy.index)}},{key:"_computeScore",value:function(t0){this._log("\n\nComputing score:\n");for(var Fy=this._keyWeights,jy=!!Object.keys(Fy).length,By=0,qy=t0.length;By<qy;By+=1){for(var h0=t0[By],Ly=h0.output,Qy=Ly.length,n0=1,Gy=0;Gy<Qy;Gy+=1){var g0=Ly[Gy],w0=g0.key,N0=jy?Fy[w0]:1;w0=0===g0.score&&Fy&&0<Fy[w0]?Number.EPSILON:g0.score,n0*=Math.pow(w0,N0)}h0.score=n0,this._log(h0)}}},{key:"_sort",value:function(t0){this._log("\n\nSorting...."),t0.sort(this.options.sortFn)}},{key:"_format",value:function(t0){var Fy,jy=[],By=(this.options.verbose&&(Fy=[],this._log("\n\nOutput:\n\n",JSON.stringify(t0,function(g0,N0){if("object"===oy(N0)&&null!==N0){if(-1!==Fy.indexOf(N0))return;Fy.push(N0)}return N0},2)),Fy=null),[]);this.options.includeMatches&&By.push(function(g0,N0){var w0=g0.output;N0.matches=[];for(var E0=0,u_=w0.length;E0<u_;E0+=1){var __,b_=w0[E0];0!==b_.matchedIndices.length&&(__={indices:b_.matchedIndices,value:b_.value},b_.key&&(__.key=b_.key),b_.hasOwnProperty("arrayIndex")&&-1<b_.arrayIndex&&(__.arrayIndex=b_.arrayIndex),N0.matches.push(__))}}),this.options.includeScore&&By.push(function(g0,N0){N0.score=g0.score});for(var qy=0,h0=t0.length;qy<h0;qy+=1){var Ly=t0[qy];if(this.options.id&&(Ly.item=this.options.getFn(Ly.item,this.options.id)[0]),By.length){for(var Qy={item:Ly.item},n0=0,Gy=By.length;n0<Gy;n0+=1)By[n0](Ly,Qy);jy.push(Qy)}else jy.push(Ly.item)}return jy}},{key:"_log",value:function(){var t0;this.options.verbose&&(t0=console).log.apply(t0,arguments)}}],ky=0;ky<s0.length;ky++){var u0=s0[ky];u0.enumerable=u0.enumerable||!1,u0.configurable=!0,"value"in u0&&(u0.writable=!0),Object.defineProperty(e0,u0.key,u0)}return Ay}(),ba.exports=Ty},function(ba,_h,vy){var oy=vy(2),uy=vy(3),cy=vy(6);vy=function(){function Ty(u0,Gy){var Fy=void 0===(Fy=Gy.location)?0:Fy,jy=void 0===(jy=Gy.distance)?100:jy,By=void 0===(By=Gy.threshold)?.6:By,qy=void 0===(qy=Gy.maxPatternLength)?32:qy,h0=void 0!==(h0=Gy.isCaseSensitive)&&h0,Ly=void 0===(Ly=Gy.tokenSeparator)?/ +/g:Ly,Qy=void 0!==(Qy=Gy.findAllMatches)&&Qy,n0=void 0===(n0=Gy.minMatchCharLength)?1:n0;if(Gy=void 0!==(Gy=Gy.includeMatches)&&Gy,!(this instanceof Ty))throw new TypeError("Cannot call a class as a function");this.options={location:Fy,distance:jy,threshold:By,maxPatternLength:qy,isCaseSensitive:h0,tokenSeparator:Ly,findAllMatches:Qy,includeMatches:Gy,minMatchCharLength:n0},this.pattern=h0?u0:u0.toLowerCase(),this.pattern.length<=qy&&(this.patternAlphabet=cy(this.pattern))}for(var Ay=Ty.prototype,e0=[{key:"search",value:function(u0){var Fy=(t0=this.options).isCaseSensitive,t0=t0.includeMatches;if(Fy||(u0=u0.toLowerCase()),this.pattern===u0)return Fy={isMatch:!0,score:0},t0&&(Fy.matchedIndices=[[0,u0.length-1]]),Fy;var h0=(Fy=this.options).maxPatternLength;return Fy=Fy.tokenSeparator,this.pattern.length>h0?oy(u0,this.pattern,Fy):uy(u0,this.pattern,this.patternAlphabet,{location:Fy=(h0=this.options).location,distance:h0.distance,threshold:h0.threshold,findAllMatches:h0.findAllMatches,minMatchCharLength:h0=h0.minMatchCharLength,includeMatches:t0})}}],s0=0;s0<e0.length;s0++){var ky=e0[s0];ky.enumerable=ky.enumerable||!1,ky.configurable=!0,"value"in ky&&(ky.writable=!0),Object.defineProperty(Ay,ky.key,ky)}return Ty}(),ba.exports=vy},function(ba,_h){var gg=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;ba.exports=function(oy,cy){var Ty=2<arguments.length&&void 0!==arguments[2]?arguments[2]:/ +/g,vy=(cy=new RegExp(cy.replace(gg,"\\$&").replace(Ty,"|")),oy.match(cy)),Ay=[];if(Ty=!!vy)for(var e0=0,s0=vy.length;e0<s0;e0+=1){var ky=vy[e0];Ay.push([oy.indexOf(ky),ky.length-1])}return{score:Ty?.5:1,isMatch:Ty,matchedIndices:Ay}}},function(ba,_h,gg){var oy=gg(4),uy=gg(5);ba.exports=function(cy,vy,Ty,Ay){for(var e0=Ay.location,s0=void 0===(ky=Ay.distance)?100:ky,ky=Ay.threshold,u0=void 0!==(t0=Ay.findAllMatches)&&t0,t0=void 0===(t0=Ay.minMatchCharLength)?1:t0,Fy=(Ay=void 0!==(Ay=Ay.includeMatches)&&Ay,void 0===e0?0:e0),jy=cy.length,By=void 0===ky?.6:ky,qy=cy.indexOf(vy,Fy),h0=vy.length,Ly=[],Qy=0;Qy<jy;Qy+=1)Ly[Qy]=0;-1!==qy&&(e0=oy(vy,{errors:0,currentLocation:qy,expectedLocation:Fy,distance:s0}),By=Math.min(e0,By),-1!==(qy=cy.lastIndexOf(vy,Fy+h0))&&(ky=oy(vy,{errors:0,currentLocation:qy,expectedLocation:Fy,distance:s0}),By=Math.min(ky,By))),qy=-1;for(var n0=[],Gy=1,g0=h0+jy,N0=1<<(h0<=31?h0-1:30),w0=0;w0<h0;w0+=1){for(var E0=0,u_=g0;E0<u_;)oy(vy,{errors:w0,currentLocation:Fy+u_,expectedLocation:Fy,distance:s0})<=By?E0=u_:g0=u_,u_=Math.floor((g0-E0)/2+E0);g0=u_;var __=Math.max(1,Fy-u_+1),b_=u0?jy:Math.min(Fy+u_,jy)+h0,U_=Array(b_+2);U_[b_+1]=(1<<w0)-1;for(var V0=b_;__<=V0;--V0){var q0=V0-1,a1=Ty[cy.charAt(q0)];if(a1&&(Ly[q0]=1),U_[V0]=(U_[V0+1]<<1|1)&a1,0!==w0&&(U_[V0]|=(n0[V0+1]|n0[V0])<<1|1|n0[V0+1]),U_[V0]&N0&&(Gy=oy(vy,{errors:w0,currentLocation:q0,expectedLocation:Fy,distance:s0}))<=By){if(By=Gy,(qy=q0)<=Fy)break;__=Math.max(1,2*Fy-qy)}}if(oy(vy,{errors:w0+1,currentLocation:Fy,expectedLocation:Fy,distance:s0})>By)break;n0=U_}return e0={isMatch:0<=qy,score:0===Gy?.001:Gy},Ay&&(e0.matchedIndices=uy(Ly,t0)),e0}},function(ba,_h){ba.exports=function(Ay,vy){var Ty=vy.errors,uy=vy.currentLocation,cy=vy.expectedLocation;return vy=void 0===(vy=vy.distance)?100:vy,Ty=(void 0===Ty?0:Ty)/Ay.length,Ay=Math.abs((void 0===cy?0:cy)-(void 0===uy?0:uy)),vy?Ty+Ay/vy:Ay?1:Ty}},function(ba,_h){ba.exports=function(){for(var gg=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],oy=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,uy=[],cy=-1,vy=0,Ty=gg.length;vy<Ty;vy+=1){var Ay=gg[vy];Ay&&-1===cy?cy=vy:Ay||-1===cy||((Ay=vy-1)-cy+1>=oy&&uy.push([cy,Ay]),cy=-1)}return gg[vy-1]&&oy<=vy-cy&&uy.push([cy,vy-1]),uy}},function(ba,_h){ba.exports=function(gg){for(var oy={},uy=gg.length,cy=0;cy<uy;cy+=1)oy[gg.charAt(cy)]=0;for(var vy=0;vy<uy;vy+=1)oy[gg.charAt(vy)]|=1<<uy-vy-1;return oy}},function(ba,_h){function gg(vy){return Array.isArray?Array.isArray(vy):"[object Array]"===Object.prototype.toString.call(vy)}function oy(vy){if(null==vy)return"";if("string"==typeof vy)return vy;var Ty=vy+"";return"0"==Ty&&1/vy==-1/0?"-0":Ty}function uy(vy){return"string"==typeof vy}function cy(vy){return"number"==typeof vy}ba.exports={get:function(vy,Ty){var Ay=[];return function e0(s0,ky){if(ky){var u0=ky.indexOf("."),t0=ky,Fy=null,jy=(-1!==u0&&(t0=ky.slice(0,u0),Fy=ky.slice(u0+1)),s0[t0]);if(null!=jy)if(Fy||!uy(jy)&&!cy(jy))if(gg(jy))for(var By=0,qy=jy.length;By<qy;By+=1)e0(jy[By],Fy);else Fy&&e0(jy,Fy);else Ay.push(oy(jy))}else Ay.push(s0)}(vy,Ty),Ay},isArray:gg,isString:uy,isNum:cy,toString:oy}}],ga={},_r.m=Ni,_r.c=ga,_r.d=function(ba,_h,gg){_r.o(ba,_h)||Object.defineProperty(ba,_h,{enumerable:!0,get:gg})},_r.r=function(ba){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(ba,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ba,"__esModule",{value:!0})},_r.t=function(ba,_h){if(1&_h&&(ba=_r(ba)),8&_h||4&_h&&"object"==k(ba)&&ba&&ba.__esModule)return ba;var gg=Object.create(null);if(_r.r(gg),Object.defineProperty(gg,"default",{enumerable:!0,value:ba}),2&_h&&"string"!=typeof ba)for(var oy in ba)_r.d(gg,oy,function(uy){return ba[uy]}.bind(null,oy));return gg},_r.n=function(ba){var _h=ba&&ba.__esModule?function(){return ba.default}:function(){return ba};return _r.d(_h,"a",_h),_h},_r.o=function(ba,_h){return Object.prototype.hasOwnProperty.call(ba,_h)},_r.p="",_r(_r.s=0))}(c0={exports:{}});var HE=(R0=c0=c0.exports)&&R0.__esModule&&Object.prototype.hasOwnProperty.call(R0,"default")?R0.default:R0,X2=_u(function _d(gg){var Ni=void 0===(Ni=gg.addressList)?[]:Ni,ga=void 0===(ga=gg.geometries)?[]:ga,ba=void 0===(ba=gg.entity)?null:ba,_h=void 0===(_h=gg.name)?"":_h;gg=void 0===(gg=gg.icon)?"":gg,_e(this,_d),this.addressList=Ni,this.geometries=ga,this.icon=gg,this.entity=ba,this.name=_h}),ZR={keys:[{name:"name",weight:.6},{name:"addressList",weight:.4}],threshold:.2},sI=function(){function _d(_r){_e(this,_d),this.fuseSearch=null,this.levels_=null,this.searchListEntities_=[],this.searchListIcons_=[],this.searchList_=[],this.venueModel=_r,this.init()}return _u(_d,[{key:"init",value:function(){var _r=this.venueModel.getGeometries().reduce(function(Ni,ga){return Ni[ga.getId()]=ga,Ni},{});this.initEntityList(this.venueModel.getOccupant()),this.initIconList(_r),this.levels_=this.venueModel.getLevels().map(function(Ni){return{levelId:Ni.getId(),levelName:Ni.getName(),drawingId:Ni.getDrawing().getId(),drawingName:Ni.getDrawing().getName()}}),_r=[].concat(K0(this.searchListEntities_),K0(this.searchListIcons_)),this.searchList_=_r.sort(function(Ni,ga){return Ni.name.localeCompare(ga.name)}),this.fuseSearch_=new HE(this.searchList_,ZR)}},{key:"initEntityList",value:function(){var _r=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(Ni){return Ni.spaceIds?new X2({geometries:Ni.space,addressList:Ni.spaceIds||[],name:Ni.properties.name||"",entity:Ni}):null}).filter(function(Ni){return null!==Ni});this.searchListEntities_=_r}},{key:"initIconList",value:function(){this.searchListIcons_=Object.values(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).filter(function(_r){return _r.isIcon()}).map(function(_r){var Ni=_r.getIcon();return new X2({geometries:[_r],icon:Ni,name:_r.properties.name||""})})}},{key:"all",value:function(){return this.searchList_}},{key:"allIconTypes",value:function(){var _r=this.searchListIcons_.reduce(function(Ni,ga){return Ni[ga.name]=ga.name,Ni},{});return Object.keys(_r)}},{key:"find",value:function(){var _r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return""===_r?this.searchList_:this.fuseSearch_.search(_r)}}]),_d}(),aT=Object.freeze({SITE:"SITE",IMAGES:"IMAGES",THEME:"THEME"}),xC="indoor.Site",aI="indoor.Occupant",uI="indoor.Space",J2="Address",EC="indoor.Level",Q2="indoor.Entrance",TC="SPACE_TYPE_NAME",AC="SPACE_CATEGORY_NAME",CC="Point",$1="LineString",tD="Polygon",eD="MultiPoint",nD="MultiLineString",rD="MultiPolygon",uT=Object.freeze({STANDARD:"STANDARD",FLATTEN:"FLATTEN",OUTDOOR_MAIN:"OUTDOOR_MAIN",INDOOR_MAIN:"INDOOR_MAIN",NO_OUTDOORS:"NO_OUTDOORS",FLATTEN_INDOOR_MAIN:"FLATTEN_INDOOR_MAIN",FLATTEN_OUTDOOR_COPY:"FLATTEN_OUTDOOR_COPY"}),yS="9999999999999",mS="https://interactive.data.api.platform.here.com/interactive/v1/catalogs",R0=Object.freeze({THEME:"THEME",THEME_MAP:"THEME_MAP",PRESETS:"PRESETS",SDK_STRINGS:"SDK_STRINGS",ICON_FILE:"ICON_FILE",INPUT_COLORS:"INPUT_COLORS",BASE_MAP_INFO:"BASE_MAP_INFO",CONFIG_PROFILE:"CONFIG_PROFILE",NAV_THEME:"NAV_THEME",NAV_NAME_THEME:"NAV_NAME_THEME",NAV_PROP_MAP:"NAV_PROP_MAP",NAV_STRINGS:"NAV_STRINGS",NAV_THEME_MAP:"NAV_THEME_MAP",NAV_NAME_THEME_MAP:"NAV_NAME_THEME_MAP",V4_THEME_FAMILY:"V4_THEME_FAMILY",V4_MAPTYPE_THEME:"V4_MAPTYPE_THEME",ICON:"ICON",MARKER:"MARKER",PERMISSIONS:"PERMISSIONS",NAICS_ARRAY:"NAICS_ARRAY",NAICS_MAP:"NAICS_MAP"}),s1=(Object.freeze((pd(c0={},R0.THEME,"themeUrls"),pd(c0,R0.THEME_MAP,"themeMapUrl"),pd(c0,R0.PRESETS,"presetsUrl"),pd(c0,R0.SDK_STRINGS,"stringsUrl"),c0)),Object.freeze((pd(c0={},R0.THEME,"themeOverrides"),pd(c0,R0.THEME_MAP,"themeMapOverrides"),pd(c0,R0.PRESETS,"presetOverrides"),pd(c0,R0.SDK_STRINGS,"stringsOverrides"),pd(c0,R0.INPUT_COLORS,"inputColorOverrides"),c0)),Object.freeze((pd(c0={},R0.THEME,["Modern","Standard","Factory","Navteq","TheBase","Westfield_noLabels","Westfield","TDM_noLabel"]),pd(c0,R0.SDK_STRINGS,["Standard","SDK","sdk/standard"]),pd(c0,R0.V4_THEME_FAMILY,["modern","standard"]),pd(c0,R0.V4_MAPTYPE_THEME,["Airport Terminal","Airport","Casino","College Building","College Campus","Convention","General","Hospital","Outdoor","Retail","School Building","School Campus","Shopping Mall","Traffic","Train Station"]),pd(c0,R0.NAV_THEME,["Factory","MapEditor"]),pd(c0,R0.ICON,["Multicolor","Standard","TheBase","Factory"]),c0)),Object.freeze((pd(c0={},R0.THEME,"Modern"),pd(c0,R0.THEME_MAP,"Standard"),pd(c0,R0.PRESETS,"Standard"),pd(c0,R0.SDK_STRINGS,"Standard"),pd(c0,R0.ICON_FILE,"Standard"),pd(c0,R0.INPUT_COLORS,"Standard"),pd(c0,R0.BASE_MAP_INFO,"Standard"),pd(c0,R0.CONFIG_PROFILE,"factory"),pd(c0,R0.NAV_THEME,"Factory"),pd(c0,R0.NAV_NAME_THEME,"FactoryName"),pd(c0,R0.NAV_PROP_MAP,"Standard"),pd(c0,R0.NAV_STRINGS,"Standard"),pd(c0,R0.NAV_THEME_MAP,"Standard"),pd(c0,R0.NAV_NAME_THEME_MAP,"StandardName"),pd(c0,R0.V4_THEME_FAMILY,"Standard"),pd(c0,R0.V4_MAPTYPE_THEME,"Standard"),pd(c0,R0.ICON,"Multicolor"),pd(c0,R0.MARKER,"Standard"),c0)),R0=Object.freeze({GEO_JSON:"GEO_JSON",V5_MAP:"V5_MAP",V5_NAV:"V5_NAV",V5_INFO:"V5_INFO",KML:"KML",SVG:"SVG",PNG:"PNG"}),Object.freeze(pd({},R0.GEO_JSON,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_ENTITY:"COMMUNITY_ENTITY",PATH_LEVEL_GEOMETRY:"PATH_LEVEL_GEOMETRY",GEOJSON_LEVEL_GEOMETRY:"GEOJSON_LEVEL_GEOMETRY"})),Object.freeze({ACCOUNT_API:"ACCOUNT_API",DEFAULT_COLLECTION:"DEFAULT_COLLECTION"})),UE=Object.freeze((pd(c0={},s1.ACCOUNT_API,{BASE_URL:"https://account.api.here.com/authorization/v1.1/projects/me"}),pd(c0,s1.DEFAULT_COLLECTION,{BASE_URL:"https://config.data.api.platform.here.com/config/v1/catalogs",PARAMS:{CREATED_BY:"created",COLLECTION:"-collection"}}),c0)),dE=Object.freeze({isIconsEnabled:!0,isMetaEnabled:!0,metaOptions:{},iconOptions:{}});function SE(){}function $_(){$_.init.call(this)}function iD(_d){return void 0===_d._maxListeners?$_.defaultMaxListeners:_d._maxListeners}function DC(_d,_r,Ni,ga){var ba,_h;if("function"!=typeof Ni)throw new TypeError('"listener" argument must be a function');return(ba=_d._events)?(ba.newListener&&(_d.emit("newListener",_r,Ni.listener||Ni),ba=_d._events),_h=ba[_r]):(ba=_d._events=new SE,_d._eventsCount=0),_h?("function"==typeof _h?_h=ba[_r]=ga?[Ni,_h]:[_h,Ni]:ga?_h.unshift(Ni):_h.push(Ni),_h.warned||(ga=iD(_d))&&0<ga&&_h.length>ga&&(_h.warned=!0,(ga=new Error("Possible EventEmitter memory leak detected. "+_h.length+" "+_r+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",ga.emitter=_d,ga.type=_r,ga.count=_h.length,"function"==typeof console.warn?console.warn(ga):console.log(ga))):(_h=ba[_r]=Ni,++_d._eventsCount),_d}function SC(_d,_r,Ni){var ga=!1;function ba(){_d.removeListener(_r,ba),ga||(ga=!0,Ni.apply(_d,arguments))}return ba.listener=Ni,ba}function GE(_d){var _r=this._events;if(_r){if("function"==typeof(_r=_r[_d]))return 1;if(_r)return _r.length}return 0}function qT(_d,_r){for(var Ni=new Array(_r);_r--;)Ni[_r]=_d[_r];return Ni}function MC(_d,_r,Ni){return Ni===CA.ObjectType.SEGMENT_START_MARKER?0===_d?dI:null:Ni===CA.ObjectType.SEGMENT_FINISH_MARKER?1===_r.length||_d===_r.length-1?gI:null:"indoor"===_r[_d].departure.place.type?JR:QR}SE.prototype=Object.create(null),($_.EventEmitter=$_).usingDomains=!1,$_.prototype.domain=void 0,$_.prototype._events=void 0,$_.prototype._maxListeners=void 0,$_.defaultMaxListeners=10,$_.init=function(){this.domain=null,$_.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new SE,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$_.prototype.setMaxListeners=function(_d){if("number"!=typeof _d||_d<0||isNaN(_d))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=_d,this},$_.prototype.getMaxListeners=function(){return iD(this)},$_.prototype.emit=function(_d){var _r,Ni,ga,ba="error"===_d,_h=this._events;if(_h)ba=ba&&null==_h.error;else if(!ba)return!1;if(gg=this.domain,ba){var gg;if(ba=arguments[1],gg)return(ba=ba||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,ba.domain=gg,ba.domainThrown=!1,gg.emit("error",ba),!1;throw ba instanceof Error?ba:((gg=new Error('Uncaught, unspecified "error" event. ('+ba+")")).context=ba,gg)}if(!(_r=_h[_d]))return!1;var oy,uy="function"==typeof _r;switch(oy=arguments.length){case 1:var s0=_r,cy=this;if(e0=uy)s0.call(cy);else for(var vy=s0.length,Ty=qT(s0,vy),Ay=0;Ay<vy;++Ay)Ty[Ay].call(cy);break;case 2:var e0=_r,ky=this,u0=arguments[1];if(s0=uy)e0.call(ky,u0);else for(var t0=e0.length,Fy=qT(e0,t0),jy=0;jy<t0;++jy)Fy[jy].call(ky,u0);break;case 3:var g0=_r,By=this,qy=arguments[1],h0=arguments[2];if(Gy=uy)g0.call(By,qy,h0);else for(var Ly=g0.length,Qy=qT(g0,Ly),n0=0;n0<Ly;++n0)Qy[n0].call(By,qy,h0);break;case 4:var Gy=_r,N0=this,w0=arguments[1],E0=arguments[2],u_=arguments[3];if(g0=uy)Gy.call(N0,w0,E0,u_);else for(var __=Gy.length,b_=qT(Gy,__),U_=0;U_<__;++U_)b_[U_].call(N0,w0,E0,u_);break;default:for(Ni=new Array(oy-1),ga=1;ga<oy;ga++)Ni[ga-1]=arguments[ga];var V0=_r,q0=uy,a1=this,B0=Ni;if(q0)V0.apply(a1,B0);else for(var M1=V0.length,KT=qT(V0,M1),$x=0;$x<M1;++$x)KT[$x].apply(a1,B0)}return!0},$_.prototype.on=$_.prototype.addListener=function(_d,_r){return DC(this,_d,_r,!1)},$_.prototype.prependListener=function(_d,_r){return DC(this,_d,_r,!0)},$_.prototype.once=function(_d,_r){if("function"!=typeof _r)throw new TypeError('"listener" argument must be a function');return this.on(_d,SC(this,_d,_r)),this},$_.prototype.prependOnceListener=function(_d,_r){if("function"!=typeof _r)throw new TypeError('"listener" argument must be a function');return this.prependListener(_d,SC(this,_d,_r)),this},$_.prototype.removeListener=function(_d,_r){var Ni,ga,ba,_h,gg;if("function"!=typeof _r)throw new TypeError('"listener" argument must be a function');if((ga=this._events)&&(Ni=ga[_d]))if(Ni===_r||Ni.listener&&Ni.listener===_r)0==--this._eventsCount?this._events=new SE:(delete ga[_d],ga.removeListener&&this.emit("removeListener",_d,Ni.listener||_r));else if("function"!=typeof Ni){for(ba=-1,_h=Ni.length;0<_h--;)if(Ni[_h]===_r||Ni[_h].listener&&Ni[_h].listener===_r){gg=Ni[_h].listener,ba=_h;break}if(ba<0)return this;if(1===Ni.length){if(Ni[0]=void 0,0==--this._eventsCount)return this._events=new SE,this;delete ga[_d]}else{for(var oy=Ni,uy=ba,cy=uy+1,vy=oy.length;cy<vy;uy+=1,cy+=1)oy[uy]=oy[cy];oy.pop()}ga.removeListener&&this.emit("removeListener",_d,gg||_r)}return this},$_.prototype.removeAllListeners=function(_d){var _r,Ni=this._events;if(Ni){if(!Ni.removeListener)return 0===arguments.length?(this._events=new SE,this._eventsCount=0):Ni[_d]&&(0==--this._eventsCount?this._events=new SE:delete Ni[_d]),this;if(0===arguments.length){for(var ga,ba=Object.keys(Ni),_h=0;_h<ba.length;++_h)"removeListener"!==(ga=ba[_h])&&this.removeAllListeners(ga);return this.removeAllListeners("removeListener"),this._events=new SE,this._eventsCount=0,this}if("function"==typeof(_r=Ni[_d]))this.removeListener(_d,_r);else if(_r)for(;this.removeListener(_d,_r[_r.length-1]),_r[0];);}return this},$_.prototype.listeners=function(Ni){var _r=this._events;return _r&&(_r=_r[Ni])?"function"==typeof _r?[_r.listener||_r]:function(ga){for(var ba=new Array(ga.length),_h=0;_h<ba.length;++_h)ba[_h]=ga[_h].listener||ga[_h];return ba}(_r):[]},$_.listenerCount=function(_d,_r){return"function"==typeof _d.listenerCount?_d.listenerCount(_r):GE.call(_d,_r)},$_.prototype.listenerCount=GE,$_.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var qE="venues-ui-button--active",WT="venues-ui-button",IC="venues-ui__drawings",vS="data-drawing",fI=function(){function _d(_r,Ni,gg){var ba=this,_h=(_e(this,_d),this.clickHandler=gg,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("class",IC),document.createElement("div"));(_h.setAttribute("class","trigger ".concat(WT)),gg=document.createElement("div")).setAttribute("class","arrow arrow--down"),_h.appendChild(gg),_h.addEventListener("click",function(){_h.classList.toggle(qE),ba.containerButtons.classList.toggle("drawings--open")}),this.containerDiv.appendChild(_h),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","drawings"),this.containerDiv.appendChild(this.containerButtons),Ni&&this.update(Ni),_r.appendChild(this.containerDiv)}return _u(_d,[{key:"drawButton",value:function(_r,Ni,gg){var ba=this,_h=document.createElement("div");gg=Number(gg)===Number(_r),_h.setAttribute("class",gg?"".concat(WT," ").concat(qE):WT),_h.innerHTML=Ni,_h.setAttribute(vS,_r),_h.addEventListener("click",function(){ba.switch(_r),ba.clickHandler(_r)}),this.containerButtons.appendChild(_h)}},{key:"switch",value:function(_r){this.containerButtons.querySelectorAll(".".concat(IC," .").concat(qE)).forEach(function(Ni){return Ni.setAttribute("class",WT)}),(_r=this.containerButtons.querySelector("[".concat(vS,"='").concat(_r,"']")))&&_r.setAttribute("class","".concat(WT," ").concat(qE))}},{key:"update",value:function(_r){var ba,Ni=this,ga=(this.containerButtons.innerHTML="",ba=(ba=_r).getDrawings(),new Map(ba.map(function(_h){var gg=_h.getDisplayName()||_h.getName();return[_h.getId(),gg]})));0<ga.size&&ga.forEach(function(ba,_h){return Ni.drawButton(_h,ba,_r.getRootDrawing().getId())})}}]),_d}(),kC="venues-ui-button--active",ME="venues-ui-button",oD="data-level",Z_="venues-ui__levels",pI=function(){function _d(_r,Ni,ga,ba){var _h=4<arguments.length&&void 0!==arguments[4]?arguments[4]:4;_e(this,_d),this.clickHandler=ba,this.levelButtonCount=_h,this.currentScrollIndex=0,this.containerUI=document.createElement("div"),this.containerUI.setAttribute("class","".concat(Z_)),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","levels"),this.containerUI.appendChild(this.containerButtons),Ni&&this.update(Ni,ga),_r.appendChild(this.containerUI)}return _u(_d,[{key:"clear",value:function(){this.containerButtons.innerHTML="",this.buttonScrollUp&&(this.containerUI.removeChild(this.buttonScrollUp),this.buttonScrollUp=null),this.buttonScrollDown&&(this.containerUI.removeChild(this.buttonScrollDown),this.buttonScrollDown=null)}},{key:"drawLevelButton",value:function(_r,Ni){var ga=this,ba=document.createElement("div");ba.innerHTML=Ni,ba.style.fontSize="".concat(Math.max(Math.min(28.8/Ni.length,11.52),10),"px"),ba.style.display="block",ba.setAttribute("class",ME),ba.setAttribute(oD,_r),ba.addEventListener("click",function(){ga.switch(_r),ga.clickHandler(_r)}),this.containerButtons.appendChild(ba)}},{key:"drawScrollButtons",value:function(){var Ni,_r=this;((this.buttonScrollUp=document.createElement("div"),this.buttonScrollUp.setAttribute("class","".concat(ME," ").concat(ME,"--up")),Ni=document.createElement("div")).setAttribute("class","arrow arrow--up"),this.buttonScrollUp.appendChild(Ni),this.buttonScrollUp.addEventListener("click",function(){return _r.scroll(1)}),this.containerUI.insertBefore(this.buttonScrollUp,this.containerButtons),this.buttonScrollDown=document.createElement("div"),this.buttonScrollDown.setAttribute("class","".concat(ME," ").concat(ME,"--down")),Ni=document.createElement("div")).setAttribute("class","arrow arrow--down"),this.buttonScrollDown.appendChild(Ni),this.buttonScrollDown.addEventListener("click",function(){return _r.scroll(-1)}),this.containerUI.appendChild(this.buttonScrollDown)}},{key:"scroll",value:function(){var _r,Ni,ga=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,ba=Array.from(this.containerButtons.querySelectorAll(".".concat(ME))).reverse(),_h=[];0<=ga?(this.currentScrollIndex=Math.min(this.currentScrollIndex+ga,ba.length-this.levelButtonCount),_r=Math.min(this.currentScrollIndex,ba.length-this.levelButtonCount),Ni=Math.min(this.currentScrollIndex+this.levelButtonCount,ba.length),_h=ba.slice(_r,Ni)):ga<0&&(this.currentScrollIndex=Math.max(this.currentScrollIndex+ga,0),_r=Math.max(0,this.currentScrollIndex),Ni=Math.min(ba.length,this.currentScrollIndex+this.levelButtonCount),_h=ba.slice(_r,Ni)),ba.forEach(function(gg){gg.style.display=-1!==_h.indexOf(gg)?"block":"none"}),this.buttonScrollDown&&(0===this.currentScrollIndex?this.buttonScrollDown.setAttribute("disabled","disabled"):this.buttonScrollDown.removeAttribute("disabled")),this.buttonScrollUp&&(this.currentScrollIndex===ba.length-this.levelButtonCount?this.buttonScrollUp.setAttribute("disabled","disabled"):this.buttonScrollUp.removeAttribute("disabled"))}},{key:"switch",value:function(ga){var Ni;this.containerButtons.querySelectorAll(".".concat(kC)).forEach(function(ba){return ba.setAttribute("class",ME)}),(ga=this.containerButtons.querySelector(".".concat(Z_," [").concat(oD,"='").concat(ga,"']")))&&(Ni=Array.from(this.containerButtons.querySelectorAll(".".concat(ME))).reverse(),ga.setAttribute("class","".concat(ME," ").concat(kC)),((Ni=Ni.indexOf(ga))<this.currentScrollIndex||Ni>=this.currentScrollIndex+4)&&this.scroll(Ni-this.currentScrollIndex))}},{key:"update",value:function(_r,_h){var ga,ba=this,gg=(_h=function(){return new Map((0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(oy){return[oy.getZIndex(),oy.getShortName()||oy.getDisplayName()||oy.getName()]}))}((ga=_r,(_h===uT.FLATTEN?(_h=ga.getVenueModel().getLevelMapFlattenedByZIndex_(),Object.values(_h).map(function(oy){return oy[0]})):ga.getLevels()).sort(function(oy,uy){return uy.getZIndex()-oy.getZIndex()}))),_r.getMainLevel().getZIndex());this.clear(),_h.forEach(function(oy,uy){return ba.drawLevelButton(uy,oy)}),_h.size>this.levelButtonCount&&(this.currentScrollIndex=_h.size>this.levelButtonCount+1?Math.min(Array.from(_h).reverse().findIndex(function(oy){return oy[0]===gg}),_h.size-this.levelButtonCount):0,this.drawScrollButtons(),this.scroll(0)),this.switch(gg)}}]),_d}(),OC=function(){function _d(_r,Ni){_e(this,_d),this.baseTheme=_r,this.metaInformation=Ni,this.labelStyleMap={},this.styleMap={},this.setStyleMap()}return _u(_d,[{key:"setStyleMap",value:function(){this.styleMap.ENTRANCE=this.baseTheme.entranceRules.default.styleProperties,this.labelStyleMap.ENTRANCE=this.baseTheme.entranceRules.default.textLabelStyleProperties;for(var _r=0,Ni=Object.entries(this.baseTheme.spaceRules);_r<Ni.length;_r++){var ba,ga=(ba=Oy(Ni[_r],2))[0],_h=(ba=ba[1]).properties.behavioralAppearance.default.styleProperties,gg=ba.properties.behavioralAppearance.default.textLabelStyleProperties;if(this.styleMap[ga]=_h,this.labelStyleMap[ga]=gg,ba.spaceTypes)for(var oy=0,uy=Object.entries(ba.spaceTypes);oy<uy.length;oy++){var cy=(Ty=Oy(uy[oy],2))[0],vy=(Ty=Ty[1]).behavioralAppearance.default.styleProperties,Ty=Ty.behavioralAppearance.default.textLabelStyleProperties;this.styleMap["".concat(ga,"_").concat(cy)]=vy&&0!==Object.keys(vy)?vy:_h,this.labelStyleMap["".concat(ga,"_").concat(cy)]=Ty&&0!==Object.keys(Ty)?Ty:gg}}}},{key:"getBaseTheme",value:function(){return this.baseTheme}},{key:"getStyleMap",value:function(){return this.styleMap}},{key:"getGeometryStyle",value:function(_r){return this.styleMap&&Object.getOwnPropertyNames(this.styleMap)?this.styleMap[_r]:null}},{key:"getLabelStyle",value:function(_r){return this.labelStyleMap&&Object.getOwnPropertyNames(this.labelStyleMap)?this.labelStyleMap[_r]:null}}],[{key:"getGeometryDefaultStyle",value:function(){return{fill:"#e5e5e5",fillOpacity:1,stroke:"#6c7a89",strokeOpacity:1,strokeWidth:2}}},{key:"getLabelDefaultStyle",value:function(){return{stroke:"#6c7a89",zmin:15}}}]),_d}(),WE=function(){function _d(){_e(this,_d),this.config=Object.seal({emitEventOnOverrideUpdate:!0}),this.imageCache={},this.releaseSettings_={displayOptions:{},mom:[]},this.theme={}}return _u(_d,[{key:"getMomData",value:function(){return this.releaseSettings_.mom}},{key:"getTheme",value:function(){return this.theme||{}}},{key:"getStyle",value:function(gg){var Ni=1<arguments.length&&void 0!==arguments[1]&&arguments[1],ga=this.getTheme(),ba=OC.getGeometryDefaultStyle(),_h=gg.properties.spaceType,oy=gg=gg.properties.spaceCategory;return _h&&(oy="".concat(gg,"_").concat(_h)),{m:(gg=(gg=ga.getGeometryStyle(oy))&&!Ni?gg:ba).fill&&gg.fill.toLowerCase()||"#fff",w:gg.strokeWidth/10||.1,o:gg.stroke&&gg.stroke.toLowerCase()||"#fff",l:"Dark"}}},{key:"getLabelStyle",value:function(_r){this.getTheme();var Ni=OC.getLabelDefaultStyle();return{fill:Ni.stroke,zmin:Ni.zmin}}}]),_d}(),E_=Math.PI/180,$T=180/Math.PI,l_=function(){function _d(){_e(this,_d)}return _u(_d,null,[{key:"toRadians",value:function(_r){return _r*E_}},{key:"toDegrees",value:function(_r){return _r*$T}},{key:"getBoundingBox",value:function(_r,Ni){var ga=[];switch(_r){case CC:ga=[Ni,Ni];break;case eD:case $1:ga=Ni;break;case nD:case tD:ga=Ni.reduce(function(ba,_h){return ba.concat(_h)},[]);break;case rD:ga=Ni.reduce(function(ba,_h){return ba.concat(_h)},[]).reduce(function(ba,_h){return ba.concat(_h)},[])}return _d.getBoundingBoxVertices(ga)}},{key:"getInverseTransform",value:function(_r){var Ni;return(Ni=[_r[3]/(Ni=_r[0]*_r[3]-_r[1]*_r[2]),-_r[1]/Ni,-_r[2]/Ni,_r[0]/Ni,0,0])[4]=-(Ni[0]*_r[4]+Ni[2]*_r[5]),Ni[5]=-(Ni[1]*_r[4]+Ni[3]*_r[5]),Ni}},{key:"applyTransformToPoint",value:function(_r,Ni){return[Ni[0]*_r[0]+Ni[1]*_r[2]+_r[4],Ni[0]*_r[1]+Ni[1]*_r[3]+_r[5]]}},{key:"transformProduct",value:function(_r,Ni){var ga=[0,0,0,0,0,0];return ga[0]=Ni[0]*_r[0]+Ni[2]*_r[1],ga[1]=Ni[1]*_r[0]+Ni[3]*_r[1],ga[2]=Ni[0]*_r[2]+Ni[2]*_r[3],ga[3]=Ni[1]*_r[2]+Ni[3]*_r[3],ga[4]=Ni[0]*_r[4]+Ni[2]*_r[5]+Ni[4],ga[5]=Ni[1]*_r[4]+Ni[3]*_r[5]+Ni[5],ga}},{key:"convertLonLatToMerc",value:function(ga){var Ni=ga[0]*E_;return ga=ga[1]*E_,ga=Math.sin(ga),[.5+Ni/(2*Math.PI),.5-Math.log((1+ga)/(1-ga))/(4*Math.PI)]}},{key:"convertMercToLatLon",value:function(ga){var Ni=2*Math.PI*(ga[0]-.5);return ga=Math.atan(Math.sinh(2*Math.PI*(.5-ga[1]))),[Ni/E_,ga/E_]}},{key:"getTransformScale",value:function(_r){return Math.sqrt(_r[0]*_r[3]-_r[1]*_r[2])}},{key:"getLonLatToMercTransform",value:function(ba){var Ni=[.002777777777777778,0,0,-1/(360*Math.cos(ba[1]*E_)),0,0],ga=_d.applyTransformToPoint(Ni,ba);return ba=_d.convertLonLatToMerc(ba),Ni[4]=ba[0]-ga[0],Ni[5]=ba[1]-ga[1],Ni}},{key:"getNatToMercTransform",value:function(_r){var Ni=_d.getLonLatToMercTransform(Ni=[_r[4],_r[5]]);return _d.transformProduct(_r,Ni)}},{key:"convertMxMy2LonLat",value:function(_r,Ni){return _r.length&&Ni.length?_d.applyTransformToPoint(_r,Ni):[]}},{key:"convertLonLat2MxMy",value:function(_r,Ni){return _r.length&&Ni.length?(_r=_d.getInverseTransform(_r),_d.applyTransformToPoint(_r,Ni)):[]}},{key:"getFlattenedQuadraticBezierCurve",value:function(_r,Ni,ga){var ba=[],_h=3<arguments.length&&void 0!==arguments[3]?arguments[3]:10;_h<1&&(_h=6);for(var gg=0;gg<=_h;gg+=1){var uy,vy,oy=2*(uy=gg/_h)*(1-uy),cy=(vy=(1-uy)*(1-uy))*_r[0]+oy*Ni[0]+(uy*=uy)*ga[0];ba.push([cy,vy=vy*_r[1]+oy*Ni[1]+uy*ga[1]])}return ba}},{key:"getFlattenedCubicBezierCurve",value:function(_r,Ni,ga,ba){var _h=[],gg=4<arguments.length&&void 0!==arguments[4]?arguments[4]:10;gg<1&&(gg=6);for(var oy=0;oy<=gg;oy+=1){var vy,Ay,uy=3*(vy=oy/gg)*(1-vy)*(1-vy),cy=3*vy*vy*(1-vy),Ty=(Ay=(1-vy)*(1-vy)*(1-vy))*_r[0]+uy*Ni[0]+cy*ga[0]+(vy*=vy*vy)*ba[0];_h.push([Ty,Ay=Ay*_r[1]+uy*Ni[1]+cy*ga[1]+vy*ba[1]])}return _h}},{key:"getRectangularCoordinatesOfLabelArea",value:function(vy,Ni){var ga=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],ba=(uy=Oy(vy,6))[0],_h=uy[1],gg=uy[2],oy=uy[3],uy=uy[5],cy=_d.getDeltaLonLatForMeterAtGivenLonLat(ba,_h);return vy=vy[4],ga?(uy&&(vy*=-1),null!=Ni&&(vy=(vy+=Ni<0?2*Math.PI+Ni:Ni)<0?2*Math.PI+vy:vy)):vy=0,_d.getRectVerticesFromSignatureRectRepresentation([ba,_h],{xLength:gg,yLength:oy},vy,cy)}},{key:"getRotatedPoint",value:function(uy,gg){var ga=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],ba=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[0,0],_h=Math.cos(gg),oy=(gg=Math.sin(gg),uy[0]-ba[0]),cy=(uy=uy[1]-ba[1],[]);return[(cy=ga?[oy*_h+uy*gg,uy*_h-oy*gg]:[oy*_h-uy*gg,uy*_h+oy*gg])[0]+ba[0],cy[1]+ba[1]]}},{key:"getRectVerticesFromSignatureRectRepresentation",value:function(Ay,gg,ga,ba){var _h=gg.xLength,oy=(gg=gg.yLength,!(4<arguments.length&&void 0!==arguments[4])||arguments[4]),uy=(Ay=Oy(Ay,2))[0],cy=Ay[1],vy=_h/2,Ty=gg/2,e0=(Ay=Oy(ba,2))[0],s0=Ay[1];return[[1,1],[-1,1],[-1,-1],[1,-1]].map(function(ky){return[ky[0]*vy,ky[1]*Ty]}).map(function(ky){return _d.getRotatedPoint(ky,ga,oy)}).map(function(ky){return[ky[0]*e0,ky[1]*s0]}).map(function(ky){return[ky[0]+uy,ky[1]+cy]})}},{key:"getScaleFactorForRectInSpace",value:function(_r,Ni,ga,ba){return _r/=ga,(ga=Ni/ba)<_r?ga:_r}},{key:"getDeltaLonLatForMeterAtGivenLonLat",value:function(_r,Ni){return[1/6371e3*(180/Math.PI)/Math.cos(Ni*Math.PI/180),1/6371e3*(180/Math.PI)]}},{key:"getBoundingBoxVertices",value:function(){var _r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],Ni=[[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]];return _r.reduce(function(ga,ba){return[[Math.min(ba[0],ga[0][0]),Math.min(ba[1],ga[0][1])],[Math.max(ba[0],ga[1][0]),Math.max(ba[1],ga[1][1])]]},Ni)}},{key:"isPointInBoundingBox",value:function(_r,Ni){var ga,ba,_h,gg;if(_r&&Ni)return ga=(_r=Oy(_r,2))[0],_r=_r[1],Ni=Oy(Ni,2),ba=(_h=Oy(Ni[0],2))[0],_h=_h[1],gg=(Ni=Oy(Ni[1],2))[0],Ni=Ni[1],ga<=gg&&ba<=ga&&_r<=Ni&&_h<=_r}},{key:"isPointOnLineSegment",value:function(_h,oy,cy){var ba=(_h=Oy(_h,2))[0],gg=(_h=_h[1],(oy=Oy(oy,2))[0]),uy=(oy=oy[1],(cy=Oy(cy,2))[0]),vy=(oy-_h)*((cy=cy[1])-_h)<=0;return gg===uy?gg===ba&&vy:_h-cy==(cy-oy)/(uy-gg)*(ba-uy)&&vy}},{key:"rayIntersectLineSegment",value:function(_h,oy,cy){var ba=(_h=Oy(_h,2))[0],gg=(_h=_h[1],(oy=Oy(oy,2))[0]),uy=(oy=oy[1],(cy=Oy(cy,2))[0]);return cy=cy[1],gg!==uy&&0<=(ba=(ba-gg)/(uy-gg))&&ba<1&&_h<(cy-oy)*ba+oy}},{key:"isPointInPolygon",value:function(_h,Ni){var ga=(_h=Oy(_h,2))[0],ba=_h[1];if((_h=Ni.length)<3)return!1;var gg=0,oy=Ni[_h-1];return Ni.forEach(function(uy){_d.rayIntersectLineSegment([ga,ba],oy,uy)&&(gg+=1),oy=uy}),gg%2!=0}},{key:"isPointOnLineString",value:function(ga,Ni){var ba=(ga=Oy(ga,2))[0],_h=ga[1],gg=Ni.length;if(!(gg<2))for(var oy=Ni[gg-1],uy=0;uy<gg;uy+=1){if(_d.isPointOnLineSegment([ba,_h],oy,Ni[uy]))return!0;oy=Ni[uy]}return!1}},{key:"getAreaOfPolygon",value:function(_r){var Ni=_r.length;if(Ni<3)return null;var ga=0,ba=_r[Ni-1];return _r.forEach(function(_h){var gg,oy,uy;ga+=.5*(oy=_h,uy=(gg=Oy(gg=ba,2))[0],gg=gg[1],uy*(oy=Oy(oy,2))[1]-gg*oy[0]),ba=_h}),ga}},{key:"getDistanceBetweenPoints",value:function(_h,ga){var ba=(_h=Oy(_h,2))[0];return _h=_h[1],ba-=(ga=Oy(ga,2))[0],_h-=ga[1],Math.sqrt(ba*ba+_h*_h)}}]),_d}(),TA=function(){function _d(){_e(this,_d),this.spaceRules={}}return _u(_d,null,[{key:"getDataEntriesOne",value:function(ba,Ni){var ga;return ba=[ba,""],null!==Ni&&Array.isArray(Ni)?ba[1]=Ni.toString():null!==Ni&&"object"===k(Ni)?0<(ga=Object.entries(Ni)).length&&(ga=this.getDataEntriesOne(ga[0][0],ga[0][1]),ba[0]="".concat(ba[0],".").concat(ga[0]),ba[1]=ga[1]):ba[1]=Ni,ba}},{key:"getDataEntriesAll",value:function(_r){for(var Ni=[],ga=0,ba=Object.entries(_r);ga<ba.length;ga++){var _h=Oy(ba[ga],2),gg=this.getDataEntriesOne(gg=_h[0],_h=_h[1]);Ni.push(gg)}return Ni}},{key:"doFindComboMatch",value:function(_r,Ni){var ga="";if(_r&&_r.configuration&&_r.configuration.combinations)for(var ba=this.getDataEntriesAll(Ni),_h=(Ni=Object.entries(_r.configuration.combinations),0),gg=0,oy=Ni;gg<oy.length;gg++)!function(){var cy=oy[gg],vy=Object.keys(cy[1]).filter(function(Ty){return ba.some(function(Ay){return Ty===Ay[0]&&cy[1][Ty]===Ay[1]})});vy.length===Object.keys(cy[1]).length&&vy.length>_h&&(ga=cy[0],_h=vy.length)}();return ga}},{key:"getIconFromCombinations",value:function(_r,Ni){if(_r&&_r.configuration.combinations&&Ni&&0<Object.keys(Ni).length&&_r.behavioralAppearance.combinations&&0<Object.keys(_r.behavioralAppearance.combinations).length){if(""===(Ni=this.doFindComboMatch(_r,Ni))||!_r.behavioralAppearance.combinations[Ni].labelIcon)return"";if(_r.behavioralAppearance.combinations&&_r.behavioralAppearance.combinations[Ni]&&_r.behavioralAppearance.combinations[Ni].labelIcon)return _r.behavioralAppearance.combinations[Ni].labelIcon.referenceUri}return""}},{key:"findSpace",value:function(_r,Ni){if(Ni.spaceTypes&&Ni.spaceTypes[_r])return Ni.spaceTypes[_r]}},{key:"findCategory",value:function(_r){if(this.spaceRules[_r])return this.spaceRules[_r]}},{key:"setSpaceRules",value:function(_r){this.spaceRules=_r}},{key:"getSpaceIcon",value:function(_r,gg,ga){var ba,_h="";return(gg=this.findCategory(gg))&&(_r=this.findSpace(_r,gg))&&(ba="",(ba=ga?this.getIconFromCombinations(_r,ga):ba)&&""!==ba?_h=ba:_r.behavioralAppearance.default.labelIcon?_h=_r.behavioralAppearance.default.labelIcon.referenceUri:gg.properties.behavioralAppearance.default.labelIcon&&(_h=gg.properties.behavioralAppearance.default.labelIcon.referenceUri)),_h}}]),_d}(),ix=function(){function _d(){_e(this,_d),this.themeRule={},this.svgList={},this.defaultLang="ENG"}return _u(_d,null,[{key:"getNumberFromAlphaNumeric",value:function(_r){try{var Ni=_r.split("").reverse().join("").replace(/[^0-9]/g,"").substr(0,6);return parseInt(Ni,10)}catch{return null}}},{key:"extractNumFromSting",value:function(_r){try{var Ni=_r.replace(/[^0-9]/g,"");return parseInt(Ni,10)}catch{return console.warn("Exception in converting string to Id"),this.getNumberFromAlphaNumeric(_r)}}},{key:"getVenueId",value:function(_r){var Ni;return"number"!=typeof _r?(Ni=_r.substr(_r.length-6),parseInt(Ni,10)):_r}},{key:"getStringFormatIdentifier",value:function(_r){return"number"==typeof _r||_r.length<13?"indoormap-00000000-0000-4000-a000-".concat(_r.toString().padStart(12,"0")):_r}},{key:"setSite",value:function(ba,Ni){var ga=this.getName(ba);return(ba={id:this.getStringFormatIdentifier(Ni),location:ba.referencePoint,properties:ba.properties,geometry:ba.geometry,map_version:ba.properties.indoorSiteMetadata.legacyVersion.mapVersion,identifier:this.getVenueId(Ni),obj_type:"CommunityMap"}).properties.name=ga,ba.properties.display_name=ga,ba}},{key:"setEntrance",value:function(_r){var Ni=this.themeRule.entranceRules.default.labelIcon.referenceUri,ga=this.extractNumFromSting(_r.id),ba=this.getName(_r),_h=_r.properties;return _h.icon=!0,_h.svg=this.svgList[Ni.toLowerCase()],_h.name=ba||"entrance",_h.display_name=ba||"entrance",_h.level={id:_r.properties.level.id},{id:_r.id,levelId:_r.properties.level.id,momType:Q2,geometry:_r.geometry,location:_r.geometry,properties:_h,identifier:ga,label_area:[_r.referencePoint.coordinates[0],_r.referencePoint.coordinates[1],50,50,180]}}},{key:"setStructure",value:function(_r){var Ni=this.extractNumFromSting(_r.id),ga=this.getName(_r),ba=_r.properties;return ba.is_root=0===_r.properties.drawOrder,ba.display_name=ga,ba.map_type=_r.properties.structureType,ba.name=ga,{id:_r.id,obj_type:"Drawing",identifier:Ni,properties:ba}}},{key:"getNameByPriority",value:function(_r,Ni){for(var ga,_h="",gg=0;gg<_r.length;gg++){var oy=_r[gg];if(("OFFICIAL"===(ga=oy).nameType&&ga.languageCode&&ga.languageCode===this.defaultLang||"OFFICIAL"===ga.nameType)&&(Ni&&Ni===oy.nameType||!Ni)){_h=oy.name;break}if("ABBREVIATION"===oy.nameType&&(Ni&&Ni===oy.nameType||!Ni)){_h=oy.name;break}if("UNCLASSIFIED"===oy.nameType&&(Ni&&Ni===oy.nameType||!Ni)){_h=oy.name;break}if(!oy.nameType&&oy.name){_h=oy.name;break}}return _h}},{key:"getName",value:function(_r,Ni){return _r.properties&&_r.properties.names?this.getNameByPriority(_r.properties.names,Ni):_r.properties.placeProperties&&_r.properties.placeProperties&&_r.properties.placeProperties.names?this.getNameByPriority(_r.properties.placeProperties.names,Ni):_r.properties.locationDetails&&_r.properties.locationDetails[0]&&_r.properties.locationDetails[0].names?this.getNameByPriority(_r.properties.locationDetails[0].names,Ni):""}},{key:"setLevel",value:function(_r){var Ni=this.extractNumFromSting(_r.id),ga=_r.properties.names,ba=_r.properties;return ba["short name"]=this.getNameByPriority(ga,ga&&1!==ga.length?"ABBREVIATION":""),ba.name=this.getNameByPriority(ga,ga&&1!==ga.length?"ABBREVIATION":""),{id:_r.id,obj_type:"Level",identifier:Ni,properties:ba}}},{key:"setLevelConnector",value:function(_r){var Ni=this.extractNumFromSting(_r.id);return{id:_r.id,obj_type:"LevelConnector",properties:_r.properties,geometry:_r.geometry,identifier:Ni,location:_r.geometry}}},{key:"setOccupant",value:function(_r){var Ni=this.getName(_r),ga=this.extractNumFromSting(_r.id),ba=_r.properties;return ba.occupantName=Ni,ba.email=_r.properties.placeProperties&&_r.properties.placeProperties.contacts&&_r.properties.placeProperties.contacts.find(function(_h){return"EMAIL"===_h.contactType})&&_r.properties.placeProperties.contacts.find(function(_h){return"EMAIL"===_h.contactType}).value,ba.name=Ni,ba.tags=_r.properties.attributes&&_r.properties.attributes.tags,{geometry:_r.geometry,id:_r.id,obj_type:"Geometry",properties:ba,identifier:ga,spaceIds:_r.properties.spaces||[],type:"Feature",momType:aI}}},{key:"getIcon",value:function(_r){var Ni=!1,ga="";return this.svgList[_r]&&(Ni=!0,ga=this.svgList[_r]),{icon:Ni,svg:ga}}},{key:"setSpace",value:function(_r){var ga=TA.getSpaceIcon(_r.properties.spaceType,_r.properties.spaceCategory,_r.properties.spaceTypeProperties),oy=this.getName(_r),Ni=(ga=this.getIcon(ga)).icon,ba=(ga=ga.svg,this.extractNumFromSting(_r.id)),_h=(_r.properties.level.id.includes("out"),_r.properties.level.id),gg=_r.properties;return gg.spaceName=oy,gg[_r.properties.spaceCategory]=_r.properties.spaceType,gg.spaceType=_r.properties.spaceType,gg.spaceCategory=_r.properties.spaceCategory,gg.icon=Ni,gg.svg=ga,oy={geometry:_r.geometry,id:_r.id,levelId:_h,label_area:[_r.referencePoint.coordinates[0],_r.referencePoint.coordinates[1],50,50,180],location:_r.referencePoint,obj_type:"Geometry",identifier:ba,properties:gg,momType:uI,type:"Feature"},_r.properties.spaceAddress&&_r.properties.spaceAddress.id&&(oy.addressId=_r.properties.spaceAddress.id),oy}},{key:"setSpaceGroups",value:function(_r){var Ni=this.extractNumFromSting(_r.id);return{id:_r.id,obj_type:"SpaceGroups",properties:_r.properties,geometry:_r.geometry,location:_r.referencePoint,identifier:Ni}}},{key:"setTopology",value:function(_r){var Ni=this.extractNumFromSting(_r.id);return{id:_r.id,obj_type:"Topology",properties:_r.properties,geometry:_r.geometry,identifier:Ni}}},{key:"setAddress",value:function(_r){var Ni=this.extractNumFromSting(_r.id),ga=this.getName(_r),ba=_r.properties;return ba.addressName=ga,ba.name=ga,{id:_r.id,properties:ba,obj_type:"Address",identifier:Ni}}},{key:"manageSvgDimensions",value:function(_r){for(var Ni={},ga=0,ba=Object.entries(_r);ga<ba.length;ga++){var _h,gg,uy,oy=(uy=Oy(ba[ga],2))[0];"string"==typeof(uy=uy[1])&&(_h=-1!==uy.indexOf("<g")&&uy.indexOf("<g")||uy.indexOf("<p"),gg=uy.indexOf("</s"),_h&&gg&&(uy=uy.substring(_h-1,gg-1),Ni[oy]="<svg width='64' height='64' viewBox='0 0 24 32' fill='none' xmlns='http://www.w3.org/2000/svg'>".concat(uy,"</svg>")))}return Ni}},{key:"getSiteBoundingBox",value:function(_r){if(_r){var Ni=(_r=Oy(l_.getBoundingBox(_r.geometry.type,_r.geometry.coordinates),2))[0];if(_r=_r[1],Ni)return"".concat(Ni[0],",").concat(Ni[1],",").concat(_r[0],",").concat(_r[1])}return"null, null, null, null"}}]),_d}(),H_=function(){function _d(){_e(this,_d)}return _u(_d,null,[{key:"get",value:function(_r){return fetch(_r,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{method:"GET"}).then(function(Ni){return Ni.ok?Ni.json():Promise.reject(new Error("Call failed for ".concat(_r," : ").concat(Ni.status," ").concat(Ni.statusText)))})}},{key:"getFormattedIndoorMapId",value:function(_r){return"number"==typeof _r?"indoormap-00000000-0000-4000-a000-".concat(_r.toString().padStart(12,"0")):_r.includes("indoormap")?_r:"indoormap-00000000-0000-4000-a000-".concat(_r.padStart(12,"0"))}},{key:"getConfigUrl",value:function(_r,Ni,uy){var ba=uy.apiKey,oy=uy.url,_h=uy.token,gg=(uy=uy.hrn,{method:"GET",mode:"cors",cache:"default"});return oy="".concat(oy||mS,"/").concat(uy),uy="",Ni===aT.SITE&&(uy="".concat(oy,"/layers/").concat(yS,"/search?p.featureType=indoor.Site&p.indoorMapId='").concat(this.getFormattedIndoorMapId(_r),"'")),Ni===aT.IMAGES&&(uy="".concat(oy,"/layers/").concat("icons","/features/svg")),Ni===aT.Theme&&(uy="".concat(oy,"/layers/").concat("config","/features/indoorMapRules")),_h?gg.headers={Authorization:"Bearer ".concat(_h)}:uy=uy.concat("".concat(Ni===aT.SITE?"&":"?","apiKey=").concat(ba)),this.get(uy,gg)}},{key:"getMomData",value:function(oy,gg){var ga=gg.apiKey,uy=gg.url,ba=gg.token,_h=(gg=gg.hrn,{method:"GET",mode:"cors",cache:"default"});return uy="".concat(uy||mS,"/").concat(gg),gg=oy&&oy.features&&oy.features.find(function(cy){return cy.momType===xC}),oy=ix.getSiteBoundingBox(gg),uy="".concat(uy,"/layers/").concat(yS,"/bbox?bbox=").concat(oy,"&f.momType=indoor.Level,indoor.Space,indoor.Site,indoor.Structure,indoor.Occupant,indoor.SpaceGroups,Address,indoor.Entrance"),ba?_h.headers={Authorization:"Bearer ".concat(ba)}:uy=uy.concat("&apiKey=".concat(ga)),{mom:this.get(uy,_h),site:gg}}},{key:"getDefaultCollection",value:function(Ni){Ni=Ni.token;var ga=(ba=UE[s1.DEFAULT_COLLECTION]).PARAMS,ba=ba.BASE_URL;return ba=encodeURI("".concat(ba,"?sortBy=").concat(ga.CREATED_BY,"&q=").concat(ga.COLLECTION)),Ni?(ga={method:"GET",headers:{Authorization:"Bearer ".concat(Ni)}},this.get(ba,ga)):Promise.reject(new Error("Please provide valid token"))}},{key:"getProjectAccountDetails",value:function(Ni){var ga=UE[s1.ACCOUNT_API].BASE_URL;return(Ni=Ni.token)?(Ni={method:"GET",mode:"cors",headers:{Authorization:"Bearer ".concat(Ni)}},this.get(ga,Ni)):Promise.reject(new Error("Please provide valid token"))}}]),_d}(),O0=function(){function _d(){_e(this,_d)}return _u(_d,null,[{key:"isPointOnGeoJSONLineString",value:function(_r,Ni){var ga=!1;if(Ni&&1<Ni.length)for(var gg=1;gg<Ni.length;gg+=1)if(l_.isPointOnLineSegment(_r,Ni[gg-1],Ni[gg])){ga=!0;break}return ga}},{key:"isPointOnGeoJSONMultiLineString",value:function(_r,Ni){for(var ga=!1,ba=0;ba<Ni.length;ba+=1)if(_d.isPointOnGeoJSONLineString(_r,Ni[ba])){ga=!0;break}return ga}},{key:"isPointInsideGeoJSONPolygon",value:function(_r,Ni){var ga=!1;if(ga=!!l_.isPointInPolygon(_r,Ni[0])||ga)for(var ba=1;ba<Ni.length;ba+=1)if(l_.isPointInPolygon(_r,Ni[ba])){ga=!1;break}return ga}},{key:"isPointInsideGeoJSONMultiPolygon",value:function(_r,Ni){for(var ga=Ni.length,ba=0;ba<ga;ba+=1)if(_d.isPointInsideGeoJSONPolygon(_r,Ni[ba]))return!0;return!1}},{key:"getGeometriesByLonLat",value:function(_r,Ni){for(var ga=2<arguments.length&&void 0!==arguments[2]&&arguments[2],ba=[],_h=Ni.filter(function(uy){return l_.isPointInBoundingBox(_r,uy.getBoundingBox())}),gg=0;gg<_h.length;gg+=1){var oy=_h[gg];if(oy.isPointInsideGeometry(_r,!0)&&(ba.push(oy),!ga))break}return ba.sort(function(uy,cy){return cy.getZIndex()-uy.getZIndex()})}}]),_d}(),RC=function(){function _d(){var _r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Ni=1<arguments.length?arguments[1]:void 0,ga=2<arguments.length?arguments[2]:void 0;_e(this,_d),this.id=_r.id,this.properties=_r.properties||{},this.labelArea=_r.label_area||[],this.geometry=_r.geometry||{},this.location=_r.location||{},this.address=_r.address||{},this.level=Ni,this.zIndex=ga,this.spaceId=_r.spaceId,this.state_={isHighlighted:!1,highlightedStyle:{}},this.geometryData=_r}return _u(_d,[{key:"getId",value:function(){return this.geometryData&&this.geometryData.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getInternalAddress",value:function(){return this.address?this.address.properties&&this.address.properties.name:null}},{key:"getCenter",value:function(){return this.location.coordinates||[]}},{key:"getCoordinates",value:function(){return this.geometry.coordinates||[]}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getStyle",value:function(){return this.getMetaInformation_().getStyle(this)}},{key:"getIcon",value:function(){return this.properties.svg}},{key:"getLabelArea",value:function(){return this.labelArea||[]}},{key:"getLabelStyle",value:function(){return this.getMetaInformation_().getLabelStyle(this)||null}},{key:"getLevel",value:function(){return this.level}},{key:"getType",value:function(){return this.geometry.type}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"getBoundingBox",value:function(){var _r=this.getType(),Ni=this.getCoordinates(),ga=[];switch(_r){case CC:ga=[Ni,Ni];break;case eD:case $1:ga=Ni;break;case nD:case tD:ga=Ni.reduce(function(ba,_h){return ba.concat(_h)},[]);break;case rD:ga=Ni.reduce(function(ba,_h){return ba.concat(_h)},[]).reduce(function(ba,_h){return ba.concat(_h)},[])}return l_.getBoundingBoxVertices(ga)}},{key:"isIcon",value:function(){return!!this.properties.icon}},{key:"isPointInsideGeometry",value:function(_r){var Ni,ga=1<arguments.length&&void 0!==arguments[1]&&arguments[1],ba=!1;switch(this.getType()){case CC:Ni=this.getLabelArea()&&l_.getRectangularCoordinatesOfLabelArea(this.getLabelArea()),ba=l_.isPointInPolygon(_r,Ni);break;case eD:break;case $1:ba=ga&&O0.isPointOnGeoJSONLineString(_r,this.getCoordinates());break;case nD:ba=ga&&O0.isPointOnGeoJSONMultiLineString(_r,this.getCoordinates());break;case tD:ba=O0.isPointInsideGeoJSONPolygon(_r,this.getCoordinates());break;case rD:ba=O0.isPointInsideGeoJSONMultiPolygon(_r,this.getCoordinates())}return ba}},{key:"highlight",value:function(){var _r=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],Ni=1<arguments.length?arguments[1]:void 0;this.state_.isHighlighted=_r,this.state_.highlightedStyle=_r?Ni:{}}},{key:"isHighlighted",value:function(){return Boolean(this.state_.isHighlighted)}},{key:"getHighlightedStyle",value:function(){return this.state_.highlightedStyle||{}}},{key:"toJSON",value:function(){return m({},this.geometry)}},{key:"getMetaInformation_",value:function(){return this.getLevel()?this.getLevel().getDrawing().getVenueModel().metaInformation_:null}}]),_d}(),_S=function(){function _d(_r,Ni){var ga=this;_e(this,_d),this.id=_r&&_r.id,this.properties=_r&&_r.properties,this.zIndexCount=0,this.geometries=_r&&_r.features&&Object.values(_r.features).reduce(function(ba,_h){return ba[[_h.id]]=new RC(_h,ga,_h.properties.drawOrder),ba},{}),this.drawing=Ni,this.levelData=_r}return _u(_d,[{key:"getId",value:function(){return this.levelData&&this.levelData.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getName",value:function(){return this.properties&&this.properties.name||""}},{key:"getDisplayName",value:function(){return this.properties&&this.properties.display_name||""}},{key:"getDrawing",value:function(){return this.drawing}},{key:"getShortName",value:function(){return this.properties&&this.properties["short name"]||""}},{key:"getZIndex",value:function(){return this.properties&&this.properties.zLevel}},{key:"getFeatureCollectionArray",value:function(){return this.getGeometries().map(function(_r){return _r.toJSON()})}},{key:"getGeometryById",value:function(_r){return this.geometries[_r]}},{key:"getGeometries",value:function(){return 0<arguments.length&&void 0!==arguments[0]&&arguments[0]?this.geometries&&Object.values(this.geometries).sort(function(_r,Ni){return Ni.getZIndex()-_r.getZIndex()}):this.geometries&&Object.values(this.geometries).sort(function(_r,Ni){return _r.getZIndex()-Ni.getZIndex()})}},{key:"getGeometriesByAddress",value:function(_r){return Object.values(this.geometries).filter(function(Ni){return Ni.address&&Ni.address.properties&&Ni.address.properties.name&&Ni.address.properties.name===_r})}},{key:"isMain",value:function(){return Boolean(this.properties.isMain)}}]),_d}(),a0=function(){function _d(_r){var Ni=this,ga=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},ba=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],_h=3<arguments.length?arguments[3]:void 0;_e(this,_d),this.venueModel=_h,this.levels=ba.map(function(gg){return new _S(gg,Ni)}),this.structure=_r,this.id=_r&&_r.id,this.properties=ga}return _u(_d,[{key:"getId",value:function(){return this.structure&&this.structure&&this.structure.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"isRoot",value:function(){return Boolean(this.properties.is_root)}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getBoundingBox",value:function(){if(this.structure&&this.structure.geometry){var _r=(Ni=Oy(l_.getBoundingBox(this.structure.geometry.type,this.structure.geometry.coordinates),2))[0],Ni=Ni[1];if(_r)return[Ni[1],_r[0],_r[1],Ni[0]]}return[null,null,null,null]}},{key:"getCenter",value:function(){return this.structure&&this.structure.location&&this.structure.location.coordinates}},{key:"getGeometryById",value:function(_r){return this.getGeometries().find(function(Ni){return Ni.getId()===_r||Ni.getIdentifier()===_r})}},{key:"getGeometries",value:function(){return this.levels.flatMap(function(_r){return _r.getGeometries()})}},{key:"getLevelById",value:function(_r){return this.levels.find(function(Ni){return Ni.getId()===_r||Ni.getIdentifier()===_r})}},{key:"getLevelByZIndex",value:function(_r){return this.levels.find(function(Ni){return Ni.getZIndex()===_r})}},{key:"getLevels",value:function(){return this.levels}},{key:"getMainLevel",value:function(){return this.levels.find(function(_r){return _r.isMain()})}},{key:"getVenueModel",value:function(){return this.venueModel}}]),_d}(),YT=uT.STANDARD,Z0=function(){function _d(_r){var Ni=this,ga=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new WE;_e(this,_d),this.metaInformation_=ga,this.momStructure=_r,this.id=_r&&_r.site&&_r.site.id,this.location=_r&&_r.site&&_r.site.location||{},this.properties=_r&&_r.site&&m({},_r.site.properties),this.drawings=_r&&_r.structure&&Object.values(_r.structure).map(function(ba){var _h=_r.getStructureWiseGeometry(ba.id);return new a0(ba,ba.properties,Object.values(_h),Ni)})}return _u(_d,[{key:"getDisplaySettings",value:function(){return(this.metaInformation_.releaseSettings_?this.metaInformation_.releaseSettings_.displayOptions:"").display||YT}},{key:"getId",value:function(){return this.momStructure&&this.momStructure.site&&this.momStructure.site.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getName",value:function(){return this.properties.name}},{key:"getBoundingBox",value:function(){if(this.momStructure){var _r=(Ni=Oy(l_.getBoundingBox(this.momStructure.site.geometry.type,this.momStructure.site.geometry.coordinates),2))[0],Ni=Ni[1];if(_r)return[Ni[1],_r[0],_r[1],Ni[0]]}return[null,null,null,null]}},{key:"getCenter",value:function(){return this.location.coordinates}},{key:"getGeometryById",value:function(_r){return this.getGeometries().find(function(Ni){return Ni.getId()===_r||Ni.getIdentifier()===_r})}},{key:"getGeometries",value:function(){return this.getLevels().sort(function(_r,Ni){return _r.getZIndex()-Ni.getZIndex()}).flatMap(function(_r){return _r.getGeometries()})}},{key:"getGeometriesByLonLat",value:function(_r){var ba,Ni=this,ga=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return 0===(ba=(ba=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]).map(function(_h){return Ni.getLevelById(_h)})).length&&(ba=this.drawings.filter(function(_h){return _h=_h.getBoundingBox(),l_.isPointInBoundingBox(_r,_h)}).flatMap(function(_h){return _h.getLevels()})),O0.getGeometriesByLonLat(_r,ba.flatMap(function(_h){return _h.getGeometries(!0)}),ga)}},{key:"getDrawingById",value:function(_r){return this.drawings.find(function(Ni){return Ni.getId()===_r||Ni.getIdentifier()===_r})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getRootDrawing",value:function(){return this.drawings.find(function(_r){return _r.isRoot()})}},{key:"getLevelById",value:function(_r){return this.getLevels().find(function(Ni){return Ni.getId()===_r||Ni.getIdentifier()===_r})}},{key:"getLevelsByZIndex",value:function(){var _r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.getLevels().filter(function(Ni){return Number(Ni.getZIndex())===Number(_r)})}},{key:"getLevels",value:function(){return this.drawings.flatMap(function(_r){return _r.getLevels()})}},{key:"getMomStructure",value:function(){return this.momStructure}},{key:"getLevelMapFlattenedByZIndex_",value:function(){return this.getLevels().reduce(function(_r,Ni){var ga=Ni.getZIndex();return _r[ga]||(_r[ga]=[]),_r[ga].push(Ni),_r},{})}},{key:"getOccupant",value:function(){return Object.values(this.momStructure.occupant)}}]),_d}(),P_=function(){function _d(_r){_e(this,_d),this.theme=_r&&_r.theme,this.level=_r&&_r.level,this.site=_r&&_r.site,this.spaces=_r&&_r.spaces,this.address=_r&&_r.address,this.levelConnector=_r&&_r.levelConnector,this.topology=_r&&_r.topology,this.entrance=_r&&_r.entrance,this.occupant=_r&&_r.occupant,this.structure=_r&&_r.structure,this.spaceGroups=_r&&_r.spaceGroups,this.levelWiseGeometry={},this.levelStructureMapping=_r&&_r.levelStructureMapping,this.outdoorLevelMapping=_r&&_r.outdoorLevelMapping||{},this.labelTextPreference=_r&&_r.labelTextPreference||null}return _u(_d,[{key:"setSpaceWithLevel",value:function(){var _r=this;this.spaces&&Object.values(this.spaces).forEach(function(Ni){var ga="",ba=((Ni.addressId&&(ga=_r.address&&_r.address[Ni.addressId]&&_r.address[Ni.addressId].properties.addressName),ba=Ni.properties).addressName=ga,ga=_r.getLabelAsPerPreference(m(m({},Ni),{},{properties:ba})),((ba=Ni.properties).name=ga,ba.display_name=ga,Ni.properties.icon&&(ba.name=Ni.id,ba.display_name=Ni.id),ga=Ni).properties=ba,ga.address=_r.address[Ni.addressId],(_r.spaces[Ni.id]=Ni).levelId);_r.outdoorLevelMapping[ba]&&(ba=_r.outdoorLevelMapping[ba]),_r.levelWiseGeometry[ba]||(_r.levelWiseGeometry[ba]={}),_r.levelWiseGeometry[ba][ga.id]=ga})}},{key:"setOccupantWithLevel",value:function(){var _r=this;this.occupant&&Object.values(this.occupant).forEach(function(Ni){var ga,ba;Ni.spaceIds&&Ni.properties.occupantName&&(ga=[],ba=[],Ni.spaceIds.forEach(function(_h){function gg(cy){var Ay=!1,vy=(_r.labelTextPreference&&_r.labelTextPreference.length&&(Ay=-1!==_r.labelTextPreference.indexOf("OCCUPANT_NAMES")),Ay=null===_r.labelTextPreference||Ay,cy),Ty=cy.properties;Ty.name=cy.properties.icon||!Ay?cy.properties.name:Ni.properties.occupantName,Ty.display_name=cy.properties.icon||!Ay?cy.properties.display_name:Ni.properties.occupantName,Ty.address=cy.address,Ty.occupantName=Ni.properties.occupantName,_r.outdoorLevelMapping[Ay=cy.levelId]&&(Ay=_r.outdoorLevelMapping[Ay]),_r.levelWiseGeometry[Ay]||(_r.levelWiseGeometry[Ay]={}),_r.levelWiseGeometry[Ay][cy.id]=vy,ga.push(vy),ba.push(cy.id)}var oy=_r.spaces[oy=_h.id],uy=null;_r.spaceGroups&&Object.values(_r.spaceGroups).forEach(function(cy){cy.properties.spaceGroups&&cy.properties.spaceGroups&&cy.properties.spaceGroups.forEach(function(vy){vy.mainSpace&&vy.mainSpace.id===_h.id&&(uy=vy.spaces.map(function(Ty){return Ty.id}))})}),uy&&0<uy.length&&uy.forEach(function(cy){gg(_r.spaces[cy])}),oy&&gg(oy)}),_r.occupant[Ni.id]=Ni,_r.occupant[Ni.id].space=ga,_r.occupant[Ni.id].spaceIds=ba)})}},{key:"setEntrance",value:function(){var _r=this;this.entrance&&Object.values(this.entrance).forEach(function(Ni){var ga=Ni.properties.level.id;_r.levelWiseGeometry[ga]||(_r.levelWiseGeometry[Ni.properties.level.id]={}),_r.outdoorLevelMapping[ga]&&(ga=_r.outdoorLevelMapping[ga]),_r.levelWiseGeometry[ga][Ni.id]=Ni})}},{key:"setLevelWiseGeometry",value:function(){var _r=this;this.level&&Object.keys(this.level).forEach(function(Ni){_r.levelWiseGeometry[Ni]={}}),this.setSpaceWithLevel(),this.setOccupantWithLevel(),this.setEntrance()}},{key:"getStructureWiseGeometry",value:function(_r){for(var Ni={},ga=0,ba=Object.entries(this.levelWiseGeometry);ga<ba.length;ga++){var _h=(gg=Oy(ba[ga],2))[0],gg=gg[1];_r===this.levelStructureMapping[_h]&&(Ni[_h]=this.level[_h],Ni[_h].features=gg)}return Ni}},{key:"getLabelAsPerPreference",value:function(ba){var Ni=(ba=ba.properties).spaceType,gg=ba.occupantName,uy=ba.spaceName,ga=ba.addressName,_h=(ba=ba.spaceCategory,pd(cy={},"OCCUPANT_NAMES",gg),pd(cy,"SPACE_NAME",uy),pd(cy,TC,Ni?Ni.charAt(0).toUpperCase()+Ni.slice(1).toLowerCase():""),pd(cy,AC,ba?ba.charAt(0).toUpperCase()+ba.slice(1).toLowerCase():""),pd(cy,"INTERNAL_ADDRESS_SHORT",ga),pd(cy,"INTERNAL_ADDRESS",ga),pd(cy,"INTERNAL_ADDRESS_LONG",ga),cy),oy=(gg=this.theme.spaceRules,"");if("NONE"===(uy=ba&&Ni&&gg[ba]&&gg[ba].spaceTypes&&gg[ba].spaceTypes[Ni].behavioralAppearance.default.labelType)){if(!this.labelTextPreference)return"";_h[TC]=""}if(("NONE"===(ga=ba&&Ni&&gg[ba]&&gg[ba].properties&&gg[ba].properties.behavioralAppearance&&gg[ba].properties.behavioralAppearance.default&&gg[ba].properties.behavioralAppearance.default.labelType)||void 0===ga)&&void 0===uy){if(!this.labelTextPreference)return"";_h[TC]="",_h[AC]=""}var cy=ba&&Ni&&gg[ba]&&gg[ba].properties&&gg[ba].properties.behavioralAppearance&&gg[ba].properties.behavioralAppearance.default&&gg[ba].properties.behavioralAppearance.default.labelTextPreference,vy=cy&&this.labelTextPreference?this.labelTextPreference:cy;if(vy)for(var Ty=0;Ty<vy.length;Ty++)if(_h[vy[Ty]]){oy=_h[vy[Ty]];break}return oy}}]),_d}(),bS=function(){function _d(oy){var ba=oy.apiKey,_h=oy.baseUrl,gg=oy.token;oy=oy.hrn,_e(this,_d),this.hostOptions_={apiKey:ba,url:_h,token:gg,hrn:oy},this.momData=[],this.theme={},this.loadOptions={}}var _r,Ni;return _u(_d,[{key:"setHostOptions",value:function(ga){0!==Object.keys(ga).length&&(this.hostOptions_=m(m({},this.hostOptions_),ga))}},{key:"getToken",value:function(){return this.hostOptions_.token}},{key:"getHrn",value:function(){return this.hostOptions_.hrn}},{key:"load",value:function(ga){var ba=this,_h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.loadOptions=m(m(m({},dE),_h),{},{venueId:ga}),this.hostOptions_.mapData=_h.mapData,this.hostOptions_.themeRule=_h.themeRule,this.hostOptions_.svgList=_h.svgList,this.hostOptions_.labelTextPreference=_h.labelTextPreferenceOverride,this.getHrn()?this.getVenueModalInstance():this.getToken()?this.getDefaultCollectionWithToken().then(function(){return ba.getVenueModalInstance()}).catch(function(){return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"))}):Promise.reject(new Error("In order to load indoor map, Please provide either hrn or token"))}},{key:"getVenueModalInstance",value:function(){var ga=this;return Promise.resolve().then(function(){return ga.loadOptions.isMetaEnabled?ga.getMeta_(ga.loadOptions.isIconsEnabled).catch(function(ba){return console.warn(ba),Promise.resolve()}):Promise.reject()}).then(function(ba){return ga.getVenue_(ba)}).then(function(ba){return ba}).catch(function(ba){console.debug("Captured event VENUE_ERROR_STATE",ba)})}},{key:"createMomStructure",value:function(){var ga=this,ba={site:{},structure:{},level:{},levelConnector:{},occupant:{},spaces:{},spaceGroups:{},topology:{},address:{},outdoorLevelMapping:{},entrance:{},levelStructureMapping:{}};return this.momData.forEach(function(_h){var gg="indoormap-00000000-0000-4000-a000-".concat(ga.loadOptions.venueId.toString().padStart(12,"0")),oy=_h.id;_h.momType!==J2&&!ga.hostOptions_.mapData&&_h.properties.indoorMapId!=ga.loadOptions.venueId&&_h.properties.indoorMapId!==gg||(_h.momType===xC?ba.site=ix.setSite(_h,ga.loadOptions.venueId):"indoor.Structure"===_h.momType?ba.structure[oy]=ix.setStructure(_h):_h.momType!==EC||_h.properties.isOutdoor&&(!_h.properties.isOutdoor||_h.properties.parentIndoorLevel)?_h.momType===EC&&_h.properties.isOutdoor&&_h.properties.parentIndoorLevel?ba.outdoorLevelMapping[_h.id]=_h.properties.parentIndoorLevel.id:_h.momType===Q2?ba.entrance[oy]=ix.setEntrance(_h):_h.momType===aI?ba.occupant[oy]=ix.setOccupant(_h):_h.momType===uI?ba.spaces[oy]=ix.setSpace(_h):"indoor.SpaceGroups"===_h.momType?ba.spaceGroups[oy]=ix.setSpaceGroups(_h):_h.momType===J2&&(ba.address[oy]=ix.setAddress(_h)):(ba.level[oy]=ix.setLevel(_h),ba.levelStructureMapping[oy]=_h.properties.structure.id))}),ba.theme=this.theme,ba.labelTextPreference=this.hostOptions_.labelTextPreference,new P_(ba)}},{key:"getVenue_",value:function(ga){this.momData=ga.getMomData();var ba=this.createMomStructure();return ba.setLevelWiseGeometry(),new Z0(ba,ga)}},{key:"setConfigData",value:function(gg){var ba=gg.themeRule,_h=gg.svgList;gg=gg.defaultLang,TA.setSpaceRules(ba.spaceRules),ix.svgList=_h,ix.themeRule=ba,ix.defaultLang=gg,this.theme=ba}},{key:"getMeta_",value:function(){var ga=this,ba=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],_h=new WE,gg=this.hostOptions_.mapData?{}:this.getMetaConfig_(this.loadOptions.venueId,aT.SITE),oy=this.hostOptions_.themeRule||this.getMetaConfig_(this.loadOptions.venueId,aT.Theme),uy=[];return ba&&(uy=this.hostOptions_.svgList||this.getMetaConfig_(this.loadOptions.venueId,aT.IMAGES)),new Promise(function(cy){Promise.all([gg,oy,uy]).then(function(Ty){var Ay=(Ty=Oy(Ty,3))[0],e0=Ty[1],s0=Ty[2],ky=ga.hostOptions_.mapData?{mom:new Promise(function(u0){return u0(ga.hostOptions_.mapData)}),site:ga.hostOptions_.mapData.features.find(function(u0){return u0.momType===xC})}:H_.getMomData(Ay,ga.hostOptions_);ky.mom.then(function(u0){var t0=e0.properties;_h.imageCache=ba?ix.manageSvgDimensions(s0.properties):[],ga.setConfigData({themeRule:t0,svgList:_h.imageCache,defaultLang:ky&&ky.site&&ky.site.properties.defaultLanguageCode}),_h.releaseSettings_={displayOptions:{display:t0.entranceRules.default.displayName||uT.STANDARD},mom:u0.features},_h.theme=new OC(t0,_h),cy(_h)})})})}},{key:"getMetaConfig_",value:function(ga,ba){return H_.getConfigUrl(ga,ba,this.hostOptions_)}},{key:"fetchCollections",value:function(){return H_.getDefaultCollection(this.hostOptions_)}},{key:"fetchUserProjects",value:function(){return H_.getProjectAccountDetails(this.hostOptions_)}},{key:"getDefaultCollectionWithToken",value:(_r=w().mark(function ga(){var ba=this;return w().wrap(function(_h){for(;;)switch(_h.prev=_h.next){case 0:return _h.abrupt("return",Promise.all([this.fetchCollections(),this.fetchUserProjects()]).then(function(oy){var uy;return oy=Oy(oy,2),(uy=ba.getHrnFromDefaultCollection(uy=oy[0],oy=oy[1])).hrn?(ba.setHostOptions(oy={hrn:uy.hrn}),Promise.resolve()):Promise.reject()}).catch(function(gg){return Promise.reject(gg)}));case 1:case"end":return _h.stop()}},ga,this)}),Ni=function(){var ga=this,ba=arguments;return new Promise(function(_h,gg){var oy=_r.apply(ga,ba);function uy(vy){Y(oy,_h,gg,uy,cy,"next",vy)}function cy(vy){Y(oy,_h,gg,uy,cy,"throw",vy)}uy(void 0)})},function(){return Ni.apply(this,arguments)})},{key:"getHrnFromDefaultCollection",value:function(gg,ba){var _h;return gg=gg.results.items,Array.isArray(gg)&&gg.length?(_h=this.getProjectRealm(ba),gg.find(function(oy){return oy.hrn.includes(_h)})):Promise.reject(new Error("Error while accessing default collection"))}},{key:"getProjectRealm",value:function(ga){return Array.isArray(ga.items)&&ga.items.length&&ga.items[0].id.includes("indoor-")?this.getRealmNameFromHrn(ga=ga.items[0].hrn):""}},{key:"getRealmNameFromHrn",value:function(ga){return ga?(ga=ga.split(":")).length&&ga[4]:""}}]),_d}(),NC=["origin","destination"],sD=function(){function _d(){var _r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(_e(this,_d),!_r.apiKey&&!_r.token)throw new Error("API key or Token is missing");this.config_=m({baseUrl:"https://meta-indoor-routing.api-gateway.ls.hereapi.com"},_r)}return _u(_d,[{key:"calculateRoute",value:function(ba){var Ni=void 0===(Ni=ba.origin)?{}:Ni,ga=void 0===(ga=ba.destination)?{}:ga;if(ba=function Py(_d,_r){if(null==_d)return{};var Ni,ga=function(gg,oy){if(null==gg)return{};for(var uy,cy={},vy=Object.keys(gg),Ty=0;Ty<vy.length;Ty++)0<=oy.indexOf(uy=vy[Ty])||(cy[uy]=gg[uy]);return cy}(_d,_r);if(Object.getOwnPropertySymbols)for(var ba=Object.getOwnPropertySymbols(_d),_h=0;_h<ba.length;_h++)0<=_r.indexOf(Ni=ba[_h])||Object.prototype.propertyIsEnumerable.call(_d,Ni)&&(ga[Ni]=_d[Ni]);return ga}(ba,NC),!Ni.coordinates||!ga.coordinates)throw new Error("Waypoint coordinates are missing");function _h(vy){var Ty=vy.coordinates,cy=vy.venueId;return vy=vy.levelId,Ty=Ty.join(","),cy&&vy?Ty.concat(";indoorMapId=",cy,";levelId=",vy):Ty}var gg=new URL("".concat(this.config_.baseUrl,"/v1/routes")),oy=new URLSearchParams({origin:_h(Ni),destination:_h(ga),apiKey:this.config_.apiKey});return Object.entries(ba).forEach(function(vy){vy=Oy(vy,2),oy.append(vy[0],"object"===k(vy=vy[1])?JSON.stringify(vy):vy)}),gg.search=oy,fetch(gg,{headers:{"X-Api-Key":this.config_.apiKey}}).then(function(uy){return uy.json()})}}]),_d}(),Ww={VENUE_DATA_LOADED:"VENUE_DATA_LOADED",VENUE_THEME_LOADED:"VENUE_THEME_LOADED",VENUE_ICONS_LOADED:"VENUE_ICONS_LOADED",VENUE_MOM_DATA_LOADED:"VENUE_MOM_DATA_LOADED",VENUE_ERROR_STATE:"VENUE_ERROR_STATE",VENUE_MAP_DATA_LOADED:"VENUE_MAP_DATA_LOADED",VENUE_ENTITY_DATA_LOADED:"VENUE_ENTITY_DATA_LOADED",VENUE_DATA_MODEL_LOADED:"VENUE_DATA_MODEL_LOADED",VENUE_NAV_DATA_LOADED:"VENUE_NAV_DATA_LOADED",META_DATA_LOADED:"META_DATA_LOADED",META_DATA_MODEL_LOADED:"META_DATA_MODEL_LOADED",META_DATA_MODEL_UPDATED:"META_DATA_MODEL_UPDATED"},s_=((Object.freeze((pd(R0={},Ww.VENUE_DATA_LOADED,{description:"event fired when all requested files along with metadata & overrides are loaded",emitTemplate:{}}),pd(R0,Ww.VENUE_MAP_DATA_LOADED,{description:"event fired when requested levels, drawings & community files are loaded",emitTemplate:{}}),pd(R0,Ww.VENUE_ENTITY_DATA_LOADED,{description:"event fired when requested entity data is loaded",emitTemplate:{}}),pd(R0,Ww.VENUE_DATA_MODEL_LOADED,{description:"event fired when a map file is loaded",emitTemplate:{}}),pd(R0,Ww.VENUE_NAV_DATA_LOADED,{description:"event fired when requested navigation product is loaded",emitTemplate:{}}),pd(R0,Ww.META_DATA_LOADED,{description:"event fired when all requested meta files are loaded except icon & marker",emitTemplate:{}}),pd(R0,Ww.META_DATA_MODEL_LOADED,{description:"event fired when a specific model is loaded except icon & marker",emitTemplate:{}}),pd(R0,Ww.META_DATA_MODEL_UPDATED,{description:"event fired when a specific meta override is added or removed",emitTemplate:{}}),pd(R0,Ww.VENUE_ICONS_LOADED,{description:"event fired when all icons of venue are loaded",emitTemplate:{}}),R0)),c0=new $_).EVENT_NAME=Ww,c0.on("newListener",function(_d){Ww[_d]||console.warn("subscribing for un-registered/documented event")}),function(){iy(_r,H.map.Feature);var _d=_m(_r);function _r(Ni){var ga;if(_e(this,_r),ga=_d.call(this),Ni instanceof Z0)return ga.venueModel=Ni,ga.search_=new sI(Ni),ga.status_={activeDrawingId:Ni.getRootDrawing().getIdentifier(),activeLevelIndex:Ni.getRootDrawing().getMainLevel().getZIndex()},ga.mapObjectStore_=ga.getDefaultMapObjectsStore_(),ga.drawings=Ni.getDrawings().map(function(ba){return(ba=new q1(ba)).setParentEventTarget(Jy(ga)),ba}),ga.levels=Ni.getLevels().map(function(ba){var _h=new Uw(ba);return _h.setParentEventTarget(ga.drawings.find(function(gg){return gg.getIdentifier()===_h.getData().getDrawing().getIdentifier()})),_h}),ga.geometries=Ni.getGeometries().map(function(ba){var _h=new N_(ba);return _h.setParentEventTarget(ga.levels.find(function(gg){return gg.getIdentifier()===_h.getData().getLevel().getIdentifier()})),_h}),ga.mutualExclusiveHighlight_=!1,ga;throw new Error("It is mandatory to provide valid instance of venueModel")}return _u(_r,[{key:"getData",value:function(){return this.venueModel}},{key:"getBoundingBox",value:function(){return Ey(H.geo.Rect,K0(this.venueModel.getBoundingBox()))}},{key:"getCenter",value:function(){var Ni=(ga=Oy(this.venueModel.getCenter(),2))[0],ga=ga[1];return new H.geo.Point(ga,Ni)}},{key:"getId",value:function(){return this.venueModel.getId()}},{key:"getIdentifier",value:function(){return this.venueModel.getIdentifier()}},{key:"getName",value:function(){return this.venueModel.getName()}},{key:"getDrawing",value:function(Ni){return this.drawings.find(function(ga){return ga.getIdentifier()===Ni})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getLevel",value:function(Ni){return this.levels.find(function(ga){return ga.getIdentifier()===Ni})}},{key:"getLevels",value:function(){return this.levels}},{key:"getGeometry",value:function(Ni){return this.getGeometries().find(function(ga){return ga.getIdentifier()===Ni})}},{key:"getGeometries",value:function(){return this.geometries}},{key:"getActiveLevels",value:function(){var Ni=this;return this.getData().getDisplaySettings()===uT.FLATTEN?this.venueModel.getLevelsByZIndex(this.status_.activeLevelIndex).map(function(ga){return Ni.getLevel(ga.getIdentifier())}):[this.venueModel.getDrawingById(this.status_.activeDrawingId).getLevelByZIndex(this.status_.activeLevelIndex)].map(function(ga){return Ni.getLevel(ga.getIdentifier())})}},{key:"getActiveDrawing",value:function(){return this.getDrawing(this.status_.activeDrawingId)}},{key:"setActiveDrawing",value:function(Ni){if(this.status_.activeDrawingId!==Ni){var ga=this.venueModel.getDrawingById(Ni);if(!ga)throw new Error("Drawing ".concat(Ni," was not found"));var ba=this.status_.activeDrawingId;this.status_.activeDrawingId=ga.id,this.setActiveLevelIndex(ga.getMainLevel().getZIndex()),this.dispatchEvent(new H.util.ChangeEvent(_r.EVENTS.DRAWING_CHANGE,Ni,ba))}}},{key:"getActiveLevelIndex",value:function(){return this.status_.activeLevelIndex}},{key:"setActiveLevelIndex",value:function(Ni){var ga;this.venueModel.getLevelsByZIndex(Ni)&&(ga=this.status_.activeLevelIndex,this.status_.activeLevelIndex=Ni,this.dispatchEvent(new H.util.ChangeEvent(_r.EVENTS.LEVEL_CHANGE,Ni,ga)))}},{key:"isActive",value:function(){var Ni=this.getParentEventTarget();return!!Ni&&this===Ni.activeVenue}},{key:"getHighlightedGeometries",value:function(){var Ni=this;return this.venueModel.getGeometries().filter(function(ga){return ga.isHighlighted()}).map(function(ga){return Ni.getGeometry(ga.getIdentifier())})}},{key:"setHighlightedGeometries",value:function(){var Ni=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],ga=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],_h=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},ba=3<arguments.length&&void 0!==arguments[3]&&arguments[3],gg=(_h=m(m({},Y2),_h)).fillColor,oy=_h.outlineColor,uy=_h.outlineWidth;this.mutualExclusiveHighlight_=!!ba,this.mutualExclusiveHighlight_&&this.getHighlightedGeometries().forEach(function(cy){cy.getData().highlight(!1)}),ga.forEach(function(cy){cy.getData().highlight(Ni,{m:gg,o:oy,w:uy})}),this.dispatchEvent(_r.EVENTS.GEOMETRY_HIGHLIGHT)}},{key:"getMapObjects",value:function(){var Ni=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getActiveLevelIndex(),ga=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getActiveDrawing();return this.mapObjectStore_[Ni][ga.getIdentifier()]}},{key:"setMapObjects",value:function(){var Ni=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],ga=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getActiveLevelIndex(),ba=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.getActiveDrawing();this.mapObjectStore_[ga]&&this.mapObjectStore_[ga][ba.getIdentifier()]&&(this.mapObjectStore_[ga][ba.getIdentifier()]=K0(Ni)),this.updateMapObjectsVisibility_()}},{key:"search",value:function(){var Ni=this;return this.search_.find(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").flatMap(function(ga){return ga.geometries.map(function(ba){return Ni.getGeometry(ba.id)})})}},{key:"updateMapObjectsVisibility_",value:function(){Object.values(this.mapObjectStore_).forEach(function(Ni){Object.values(Ni).forEach(function(ga){return ga.forEach(function(ba){return ba.setVisibility(!1)})})}),this.isActive()&&this.mapObjectStore_[this.getActiveLevelIndex()][this.getActiveDrawing().getIdentifier()].forEach(function(Ni){return Ni.setVisibility(!0)})}},{key:"getDefaultMapObjectsStore_",value:function(){var Ni=this,ga=this.getData().getDisplaySettings()===uT.FLATTEN;return this.venueModel.getLevels().reduce(function(oy,_h){var gg=_h.getZIndex();return(oy=m({},oy))[gg]||(oy[gg]={}),oy[gg][_h.getDrawing().getIdentifier()]=[],ga&&(oy[gg][Ni.venueModel.getRootDrawing().getIdentifier()]=[]),oy},{})}}]),_r}()),AA=(s_.EVENTS={ACTIVE_VENUE_CHANGE:"activevenuechange",DRAWING_CHANGE:"drawingchange",LEVEL_CHANGE:"levelchange",GEOMETRY_HIGHLIGHT:"geometryhighlight"},function(){function _d(){_e(this,_d)}return _u(_d,null,[{key:"getIconLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).flatMap(function(_r){return _r.getData().getGeometries()}).filter(function(_r){return _r.isIcon()&&_r.getIcon()}).map(function(_r){var Ni=(ga=Oy(_r.getLabelArea(),2))[0],ga=ga[1],ba=_r.getLevel(),_h=_r.getIcon(),gg=_r.properties.spaceType||_r.properties.spaceCategory||_r.getDisplayName();return{type:"Feature",properties:{id:_r.getIdentifier(),geometryId:_r.getIdentifier(),levelId:ba.getIdentifier(),name:gg,venueId:ba.getDrawing().getVenueModel().getIdentifier(),url:_h?"data:image/svg+xml;utf8,".concat(encodeURIComponent(_h)):""},geometry:{type:jx_POINT,coordinates:[Ni,ga]}}})}}},{key:"getLabelLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).flatMap(function(_r){return _r.getData().getGeometries()}).filter(function(_r){return _r.getDisplayName()&&!_r.isIcon()}).map(function(_r){var Ni=(ga=Oy(_r.getLabelArea(),2))[0],ga=ga[1],ba=(_h=_r.getLabelStyle()).fill,_h=_h.zmin,gg=_r.getLevel();return{type:"Feature",properties:{id:_r.getIdentifier(),geometryId:_r.getIdentifier(),levelId:gg.getIdentifier(),venueId:gg.getDrawing().getVenueModel().getIdentifier(),name:_r.getDisplayName(),minZoom:_h||15,textFillColor:ba.toLowerCase()},geometry:{type:jx_POINT,coordinates:[Ni,ga]}}})}}},{key:"getGeometryLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).flatMap(function(_r){return _r.getData().getGeometries()}).filter(function(_r){return _r.getType()!==jx_POINT}).map(function(_r){var Ni=(ba=_r.getHighlightedStyle()||{}).m,ga=ba.o,ba=ba.w,_h=(oy=m({},_r.getStyle())).m,gg=oy.o,oy=oy.w,uy=(vy=KR).fillColor,cy=vy.outlineColor,vy=vy.outlineWidth,Ty=_r.getLevel();return{type:"Feature",properties:{id:_r.getIdentifier(),fillColor:(Ni||_h||uy).toLowerCase(),geometryId:_r.getIdentifier(),levelId:Ty.getIdentifier(),venueId:Ty.getDrawing().getVenueModel().getIdentifier(),outlineColor:(ga||gg||cy).toLowerCase(),outlineWidth:Number(((ba||oy||vy)/3).toFixed(2)),zIndex:_r.getZIndex()},geometry:{type:_r.getType(),coordinates:_r.getCoordinates()}}})}}},{key:"getFootprintLayer",value:function(_r){return{type:"FeatureCollection",features:_r.flatMap(function(Ni){var ga=Ni.getData().getRootDrawing().getMainLevel().getIdentifier(),ba=Ni.getLevel(ga).getData().getGeometries().filter(function(_h){return _h.getType()===jx_POLYGON});return[{type:"Feature",properties:{isFootprint:!0,levelId:ga,venueId:Ni.getIdentifier(),zIndex:1},geometry:{type:"MultiPolygon",coordinates:ba.map(function(_h){return _h.getCoordinates()})}},{type:"Feature",properties:{isFootprint:!0,levelId:ga,venueId:Ni.getIdentifier(),zIndex:2,venueName:Ni.getName()},geometry:{type:"Point",coordinates:Ni.getCenter().toGeoJSON().coordinates.slice(0,2)}}]})}}}]),_d}()),wS=function(){function _d(){_e(this,_d)}return _u(_d,null,[{key:"getStyle",value:function(){var _r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],Ni=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],ga={styles:[{layer:q_.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#613F8E",lineWidth:"2px",renderOrder:1},{layer:q_.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#AF91B4",renderOrder:2},{layer:q_.FOOTPRINT,when:["==",["geometry-type"],"Point"],technique:"text",color:"black",size:16,text:["get","venueName"],priority:61},{layer:q_.VECTOR,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:["get","fillColor"],renderOrder:["get","zIndex"]},{layer:q_.VECTOR,technique:"solid-line",color:["get","outlineColor"],lineWidth:["get","outlineWidth"],renderOrder:["get","zIndex"]},{layer:q_.TEXT,minZoomLevel:["get","minZoom"],technique:"text",color:["get","textFillColor"],size:13,text:["get","name"],priority:60},{layer:q_.ICON,minZoomLevel:16,when:["==",["geometry-type"],"Point"],technique:"labeled-icon",textIsOptional:!0,size:0,imageTexture:["concat","texture",["get","name"]],screenWidth:["interpolate",["linear"],["zoom"],15,3,21,70],screenHeight:["interpolate",["linear"],["zoom"],15,3,21,70],priority:61}],images:{},imageTextures:[]};return _r.forEach(function(ba){var _h="texture"+ba.properties.name;ga.images[_h]||(ga.images[_h]={url:ba.properties.url,preload:!0},ga.imageTextures.push({name:_h,image:_h}))}),Ni.forEach(function(ba){var _h,uy=ba.getData().getHighlightedStyle();(_h=ga.styles).push.apply(_h,[{layer:q_.VECTOR,when:["==",["get","id"],ba.id],technique:"fill",color:uy.m,renderOrder:["get","zIndex"]},{layer:q_.VECTOR,when:["==",["get","id"],ba.id],technique:"solid-line",color:uy.o,lineWidth:uy=uy.w,renderOrder:["get","zIndex"]}])}),new H.map.render.harp.Style(ga)}}]),_d}(),$E=function(){function _d(){_e(this,_d)}return _u(_d,null,[{key:"getIconsTextures",value:function(){var _r={},Ni={},ga=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(ba,_h){var gg=_h.properties.name;return ba[gg]||(ba[gg]=[]),ba[gg].push(_h),ba},{});return Object.keys(ga).forEach(function(ba){var _h="texture".concat(ba),gg="sprite".concat(ba);_r[_h]={url:ga[ba][0].properties.url,sprites:pd({},gg,[0,0,50,50])},ga[ba].forEach(function(uy){Ni["icon".concat((uy=uy.properties).name)]={filter:{name:uy.name,$zoom:{min:16}},draw:{points:{interactive:!0,priority:1,size:[[15,"50%"],[16,"55%"],[17,"60%"],[18,"65%"],[19,"75%"],[20,"80%"],[21,"100%"]],texture:_h,sprite:gg}}}})}),{textures:_r,iconLayers:Ni}}},{key:"getFootprintLayer",value:function(){return{data:{source:"venues",layer:q_.FOOTPRINT},draw:{polygons:{interactive:!0,color:"#AF91B4",order:2},lines:{color:"#613F8E",width:"2px",order:1},points:{color:"[0, 0, 0, 0]",size:"0px",order:3,priority:1,text:{anchor:"center",collide:!1,font:{fill:"black",size:"16px"},text_source:"function() { return feature.venueName }"}}}}}},{key:"getGeometryLayer",value:function(){var _r,Ni,ga,ba=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],_h={};return ba.length&&(_r=(ga=ba[0].getData().getHighlightedStyle()).m,Ni=ga.o,ga=ga.w,_h={filter:{id:ba.map(function(gg){return gg.id})},draw:{polygons:{interactive:!0,color:_r},lines:{color:Ni,width:ga}}}),{data:{source:"venues",layer:q_.VECTOR},draw:{polygons:{interactive:!0,color:"function() { return feature.fillColor }",order:"function() { return feature.zIndex }"},lines:{color:"function() { return feature.outlineColor }",order:"function() { return feature.zIndex }",width:"function() { return feature.outlineWidth }"}},highlighted:_h}}},{key:"getTextLayer",value:function(){return{filter:{$zoom:{min:18}},data:{source:"venues",layer:q_.TEXT},draw:{points:{filter:"function() { return $zoom > feature.minZoom }",color:"[0, 0, 0, 0]",size:"0px",offset:["0px","-10px"],priority:2,text:{font:{fill:"function() { return feature.textFillColor }",size:13},text_source:"function() { return feature.name }"}}}}}},{key:"getIconLayer",value:function(_r){return m({data:{source:"venues",layer:q_.ICON}},_r)}},{key:"getStyle",value:function(){var Ni=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],_r=(ga=_d.getIconsTextures(ga=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[])).textures,ga=ga.iconLayers;return Ni={venue_footprints:_d.getFootprintLayer(),venue_geometries:_d.getGeometryLayer(Ni),venue_labels:_d.getTextLayer(),venue_icons:_d.getIconLayer(ga)},ga=H.gl.yaml.safeDump({sources:{venues:{max_zoom:24,type:"GeoJSONTileSource"}},layers:Ni,textures:_r}),new H.map.render.webgl.Style(ga)}}]),_d}(),ox={type:"FeatureCollection",features:[]},YE={extent:4096,indexMaxZoom:0,maxZoom:24,tolerance:3},JR=(R0=function(){iy(_r,H.map.provider.RemoteTileProvider);var _d=_m(_r);function _r(Ni){return _e(this,_r),(Ni=_d.call(this,Ni)).venues=[],Ni.activeVenue=null,Ni.dataLayers_={},Ni.tileIndexes_={},Ni.addEventListener(s_.EVENTS.ACTIVE_VENUE_CHANGE,Ni.activeVenueChangeHandler_,void 0,Jy(Ni)),Ni}return _u(_r,[{key:"setStyle",value:function(Ni){return this.setStyleInternal(Ni)}},{key:"getStyle",value:function(){return this.getStyleInternal()}},{key:"isFeatureVisible_",value:function(Ni,ga){var ba=Ni.properties;return this.activeVenue&&ba.venueId===this.activeVenue.getIdentifier()?ga!==q_.FOOTPRINT&&this.activeVenue.getActiveLevels().some(function(_h){return _h.id===ba.levelId}):!0===ba.isFootprint&&ga===q_.FOOTPRINT}},{key:"requestInternal",value:function(Ni,ga,ba,_h){function gg(cy){for(var vy=0;vy<cy.length;vy+=1)cy[vy]=cy[vy].map(function(Ty){return cS(Ty,ba,Ni,ga,YE.extent)})}var oy=this,uy={};return Object.keys(this.tileIndexes_).forEach(function(cy){var vy=oy.tileIndexes_[cy].getTile(ba,Ni,ga);uy[cy]=vy?function YR(_d){var _r=[],Ni=_d&&_d.features;if(Ni)for(var ga=0,ba=Ni.length;ga<ba;ga+=1){var _h=Ni[ga],gg=_h.type,oy=void 0,uy=!1;switch(gg){case 1:oy={type:jx_MULTI_POINT,coordinates:_h.geometry.map(function(cy){return cy.slice()})};break;case 2:case 3:oy={type:jx_MULTI_LINESTRING,coordinates:_h.geometry.map(function(cy){return cy.map(function(vy){return vy.slice()})})},3===gg&&null==(oy=function(cy){for(var vy,Ty=[],Ay=[],e0=0,s0=cy.coordinates.length;e0<s0;e0+=1){var ky=cy.coordinates[e0],u0=xA(ky);null!==u0&&(u0===(vy=vy||u0)&&Ay.length&&(Ty.push(Ay),Ay=[]),Ay.push(ky))}return 0<Ay.length&&Ty.push(Ay),1===Ty.length?(cy.type=jx_POLYGON,cy.coordinates=Ty[0]):1<Ty.length?(cy.type=jx_MULTI_POLYGON,cy.coordinates=Ty):cy=null,cy}(oy))&&(uy=!0);break;default:uy=!0}uy||_r.push({geometry:oy,id:_h.id,properties:_h.tags,type:"Feature"})}return{type:"FeatureCollection",features:_r}}(vy):ox,uy[cy].features=uy[cy].features.filter(function(u0){return oy.isFeatureVisible_(u0,cy)});for(var Ty=0;Ty<uy[cy].features.length;Ty+=1){var Ay=uy[cy].features[Ty],e0=Ay.geometry.type;if(e0===jx_POLYGON||e0===jx_MULTI_LINESTRING)gg(Ay.geometry.coordinates);else if(e0===jx_MULTI_POLYGON)Ay.geometry.coordinates.map(gg);else for(var s0=Ay.geometry.coordinates,ky=0;ky<s0.length;ky+=1)s0[ky]=cS(s0[ky],ba,Ni,ga,YE.extent)}}),_h(uy),{cancel:function(){}}}},{key:"getActiveVenue",value:function(){return this.activeVenue}},{key:"getVenue",value:function(Ni){return Ni?this.venues.find(function(ga){return ga.getIdentifier()===Ni}):this.activeVenue}},{key:"setActiveVenue",value:function(Ni){var ga=this.activeVenue;this.activeVenue=Ni,this.dispatchEvent(new H.util.ChangeEvent(s_.EVENTS.ACTIVE_VENUE_CHANGE,Ni,ga)),this.reload()}},{key:"addVenue",value:function(Ni){var ga=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!(Ni instanceof s_))throw new Error("Invalid argument");var ba=Ni.getIdentifier();if(this.getVenue(ba))throw new Error("Please invoke provider.removeVenue to remove old instance of venue ".concat(ba," before adding new"));Ni.setParentEventTarget(this),this.venues.push(Ni),ga||(this.reloadData_(),this.reloadStyle_())}},{key:"addVenues",value:function(){var Ni=this,ga=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];0<ga.length&&(ga.forEach(function(ba){ba instanceof s_&&Ni.addVenue(ba,!0)}),this.reloadData_(),this.reloadStyle_())}},{key:"removeVenue",value:function(Ni){var ga;Ni instanceof s_&&-1<this.venues.indexOf(Ni)&&(ga=Ni.getIdentifier(),this.activeVenue&&this.activeVenue.getIdentifier()===ga&&this.setActiveVenue(null),this.venues.splice(this.venues.indexOf(Ni),1),this.reloadData_(),this.reloadStyle_(),this.reload())}},{key:"getFeatureProxy",value:function(gg,ga,ba){var _h=gg.geometryId;return gg=this.getVenue(gg=gg.venueId),_h?ba(gg.getGeometries().find(function(oy){return oy.id===_h})):gg&&ba(gg),!0}},{key:"addVenueEventListeners_",value:function(Ni){Ni&&(Ni.addEventListener(s_.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),Ni.addEventListener(s_.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),Ni.addEventListener(s_.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"removeVenueEventListeners_",value:function(Ni){Ni&&(Ni.removeEventListener(s_.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),Ni.removeEventListener(s_.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),Ni.removeEventListener(s_.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"activeVenueChangeHandler_",value:function(ba){var ga=ba.oldValue;ba=ba.newValue,ga&&(this.removeVenueEventListeners_(ga),ga.updateMapObjectsVisibility_()),ba&&(this.addVenueEventListeners_(ba),ba.updateMapObjectsVisibility_())}},{key:"drawingChangeHandler_",value:function(){this.reload()}},{key:"levelChangeHandler_",value:function(){this.activeVenue&&(this.activeVenue.updateMapObjectsVisibility_(),this.reload())}},{key:"geometryHighlightHandler_",value:function(){this.reloadStyle_(this.activeVenue.getHighlightedGeometries())}},{key:"createDataLayers_",value:function(){var Ni=this,ga=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Object.keys(q_),ba=q_.FOOTPRINT,_h=q_.ICON,gg=q_.TEXT,oy=q_.VECTOR;ga.forEach(function(uy){switch(uy){case oy:Ni.dataLayers_[oy]=AA.getGeometryLayer(Ni.venues);break;case ba:Ni.dataLayers_[ba]=AA.getFootprintLayer(Ni.venues);break;case _h:Ni.dataLayers_[_h]=AA.getIconLayer(Ni.venues);break;case gg:Ni.dataLayers_[gg]=AA.getLabelLayer(Ni.venues);break;default:throw new Error("Unsupported Layer ".concat(uy))}})}},{key:"createTileIndexes_",value:function(){var Ni=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:Object.keys(q_)).forEach(function(ga){Ni.tileIndexes_[ga]=new BE(Ni.dataLayers_[ga],YE)})}},{key:"reloadData_",value:function(){var Ni=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Object.keys(q_);this.createDataLayers_(Ni),this.createTileIndexes_(Ni)}},{key:"reloadStyle_",value:function(Ni){var ga=this.dataLayers_[q_.ICON]?this.dataLayers_[q_.ICON].features:[];this.getEngineType()===H.Map.EngineType.WEBGL?this.setStyle($E.getStyle(ga,Ni)):this.getEngineType()===H.Map.EngineType.HARP&&this.setStyle(wS.getStyle(ga,Ni))}},{key:"providesGeoJSON",value:function(){return!0}}]),_r}(),new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3})),QR=new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3}),dI=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImIiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PG1hc2sgaWQ9ImMiIHdpZHRoPSIzOCIgaGVpZ2h0PSI0NiIgeD0iMCIgeT0iMCIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZWxsaXBzZSBjeD0iMjAiIGN5PSI0NS4xNiIgZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjOTc5Nzk3IiBzdHJva2Utd2lkdGg9Ii4yNSIgcng9IjMuNSIgcnk9IjMuNSIvPjx1c2UgZmlsbD0iIzAxQjZCMiIgeGxpbms6aHJlZj0iI2IiLz48cGF0aCBmaWxsPSIjMzIzMjMyIiBmaWxsLW9wYWNpdHk9Ii41IiBkPSJNMTEuODEgMzcuNjZoMTYuMzhsLTguMiA4eiIvPjx1c2Ugc3Ryb2tlPSIjNDE2QTg2IiBzdHJva2Utd2lkdGg9Ii41IiBtYXNrPSJ1cmwoI2MpIiB4bGluazpocmVmPSIjYSIvPjxlbGxpcHNlIGN4PSIxOS44MSIgY3k9IjE5LjE5IiBmaWxsPSIjRkZGIiByeD0iNC44MSIgcnk9IjQuODEiLz48L2c+PC9zdmc+"),gI=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzMi44MyAzMy4xMDRjLjQwNy0uMzc0IDEuNDE5LTEuNDUyIDEuNDE5LTEuNDUyeiIvPjxtYXNrIGlkPSJjIiB3aWR0aD0iMzgiIGhlaWdodD0iNDYiIHg9IjAiIHk9IjAiIGZpbGw9IiNmZmYiPjx1c2UgeGxpbms6aHJlZj0iI2EiLz48L21hc2s+PGVsbGlwc2UgaWQ9ImIiIGN4PSIxOS44MDciIGN5PSIxOS4xNjgiIHJ4PSIxMi4zNjMiIHJ5PSIxMi4xOTciLz48bWFzayBpZD0iZCIgd2lkdGg9IjI1LjcyNSIgaGVpZ2h0PSIyNS4zOTQiIHg9Ii0uNSIgeT0iLS41Ij48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNi45NDQgNi40NzFoMjUuNzI1djI1LjM5NEg2Ljk0NHoiLz48dXNlIHhsaW5rOmhyZWY9IiNiIi8+PC9tYXNrPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxlbGxpcHNlIGN4PSIyMCIgY3k9IjQ1LjE2IiBmaWxsPSIjRkZGIiBzdHJva2U9IiM5Nzk3OTciIHN0cm9rZS13aWR0aD0iLjI1IiByeD0iMy41IiByeT0iMy41Ii8+PHVzZSBmaWxsPSIjMzIzMjMyIiB4bGluazpocmVmPSIjYSIvPjxwYXRoIGZpbGw9IiM3RDdEN0QiIGQ9Ik0xMi4wMTEgMzcuODA1aDE1Ljk3OGwtNy45MTYgOHoiLz48dXNlIHN0cm9rZT0iIzdDN0M3QyIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNlKSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNjKSIgeGxpbms6aHJlZj0iI2EiLz48ZWxsaXBzZSBmaWxsPSIjRkZGIiBjeD0iMTkuODA3IiBjeT0iMTkuMTY4IiByeD0iMTIuMzYzIiByeT0iMTIuMTk3Ii8+PHBhdGggZmlsbD0iIzMyMzIzMiIgZD0iTTYuODEyIDYuOTQ4aDYuNDV2Ni4zNjRoLTYuNDV6bTAgMTIuNzI3aDYuNDV2Ni4zNjRoLTYuNDV6bTYuNDUtNi4zNjNoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS0xOS4wOTFoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS02LjM2M2g2LjQ1djYuMzY0aC02LjQ1em0wIDEyLjcyN2g2LjQ1djYuMzY0aC02LjQ1eiIvPjx1c2Ugc3Ryb2tlPSIjRkZGIiBtYXNrPSJ1cmwoI2QpIiB4bGluazpocmVmPSIjYiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIvPjwvZz48L3N2Zz4="),CA=function(){function _d(_r,Ni){_e(this,_d),this.indoorMapObjects_=null,this.outdoorMapObjects_=null,this.createRouteObjects_(_r,Ni)}return _u(_d,[{key:"createRouteObjects_",value:function(_r){for(var Ni=this,ga=void 0===(_r=_r.sections)?[]:_r,ba=1<arguments.length&&void 0!==arguments[1]?arguments[1]:MC,_h=(this.indoorMapObjects_={},this.outdoorMapObjects_=new H.map.Group,function(uy){var cy,u0,vy=ga[uy],Ty=(Ay=vy.departure.place).id,Ay=Ay.type,e0=H.util.flexiblePolyline.decode(vy.polyline).polyline,s0=void 0,ky=void 0,t0=((u0=ba(uy,ga,_d.ObjectType.SEGMENT_START_MARKER))&&(s0=new H.map.Marker(vy.departure.place.location,{icon:u0})),(u0=ba(uy,ga,_d.ObjectType.SEGMENT_FINISH_MARKER))&&(ky=new H.map.Marker(vy.arrival.place.location,{icon:u0})),ba(uy,ga,_d.ObjectType.SEGMENT_POLYLINE));"indoor"===Ay?(u0=function(){var Fy=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],jy=new Map,By=new H.geo.LineString,qy=Oy(Fy[0],3)[2];return jy.set(qy,[By]),Fy.forEach(function(h0){h0[2]!==qy&&(qy=h0[2],By=new H.geo.LineString,jy.has(qy)?jy.get(qy).push(By):jy.set(qy,[By])),By.pushLatLngAlt.apply(By,K0(h0))}),jy}(e0),cy=Array.from(u0.keys()).reduce(function(Fy,jy){return Fy[jy]||(Fy[jy]=new H.map.Group),Fy},{}),t0&&u0.forEach(function(Fy,jy){Fy.forEach(function(By){1<By.getPointCount()&&(By=new H.map.Polyline(By,{style:t0}),cy[jy].addObject(By))})}),s0&&cy[vy.departure.place.location.lvl].addObject(s0),ky&&cy[vy.arrival.place.location.lvl].addObject(ky),Ni.indoorMapObjects_[Ty]=m(m({},Ni.indoorMapObjects_[Ty]||{}),cy)):(t0&&(uy=new H.geo.LineString(e0.flatMap(function(Fy){return[Fy[0],Fy[1],0]})),Ay=new H.map.Polyline(uy,{style:t0}),Ni.outdoorMapObjects_.addObject(Ay)),s0&&Ni.outdoorMapObjects_.addObject(s0),ky&&Ni.outdoorMapObjects_.addObject(ky))}),gg=0;gg<ga.length;gg++)_h(gg)}},{key:"getIndoorObjects",value:function(){return this.indoorMapObjects_}},{key:"getOutdoorObjects",value:function(){return this.outdoorMapObjects_}}]),_d}(),aD=(CA.ObjectType={SEGMENT_START_MARKER:1,SEGMENT_FINISH_MARKER:2,SEGMENT_POLYLINE:3},function(){iy(_r,H.service.Service);var _d=_m(_r);function _r(Ni){_e(this,_r),ga=_d.call(this,_r,m(m({},Ni),{},{baseUrl:void 0}));var ga,ba={apiKey:Ni.apikey,baseUrl:Ni.baseUrl,token:Ni.token},_h={apiKey:ba.apiKey,token:ba.token},gg=(ba.apiKey||(ba.apiKey=ga.getUrl().getQuery().apikey),Ni.useLegacy||!1);return ga.venueService_=new bS(ba,gg),_h.apiKey||(_h.apiKey=ga.getUrl().getQuery().apikey),Ni.routingBaseUrl&&(_h.baseUrl=Ni.routingBaseUrl),ga.routingService_=new sD(_h),ga}return _u(_r,[{key:"loadVenue",value:function(Ni){return console.warn("Venue service version 1 is no longer supported hence "+Ni+" could not be loaded"),Promise.resolve()}},{key:"calculateRoute",value:function(Ni){return console.warn("HERE Indoor Routing is deprecated and will be removed soon."),this.routingService_.calculateRoute(Ni)}}]),_r}()),Y1=(aD.CONFIG_KEY="venues",function(){iy(_r,H.service.Service);var _d=_m(_r);function _r(_h){_e(this,_r),ga=_d.call(this,_r,m(m({},_h),{},{baseUrl:void 0}));var ga,ba={apiKey:_h.apikey,baseUrl:_h.baseUrl,token:_h.token,hrn:_h.hrn};return ba.apiKey||(ba.apiKey=ga.getUrl().getQuery().apikey),ga.venueService_=new bS(ba,_h=_h.useLegacy||!1),ga}return _u(_r,[{key:"loadVenue",value:function(Ni){return this.venueService_.load(Ni,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).then(function(ga){return new s_(ga)})}}]),_r}()),c0=(Y1.CONFIG_KEY="indoorMaps",H.service.Platform.prototype.getVenuesService=function(_d,_r){var Ni=Y1;return 1!==_r&&_r?_d.hrn||2!==_r||console.warn("Hrn is mandatory parameter in Venue Service version 2"):(console.warn("Venue service version 1 is no longer supported"),Ni=aD),this.createService(Ni,_d)},Y1.LABEL_TEXT_PREFERENCE_OVERRIDE={OCCUPANT_NAMES:"OCCUPANT_NAMES",SPACE_NAME:"SPACE_NAME",SPACE_TYPE_NAME:"SPACE_TYPE_NAME",SPACE_CATEGORY_NAME:"SPACE_CATEGORY_NAME",INTERNAL_ADDRESS:"INTERNAL_ADDRESS"},function(){iy(_r,H.ui.Control);var _d=_m(_r);function _r(Ni){var ga,ba=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return _e(this,_r),(ga=_d.call(this)).provider_=null,ga.levelSelectorUI_=null,ga.setAlignment(ba&&ba.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),ga.addClass("venues-ui"),Ni instanceof s_&&ga.setVenue(Ni),ga}return _u(_r,[{key:"renderInternal",value:function(Ni,ga){y0(sy(_r.prototype),"renderInternal",this).call(this,Ni,ga),this.createLevelSelectorUI_(Ni),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(Ni){Ni instanceof s_&&(this.removeEventListeners_(),this.venue=Ni,this.provider_=Ni.getParentEventTarget(),this.update_(),this.addEventListeners_())}},{key:"createLevelSelectorUI_",value:function(Ni){var ga=this;Ni.innerHTML="",this.levelSelectorUI_=null,this.levelSelectorUI_=new pI(Ni,null,null,function(ba){return ga.venue.setActiveLevelIndex(ba)})}},{key:"update_",value:function(){var Ni,ga;this.levelSelectorUI_&&(Ni=this.venue.getActiveDrawing().getData(),ga=this.venue.getData().getDisplaySettings(),this.levelSelectorUI_.update(Ni,ga),this.levelChangeHandler_())}},{key:"addEventListeners_",value:function(){this.venue&&(this.venue.addEventListener(s_.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.addEventListener(s_.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.addEventListener(s_.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&(this.venue.removeEventListener(s_.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.removeEventListener(s_.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.removeEventListener(s_.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"levelChangeHandler_",value:function(){this.levelSelectorUI_.switch(this.venue.getActiveLevelIndex())}},{key:"drawingChangeHandler_",value:function(){this.update_()}},{key:"activeVenueChangeHandler_",value:function(Ni){this.setVenue(Ni.newValue)}}]),_r}()),PC=function(){iy(_r,H.ui.Control);var _d=_m(_r);function _r(Ni){var ga,ba=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return _e(this,_r),(ga=_d.call(this)).provider_=null,ga.drawingSelectorUI_=null,ga.addClass("venues-ui"),ga.setAlignment(ba&&ba.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),Ni instanceof s_&&ga.setVenue(Ni),ga}return _u(_r,[{key:"renderInternal",value:function(Ni,ga){y0(sy(_r.prototype),"renderInternal",this).call(this,Ni,ga),this.createDrawingSelectorUI_(Ni),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(Ni){Ni instanceof s_&&(this.removeEventListeners_(),this.venue=Ni,this.provider_=Ni.getParentEventTarget(),this.drawingSelectorUI_&&this.drawingSelectorUI_.update(Ni.getData()),this.addEventListeners_())}},{key:"createDrawingSelectorUI_",value:function(Ni){var ga=this;Ni.innerHTML="",this.drawingSelectorUI_=null,this.drawingSelectorUI_=new fI(Ni,null,function(ba){return ga.venue.setActiveDrawing(ba)})}},{key:"addEventListeners_",value:function(){this.venue&&this.venue.addEventListener(s_.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.addEventListener(s_.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&this.venue.removeEventListener(s_.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.removeEventListener(s_.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"drawingChangeHandler_",value:function(){this.drawingSelectorUI_.switch(this.venue.getActiveDrawing().id)}},{key:"activeVenueChangeHandler_",value:function(Ni){this.setVenue(Ni.newValue)}}]),_r}();return PC=Object.freeze({__proto__:null,DrawingControl:PC,LevelControl:c0}),o(".venues-ui * {\n  font-family: \"Fira Sans\", \"Helvetica Neue\", Helvetica, sans-serif;\n  color: #0F1621;\n}\n.venues-ui .arrow {\n  display: block;\n  width: 100%;\n  height: 100%;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.venues-ui .arrow--up {\n  background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-426.000000, -584.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls-Copy' transform='translate(417.753906, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(15.000000, 16.499023) rotate(-180.000000) translate(-15.000000, -16.499023) translate(9.000000, 12.749023)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\");\n}\n.venues-ui .arrow--down {\n  background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-347.000000, -704.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls' transform='translate(338.251953, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(9.000000, 132.746094)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\");\n}\n.venues-ui .venues-ui-button {\n  display: block;\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  font-size: 16px;\n  font-weight: 600;\n  background-color: #fff;\n  border: none;\n  border-bottom: 1px solid #9FA2A6;\n  cursor: pointer;\n  overflow: hidden;\n  color: #6e737a;\n  text-align: center;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.venues-ui .venues-ui-button:hover, .venues-ui .venues-ui-button--active {\n  background-color: #f0f0f0;\n  color: #0F1621;\n}\n@keyframes fade {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n.venues-ui__drawings .drawings {\n  position: absolute;\n  top: 0;\n  right: 45px;\n  display: none;\n  opacity: 0;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);\n}\n.venues-ui__drawings .drawings--open {\n  display: block;\n  opacity: 1;\n  animation: fade 1s;\n}\n.venues-ui__drawings .drawings .venues-ui-button {\n  width: auto;\n  padding: 0 10px;\n}\n.venues-ui__drawings .drawings .venues-ui-button:first-of-type {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n.venues-ui__drawings .drawings .venues-ui-button:last-of-type {\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.venues-ui__drawings .trigger {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);\n}\n.venues-ui__drawings .trigger .arrow {\n  transform: rotate(0);\n  transition: 0.4s;\n}\n.venues-ui__drawings .trigger.venues-ui-button--active .arrow {\n  transform: rotate(90deg);\n  transition: 0.4s;\n}\n.venues-ui__levels {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);\n}\n.venues-ui__levels .levels {\n  overflow: hidden;\n}\n.venues-ui__levels .venues-ui-button--up + .levels .venues-ui-button {\n  border-radius: 0;\n}\n.venues-ui__levels .venues-ui-button:first-of-type {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n.venues-ui__levels .venues-ui-button:last-of-type {\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.venues-ui__levels .venues-ui-button[disabled=disabled] .arrow {\n  opacity: 0.5;\n}\n.venues-ui__directory {\n  position: absolute;\n  top: 10px;\n  right: 60px;\n  bottom: calc(100% - 45px);\n  width: 350px;\n  overflow: hidden;\n  background: white;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);\n}\n.venues-ui__directory.active {\n  bottom: 10px;\n}\n.venues-ui__directory .directory__list {\n  top: 80px;\n  bottom: 20px;\n  position: absolute;\n  overflow-y: scroll;\n  right: 10px;\n  left: 10px;\n  font-size: 12px;\n}\n.venues-ui__directory .directory__list svg {\n  width: 25px;\n  height: 25px;\n}\n.venues-ui__directory .directory__heading {\n  margin: 8px;\n  font-size: 15px;\n  font-weight: normal;\n  cursor: pointer;\n}\n.venues-ui__directory .directory__input {\n  margin: 10px;\n}\n.venues-ui__directory .directory__input input {\n  width: 100%;\n  padding: 5px 0;\n}\n.venues-ui__directory .directory__trigger {\n  position: absolute;\n  right: 10px;\n  top: 15px;\n  width: 10px;\n  height: 10px;\n}\n.venues-ui__directory .directory__trigger .arrow {\n  transform: rotate(0);\n  transition: 0.4s;\n}\n.venues-ui__directory .directory__trigger--active .arrow {\n  transform: rotate(-180deg);\n  transition: 0.4s;\n}"),e.Drawing=q1,e.Geometry=N_,e.Level=Uw,e.Provider=R0,e.Route=CA,e.Service=aD,e.Service2=Y1,e.Venue=s_,e.ui=PC,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}.call(self);const __WEBPACK_DEFAULT_EXPORT__=H},286:(e,o,f)=>{function m(n){return"function"==typeof n}function w(n){const i=n(d=>{Error.call(d),d.stack=(new Error).stack});return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}const k=w(n=>function(i){n(this),this.message=i?`${i.length} errors occurred during unsubscription:\n${i.map((d,v)=>`${v+1}) ${d.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=i});function Y(n,r){if(n){const i=n.indexOf(r);0<=i&&n.splice(i,1)}}class _e{constructor(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let r;if(!this.closed){this.closed=!0;const{_parentage:i}=this;if(i)if(this._parentage=null,Array.isArray(i))for(const I of i)I.remove(this);else i.remove(this);const{initialTeardown:d}=this;if(m(d))try{d()}catch(I){r=I instanceof k?I.errors:[I]}const{_finalizers:v}=this;if(v){this._finalizers=null;for(const I of v)try{pd(I)}catch(q){r=r??[],q instanceof k?r=[...r,...q.errors]:r.push(q)}}if(r)throw new k(r)}}add(r){var i;if(r&&r!==this)if(this.closed)pd(r);else{if(r instanceof _e){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=null!==(i=this._finalizers)&&void 0!==i?i:[]).push(r)}}_hasParent(r){const{_parentage:i}=this;return i===r||Array.isArray(i)&&i.includes(r)}_addParent(r){const{_parentage:i}=this;this._parentage=Array.isArray(i)?(i.push(r),i):i?[i,r]:r}_removeParent(r){const{_parentage:i}=this;i===r?this._parentage=null:Array.isArray(i)&&Y(i,r)}remove(r){const{_finalizers:i}=this;i&&Y(i,r),r instanceof _e&&r._removeParent(this)}}_e.EMPTY=(()=>{const n=new _e;return n.closed=!0,n})();const _o=_e.EMPTY;function _u(n){return n instanceof _e||n&&"closed"in n&&m(n.remove)&&m(n.add)&&m(n.unsubscribe)}function pd(n){m(n)?n():n.unsubscribe()}const iy={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},sy={setTimeout(n,r,...i){const{delegate:d}=sy;return d?.setTimeout?d.setTimeout(n,r,...i):setTimeout(n,r,...i)},clearTimeout(n){const{delegate:r}=sy;return(r?.clearTimeout||clearTimeout)(n)},delegate:void 0};function gy(n){sy.setTimeout(()=>{const{onUnhandledError:r}=iy;if(!r)throw n;r(n)})}function wy(){}const Ey=_m("C",void 0,void 0);function _m(n,r,i){return{kind:n,value:r,error:i}}let y0=null;function Oy(n){if(iy.useDeprecatedSynchronousErrorHandling){const r=!y0;if(r&&(y0={errorThrown:!1,error:null}),n(),r){const{errorThrown:i,error:d}=y0;if(y0=null,i)throw d}}else n()}class I0 extends _e{constructor(r){super(),this.isStopped=!1,r?(this.destination=r,_u(r)&&r.add(this)):this.destination=S1}static create(r,i,d){return new Uw(r,i,d)}next(r){this.isStopped?Px(function Jy(n){return _m("N",n,void 0)}(r),this):this._next(r)}error(r){this.isStopped?Px(function Py(n){return _m("E",void 0,n)}(r),this):(this.isStopped=!0,this._error(r))}complete(){this.isStopped?Px(Ey,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(r){this.destination.next(r)}_error(r){try{this.destination.error(r)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const p1=Function.prototype.bind;function N_(n,r){return p1.call(n,r)}class q1{constructor(r){this.partialObserver=r}next(r){const{partialObserver:i}=this;if(i.next)try{i.next(r)}catch(d){K_(d)}}error(r){const{partialObserver:i}=this;if(i.error)try{i.error(r)}catch(d){K_(d)}else K_(r)}complete(){const{partialObserver:r}=this;if(r.complete)try{r.complete()}catch(i){K_(i)}}}class Uw extends I0{constructor(r,i,d){let v;if(super(),m(r)||!r)v={next:r??void 0,error:i??void 0,complete:d??void 0};else{let I;this&&iy.useDeprecatedNextContext?(I=Object.create(r),I.unsubscribe=()=>this.unsubscribe(),v={next:r.next&&N_(r.next,I),error:r.error&&N_(r.error,I),complete:r.complete&&N_(r.complete,I)}):v=r}this.destination=new q1(v)}}function K_(n){iy.useDeprecatedSynchronousErrorHandling?function K0(n){iy.useDeprecatedSynchronousErrorHandling&&y0&&(y0.errorThrown=!0,y0.error=n)}(n):gy(n)}function Px(n,r){const{onStoppedNotification:i}=iy;i&&sy.setTimeout(()=>i(n,r))}const S1={closed:!0,next:wy,error:function F_(n){throw n},complete:wy},zE="function"==typeof Symbol&&Symbol.observable||"@@observable";function fE(n){return n}function G2(n){return 0===n.length?fE:1===n.length?n[0]:function(i){return n.reduce((d,v)=>v(d),i)}}let i1=(()=>{class n{constructor(i){i&&(this._subscribe=i)}lift(i){const d=new n;return d.source=this,d.operator=i,d}subscribe(i,d,v){const I=function vC(n){return n&&n instanceof I0||function Fx(n){return n&&m(n.next)&&m(n.error)&&m(n.complete)}(n)&&_u(n)}(i)?i:new Uw(i,d,v);return Oy(()=>{const{operator:q,source:J}=this;I.add(q?q.call(I,J):J?this._subscribe(I):this._trySubscribe(I))}),I}_trySubscribe(i){try{return this._subscribe(i)}catch(d){i.error(d)}}forEach(i,d){return new(d=Lx(d))((v,I)=>{const q=new Uw({next:J=>{try{i(J)}catch(_n){I(_n),q.unsubscribe()}},error:I,complete:v});this.subscribe(q)})}_subscribe(i){var d;return null===(d=this.source)||void 0===d?void 0:d.subscribe(i)}[zE](){return this}pipe(...i){return G2(i)(this)}toPromise(i){return new(i=Lx(i))((d,v)=>{let I;this.subscribe(q=>I=q,q=>v(q),()=>d(I))})}}return n.create=r=>new n(r),n})();function Lx(n){var r;return null!==(r=n??iy.Promise)&&void 0!==r?r:Promise}const CE=w(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let W1=(()=>{class n extends i1{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(i){const d=new q2(this,this);return d.operator=i,d}_throwIfClosed(){if(this.closed)throw new CE}next(i){Oy(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const d of this.currentObservers)d.next(i)}})}error(i){Oy(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=i;const{observers:d}=this;for(;d.length;)d.shift().error(i)}})}complete(){Oy(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:i}=this;for(;i.length;)i.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var i;return(null===(i=this.observers)||void 0===i?void 0:i.length)>0}_trySubscribe(i){return this._throwIfClosed(),super._trySubscribe(i)}_subscribe(i){return this._throwIfClosed(),this._checkFinalizedStatuses(i),this._innerSubscribe(i)}_innerSubscribe(i){const{hasError:d,isStopped:v,observers:I}=this;return d||v?_o:(this.currentObservers=null,I.push(i),new _e(()=>{this.currentObservers=null,Y(I,i)}))}_checkFinalizedStatuses(i){const{hasError:d,thrownError:v,isStopped:I}=this;d?i.error(v):I&&i.complete()}asObservable(){const i=new i1;return i.source=this,i}}return n.create=(r,i)=>new q2(r,i),n})();class q2 extends W1{constructor(r,i){super(),this.destination=r,this.source=i}next(r){var i,d;null===(d=null===(i=this.destination)||void 0===i?void 0:i.next)||void 0===d||d.call(i,r)}error(r){var i,d;null===(d=null===(i=this.destination)||void 0===i?void 0:i.error)||void 0===d||d.call(i,r)}complete(){var r,i;null===(i=null===(r=this.destination)||void 0===r?void 0:r.complete)||void 0===i||i.call(r)}_subscribe(r){var i,d;return null!==(d=null===(i=this.source)||void 0===i?void 0:i.subscribe(r))&&void 0!==d?d:_o}}function W2(n){return m(n?.lift)}function o1(n){return r=>{if(W2(r))return r.lift(function(i){try{return n(i,this)}catch(d){this.error(d)}});throw new TypeError("Unable to lift unknown Observable type")}}function G_(n,r,i,d,v){return new _C(n,r,i,d,v)}class _C extends I0{constructor(r,i,d,v,I,q){super(r),this.onFinalize=I,this.shouldUnsubscribe=q,this._next=i?function(J){try{i(J)}catch(_n){r.error(_n)}}:super._next,this._error=v?function(J){try{v(J)}catch(_n){r.error(_n)}finally{this.unsubscribe()}}:super._error,this._complete=d?function(){try{d()}catch(J){r.error(J)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:i}=this;super.unsubscribe(),!i&&(null===(r=this.onFinalize)||void 0===r||r.call(this))}}}function r_(n,r){return o1((i,d)=>{let v=0;i.subscribe(G_(d,I=>{d.next(n.call(r,I,v++))}))})}function HE(n){return this instanceof HE?(this.v=n,this):new HE(n)}function X2(n,r,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var v,d=i.apply(n,r||[]),I=[];return v={},q("next"),q("throw"),q("return"),v[Symbol.asyncIterator]=function(){return this},v;function q(ay){d[ay]&&(v[ay]=function(yy){return new Promise(function(xy,Ry){I.push([ay,yy,xy,Ry])>1||J(ay,yy)})})}function J(ay,yy){try{!function _n(ay){ay.value instanceof HE?Promise.resolve(ay.value.v).then(_a,_f):gd(I[0][2],ay)}(d[ay](yy))}catch(xy){gd(I[0][3],xy)}}function _a(ay){J("next",ay)}function _f(ay){J("throw",ay)}function gd(ay,yy){ay(yy),I.shift(),I.length&&J(I[0][0],I[0][1])}}function sI(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n[Symbol.asyncIterator];return r?r.call(n):(n=function Z2(n){var r="function"==typeof Symbol&&Symbol.iterator,i=r&&n[r],d=0;if(i)return i.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&d>=n.length&&(n=void 0),{value:n&&n[d++],done:!n}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),i={},d("next"),d("throw"),d("return"),i[Symbol.asyncIterator]=function(){return this},i);function d(I){i[I]=n[I]&&function(q){return new Promise(function(J,_n){!function v(I,q,J,_n){Promise.resolve(_n).then(function(_a){I({value:_a,done:J})},q)}(J,_n,(q=n[I](q)).done,q.value)})}}}const EC=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Q2(n){return m(n?.then)}function pS(n){return m(n[zE])}function dS(n){return Symbol.asyncIterator&&m(n?.[Symbol.asyncIterator])}function EA(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const gS=function cI(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function TC(n){return m(n?.[gS])}function AC(n){return X2(this,arguments,function*(){const i=n.getReader();try{for(;;){const{value:d,done:v}=yield HE(i.read());if(v)return yield HE(void 0);yield yield HE(d)}}finally{i.releaseLock()}})}function CC(n){return m(n?.getReader)}function $1(n){if(n instanceof i1)return n;if(null!=n){if(pS(n))return function tD(n){return new i1(r=>{const i=n[zE]();if(m(i.subscribe))return i.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(EC(n))return function eD(n){return new i1(r=>{for(let i=0;i<n.length&&!r.closed;i++)r.next(n[i]);r.complete()})}(n);if(Q2(n))return function nD(n){return new i1(r=>{n.then(i=>{r.closed||(r.next(i),r.complete())},i=>r.error(i)).then(null,gy)})}(n);if(dS(n))return uT(n);if(TC(n))return function rD(n){return new i1(r=>{for(const i of n)if(r.next(i),r.closed)return;r.complete()})}(n);if(CC(n))return function yS(n){return uT(AC(n))}(n)}throw EA(n)}function uT(n){return new i1(r=>{(function hI(n,r){var i,d,v,I;return function K2(n,r,i,d){return new(i||(i=Promise))(function(I,q){function J(_f){try{_a(d.next(_f))}catch(gd){q(gd)}}function _n(_f){try{_a(d.throw(_f))}catch(gd){q(gd)}}function _a(_f){_f.done?I(_f.value):function v(I){return I instanceof i?I:new i(function(q){q(I)})}(_f.value).then(J,_n)}_a((d=d.apply(n,r||[])).next())})}(this,void 0,void 0,function*(){try{for(i=sI(n);!(d=yield i.next()).done;)if(r.next(d.value),r.closed)return}catch(q){v={error:q}}finally{try{d&&!d.done&&(I=i.return)&&(yield I.call(i))}finally{if(v)throw v.error}}r.complete()})})(n,r).catch(i=>r.error(i))})}function pE(n,r,i,d=0,v=!1){const I=r.schedule(function(){i(),v?n.add(this.schedule(null,d)):this.unsubscribe()},d);if(n.add(I),!v)return I}function s1(n,r,i=1/0){return m(r)?s1((d,v)=>r_((I,q)=>r(d,I,v,q))($1(n(d,v))),i):("number"==typeof r&&(i=r),o1((d,v)=>function mS(n,r,i,d,v,I,q,J){const _n=[];let _a=0,_f=0,gd=!1;const ay=()=>{gd&&!_n.length&&!_a&&r.complete()},yy=Ry=>_a<d?xy(Ry):_n.push(Ry),xy=Ry=>{I&&r.next(Ry),_a++;let zy=!1;$1(i(Ry,_f++)).subscribe(G_(r,Ky=>{v?.(Ky),I?yy(Ky):r.next(Ky)},()=>{zy=!0},void 0,()=>{if(zy)try{for(_a--;_n.length&&_a<d;){const Ky=_n.shift();q?pE(r,q,()=>xy(Ky)):xy(Ky)}ay()}catch(Ky){r.error(Ky)}}))};return n.subscribe(G_(r,yy,()=>{gd=!0,ay()})),()=>{J?.()}}(d,v,n,i)))}function UE(n=1/0){return s1(fE,n)}const dE=new i1(n=>n.complete());function iD(n){return n&&m(n.schedule)}function DC(n){return n[n.length-1]}function SC(n){return m(DC(n))?n.pop():void 0}function GE(n){return iD(DC(n))?n.pop():void 0}function MC(n,r=0){return o1((i,d)=>{i.subscribe(G_(d,v=>pE(d,n,()=>d.next(v),r),()=>pE(d,n,()=>d.complete(),r),v=>pE(d,n,()=>d.error(v),r)))})}function qE(n,r=0){return o1((i,d)=>{d.add(n.schedule(()=>i.subscribe(d),r))})}function kC(n,r){if(!n)throw new Error("Iterable cannot be null");return new i1(i=>{pE(i,r,()=>{const d=n[Symbol.asyncIterator]();pE(i,r,()=>{d.next().then(v=>{v.done?i.complete():i.next(v.value)})},0,!0)})})}function Z_(n,r){return r?function oD(n,r){if(null!=n){if(pS(n))return function WT(n,r){return $1(n).pipe(qE(r),MC(r))}(n,r);if(EC(n))return function vS(n,r){return new i1(i=>{let d=0;return r.schedule(function(){d===n.length?i.complete():(i.next(n[d++]),i.closed||this.schedule())})})}(n,r);if(Q2(n))return function IC(n,r){return $1(n).pipe(qE(r),MC(r))}(n,r);if(dS(n))return kC(n,r);if(TC(n))return function fI(n,r){return new i1(i=>{let d;return pE(i,r,()=>{d=n[gS](),pE(i,r,()=>{let v,I;try{({value:v,done:I}=d.next())}catch(q){return void i.error(q)}I?i.complete():i.next(v)},0,!0)}),()=>m(d?.return)&&d.return()})}(n,r);if(CC(n))return function ME(n,r){return kC(AC(n),r)}(n,r)}throw EA(n)}(n,r):$1(n)}function WE(n,r,...i){if(!0===r)return void n();if(!1===r)return;const d=new Uw({next:()=>{d.unsubscribe(),n()}});return r(...i).subscribe(d)}function E_(n){for(let r in n)if(n[r]===E_)return r;throw Error("Could not find renamed property on target object.")}function $T(n,r){for(const i in r)r.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(n[i]=r[i])}function l_(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(l_).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const r=n.toString();if(null==r)return""+r;const i=r.indexOf("\n");return-1===i?r:r.substring(0,i)}function TA(n,r){return null==n||""===n?null===r?"":r:null==r||""===r?n:n+" "+r}const ix=E_({__forward_ref__:E_});function H_(n){return n.__forward_ref__=H_,n.toString=function(){return l_(this())},n}function O0(n){return RC(n)?n():n}function RC(n){return"function"==typeof n&&n.hasOwnProperty(ix)&&n.__forward_ref__===H_}class a0 extends Error{constructor(r,i){super(function YT(n,r){return`NG0${Math.abs(n)}${r?": "+r.trim():""}`}(r,i)),this.code=r}}function Z0(n){return"string"==typeof n?n:null==n?"":String(n)}function Ww(n,r){throw new a0(-201,!1)}function Y1(n,r){null==n&&function c0(n,r,i,d){throw new Error(`ASSERTION ERROR: ${n}`+(null==d?"":` [Expected=> ${i} ${d} ${r} <=Actual]`))}(r,n,null,"!=")}function Ni(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ba(n){return{providers:n.providers||[],imports:n.imports||[]}}function _h(n){return oy(n,Ty)||oy(n,e0)}function oy(n,r){return n.hasOwnProperty(r)?n[r]:null}function vy(n){return n&&(n.hasOwnProperty(Ay)||n.hasOwnProperty(s0))?n[Ay]:null}const Ty=E_({\u0275prov:E_}),Ay=E_({\u0275inj:E_}),e0=E_({ngInjectableDef:E_}),s0=E_({ngInjectorDef:E_});var ky=(()=>((ky=ky||{})[ky.Default=0]="Default",ky[ky.Host=1]="Host",ky[ky.Self=2]="Self",ky[ky.SkipSelf=4]="SkipSelf",ky[ky.Optional=8]="Optional",ky))();let u0;function Fy(n){const r=u0;return u0=n,r}function jy(n,r,i){const d=_h(n);return d&&"root"==d.providedIn?void 0===d.value?d.value=d.factory():d.value:i&ky.Optional?null:void 0!==r?r:void Ww(l_(n))}function qy(n){return{toString:n}.toString()}var h0=(()=>((h0=h0||{})[h0.OnPush=0]="OnPush",h0[h0.Default=1]="Default",h0))(),n0=(()=>{return(n=n0||(n0={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n0;var n})();const Gy=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),w0={},E0=[],u_=E_({\u0275cmp:E_}),__=E_({\u0275dir:E_}),b_=E_({\u0275pipe:E_}),U_=E_({\u0275mod:E_}),V0=E_({\u0275fac:E_}),q0=E_({__NG_ELEMENT_ID__:E_});let a1=0;function B0(n){return qy(()=>{const i=!0===n.standalone,d={},v={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:d,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===h0.OnPush,directiveDefs:null,pipeDefs:null,standalone:i,dependencies:i&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||E0,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||n0.Emulated,id:"c"+a1++,styles:n.styles||E0,_:null,setInput:null,schemas:n.schemas||null,tView:null},I=n.dependencies,q=n.features;return v.inputs=DA(n.inputs,d),v.outputs=DA(n.outputs),q&&q.forEach(J=>J(v)),v.directiveDefs=I?()=>("function"==typeof I?I():I).map(KT).filter($x):null,v.pipeDefs=I?()=>("function"==typeof I?I():I).map(k1).filter($x):null,v})}function KT(n){return y_(n)||I1(n)}function $x(n){return null!==n}function u1(n){return qy(()=>({type:n.type,bootstrap:n.bootstrap||E0,declarations:n.declarations||E0,imports:n.imports||E0,exports:n.exports||E0,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function DA(n,r){if(null==n)return w0;const i={};for(const d in n)if(n.hasOwnProperty(d)){let v=n[d],I=v;Array.isArray(v)&&(I=v[1],v=v[0]),i[v]=d,r&&(r[v]=I)}return i}const H0=B0;function y_(n){return n[u_]||null}function I1(n){return n[__]||null}function k1(n){return n[b_]||null}function T1(n,r){const i=n[U_]||null;if(!i&&!0===r)throw new Error(`Type ${l_(n)} does not have '\u0275mod' property.`);return i}function L_(n){return Array.isArray(n)&&"object"==typeof n[1]}function h1(n){return Array.isArray(n)&&!0===n[1]}function jC(n){return 0!=(8&n.flags)}function cD(n){return 2==(2&n.flags)}function RA(n){return 1==(1&n.flags)}function gE(n){return null!==n.template}function mI(n){return 0!=(256&n[2])}function j_(n,r){return n.hasOwnProperty(V0)?n[V0]:null}class iN{constructor(r,i,d){this.previousValue=r,this.currentValue=i,this.firstChange=d}isFirstChange(){return this.firstChange}}function My(){return AS}function AS(n){return n.type.prototype.ngOnChanges&&(n.setInput=_I),vI}function vI(){const n=DS(this),r=n?.current;if(r){const i=n.previous;if(i===w0)n.previous=r;else for(let d in r)i[d]=r[d];n.current=null,this.ngOnChanges(r)}}function _I(n,r,i,d){const v=DS(n)||function bI(n,r){return n[CS]=r}(n,{previous:w0,current:null}),I=v.current||(v.current={}),q=v.previous,J=this.declaredInputs[i],_n=q[J];I[J]=new iN(_n&&_n.currentValue,r,q===w0),n[d]=r}My.ngInherit=!0;const CS="__ngSimpleChanges__";function DS(n){return n[CS]||null}function b1(n){for(;Array.isArray(n);)n=n[0];return n}function dD(n,r){return b1(r[n])}function X1(n,r){return b1(r[n.index])}function MS(n,r){return n.data[r]}function mx(n,r){const i=r[n];return L_(i)?i:i[0]}function NA(n){return 64==(64&n[2])}function yE(n,r){return null==r?null:n[r]}function zC(n){n[18]=0}function xI(n,r){n[5]+=r;let i=n,d=n[3];for(;null!==d&&(1===r&&1===i[5]||-1===r&&0===i[5]);)d[5]+=r,i=d,d=d[3]}const i_={lFrame:qC(null),bindingsEnabled:!0};function uN(){return i_.bindingsEnabled}function Hy(){return i_.lFrame.lView}function k_(){return i_.lFrame.tView}function IS(n){return i_.lFrame.contextLView=n,n[8]}function AI(n){return i_.lFrame.contextLView=null,n}function f_(){let n=kS();for(;null!==n&&64===n.type;)n=n.parent;return n}function kS(){return i_.lFrame.currentTNode}function J1(n,r){const i=i_.lFrame;i.currentTNode=n,i.isParent=r}function nA(){return i_.lFrame.isParent}function OS(){i_.lFrame.isParent=!1}function UC(){return i_.lFrame.bindingIndex++}function hN(n,r){const i=i_.lFrame;i.bindingIndex=i.bindingRootIndex=n,GC(r)}function GC(n){i_.lFrame.currentDirectiveIndex=n}function CI(){return i_.lFrame.currentQueryIndex}function DI(n){i_.lFrame.currentQueryIndex=n}function fN(n){const r=n[1];return 2===r.type?r.declTNode:1===r.type?n[6]:null}function PS(n,r,i){if(i&ky.SkipSelf){let v=r,I=n;for(;!(v=v.parent,null!==v||i&ky.Host||(v=fN(I),null===v||(I=I[15],10&v.type))););if(null===v)return!1;r=v,n=I}const d=i_.lFrame=LA();return d.currentTNode=r,d.lView=n,!0}function gD(n){const r=LA(),i=n[1];i_.lFrame=r,r.currentTNode=i.firstChild,r.lView=n,r.tView=i,r.contextLView=n,r.bindingIndex=i.bindingStartIndex,r.inI18n=!1}function LA(){const n=i_.lFrame,r=null===n?null:n.child;return null===r?qC(n):r}function qC(n){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=r),r}function SI(){const n=i_.lFrame;return i_.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const by=SI;function WC(){const n=SI();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ux(){return i_.lFrame.selectedIndex}function fT(n){i_.lFrame.selectedIndex=n}function YC(n,r){for(let i=r.directiveStart,d=r.directiveEnd;i<d;i++){const I=n.data[i].type.prototype,{ngAfterContentInit:q,ngAfterContentChecked:J,ngAfterViewInit:_n,ngAfterViewChecked:_a,ngOnDestroy:_f}=I;q&&(n.contentHooks||(n.contentHooks=[])).push(-i,q),J&&((n.contentHooks||(n.contentHooks=[])).push(i,J),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(i,J)),_n&&(n.viewHooks||(n.viewHooks=[])).push(-i,_n),_a&&((n.viewHooks||(n.viewHooks=[])).push(i,_a),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(i,_a)),null!=_f&&(n.destroyHooks||(n.destroyHooks=[])).push(i,_f)}}function FA(n,r,i){ZE(n,r,3,i)}function jA(n,r,i,d){(3&n[2])===i&&ZE(n,r,i,d)}function yD(n,r){let i=n[2];(3&i)===r&&(i&=2047,i+=1,n[2]=i)}function ZE(n,r,i,d){const I=d??-1,q=r.length-1;let J=0;for(let _n=void 0!==d?65535&n[18]:0;_n<q;_n++)if("number"==typeof r[_n+1]){if(J=r[_n],null!=d&&J>=d)break}else r[_n]<0&&(n[18]+=65536),(J<I||-1==I)&&(gN(n,i,r,_n),n[18]=(4294901760&n[18])+_n+2),_n++}function gN(n,r,i,d){const v=i[d]<0,I=i[d+1],J=n[v?-i[d]:i[d]];if(v){if(n[2]>>11<n[18]>>16&&(3&n[2])===r){n[2]+=2048;try{I.call(J)}finally{}}}else try{I.call(J)}finally{}}class KC{constructor(r,i,d){this.factory=r,this.resolving=!1,this.canSeeViewProviders=i,this.injectImpl=d}}function FS(n,r,i){let d=0;for(;d<i.length;){const v=i[d];if("number"==typeof v){if(0!==v)break;d++;const I=i[d++],q=i[d++],J=i[d++];n.setAttribute(r,q,J,I)}else{const I=v,q=i[++d];OI(I)?n.setProperty(r,I,q):n.setAttribute(r,I,q),d++}}return d}function kI(n){return 3===n||4===n||6===n}function OI(n){return 64===n.charCodeAt(0)}function b0(n,r){if(null!==r&&0!==r.length)if(null===n||0===n.length)n=r.slice();else{let i=-1;for(let d=0;d<r.length;d++){const v=r[d];"number"==typeof v?i=v:0===i||e1(n,i,v,null,-1===i||2===i?r[++d]:null)}}return n}function e1(n,r,i,d,v){let I=0,q=n.length;if(-1===r)q=-1;else for(;I<n.length;){const J=n[I++];if("number"==typeof J){if(J===r){q=-1;break}if(J>r){q=I-1;break}}}for(;I<n.length;){const J=n[I];if("number"==typeof J)break;if(J===i){if(null===d)return void(null!==v&&(n[I+1]=v));if(d===n[I+1])return void(n[I+2]=v)}I++,null!==d&&I++,null!==v&&I++}-1!==q&&(n.splice(q,0,r),I=q+1),n.splice(I++,0,i),null!==d&&n.splice(I++,0,d),null!==v&&n.splice(I++,0,v)}function VA(n){return-1!==n}function ZC(n){return 32767&n}function pT(n,r){let i=function RI(n){return n>>16}(n),d=r;for(;i>0;)d=d[15],i--;return d}let l0=!0;function R1(n){const r=l0;return l0=n,r}let I3=0;const Q1={};function W_(n,r){const i=LI(n,r);if(-1!==i)return i;const d=r[1];d.firstCreatePass&&(n.injectorIndex=r.length,PI(d.data,n),PI(r,null),PI(d.blueprint,null));const v=n1(n,r),I=n.injectorIndex;if(VA(v)){const q=ZC(v),J=pT(v,r),_n=J[1].data;for(let _a=0;_a<8;_a++)r[I+_a]=J[q+_a]|_n[q+_a]}return r[I+8]=v,I}function PI(n,r){n.push(0,0,0,0,0,0,0,0,r)}function LI(n,r){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===r[n.injectorIndex+8]?-1:n.injectorIndex}function n1(n,r){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let i=0,d=null,v=r;for(;null!==v;){if(d=GS(v),null===d)return-1;if(i++,v=v[15],-1!==d.injectorIndex)return d.injectorIndex|i<<16}return-1}function XC(n,r,i){!function mN(n,r,i){let d;"string"==typeof i?d=i.charCodeAt(0)||0:i.hasOwnProperty(q0)&&(d=i[q0]),null==d&&(d=i[q0]=I3++);const v=255&d;r.data[n+(v>>5)]|=1<<v}(n,r,i)}function VS(n,r,i){if(i&ky.Optional||void 0!==n)return n;Ww()}function zS(n,r,i,d){if(i&ky.Optional&&void 0===d&&(d=null),0==(i&(ky.Self|ky.Host))){const v=n[9],I=Fy(void 0);try{return v?v.get(r,d,i&ky.Optional):jy(r,d,i&ky.Optional)}finally{Fy(I)}}return VS(d,0,i)}function JC(n,r,i,d=ky.Default,v){if(null!==n){if(1024&r[2]){const q=function VI(n,r,i,d,v){let I=n,q=r;for(;null!==I&&null!==q&&1024&q[2]&&!(256&q[2]);){const J=BS(I,q,i,d|ky.Self,Q1);if(J!==Q1)return J;let _n=I.parent;if(!_n){const _a=q[21];if(_a){const _f=_a.get(i,Q1,d);if(_f!==Q1)return _f}_n=GS(q),q=q[15]}I=_n}return v}(n,r,i,d,Q1);if(q!==Q1)return q}const I=BS(n,r,i,d,Q1);if(I!==Q1)return I}return zS(r,i,d,v)}function BS(n,r,i,d,v){const I=function FI(n){if("string"==typeof n)return n.charCodeAt(0)||0;const r=n.hasOwnProperty(q0)?n[q0]:void 0;return"number"==typeof r?r>=0?255&r:RE:r}(i);if("function"==typeof I){if(!PS(r,n,d))return d&ky.Host?VS(v,0,d):zS(r,i,d,v);try{const q=I(d);if(null!=q||d&ky.Optional)return q;Ww()}finally{by()}}else if("number"==typeof I){let q=null,J=LI(n,r),_n=-1,_a=d&ky.Host?r[16][6]:null;for((-1===J||d&ky.SkipSelf)&&(_n=-1===J?n1(n,r):r[J+8],-1!==_n&&jI(d,!1)?(q=r[1],J=ZC(_n),r=pT(_n,r)):J=-1);-1!==J;){const _f=r[1];if(HS(I,J,_f.data)){const gd=vN(J,r,i,q,d,_a);if(gd!==Q1)return gd}_n=r[J+8],-1!==_n&&jI(d,r[1].data[J+8]===_a)&&HS(I,J,r)?(q=_f,J=ZC(_n),r=pT(_n,r)):J=-1}}return v}function vN(n,r,i,d,v,I){const q=r[1],J=q.data[n+8],_f=zA(J,q,i,null==d?cD(J)&&l0:d!=q&&0!=(3&J.type),v&ky.Host&&I===J);return null!==_f?QC(r,q,_f,J):Q1}function zA(n,r,i,d,v){const I=n.providerIndexes,q=r.data,J=1048575&I,_n=n.directiveStart,_f=I>>20,ay=v?J+_f:n.directiveEnd;for(let yy=d?J:J+_f;yy<ay;yy++){const xy=q[yy];if(yy<_n&&i===xy||yy>=_n&&xy.type===i)return yy}if(v){const yy=q[_n];if(yy&&gE(yy)&&yy.type===i)return _n}return null}function QC(n,r,i,d){let v=n[i];const I=r.data;if(function bx(n){return n instanceof KC}(v)){const q=v;q.resolving&&function bS(n,r){const i=r?`. Dependency path: ${r.join(" > ")} > ${n}`:"";throw new a0(-200,`Circular dependency in DI detected for ${n}${i}`)}(function P_(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Z0(n)}(I[i]));const J=R1(q.canSeeViewProviders);q.resolving=!0;const _n=q.injectImpl?Fy(q.injectImpl):null;PS(n,d,ky.Default);try{v=n[i]=q.factory(void 0,I,n,d),r.firstCreatePass&&i>=d.directiveStart&&function dN(n,r,i){const{ngOnChanges:d,ngOnInit:v,ngDoCheck:I}=r.type.prototype;if(d){const q=AS(r);(i.preOrderHooks||(i.preOrderHooks=[])).push(n,q),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(n,q)}v&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-n,v),I&&((i.preOrderHooks||(i.preOrderHooks=[])).push(n,I),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(n,I))}(i,I[i],r)}finally{null!==_n&&Fy(_n),R1(J),q.resolving=!1,by()}}return v}function HS(n,r,i){return!!(i[r+(n>>5)]&1<<n)}function jI(n,r){return!(n&ky.Self||n&ky.Host&&r)}class BA{constructor(r,i){this._tNode=r,this._lView=i}get(r,i,d){return JC(this._tNode,this._lView,r,d,i)}}function RE(){return new BA(f_(),Hy())}function US(n){return RC(n)?()=>{const r=US(O0(n));return r&&r()}:j_(n)}function GS(n){const r=n[1],i=r.type;return 2===i?r.declTNode:1===i?n[6]:null}const HA="__parameters__";function GA(n,r,i){return qy(()=>{const d=function _D(n){return function(...i){if(n){const d=n(...i);for(const v in d)this[v]=d[v]}}}(r);function v(...I){if(this instanceof v)return d.apply(this,I),this;const q=new v(...I);return J.annotation=q,J;function J(_n,_a,_f){const gd=_n.hasOwnProperty(HA)?_n[HA]:Object.defineProperty(_n,HA,{value:[]})[HA];for(;gd.length<=_f;)gd.push(null);return(gd[_f]=gd[_f]||[]).push(q),_n}}return i&&(v.prototype=Object.create(i.prototype)),v.prototype.ngMetadataName=n,v.annotationCls=v,v})}class z0{constructor(r,i){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof i?this.__NG_ELEMENT_ID__=i:void 0!==i&&(this.\u0275prov=Ni({token:this,providedIn:i.providedIn||"root",factory:i.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Kx(n,r){void 0===r&&(r=n);for(let i=0;i<n.length;i++){let d=n[i];Array.isArray(d)?(r===n&&(r=n.slice(0,i)),Kx(d,r)):r!==n&&r.push(d)}return r}function mE(n,r){n.forEach(i=>Array.isArray(i)?mE(i,r):r(i))}function gT(n,r,i){r>=n.length?n.push(i):n.splice(r,0,i)}function Zy(n,r){return r>=n.length-1?n.pop():n.splice(r,1)[0]}function Zx(n,r,i){let d=qA(n,r);return d>=0?n[1|d]=i:(d=~d,function UI(n,r,i,d){let v=n.length;if(v==r)n.push(i,d);else if(1===v)n.push(d,n[0]),n[0]=i;else{for(v--,n.push(n[v-1],n[v]);v>r;)n[v]=n[v-2],v--;n[r]=i,n[r+1]=d}}(n,d,r,i)),d}function mT(n,r){const i=qA(n,r);if(i>=0)return n[1|i]}function qA(n,r){return function qI(n,r,i){let d=0,v=n.length>>i;for(;v!==d;){const I=d+(v-d>>1),q=n[I<<i];if(r===q)return I<<i;q>r?v=I:d=I+1}return~(v<<i)}(n,r,1)}const s2={},WI="__NG_DI_FLAG__",WA="ngTempTokenPath",$S=/\n/gm,$I="__source";let wD;function a2(n){const r=wD;return wD=n,r}function F3(n,r=ky.Default){if(void 0===wD)throw new a0(-203,!1);return null===wD?jy(n,void 0,r):wD.get(n,r&ky.Optional?null:void 0,r)}function x0(n,r=ky.Default){return(function t0(){return u0}()||F3)(O0(n),r)}function A1(n,r=ky.Default){return"number"!=typeof r&&(r=0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)),x0(n,r)}function u2(n){const r=[];for(let i=0;i<n.length;i++){const d=O0(n[i]);if(Array.isArray(d)){if(0===d.length)throw new a0(900,!1);let v,I=ky.Default;for(let q=0;q<d.length;q++){const J=d[q],_n=YI(J);"number"==typeof _n?-1===_n?v=J.token:I|=_n:v=J}r.push(x0(v,I))}else r.push(x0(d))}return r}function YA(n,r){return n[WI]=r,n.prototype[WI]=r,n}function YI(n){return n[WI]}const XE=YA(GA("Optional"),8),iA=YA(GA("SkipSelf"),4);var Tx=(()=>((Tx=Tx||{})[Tx.Important=1]="Important",Tx[Tx.DashCase=2]="DashCase",Tx))();const _k=new Map;let H3=0;const sA="__ngContext__";function zb(n,r){L_(r)?(n[sA]=r[20],function tO(n){_k.set(n[20],n)}(r)):n[sA]=r}function eM(n,r){return undefined(n,r)}function uA(n){const r=n[3];return h1(r)?r[3]:r}function SD(n){return p2(n[13])}function nM(n){return p2(n[4])}function p2(n){for(;null!==n&&!h1(n);)n=n[4];return n}function d2(n,r,i,d,v){if(null!=d){let I,q=!1;h1(d)?I=d:L_(d)&&(q=!0,d=d[0]);const J=b1(d);0===n&&null!==i?null==v?y2(r,i,J):Xb(r,i,J,v||null,!0):1===n&&null!==i?Xb(r,i,J,v||null,!0):2===n?function hO(n,r,i){const d=v2(n,r);d&&function JA(n,r,i,d){n.removeChild(r,i,d)}(n,d,r,i)}(r,J,q):3===n&&r.destroyNode(J),null!=I&&function W3(n,r,i,d,v){const I=i[7];I!==b1(i)&&d2(r,n,d,I,v);for(let J=10;J<i.length;J++){const _n=i[J];cx(_n[1],_n,n,r,d,I)}}(r,n,I,i,v)}}function xT(n,r,i){return n.createElement(r,i)}function iM(n,r){const i=n[9],d=i.indexOf(r),v=r[3];512&r[2]&&(r[2]&=-513,xI(v,-1)),i.splice(d,1)}function aO(n,r){if(n.length<=10)return;const i=10+r,d=n[i];if(d){const v=d[17];null!==v&&v!==n&&iM(v,d),r>0&&(n[i-1][4]=d[4]);const I=Zy(n,10+r);!function KN(n,r){cx(n,r,r[11],2,null,null),r[0]=null,r[6]=null}(d[1],d);const q=I[19];null!==q&&q.detachView(I[1]),d[3]=null,d[4]=null,d[2]&=-65}return d}function uO(n,r){if(!(128&r[2])){const i=r[11];i.destroyNode&&cx(n,r,i,3,null,null),function XN(n){let r=n[13];if(!r)return oM(n[1],n);for(;r;){let i=null;if(L_(r))i=r[13];else{const d=r[10];d&&(i=d)}if(!i){for(;r&&!r[4]&&r!==n;)L_(r)&&oM(r[1],r),r=r[3];null===r&&(r=n),L_(r)&&oM(r[1],r),i=r&&r[4]}r=i}}(r)}}function oM(n,r){if(!(128&r[2])){r[2]&=-65,r[2]|=128,function g2(n,r){let i;if(null!=n&&null!=(i=n.destroyHooks))for(let d=0;d<i.length;d+=2){const v=r[i[d]];if(!(v instanceof KC)){const I=i[d+1];if(Array.isArray(I))for(let q=0;q<I.length;q+=2){const J=v[I[q]],_n=I[q+1];try{_n.call(J)}finally{}}else try{I.call(v)}finally{}}}}(n,r),function JN(n,r){const i=n.cleanup,d=r[7];let v=-1;if(null!==i)for(let I=0;I<i.length-1;I+=2)if("string"==typeof i[I]){const q=i[I+1],J="function"==typeof q?q(r):b1(r[q]),_n=d[v=i[I+2]],_a=i[I+3];"boolean"==typeof _a?J.removeEventListener(i[I],_n,_a):_a>=0?d[v=_a]():d[v=-_a].unsubscribe(),I+=2}else{const q=d[v=i[I+1]];i[I].call(q)}if(null!==d){for(let I=v+1;I<d.length;I++)(0,d[I])();r[7]=null}}(n,r),1===r[1].type&&r[11].destroy();const i=r[17];if(null!==i&&h1(r[3])){i!==r[3]&&iM(i,r);const d=r[19];null!==d&&d.detachView(n)}!function U3(n){_k.delete(n[20])}(r)}}function QN(n,r,i){return function XA(n,r,i){let d=r;for(;null!==d&&40&d.type;)d=(r=d).parent;if(null===d)return i[0];if(2&d.flags){const v=n.data[d.directiveStart].encapsulation;if(v===n0.None||v===n0.Emulated)return null}return X1(d,i)}(n,r.parent,i)}function Xb(n,r,i,d,v){n.insertBefore(r,i,d,v)}function y2(n,r,i){n.appendChild(r,i)}function tP(n,r,i,d,v){null!==d?Xb(n,r,i,d,v):y2(n,r,i)}function v2(n,r){return n.parentNode(r)}let gO,cO=function sM(n,r,i){return 40&n.type?X1(n,i):null};function m_(n,r,i,d){const v=QN(n,d,r),I=r[11],J=function lO(n,r,i){return cO(n,r,i)}(d.parent||r[6],d,r);if(null!=v)if(Array.isArray(i))for(let _n=0;_n<i.length;_n++)tP(I,v,i[_n],J,!1);else tP(I,v,i,J,!1)}function JE(n,r){if(null!==r){const i=r.type;if(3&i)return X1(r,n);if(4&i)return uM(-1,n[r.index]);if(8&i){const d=r.child;if(null!==d)return JE(n,d);{const v=n[r.index];return h1(v)?uM(-1,v):b1(v)}}if(32&i)return eM(r,n)()||b1(n[r.index]);{const d=aM(n,r);return null!==d?Array.isArray(d)?d[0]:JE(uA(n[16]),d):JE(n,r.next)}}return null}function aM(n,r){return null!==r?n[16][6].projection[r.projection]:null}function uM(n,r){const i=10+n+1;if(i<r.length){const d=r[i],v=d[1].firstChild;if(null!==v)return JE(d,v)}return r[7]}function fO(n,r,i,d,v,I,q){for(;null!=i;){const J=d[i.index],_n=i.type;if(q&&0===r&&(J&&zb(b1(J),d),i.flags|=4),64!=(64&i.flags))if(8&_n)fO(n,r,i.child,d,v,I,!1),d2(r,n,v,J,I);else if(32&_n){const _a=eM(i,d);let _f;for(;_f=_a();)d2(r,n,v,_f,I);d2(r,n,v,J,I)}else 16&_n?pO(n,r,d,i,v,I):d2(r,n,v,J,I);i=q?i.projectionNext:i.next}}function cx(n,r,i,d,v,I){fO(i,d,n.firstChild,r,v,I,!1)}function pO(n,r,i,d,v,I){const q=i[16],_n=q[6].projection[d.projection];if(Array.isArray(_n))for(let _a=0;_a<_n.length;_a++)d2(r,n,v,_n[_a],I);else fO(n,r,_n,q[3],v,I,!0)}function QE(n,r,i){n.setAttribute(r,"style",i)}function dO(n,r,i){""===i?n.removeAttribute(r,"class"):n.setAttribute(r,"class",i)}const b2=new z0("ENVIRONMENT_INITIALIZER"),EO=new z0("INJECTOR",-1),jD=new z0("INJECTOR_DEF_TYPES");class bP{get(r,i=s2){if(i===s2){const d=new Error(`NullInjectorError: No provider for ${l_(r)}!`);throw d.name="NullInjectorError",d}return i}}function a4(...n){return{\u0275providers:yM(0,n)}}function yM(n,...r){const i=[],d=new Set;let v;return mE(r,I=>{const q=I;VD(q,i,[],d)&&(v||(v=[]),v.push(q))}),void 0!==v&&TO(v,i),i}function TO(n,r){for(let i=0;i<n.length;i++){const{providers:v}=n[i];mE(v,I=>{r.push(I)})}}function VD(n,r,i,d){if(!(n=O0(n)))return!1;let v=null,I=vy(n);const q=!I&&y_(n);if(I||q){if(q&&!q.standalone)return!1;v=n}else{const _n=n.ngModule;if(I=vy(_n),!I)return!1;v=_n}const J=d.has(v);if(q){if(J)return!1;if(d.add(v),q.dependencies){const _n="function"==typeof q.dependencies?q.dependencies():q.dependencies;for(const _a of _n)VD(_a,r,i,d)}}else{if(!I)return!1;{if(null!=I.imports&&!J){let _a;d.add(v);try{mE(I.imports,_f=>{VD(_f,r,i,d)&&(_a||(_a=[]),_a.push(_f))})}finally{}void 0!==_a&&TO(_a,r)}if(!J){const _a=j_(v)||(()=>new v);r.push({provide:v,useFactory:_a,deps:E0},{provide:jD,useValue:v,multi:!0},{provide:b2,useValue:()=>x0(v),multi:!0})}const _n=I.providers;null==_n||J||mE(_n,_f=>{r.push(_f)})}}return v!==n&&void 0!==n.providers}const wP=E_({provide:String,useValue:E_});function AO(n){return null!==n&&"object"==typeof n&&wP in n}function tT(n){return"function"==typeof n}const mM=new z0("Set Injector scope."),f1={},SO={};let Dx;function w2(){return void 0===Dx&&(Dx=new bP),Dx}class cA{}class EP extends cA{constructor(r,i,d,v){super(),this.parent=i,this.source=d,this.scopes=v,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,OO(r,q=>this.processProvider(q)),this.records.set(EO,_E(void 0,this)),v.has("environment")&&this.records.set(cA,_E(void 0,this));const I=this.records.get(mM);null!=I&&"string"==typeof I.value&&this.scopes.add(I.value),this.injectorDefTypes=new Set(this.get(jD.multi,E0,ky.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();for(const r of this._onDestroyHooks)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(r){this._onDestroyHooks.push(r)}runInContext(r){this.assertNotDestroyed();const i=a2(this),d=Fy(void 0);try{return r()}finally{a2(i),Fy(d)}}get(r,i=s2,d=ky.Default){this.assertNotDestroyed();const v=a2(this),I=Fy(void 0);try{if(!(d&ky.SkipSelf)){let J=this.records.get(r);if(void 0===J){const _n=function c4(n){return"function"==typeof n||"object"==typeof n&&n instanceof z0}(r)&&_h(r);J=_n&&this.injectableDefInScope(_n)?_E(MO(r),f1):null,this.records.set(r,J)}if(null!=J)return this.hydrate(r,J)}return(d&ky.Self?w2():this.parent).get(r,i=d&ky.Optional&&i===s2?null:i)}catch(q){if("NullInjectorError"===q.name){if((q[WA]=q[WA]||[]).unshift(l_(r)),v)throw q;return function CN(n,r,i,d){const v=n[WA];throw r[$I]&&v.unshift(r[$I]),n.message=function DN(n,r,i,d=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let v=l_(r);if(Array.isArray(r))v=r.map(l_).join(" -> ");else if("object"==typeof r){let I=[];for(let q in r)if(r.hasOwnProperty(q)){let J=r[q];I.push(q+":"+("string"==typeof J?JSON.stringify(J):l_(J)))}v=`{${I.join(", ")}}`}return`${i}${d?"("+d+")":""}[${v}]: ${n.replace($S,"\n  ")}`}("\n"+n.message,v,i,d),n.ngTokenPath=v,n[WA]=null,n}(q,r,"R3InjectorError",this.source)}throw q}finally{Fy(I),a2(v)}}resolveInjectorInitializers(){const r=a2(this),i=Fy(void 0);try{const d=this.get(b2.multi,E0,ky.Self);for(const v of d)v()}finally{a2(r),Fy(i)}}toString(){const r=[],i=this.records;for(const d of i.keys())r.push(l_(d));return`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new a0(205,!1)}processProvider(r){let i=tT(r=O0(r))?r:O0(r&&r.provide);const d=function IO(n){return AO(n)?_E(void 0,n.useValue):_E(nC(n),f1)}(r);if(tT(r)||!0!==r.multi)this.records.get(i);else{let v=this.records.get(i);v||(v=_E(void 0,f1,!0),v.factory=()=>u2(v.multi),this.records.set(i,v)),i=r,v.multi.push(r)}this.records.set(i,d)}hydrate(r,i){return i.value===f1&&(i.value=SO,i.value=i.factory()),"object"==typeof i.value&&i.value&&function l4(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(i.value)&&this._ngOnDestroyHooks.add(i.value),i.value}injectableDefInScope(r){if(!r.providedIn)return!1;const i=O0(r.providedIn);return"string"==typeof i?"any"===i||this.scopes.has(i):this.injectorDefTypes.has(i)}}function MO(n){const r=_h(n),i=null!==r?r.factory:j_(n);if(null!==i)return i;if(n instanceof z0)throw new a0(204,!1);if(n instanceof Function)return function _w(n){const r=n.length;if(r>0)throw function i2(n,r){const i=[];for(let d=0;d<n;d++)i.push(r);return i}(r,"?"),new a0(204,!1);const i=function uy(n){const r=n&&(n[Ty]||n[e0]);if(r){const i=function cy(n){if(n.hasOwnProperty("name"))return n.name;const r=(""+n).match(/^function\s*([^\s(]+)/);return null===r?"":r[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),r}return null}(n);return null!==i?()=>i.factory(n):()=>new n}(n);throw new a0(204,!1)}function nC(n,r,i){let d;if(tT(n)){const v=O0(n);return j_(v)||MO(v)}if(AO(n))d=()=>O0(n.useValue);else if(function DO(n){return!(!n||!n.useFactory)}(n))d=()=>n.useFactory(...u2(n.deps||[]));else if(function CO(n){return!(!n||!n.useExisting)}(n))d=()=>x0(O0(n.useExisting));else{const v=O0(n&&(n.useClass||n.provide));if(!function kO(n){return!!n.deps}(n))return j_(v)||MO(v);d=()=>new v(...u2(n.deps))}return d}function _E(n,r,i=!1){return{factory:n,value:r,multi:i?[]:void 0}}function h4(n){return!!n.\u0275providers}function OO(n,r){for(const i of n)Array.isArray(i)?OO(i,r):h4(i)?OO(i.\u0275providers,r):r(i)}class RO{}class p4{resolveComponentFactory(r){throw function TP(n){const r=Error(`No component factory found for ${l_(n)}. Did you add it to @NgModule.entryComponents?`);return r.ngComponent=n,r}(r)}}let hA=(()=>{class n{}return n.NULL=new p4,n})();function PO(){return x2(f_(),Hy())}function x2(n,r){return new Qx(X1(n,r))}let Qx=(()=>{class n{constructor(i){this.nativeElement=i}}return n.__NG_ELEMENT_ID__=PO,n})();function d4(n){return n instanceof Qx?n.nativeElement:n}class AP{}let CT=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function g4(){const n=Hy(),i=mx(f_().index,n);return(L_(i)?i:n)[11]}(),n})(),E2=(()=>{class n{}return n.\u0275prov=Ni({token:n,providedIn:"root",factory:()=>null}),n})();class zD{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const y4=new zD("14.2.12"),BD={};function DT(n){return n.ngOriginalError}class ST{constructor(){this._console=console}handleError(r){const i=this._findOriginalError(r);this._console.error("ERROR",r),i&&this._console.error("ORIGINAL ERROR",i)}_findOriginalError(r){let i=r&&DT(r);for(;i&&DT(i);)i=DT(i);return i||null}}function MT(n){return n instanceof Function?n():n}function jO(n,r,i){let d=n.length;for(;;){const v=n.indexOf(r,i);if(-1===v)return v;if(0===v||n.charCodeAt(v-1)<=32){const I=r.length;if(v+I===d||n.charCodeAt(v+I)<=32)return v}i=v+1}}const VO="ng-template";function C2(n,r,i){let d=0;for(;d<n.length;){let v=n[d++];if(i&&"class"===v){if(v=n[d],-1!==jO(v.toLowerCase(),r,0))return!0}else if(1===v){for(;d<n.length&&"string"==typeof(v=n[d++]);)if(v.toLowerCase()===r)return!0;return!1}}return!1}function kP(n){return 4===n.type&&n.value!==VO}function OP(n,r,i){return r===(4!==n.type||i?n.value:VO)}function J0(n,r,i){let d=4;const v=n.attrs||[],I=function D2(n){for(let r=0;r<n.length;r++)if(kI(n[r]))return r;return n.length}(v);let q=!1;for(let J=0;J<r.length;J++){const _n=r[J];if("number"!=typeof _n){if(!q)if(4&d){if(d=2|1&d,""!==_n&&!OP(n,_n,i)||""===_n&&1===r.length){if(Hx(d))return!1;q=!0}}else{const _a=8&d?_n:r[++J];if(8&d&&null!==n.attrs){if(!C2(n.attrs,_a,i)){if(Hx(d))return!1;q=!0}continue}const gd=RP(8&d?"class":_n,v,kP(n),i);if(-1===gd){if(Hx(d))return!1;q=!0;continue}if(""!==_a){let ay;ay=gd>I?"":v[gd+1].toLowerCase();const yy=8&d?ay:null;if(yy&&-1!==jO(yy,_a,0)||2&d&&_a!==ay){if(Hx(d))return!1;q=!0}}}}else{if(!q&&!Hx(d)&&!Hx(_n))return!1;if(q&&Hx(_n))continue;q=!1,d=_n|1&d}}return Hx(d)||q}function Hx(n){return 0==(1&n)}function RP(n,r,i,d){if(null===r)return-1;let v=0;if(d||!i){let I=!1;for(;v<r.length;){const q=r[v];if(q===n)return v;if(3===q||6===q)I=!0;else{if(1===q||2===q){let J=r[++v];for(;"string"==typeof J;)J=r[++v];continue}if(4===q)break;if(0===q){v+=4;continue}}v+=I?1:2}return-1}return function zO(n,r){let i=n.indexOf(4);if(i>-1)for(i++;i<n.length;){const d=n[i];if("number"==typeof d)return-1;if(d===r)return i;i++}return-1}(r,n)}function kT(n,r,i=!1){for(let d=0;d<r.length;d++)if(J0(n,r[d],i))return!0;return!1}function UD(n,r){return n?":not("+r.trim()+")":r}function BO(n){let r=n[0],i=1,d=2,v="",I=!1;for(;i<n.length;){let q=n[i];if("string"==typeof q)if(2&d){const J=n[++i];v+="["+q+(J.length>0?'="'+J+'"':"")+"]"}else 8&d?v+="."+q:4&d&&(v+=" "+q);else""!==v&&!Hx(q)&&(r+=UD(I,v),v=""),d=q,I=I||!Hx(d);i++}return""!==v&&(r+=UD(I,v)),r}const W0={};function Mx(n){HO(k_(),Hy(),ux()+n,!1)}function HO(n,r,i,d){if(!d)if(3==(3&r[2])){const I=n.preOrderCheckHooks;null!==I&&FA(r,I,i)}else{const I=n.preOrderHooks;null!==I&&jA(r,I,0,i)}fT(i)}function wM(n,r=null,i=null,d){const v=FP(n,r,i,d);return v.resolveInjectorInitializers(),v}function FP(n,r=null,i=null,d,v=new Set){const I=[i||E0,a4(n)];return d=d||("object"==typeof n?void 0:l_(n)),new EP(I,r||w2(),d||null,v)}let tE=(()=>{class n{static create(i,d){if(Array.isArray(i))return wM({name:""},d,i,"");{const v=i.name??"";return wM({name:v},i.parent,i.providers,v)}}}return n.THROW_IF_NOT_FOUND=s2,n.NULL=new bP,n.\u0275prov=Ni({token:n,providedIn:"any",factory:()=>x0(EO)}),n.__NG_ELEMENT_ID__=-1,n})();function Xy(n,r=ky.Default){const i=Hy();return null===i?x0(n,r):JC(f_(),i,O0(n),r)}function qD(){throw new Error("invalid")}function eE(n,r){return n<<17|r<<2}function Ux(n){return n>>17&32767}function WD(n){return 2|n}function bE(n){return(131068&n)>>2}function CM(n,r){return-131069&n|r<<2}function fx(n){return 1|n}function ty(n,r){const i=n.contentQueries;if(null!==i)for(let d=0;d<i.length;d+=2){const v=i[d],I=i[d+1];if(-1!==I){const q=n.data[I];DI(v),q.contentQueries(2,r[I],I)}}}function ly(n,r,i,d,v,I,q,J,_n,_a,_f){const gd=r.blueprint.slice();return gd[0]=v,gd[2]=76|d,(null!==_f||n&&1024&n[2])&&(gd[2]|=1024),zC(gd),gd[3]=gd[15]=n,gd[8]=i,gd[10]=q||n&&n[10],gd[11]=J||n&&n[11],gd[12]=_n||n&&n[12]||null,gd[9]=_a||n&&n[9]||null,gd[6]=I,gd[20]=function tM(){return H3++}(),gd[21]=_f,gd[16]=2==r.type?n[16]:gd,gd}function ey(n,r,i,d,v){let I=n.data[r];if(null===I)I=function hy(n,r,i,d,v){const I=kS(),q=nA(),_n=n.data[r]=function d_(n,r,i,d,v,I){return{type:i,index:d,insertBeforeIndex:null,injectorIndex:r?r.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:v,attrs:I,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,q?I:I&&I.parent,i,r,d,v);return null===n.firstChild&&(n.firstChild=_n),null!==I&&(q?null==I.child&&null!==_n.parent&&(I.child=_n):null===I.next&&(I.next=_n)),_n}(n,r,i,d,v),function RS(){return i_.lFrame.inI18n}()&&(I.flags|=64);else if(64&I.type){I.type=i,I.value=d,I.attrs=v;const q=function HC(){const n=i_.lFrame,r=n.currentTNode;return n.isParent?r:r.parent}();I.injectorIndex=null===q?-1:q.injectorIndex}return J1(I,!0),I}function fy(n,r,i,d){if(0===i)return-1;const v=r.length;for(let I=0;I<i;I++)r.push(d),n.blueprint.push(d),n.data.push(null);return v}function _y(n,r,i){gD(r);try{const d=n.viewQuery;null!==d&&RT(1,d,i);const v=n.template;null!==v&&Sy(n,r,v,1,i),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&ty(n,r),n.staticViewQueries&&RT(2,n.viewQuery,i);const I=n.components;null!==I&&function ry(n,r){for(let i=0;i<r.length;i++)S_(n,r[i])}(r,I)}catch(d){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),d}finally{r[2]&=-5,WC()}}function Iy(n,r,i,d){const v=r[2];if(128!=(128&v)){gD(r);try{zC(r),function cN(n){return i_.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==i&&Sy(n,r,i,2,d);const q=3==(3&v);if(q){const _a=n.preOrderCheckHooks;null!==_a&&FA(r,_a,null)}else{const _a=n.preOrderHooks;null!==_a&&jA(r,_a,0,null),yD(r,0)}if(function iE(n){for(let r=SD(n);null!==r;r=nM(r)){if(!r[2])continue;const i=r[9];for(let d=0;d<i.length;d++){const v=i[d],I=v[3];0==(512&v[2])&&xI(I,1),v[2]|=512}}}(r),function rE(n){for(let r=SD(n);null!==r;r=nM(r))for(let i=10;i<r.length;i++){const d=r[i],v=d[1];NA(d)&&Iy(v,d,v.template,d[8])}}(r),null!==n.contentQueries&&ty(n,r),q){const _a=n.contentCheckHooks;null!==_a&&FA(r,_a)}else{const _a=n.contentHooks;null!==_a&&jA(r,_a,1),yD(r,1)}!function ka(n,r){const i=n.hostBindingOpCodes;if(null!==i)try{for(let d=0;d<i.length;d++){const v=i[d];if(v<0)fT(~v);else{const I=v,q=i[++d],J=i[++d];hN(q,I),J(2,r[I])}}}finally{fT(-1)}}(n,r);const J=n.components;null!==J&&function ny(n,r){for(let i=0;i<r.length;i++)PM(n,r[i])}(r,J);const _n=n.viewQuery;if(null!==_n&&RT(2,_n,d),q){const _a=n.viewCheckHooks;null!==_a&&FA(r,_a)}else{const _a=n.viewHooks;null!==_a&&jA(r,_a,2),yD(r,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),r[2]&=-41,512&r[2]&&(r[2]&=-513,xI(r[3],-1))}finally{WC()}}}function Sy(n,r,i,d,v){const I=ux(),q=2&d;try{fT(-1),q&&r.length>22&&HO(n,r,22,!1),i(d,v)}finally{fT(I)}}function Dy(n,r,i){if(jC(r)){const v=r.directiveEnd;for(let I=r.directiveStart;I<v;I++){const q=n.data[I];q.contentQueries&&q.contentQueries(1,i[I],I)}}}function Ny(n,r,i){!uN()||(function Gx(n,r,i,d){const v=i.directiveStart,I=i.directiveEnd;n.firstCreatePass||W_(i,r),zb(d,r);const q=i.initialInputs;for(let J=v;J<I;J++){const _n=n.data[J],_a=gE(_n);_a&&wE(r,i,_n);const _f=QC(r,n,J,i);zb(_f,r),null!==q&&rC(0,J-v,_f,_n,0,q),_a&&(mx(i.index,r)[8]=_f)}}(n,r,i,X1(i,r)),128==(128&i.flags)&&function nE(n,r,i){const d=i.directiveStart,v=i.directiveEnd,I=i.index,q=function C3(){return i_.lFrame.currentDirectiveIndex}();try{fT(I);for(let J=d;J<v;J++){const _n=n.data[J],_a=r[J];GC(J),(null!==_n.hostBindings||0!==_n.hostVars||null!==_n.hostAttrs)&&dx(_n,_a)}}finally{fT(-1),GC(q)}}(n,r,i))}function r0(n,r,i=X1){const d=r.localNames;if(null!==d){let v=r.index+1;for(let I=0;I<d.length;I+=2){const q=d[I+1],J=-1===q?i(r,n):n[q];n[v++]=J}}}function Vy(n){const r=n.tView;return null===r||r.incompleteFirstPass?n.tView=Yy(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):r}function Yy(n,r,i,d,v,I,q,J,_n,_a){const _f=22+d,gd=_f+v,ay=function S0(n,r){const i=[];for(let d=0;d<r;d++)i.push(d<n?null:W0);return i}(_f,gd),yy="function"==typeof _a?_a():_a;return ay[1]={type:n,blueprint:ay,template:i,queries:null,viewQuery:J,declTNode:r,data:ay.slice().fill(null,_f),bindingStartIndex:_f,expandoStartIndex:gd,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof I?I():I,pipeRegistry:"function"==typeof q?q():q,firstChild:null,schemas:_n,consts:yy,incompleteFirstPass:!1}}function Q0(n,r,i,d){const v=sE(r);null===i?v.push(d):(v.push(i),n.firstCreatePass&&nT(n).push(d,v.length-1))}function Y_(n,r,i){for(let d in n)if(n.hasOwnProperty(d)){const v=n[d];(i=null===i?{}:i).hasOwnProperty(d)?i[d].push(r,v):i[d]=[r,v]}return i}function r1(n,r){const d=r.directiveEnd,v=n.data,I=r.attrs,q=[];let J=null,_n=null;for(let _a=r.directiveStart;_a<d;_a++){const _f=v[_a],gd=_f.inputs,ay=null===I||kP(r)?null:iC(gd,I);q.push(ay),J=Y_(gd,_a,J),_n=Y_(_f.outputs,_a,_n)}null!==J&&(J.hasOwnProperty("class")&&(r.flags|=16),J.hasOwnProperty("style")&&(r.flags|=32)),r.initialInputs=q,r.inputs=J,r.outputs=_n}function Ix(n,r){const i=mx(r,n);16&i[2]||(i[2]|=32)}function _1(n,r,i,d){let v=!1;if(uN()){const I=function gA(n,r,i){const d=n.directiveRegistry;let v=null;if(d)for(let I=0;I<d.length;I++){const q=d[I];kT(i,q.selectors,!1)&&(v||(v=[]),XC(W_(i,r),n,q.type),gE(q)?(gx(n,i),v.unshift(q)):v.push(q))}return v}(n,r,i),q=null===d?null:{"":-1};if(null!==I){v=!0,Yw(i,n.data.length,I.length);for(let _f=0;_f<I.length;_f++){const gd=I[_f];gd.providersResolver&&gd.providersResolver(gd)}let J=!1,_n=!1,_a=fy(n,r,I.length,null);for(let _f=0;_f<I.length;_f++){const gd=I[_f];i.mergedAttrs=b0(i.mergedAttrs,gd.hostAttrs),jE(n,i,r,_a,gd),d1(_a,gd,q),null!==gd.contentQueries&&(i.flags|=8),(null!==gd.hostBindings||null!==gd.hostAttrs||0!==gd.hostVars)&&(i.flags|=128);const ay=gd.type.prototype;!J&&(ay.ngOnChanges||ay.ngOnInit||ay.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(i.index),J=!0),!_n&&(ay.ngOnChanges||ay.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(i.index),_n=!0),_a++}r1(n,i)}q&&function kx(n,r,i){if(r){const d=n.localNames=[];for(let v=0;v<r.length;v+=2){const I=i[r[v+1]];if(null==I)throw new a0(-301,!1);d.push(r[v],I)}}}(i,d,q)}return i.mergedAttrs=b0(i.mergedAttrs,i.attrs),v}function D_(n,r,i,d,v,I){const q=I.hostBindings;if(q){let J=n.hostBindingOpCodes;null===J&&(J=n.hostBindingOpCodes=[]);const _n=~r.index;(function C1(n){let r=n.length;for(;r>0;){const i=n[--r];if("number"==typeof i&&i<0)return i}return 0})(J)!=_n&&J.push(_n),J.push(d,v,q)}}function dx(n,r){null!==n.hostBindings&&n.hostBindings(1,r)}function gx(n,r){r.flags|=2,(n.components||(n.components=[])).push(r.index)}function d1(n,r,i){if(i){if(r.exportAs)for(let d=0;d<r.exportAs.length;d++)i[r.exportAs[d]]=n;gE(r)&&(i[""]=n)}}function Yw(n,r,i){n.flags|=1,n.directiveStart=r,n.directiveEnd=r+i,n.providerIndexes=r}function jE(n,r,i,d,v){n.data[d]=v;const I=v.factory||(v.factory=j_(v.type)),q=new KC(I,gE(v),Xy);n.blueprint[d]=q,i[d]=q,D_(n,r,0,d,fy(n,i,v.hostVars,W0),v)}function wE(n,r,i){const d=X1(r,n),v=Vy(i),I=n[10],q=f0(n,ly(n,v,null,i.onPush?32:16,d,r,I,I.createRenderer(d,i),null,null,null));n[r.index]=q}function rC(n,r,i,d,v,I){const q=I[r];if(null!==q){const J=d.setInput;for(let _n=0;_n<q.length;){const _a=q[_n++],_f=q[_n++],gd=q[_n++];null!==J?d.setInput(i,gd,_a,_f):i[_f]=gd}}}function iC(n,r){let i=null,d=0;for(;d<r.length;){const v=r[d];if(0!==v)if(5!==v){if("number"==typeof v)break;n.hasOwnProperty(v)&&(null===i&&(i=[]),i.push(v,n[v],r[d+1])),d+=2}else d+=2;else d+=4}return i}function X_(n,r,i,d){return new Array(n,!0,!1,r,null,0,d,i,null,null)}function PM(n,r){const i=mx(r,n);if(NA(i)){const d=i[1];48&i[2]?Iy(d,i,d.template,i[8]):i[5]>0&&F1(i)}}function F1(n){for(let d=SD(n);null!==d;d=nM(d))for(let v=10;v<d.length;v++){const I=d[v];if(NA(I))if(512&I[2]){const q=I[1];Iy(q,I,q.template,I[8])}else I[5]>0&&F1(I)}const i=n[1].components;if(null!==i)for(let d=0;d<i.length;d++){const v=mx(i[d],n);NA(v)&&v[5]>0&&F1(v)}}function S_(n,r){const i=mx(r,n),d=i[1];(function eT(n,r){for(let i=r.length;i<n.blueprint.length;i++)r.push(n.blueprint[i])})(d,i),_y(d,i,i[8])}function f0(n,r){return n[13]?n[14][4]=r:n[13]=r,n[14]=r,r}function OT(n){for(;n;){n[2]|=32;const r=uA(n);if(mI(n)&&!r)return n;n=r}return null}function oE(n,r,i,d=!0){const v=r[10];v.begin&&v.begin();try{Iy(n,r,n.template,i)}catch(q){throw d&&XP(r,q),q}finally{v.end&&v.end()}}function RT(n,r,i){DI(0),r(n,i)}function sE(n){return n[7]||(n[7]=[])}function nT(n){return n.cleanup||(n.cleanup=[])}function XP(n,r){const i=n[9],d=i?i.get(ST,null):null;d&&d.handleError(r)}function YD(n,r,i,d,v){for(let I=0;I<i.length;){const q=i[I++],J=i[I++],_n=r[q],_a=n.data[q];null!==_a.setInput?_a.setInput(_n,v,d,J):_n[J]=v}}function KD(n,r,i){let d=i?n.styles:null,v=i?n.classes:null,I=0;if(null!==r)for(let q=0;q<r.length;q++){const J=r[q];"number"==typeof J?I=J:1==I?v=TA(v,J):2==I&&(d=TA(d,J+": "+r[++q]+";"))}i?n.styles=d:n.stylesWithoutHost=d,i?n.classes=v:n.classesWithoutHost=v}function ZD(n,r,i,d,v=!1){for(;null!==i;){const I=r[i.index];if(null!==I&&d.push(b1(I)),h1(I))for(let J=10;J<I.length;J++){const _n=I[J],_a=_n[1].firstChild;null!==_a&&ZD(_n[1],_n,_a,d)}const q=i.type;if(8&q)ZD(n,r,i.child,d);else if(32&q){const J=eM(i,r);let _n;for(;_n=J();)d.push(_n)}else if(16&q){const J=aM(r,i);if(Array.isArray(J))d.push(...J);else{const _n=uA(r[16]);ZD(_n[1],_n,J,d,!0)}}i=v?i.projectionNext:i.next}return d}class xE{constructor(r,i){this._lView=r,this._cdRefInjectingView=i,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const r=this._lView,i=r[1];return ZD(i,r,i.firstChild,[])}get context(){return this._lView[8]}set context(r){this._lView[8]=r}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[3];if(h1(r)){const i=r[8],d=i?i.indexOf(this):-1;d>-1&&(aO(r,d),Zy(i,d))}this._attachedToViewContainer=!1}uO(this._lView[1],this._lView)}onDestroy(r){Q0(this._lView[1],this._lView,null,r)}markForCheck(){OT(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){oE(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new a0(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function ZN(n,r){cx(n,r,r[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new a0(902,!1);this._appRef=r}}class JP extends xE{constructor(r){super(r),this._view=r}detectChanges(){const r=this._view;oE(r[1],r,r[8],!1)}checkNoChanges(){}get context(){return null}}class LM extends hA{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const i=y_(r);return new g1(i,this.ngModule)}}function eR(n){const r=[];for(let i in n)n.hasOwnProperty(i)&&r.push({propName:n[i],templateName:i});return r}class EE{constructor(r,i){this.injector=r,this.parentInjector=i}get(r,i,d){const v=this.injector.get(r,BD,d);return v!==BD||i===BD?v:this.parentInjector.get(r,i,d)}}class g1 extends RO{constructor(r,i){super(),this.componentDef=r,this.ngModule=i,this.componentType=r.type,this.selector=function b4(n){return n.map(BO).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!i}get inputs(){return eR(this.componentDef.inputs)}get outputs(){return eR(this.componentDef.outputs)}create(r,i,d,v){let I=(v=v||this.ngModule)instanceof cA?v:v?.injector;I&&null!==this.componentDef.getStandaloneInjector&&(I=this.componentDef.getStandaloneInjector(I)||I);const q=I?new EE(r,I):r,J=q.get(AP,null);if(null===J)throw new a0(407,!1);const _n=q.get(E2,null),_a=J.createRenderer(null,this.componentDef),_f=this.componentDef.selectors[0][0]||"div",gd=d?function $0(n,r,i){return n.selectRootElement(r,i===n0.ShadowDom)}(_a,d,this.componentDef.encapsulation):xT(_a,_f,function nR(n){const r=n.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(_f)),ay=this.componentDef.onPush?288:272,yy=Yy(0,null,null,1,0,null,null,null,null,null),xy=ly(null,yy,null,ay,null,null,J,_a,_n,q,null);let Ry,zy;gD(xy);try{const Ky=function eL(n,r,i,d,v,I){const q=i[1];i[22]=n;const _n=ey(q,22,2,"#host",null),_a=_n.mergedAttrs=r.hostAttrs;null!==_a&&(KD(_n,_a,!0),null!==n&&(FS(v,n,_a),null!==_n.classes&&dO(v,n,_n.classes),null!==_n.styles&&QE(v,n,_n.styles)));const _f=d.createRenderer(n,r),gd=ly(i,Vy(r),null,r.onPush?32:16,i[22],_n,d,_f,I||null,null,null);return q.firstCreatePass&&(XC(W_(_n,i),q,r.type),gx(q,_n),Yw(_n,i.length,1)),f0(i,gd),i[22]=gd}(gd,this.componentDef,xy,J,_a);if(gd)if(d)FS(_a,gd,["ng-version",y4.full]);else{const{attrs:d0,classes:Uy}=function PP(n){const r=[],i=[];let d=1,v=2;for(;d<n.length;){let I=n[d];if("string"==typeof I)2===v?""!==I&&r.push(I,n[++d]):8===v&&i.push(I);else{if(!Hx(v))break;v=I}d++}return{attrs:r,classes:i}}(this.componentDef.selectors[0]);d0&&FS(_a,gd,d0),Uy&&Uy.length>0&&dO(_a,gd,Uy.join(" "))}if(zy=MS(yy,22),void 0!==i){const d0=zy.projection=[];for(let Uy=0;Uy<this.ngContentSelectors.length;Uy++){const j0=i[Uy];d0.push(null!=j0?Array.from(j0):null)}}Ry=function _c(n,r,i,d){const v=i[1],I=function FE(n,r,i){const d=f_();n.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),jE(n,d,r,fy(n,r,1,null),i),r1(n,d));const v=QC(r,n,d.directiveStart,d);zb(v,r);const I=X1(d,r);return I&&zb(I,r),v}(v,i,r);if(n[8]=i[8]=I,null!==d)for(const J of d)J(I,r);if(r.contentQueries){const J=f_();r.contentQueries(1,I,J.directiveStart)}const q=f_();return!v.firstCreatePass||null===r.hostBindings&&null===r.hostAttrs||(fT(q.index),D_(i[1],q,0,q.directiveStart,q.directiveEnd,r),dx(r,I)),I}(Ky,this.componentDef,xy,[_g]),_y(yy,xy,null)}finally{WC()}return new tL(this.componentType,Ry,x2(zy,xy),xy,zy)}}class tL extends class f4{}{constructor(r,i,d,v,I){super(),this.location=d,this._rootLView=v,this._tNode=I,this.instance=i,this.hostView=this.changeDetectorRef=new JP(v),this.componentType=r}setInput(r,i){const d=this._tNode.inputs;let v;if(null!==d&&(v=d[r])){const I=this._rootLView;YD(I[1],I,v,r,i),Ix(I,this._tNode.index)}}get injector(){return new BA(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}function _g(){const n=f_();YC(Hy()[1],n)}function py(n){let r=function dy(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),i=!0;const d=[n];for(;r;){let v;if(gE(n))v=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new a0(903,!1);v=r.\u0275dir}if(v){if(i){d.push(v);const q=n;q.inputs=Cy(n.inputs),q.declaredInputs=Cy(n.declaredInputs),q.outputs=Cy(n.outputs);const J=v.hostBindings;J&&m0(n,J);const _n=v.viewQuery,_a=v.contentQueries;if(_n&&_v(n,_n),_a&&Wy(n,_a),$T(n.inputs,v.inputs),$T(n.declaredInputs,v.declaredInputs),$T(n.outputs,v.outputs),gE(v)&&v.data.animation){const _f=n.data;_f.animation=(_f.animation||[]).concat(v.data.animation)}}const I=v.features;if(I)for(let q=0;q<I.length;q++){const J=I[q];J&&J.ngInherit&&J(n),J===py&&(i=!1)}}r=Object.getPrototypeOf(r)}!function my(n){let r=0,i=null;for(let d=n.length-1;d>=0;d--){const v=n[d];v.hostVars=r+=v.hostVars,v.hostAttrs=b0(v.hostAttrs,i=b0(i,v.hostAttrs))}}(d)}function Cy(n){return n===w0?{}:n===E0?[]:n}function _v(n,r){const i=n.viewQuery;n.viewQuery=i?(d,v)=>{r(d,v),i(d,v)}:r}function Wy(n,r){const i=n.contentQueries;n.contentQueries=i?(d,v,I)=>{r(d,v,I),i(d,v,I)}:r}function m0(n,r){const i=n.hostBindings;n.hostBindings=i?(d,v)=>{r(d,v),i(d,v)}:r}let v_=null;function R_(){if(!v_){const n=Gy.Symbol;if(n&&n.iterator)v_=n.iterator;else{const r=Object.getOwnPropertyNames(Map.prototype);for(let i=0;i<r.length;++i){const d=r[i];"entries"!==d&&"size"!==d&&Map.prototype[d]===Map.prototype.entries&&(v_=d)}}}return v_}function k0(n){return!!h_(n)&&(Array.isArray(n)||!(n instanceof Map)&&R_()in n)}function h_(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function a_(n,r,i){return!Object.is(n[r],i)&&(n[r]=i,!0)}function O2(n,r,i,d,v,I,q,J){const _n=Hy(),_a=k_(),_f=n+22,gd=_a.firstCreatePass?function OG(n,r,i,d,v,I,q,J,_n){const _a=r.consts,_f=ey(r,n,4,q||null,yE(_a,J));_1(r,i,_f,yE(_a,_n)),YC(r,_f);const gd=_f.tViews=Yy(2,_f,d,v,I,r.directiveRegistry,r.pipeRegistry,null,r.schemas,_a);return null!==r.queries&&(r.queries.template(r,_f),gd.queries=r.queries.embeddedTView(_f)),_f}(_f,_a,_n,r,i,d,v,I,q):_a.data[_f];J1(gd,!1);const ay=_n[11].createComment("");m_(_a,_n,ay,gd),zb(ay,_n),f0(_n,_n[_f]=X_(ay,_n,ay,gd)),RA(gd)&&Ny(_a,_n,gd),null!=q&&r0(_n,gd,J)}function PT(n,r,i){const d=Hy();return a_(d,UC(),r)&&function C_(n,r,i,d,v,I,q,J){const _n=X1(r,i);let _f,_a=r.inputs;!J&&null!=_a&&(_f=_a[d])?(YD(n,i,_f,d,v),cD(r)&&Ix(i,r.index)):3&r.type&&(d=function t_(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(d),v=null!=q?q(v,r.value||"",d):v,I.setProperty(_n,d,v))}(k_(),function c1(){const n=i_.lFrame;return MS(n.tView,n.selectedIndex)}(),d,n,r,d[11],i,!1),PT}function B4(n,r,i,d,v){const q=v?"class":"style";YD(n,i,r.inputs[q],q,d)}function Tw(n,r,i,d){const v=Hy(),I=k_(),q=22+n,J=v[11],_n=v[q]=xT(J,r,function w1(){return i_.lFrame.currentNamespace}()),_a=I.firstCreatePass?function PG(n,r,i,d,v,I,q){const J=r.consts,_a=ey(r,n,2,v,yE(J,I));return _1(r,i,_a,yE(J,q)),null!==_a.attrs&&KD(_a,_a.attrs,!1),null!==_a.mergedAttrs&&KD(_a,_a.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,_a),_a}(q,I,v,0,r,i,d):I.data[q];J1(_a,!0);const _f=_a.mergedAttrs;null!==_f&&FS(J,_n,_f);const gd=_a.classes;null!==gd&&dO(J,_n,gd);const ay=_a.styles;return null!==ay&&QE(J,_n,ay),64!=(64&_a.flags)&&m_(I,v,_n,_a),0===function x3(){return i_.lFrame.elementDepthCount}()&&zb(_n,v),function TI(){i_.lFrame.elementDepthCount++}(),RA(_a)&&(Ny(I,v,_a),Dy(I,_a,v)),null!==d&&r0(v,_a),Tw}function Xw(){let n=f_();nA()?OS():(n=n.parent,J1(n,!1));const r=n;!function ax(){i_.lFrame.elementDepthCount--}();const i=k_();return i.firstCreatePass&&(YC(i,n),jC(n)&&i.queries.elementEnd(n)),null!=r.classesWithoutHost&&function LS(n){return 0!=(16&n.flags)}(r)&&B4(i,r,Hy(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function mD(n){return 0!=(32&n.flags)}(r)&&B4(i,r,Hy(),r.stylesWithoutHost,!1),Xw}function TE(n,r,i,d){return Tw(n,r,i,d),Xw(),TE}function iR(n,r,i){const d=Hy(),v=k_(),I=n+22,q=v.firstCreatePass?function LG(n,r,i,d,v){const I=r.consts,q=yE(I,d),J=ey(r,n,8,"ng-container",q);return null!==q&&KD(J,q,!0),_1(r,i,J,yE(I,v)),null!==r.queries&&r.queries.elementStart(r,J),J}(I,v,d,r,i):v.data[I];J1(q,!0);const J=d[I]=d[11].createComment("");return m_(v,d,J,q),zb(J,d),RA(q)&&(Ny(v,d,q),Dy(v,q,d)),null!=i&&r0(d,q),iR}function oR(){let n=f_();const r=k_();return nA()?OS():(n=n.parent,J1(n,!1)),r.firstCreatePass&&(YC(r,n),jC(n)&&r.queries.elementEnd(n)),oR}function H4(){return Hy()}function sR(n){return!!n&&"function"==typeof n.then}const U4=function o6(n){return!!n&&"function"==typeof n.subscribe};function Ox(n,r,i,d){const v=Hy(),I=k_(),q=f_();return function a6(n,r,i,d,v,I,q,J){const _n=RA(d),_f=n.firstCreatePass&&nT(n),gd=r[8],ay=sE(r);let yy=!0;if(3&d.type||J){const zy=X1(d,r),Ky=J?J(zy):zy,d0=ay.length,Uy=J?B_=>J(b1(B_[d.index])):d.index;let j0=null;if(!J&&_n&&(j0=function FG(n,r,i,d){const v=n.cleanup;if(null!=v)for(let I=0;I<v.length-1;I+=2){const q=v[I];if(q===i&&v[I+1]===d){const J=r[7],_n=v[I+2];return J.length>_n?J[_n]:null}"string"==typeof q&&(I+=2)}return null}(n,r,v,d.index)),null!==j0)(j0.__ngLastListenerFn__||j0).__ngNextListenerFn__=I,j0.__ngLastListenerFn__=I,yy=!1;else{I=l6(d,r,gd,I,!1);const B_=i.listen(Ky,v,I);ay.push(I,B_),_f&&_f.push(v,Uy,d0,d0+1)}}else I=l6(d,r,gd,I,!1);const xy=d.outputs;let Ry;if(yy&&null!==xy&&(Ry=xy[v])){const zy=Ry.length;if(zy)for(let Ky=0;Ky<zy;Ky+=2){const E1=r[Ry[Ky]][Ry[Ky+1]].subscribe(I),uS=ay.length;ay.push(I,E1),_f&&_f.push(v,d.index,uS,-(uS+1))}}}(I,v,v[11],q,n,r,0,d),Ox}function u6(n,r,i,d){try{return!1!==i(d)}catch(v){return XP(n,v),!1}}function l6(n,r,i,d,v){return function I(q){if(q===Function)return d;OT(2&n.flags?mx(n.index,r):r);let _n=u6(r,0,d,q),_a=I.__ngNextListenerFn__;for(;_a;)_n=u6(r,0,_a,q)&&_n,_a=_a.__ngNextListenerFn__;return v&&!1===_n&&(q.preventDefault(),q.returnValue=!1),_n}}function GM(n=1){return function $C(n){return(i_.lFrame.contextLView=function MI(n,r){for(;n>0;)r=r[15],n--;return r}(n,i_.lFrame.contextLView))[8]}(n)}function _6(n,r,i,d,v){const I=n[i+1],q=null===r;let J=d?Ux(I):bE(I),_n=!1;for(;0!==J&&(!1===_n||q);){const _f=n[J+1];UG(n[J],r)&&(_n=!0,n[J+1]=d?fx(_f):WD(_f)),J=d?Ux(_f):bE(_f)}_n&&(n[i+1]=d?WD(I):fx(I))}function UG(n,r){return null===n||null==r||(Array.isArray(n)?n[1]:n)===r||!(!Array.isArray(n)||"string"!=typeof r)&&qA(n,r)>=0}function nL(n,r){return function LT(n,r,i,d){const v=Hy(),I=k_(),q=function hT(n){const r=i_.lFrame,i=r.bindingIndex;return r.bindingIndex=r.bindingIndex+n,i}(2);I.firstUpdatePass&&function S6(n,r,i,d){const v=n.data;if(null===v[i+1]){const I=v[ux()],q=function D6(n,r){return r>=n.expandoStartIndex}(n,i);(function O6(n,r){return 0!=(n.flags&(r?16:32))})(I,d)&&null===r&&!q&&(r=!1),r=function JG(n,r,i,d){const v=function NS(n){const r=i_.lFrame.currentDirectiveIndex;return-1===r?null:n[r]}(n);let I=d?r.residualClasses:r.residualStyles;if(null===v)0===(d?r.classBindings:r.styleBindings)&&(i=aR(i=q4(null,n,r,i,d),r.attrs,d),I=null);else{const q=r.directiveStylingLast;if(-1===q||n[q]!==v)if(i=q4(v,n,r,i,d),null===I){let _n=function QG(n,r,i){const d=i?r.classBindings:r.styleBindings;if(0!==bE(d))return n[Ux(d)]}(n,r,d);void 0!==_n&&Array.isArray(_n)&&(_n=q4(null,n,r,_n[1],d),_n=aR(_n,r.attrs,d),function t9(n,r,i,d){n[Ux(i?r.classBindings:r.styleBindings)]=d}(n,r,d,_n))}else I=function e9(n,r,i){let d;const v=r.directiveEnd;for(let I=1+r.directiveStylingLast;I<v;I++)d=aR(d,n[I].hostAttrs,i);return aR(d,r.attrs,i)}(n,r,d)}return void 0!==I&&(d?r.residualClasses=I:r.residualStyles=I),i}(v,I,r,d),function BG(n,r,i,d,v,I){let q=I?r.classBindings:r.styleBindings,J=Ux(q),_n=bE(q);n[d]=i;let _f,_a=!1;if(Array.isArray(i)){const gd=i;_f=gd[1],(null===_f||qA(gd,_f)>0)&&(_a=!0)}else _f=i;if(v)if(0!==_n){const ay=Ux(n[J+1]);n[d+1]=eE(ay,J),0!==ay&&(n[ay+1]=CM(n[ay+1],d)),n[J+1]=function GP(n,r){return 131071&n|r<<17}(n[J+1],d)}else n[d+1]=eE(J,0),0!==J&&(n[J+1]=CM(n[J+1],d)),J=d;else n[d+1]=eE(_n,0),0===J?J=d:n[_n+1]=CM(n[_n+1],d),_n=d;_a&&(n[d+1]=WD(n[d+1])),_6(n,_f,d,!0),_6(n,_f,d,!1),function HG(n,r,i,d,v){const I=v?n.residualClasses:n.residualStyles;null!=I&&"string"==typeof r&&qA(I,r)>=0&&(i[d+1]=fx(i[d+1]))}(r,_f,n,d,I),q=eE(J,_n),I?r.classBindings=q:r.styleBindings=q}(v,I,r,i,q,d)}}(I,n,q,d),r!==W0&&a_(v,q,r)&&function I6(n,r,i,d,v,I,q,J){if(!(3&r.type))return;const _n=n.data,_a=_n[J+1];rL(function qP(n){return 1==(1&n)}(_a)?k6(_n,r,i,v,bE(_a),q):void 0)||(rL(I)||function JO(n){return 2==(2&n)}(_a)&&(I=k6(_n,null,i,v,J,q)),function vE(n,r,i,d,v){if(r)v?n.addClass(i,d):n.removeClass(i,d);else{let I=-1===d.indexOf("-")?void 0:Tx.DashCase;null==v?n.removeStyle(i,d,I):("string"==typeof v&&v.endsWith("!important")&&(v=v.slice(0,-10),I|=Tx.Important),n.setStyle(i,d,v,I))}}(d,q,dD(ux(),i),v,I))}(I,I.data[ux()],v,v[11],n,v[q+1]=function i9(n,r){return null==n||("string"==typeof r?n+=r:"object"==typeof n&&(n=l_(function PE(n){return n instanceof class PD{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}(n)))),n}(r,i),d,q)}(n,r,null,!0),nL}function q4(n,r,i,d,v){let I=null;const q=i.directiveEnd;let J=i.directiveStylingLast;for(-1===J?J=i.directiveStart:J++;J<q&&(I=r[J],d=aR(d,I.hostAttrs,v),I!==n);)J++;return null!==n&&(i.directiveStylingLast=J),d}function aR(n,r,i){const d=i?1:2;let v=-1;if(null!==r)for(let I=0;I<r.length;I++){const q=r[I];"number"==typeof q?v=q:v===d&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Zx(n,q,!!i||r[++I]))}return void 0===n?null:n}function k6(n,r,i,d,v,I){const q=null===r;let J;for(;v>0;){const _n=n[v],_a=Array.isArray(_n),_f=_a?_n[1]:_n,gd=null===_f;let ay=i[v+1];ay===W0&&(ay=gd?E0:void 0);let yy=gd?mT(ay,d):_f===d?ay:void 0;if(_a&&!rL(yy)&&(yy=mT(_n,d)),rL(yy)&&(J=yy,q))return J;const xy=n[v+1];v=q?Ux(xy):bE(xy)}if(null!==r){let _n=I?r.residualClasses:r.residualStyles;null!=_n&&(J=mT(_n,d))}return J}function rL(n){return void 0!==n}function rT(n,r=""){const i=Hy(),d=k_(),v=n+22,I=d.firstCreatePass?ey(d,v,1,r,null):d.data[v],q=i[v]=function MD(n,r){return n.createText(r)}(i[11],r);m_(d,i,q,I),J1(I,!1)}function uR(n){return lR("",n,""),uR}function lR(n,r,i){const d=Hy(),v=function k2(n,r,i,d){return a_(n,UC(),i)?r+Z0(i)+d:W0}(d,n,r,i);return v!==W0&&function VE(n,r,i){const d=dD(r,n);!function ID(n,r,i){n.setValue(r,i)}(n[11],d,i)}(d,ux(),v),lR}const $M="en-US";let t8=$M;function Y4(n,r,i,d,v){if(n=O0(n),Array.isArray(n))for(let I=0;I<n.length;I++)Y4(n[I],r,i,d,v);else{const I=k_(),q=Hy();let J=tT(n)?n:O0(n.provide),_n=nC(n);const _a=f_(),_f=1048575&_a.providerIndexes,gd=_a.directiveStart,ay=_a.providerIndexes>>20;if(tT(n)||!n.multi){const yy=new KC(_n,v,Xy),xy=Z4(J,r,v?_f:_f+ay,gd);-1===xy?(XC(W_(_a,q),I,J),K4(I,n,r.length),r.push(J),_a.directiveStart++,_a.directiveEnd++,v&&(_a.providerIndexes+=1048576),i.push(yy),q.push(yy)):(i[xy]=yy,q[xy]=yy)}else{const yy=Z4(J,r,_f+ay,gd),xy=Z4(J,r,_f,_f+ay),Ry=yy>=0&&i[yy],zy=xy>=0&&i[xy];if(v&&!zy||!v&&!Ry){XC(W_(_a,q),I,J);const Ky=function x7(n,r,i,d,v){const I=new KC(n,i,Xy);return I.multi=[],I.index=r,I.componentProviders=0,A8(I,v,d&&!i),I}(v?w7:b7,i.length,v,d,_n);!v&&zy&&(i[xy].providerFactory=Ky),K4(I,n,r.length,0),r.push(J),_a.directiveStart++,_a.directiveEnd++,v&&(_a.providerIndexes+=1048576),i.push(Ky),q.push(Ky)}else K4(I,n,yy>-1?yy:xy,A8(i[v?xy:yy],_n,!v&&d));!v&&d&&zy&&i[xy].componentProviders++}}}function K4(n,r,i,d){const v=tT(r),I=function xP(n){return!!n.useClass}(r);if(v||I){const _n=(I?O0(r.useClass):r).prototype.ngOnDestroy;if(_n){const _a=n.destroyHooks||(n.destroyHooks=[]);if(!v&&r.multi){const _f=_a.indexOf(i);-1===_f?_a.push(i,[d,_n]):_a[_f+1].push(d,_n)}else _a.push(i,_n)}}}function A8(n,r,i){return i&&n.componentProviders++,n.multi.push(r)-1}function Z4(n,r,i,d){for(let v=i;v<d;v++)if(r[v]===n)return v;return-1}function b7(n,r,i,d){return X4(this.multi,[])}function w7(n,r,i,d){const v=this.multi;let I;if(this.providerFactory){const q=this.providerFactory.componentProviders,J=QC(i,i[1],this.providerFactory.index,d);I=J.slice(0,q),X4(v,I);for(let _n=q;_n<J.length;_n++)I.push(J[_n])}else I=[],X4(v,I);return I}function X4(n,r){for(let i=0;i<n.length;i++)r.push((0,n[i])());return r}function x1(n,r=[]){return i=>{i.providersResolver=(d,v)=>function _7(n,r,i){const d=k_();if(d.firstCreatePass){const v=gE(n);Y4(i,d.data,d.blueprint,v,!0),Y4(r,d.data,d.blueprint,v,!1)}}(d,v?v(n):n,r)}}class JD{}class C8{}class D8 extends JD{constructor(r,i){super(),this._parent=i,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new LM(this);const d=T1(r);this._bootstrapComponents=MT(d.bootstrap),this._r3Injector=FP(r,i,[{provide:JD,useValue:this},{provide:hA,useValue:this.componentFactoryResolver}],l_(r),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(r)}get injector(){return this._r3Injector}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(i=>i()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class J4 extends C8{constructor(r){super(),this.moduleType=r}create(r){return new D8(this.moduleType,r)}}class T7 extends JD{constructor(r,i,d){super(),this.componentFactoryResolver=new LM(this),this.instance=null;const v=new EP([...r,{provide:JD,useValue:this},{provide:hA,useValue:this.componentFactoryResolver}],i||w2(),d,new Set(["environment"]));this.injector=v,v.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(r){this.injector.onDestroy(r)}}function uL(n,r,i=null){return new T7(n,r,i).injector}let A7=(()=>{class n{constructor(i){this._injector=i,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(i){if(!i.standalone)return null;if(!this.cachedInjectors.has(i.id)){const d=yM(0,i.type),v=d.length>0?uL([d],this._injector,`Standalone[${i.type.name}]`):null;this.cachedInjectors.set(i.id,v)}return this.cachedInjectors.get(i.id)}ngOnDestroy(){try{for(const i of this.cachedInjectors.values())null!==i&&i.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Ni({token:n,providedIn:"environment",factory:()=>new n(x0(cA))}),n})();function S8(n){n.getStandaloneInjector=r=>r.get(A7).getOrCreateStandaloneInjector(n)}function P8(n,r,i,d){return function L8(n,r,i,d,v,I){const q=r+i;return a_(n,q,v)?function M_(n,r,i){return n[r]=i}(n,q+1,I?d.call(I,v):d(v)):function gR(n,r){const i=n[r];return i===W0?void 0:i}(n,q+1)}(Hy(),function vx(){const n=i_.lFrame;let r=n.bindingRootIndex;return-1===r&&(r=n.bindingRootIndex=n.tView.bindingStartIndex),r}(),n,r,i,d)}function tF(n){return r=>{setTimeout(n,void 0,r)}}const V1=class Z7 extends W1{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,i,d){let v=r,I=i||(()=>null),q=d;if(r&&"object"==typeof r){const _n=r;v=_n.next?.bind(_n),I=_n.error?.bind(_n),q=_n.complete?.bind(_n)}this.__isAsync&&(I=tF(I),v&&(v=tF(v)),q&&(q=tF(q)));const J=super.subscribe({next:v,error:I,complete:q});return r instanceof _e&&r.add(J),J}};function X7(){return this._results[R_()]()}class eF{constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const i=R_(),d=eF.prototype;d[i]||(d[i]=X7)}get changes(){return this._changes||(this._changes=new V1)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,i){return this._results.reduce(r,i)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,i){const d=this;d.dirty=!1;const v=Kx(r);(this._changesDetected=!function bN(n,r,i){if(n.length!==r.length)return!1;for(let d=0;d<n.length;d++){let v=n[d],I=r[d];if(i&&(v=i(v),I=i(I)),I!==v)return!1}return!0}(d._results,v,i))&&(d._results=v,d.length=v.length,d.last=v[this.length-1],d.first=v[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let sC=(()=>{class n{}return n.__NG_ELEMENT_ID__=tq,n})();const J7=sC,Q7=class extends J7{constructor(r,i,d){super(),this._declarationLView=r,this._declarationTContainer=i,this.elementRef=d}createEmbeddedView(r,i){const d=this._declarationTContainer.tViews,v=ly(this._declarationLView,d,r,16,null,d.declTNode,null,null,null,null,i||null);v[17]=this._declarationLView[this._declarationTContainer.index];const q=this._declarationLView[19];return null!==q&&(v[19]=q.createEmbeddedView(d)),_y(d,v,r),new xE(v)}};function tq(){return lL(f_(),Hy())}function lL(n,r){return 4&n.type?new Q7(r,n,x2(n,r)):null}let jT=(()=>{class n{}return n.__NG_ELEMENT_ID__=_q,n})();function _q(){return U8(f_(),Hy())}const tW=jT,B8=class extends tW{constructor(r,i,d){super(),this._lContainer=r,this._hostTNode=i,this._hostLView=d}get element(){return x2(this._hostTNode,this._hostLView)}get injector(){return new BA(this._hostTNode,this._hostLView)}get parentInjector(){const r=n1(this._hostTNode,this._hostLView);if(VA(r)){const i=pT(r,this._hostLView),d=ZC(r);return new BA(i[1].data[d+8],i)}return new BA(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const i=H8(this._lContainer);return null!==i&&i[r]||null}get length(){return this._lContainer.length-10}createEmbeddedView(r,i,d){let v,I;"number"==typeof d?v=d:null!=d&&(v=d.index,I=d.injector);const q=r.createEmbeddedView(i||{},I);return this.insert(q,v),q}createComponent(r,i,d,v,I){const q=r&&!function r2(n){return"function"==typeof n}(r);let J;if(q)J=i;else{const gd=i||{};J=gd.index,d=gd.injector,v=gd.projectableNodes,I=gd.environmentInjector||gd.ngModuleRef}const _n=q?r:new g1(y_(r)),_a=d||this.parentInjector;if(!I&&null==_n.ngModule){const ay=(q?_a:this.parentInjector).get(cA,null);ay&&(I=ay)}const _f=_n.create(_a,v,void 0,I);return this.insert(_f.hostView,J),_f}insert(r,i){const d=r._lView,v=d[1];if(function G0(n){return h1(n[3])}(d)){const _f=this.indexOf(r);if(-1!==_f)this.detach(_f);else{const gd=d[3],ay=new B8(gd,gd[6],gd[3]);ay.detach(ay.indexOf(r))}}const I=this._adjustIndex(i),q=this._lContainer;!function OD(n,r,i,d){const v=10+d,I=i.length;d>0&&(i[v-1][4]=r),d<I-10?(r[4]=i[v],gT(i,10+d,r)):(i.push(r),r[4]=null),r[3]=i;const q=r[17];null!==q&&i!==q&&function sO(n,r){const i=n[9];r[16]!==r[3][3][16]&&(n[2]=!0),null===i?n[9]=[r]:i.push(r)}(q,r);const J=r[19];null!==J&&J.insertView(n),r[2]|=64}(v,d,q,I);const J=uM(I,q),_n=d[11],_a=v2(_n,q[7]);return null!==_a&&function kD(n,r,i,d,v,I){d[0]=v,d[6]=r,cx(n,d,i,1,v,I)}(v,q[6],_n,d,_a,J),r.attachToViewContainerRef(),gT(nF(q),I,r),r}move(r,i){return this.insert(r,i)}indexOf(r){const i=H8(this._lContainer);return null!==i?i.indexOf(r):-1}remove(r){const i=this._adjustIndex(r,-1),d=aO(this._lContainer,i);d&&(Zy(nF(this._lContainer),i),uO(d[1],d))}detach(r){const i=this._adjustIndex(r,-1),d=aO(this._lContainer,i);return d&&null!=Zy(nF(this._lContainer),i)?new xE(d):null}_adjustIndex(r,i=0){return r??this.length+i}};function H8(n){return n[8]}function nF(n){return n[8]||(n[8]=[])}function U8(n,r){let i;const d=r[n.index];if(h1(d))i=d;else{let v;if(8&n.type)v=b1(d);else{const I=r[11];v=I.createComment("");const q=X1(n,r);Xb(I,v2(I,q),v,function eP(n,r){return n.nextSibling(r)}(I,q),!1)}r[n.index]=i=X_(d,r,v,n),f0(r,i)}return new B8(i,n,r)}class rF{constructor(r){this.queryList=r,this.matches=null}clone(){return new rF(this.queryList)}setDirty(){this.queryList.setDirty()}}class iF{constructor(r=[]){this.queries=r}createEmbeddedView(r){const i=r.queries;if(null!==i){const d=null!==r.contentQueries?r.contentQueries[0]:i.length,v=[];for(let I=0;I<d;I++){const q=i.getByIndex(I);v.push(this.queries[q.indexInDeclarationView].clone())}return new iF(v)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let i=0;i<this.queries.length;i++)null!==Y8(r,i).matches&&this.queries[i].setDirty()}}class G8{constructor(r,i,d=null){this.predicate=r,this.flags=i,this.read=d}}class oF{constructor(r=[]){this.queries=r}elementStart(r,i){for(let d=0;d<this.queries.length;d++)this.queries[d].elementStart(r,i)}elementEnd(r){for(let i=0;i<this.queries.length;i++)this.queries[i].elementEnd(r)}embeddedTView(r){let i=null;for(let d=0;d<this.length;d++){const v=null!==i?i.length:0,I=this.getByIndex(d).embeddedTView(r,v);I&&(I.indexInDeclarationView=d,null!==i?i.push(I):i=[I])}return null!==i?new oF(i):null}template(r,i){for(let d=0;d<this.queries.length;d++)this.queries[d].template(r,i)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class sF{constructor(r,i=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=i}elementStart(r,i){this.isApplyingToNode(i)&&this.matchTNode(r,i)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,i){this.elementStart(r,i)}embeddedTView(r,i){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,i),new sF(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const i=this._declarationNodeIndex;let d=r.parent;for(;null!==d&&8&d.type&&d.index!==i;)d=d.parent;return i===(null!==d?d.index:-1)}return this._appliesToNextNode}matchTNode(r,i){const d=this.metadata.predicate;if(Array.isArray(d))for(let v=0;v<d.length;v++){const I=d[v];this.matchTNodeWithReadOption(r,i,rW(i,I)),this.matchTNodeWithReadOption(r,i,zA(i,r,I,!1,!1))}else d===sC?4&i.type&&this.matchTNodeWithReadOption(r,i,-1):this.matchTNodeWithReadOption(r,i,zA(i,r,d,!1,!1))}matchTNodeWithReadOption(r,i,d){if(null!==d){const v=this.metadata.read;if(null!==v)if(v===Qx||v===jT||v===sC&&4&i.type)this.addMatch(i.index,-2);else{const I=zA(i,r,v,!1,!1);null!==I&&this.addMatch(i.index,I)}else this.addMatch(i.index,d)}}addMatch(r,i){null===this.matches?this.matches=[r,i]:this.matches.push(r,i)}}function rW(n,r){const i=n.localNames;if(null!==i)for(let d=0;d<i.length;d+=2)if(i[d]===r)return i[d+1];return null}function oW(n,r,i,d){return-1===i?function iW(n,r){return 11&n.type?x2(n,r):4&n.type?lL(n,r):null}(r,n):-2===i?function sW(n,r,i){return i===Qx?x2(r,n):i===sC?lL(r,n):i===jT?U8(r,n):void 0}(n,r,d):QC(n,n[1],i,r)}function q8(n,r,i,d){const v=r[19].queries[d];if(null===v.matches){const I=n.data,q=i.matches,J=[];for(let _n=0;_n<q.length;_n+=2){const _a=q[_n];J.push(_a<0?null:oW(r,I[_a],q[_n+1],i.metadata.read))}v.matches=J}return v.matches}function aF(n,r,i,d){const v=n.queries.getByIndex(i),I=v.matches;if(null!==I){const q=q8(n,r,v,i);for(let J=0;J<I.length;J+=2){const _n=I[J];if(_n>0)d.push(q[J/2]);else{const _a=I[J+1],_f=r[-_n];for(let gd=10;gd<_f.length;gd++){const ay=_f[gd];ay[17]===ay[3]&&aF(ay[1],ay,_a,d)}if(null!==_f[9]){const gd=_f[9];for(let ay=0;ay<gd.length;ay++){const yy=gd[ay];aF(yy[1],yy,_a,d)}}}}}return d}function mR(n){const r=Hy(),i=k_(),d=CI();DI(d+1);const v=Y8(i,d);if(n.dirty&&function $y(n){return 4==(4&n[2])}(r)===(2==(2&v.metadata.flags))){if(null===v.matches)n.reset([]);else{const I=v.crossesNgTemplate?aF(i,r,d,[]):q8(i,r,v,d);n.reset(I,d4),n.notifyOnChanges()}return!0}return!1}function uF(n,r,i){const d=k_();d.firstCreatePass&&(function $8(n,r,i){null===n.queries&&(n.queries=new oF),n.queries.track(new sF(r,i))}(d,new G8(n,r,i),-1),2==(2&r)&&(d.staticViewQueries=!0)),function W8(n,r,i){const d=new eF(4==(4&i));Q0(n,r,d,d.destroy),null===r[19]&&(r[19]=new iF),r[19].queries.push(new rF(d))}(d,Hy(),r)}function vR(){return function aW(n,r){return n[19].queries[r].queryList}(Hy(),CI())}function Y8(n,r){return n.queries.getByIndex(r)}function hL(...n){}const fL=new z0("Application Initializer");let pL=(()=>{class n{constructor(i){this.appInits=i,this.resolve=hL,this.reject=hL,this.initialized=!1,this.done=!1,this.donePromise=new Promise((d,v)=>{this.resolve=d,this.reject=v})}runInitializers(){if(this.initialized)return;const i=[],d=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let v=0;v<this.appInits.length;v++){const I=this.appInits[v]();if(sR(I))i.push(I);else if(U4(I)){const q=new Promise((J,_n)=>{I.subscribe({complete:J,error:_n})});i.push(q)}}Promise.all(i).then(()=>{d()}).catch(v=>{this.reject(v)}),0===i.length&&d(),this.initialized=!0}}return n.\u0275fac=function(i){return new(i||n)(x0(fL,8))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const bR=new z0("AppId",{providedIn:"root",factory:function pz(){return`${dF()}${dF()}${dF()}`}});function dF(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const dz=new z0("Platform Initializer"),gF=new z0("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),gz=new z0("appBootstrapListener");let MW=(()=>{class n{log(i){console.log(i)}warn(i){console.warn(i)}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const aC=new z0("LocaleId",{providedIn:"root",factory:()=>A1(aC,ky.Optional|ky.SkipSelf)||function IW(){return typeof $localize<"u"&&$localize.locale||$M}()});class OW{constructor(r,i){this.ngModuleFactory=r,this.componentFactories=i}}let yF=(()=>{class n{compileModuleSync(i){return new J4(i)}compileModuleAsync(i){return Promise.resolve(this.compileModuleSync(i))}compileModuleAndAllComponentsSync(i){const d=this.compileModuleSync(i),I=MT(T1(i).declarations).reduce((q,J)=>{const _n=y_(J);return _n&&q.push(new g1(_n)),q},[]);return new OW(d,I)}compileModuleAndAllComponentsAsync(i){return Promise.resolve(this.compileModuleAndAllComponentsSync(i))}clearCache(){}clearCacheFor(i){}getModuleId(i){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const PW=(()=>Promise.resolve(0))();function mF(n){typeof Zone>"u"?PW.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class ex{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:d=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new V1(!1),this.onMicrotaskEmpty=new V1(!1),this.onStable=new V1(!1),this.onError=new V1(!1),typeof Zone>"u")throw new a0(908,!1);Zone.assertZonePatched();const v=this;if(v._nesting=0,v._outer=v._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const I=Zone.AsyncStackTaggingZoneSpec;v._inner=v._inner.fork(new I("Angular"))}Zone.TaskTrackingZoneSpec&&(v._inner=v._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(v._inner=v._inner.fork(Zone.longStackTraceZoneSpec)),v.shouldCoalesceEventChangeDetection=!d&&i,v.shouldCoalesceRunChangeDetection=d,v.lastRequestAnimationFrameId=-1,v.nativeRequestAnimationFrame=function LW(){let n=Gy.requestAnimationFrame,r=Gy.cancelAnimationFrame;if(typeof Zone<"u"&&n&&r){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const d=r[Zone.__symbol__("OriginalDelegate")];d&&(r=d)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function VW(n){const r=()=>{!function jW(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Gy,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,_F(n),n.isCheckStableRunning=!0,vF(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),_F(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,d,v,I,q,J)=>{try{return vz(n),i.invokeTask(v,I,q,J)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===I.type||n.shouldCoalesceRunChangeDetection)&&r(),_z(n)}},onInvoke:(i,d,v,I,q,J,_n)=>{try{return vz(n),i.invoke(v,I,q,J,_n)}finally{n.shouldCoalesceRunChangeDetection&&r(),_z(n)}},onHasTask:(i,d,v,I)=>{i.hasTask(v,I),d===v&&("microTask"==I.change?(n._hasPendingMicrotasks=I.microTask,_F(n),vF(n)):"macroTask"==I.change&&(n.hasPendingMacrotasks=I.macroTask))},onHandleError:(i,d,v,I)=>(i.handleError(v,I),n.runOutsideAngular(()=>n.onError.emit(I)),!1)})}(v)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ex.isInAngularZone())throw new a0(909,!1)}static assertNotInAngularZone(){if(ex.isInAngularZone())throw new a0(909,!1)}run(r,i,d){return this._inner.run(r,i,d)}runTask(r,i,d,v){const I=this._inner,q=I.scheduleEventTask("NgZoneEvent: "+v,r,FW,hL,hL);try{return I.runTask(q,i,d)}finally{I.cancelTask(q)}}runGuarded(r,i,d){return this._inner.runGuarded(r,i,d)}runOutsideAngular(r){return this._outer.run(r)}}const FW={};function vF(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function _F(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function vz(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function _z(n){n._nesting--,vF(n)}class zW{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new V1,this.onMicrotaskEmpty=new V1,this.onStable=new V1,this.onError=new V1}run(r,i,d){return r.apply(i,d)}runGuarded(r,i,d){return r.apply(i,d)}runOutsideAngular(r){return r()}runTask(r,i,d,v){return r.apply(i,d)}}const bz=new z0(""),dL=new z0("");let xF,bF=(()=>{class n{constructor(i,d,v){this._ngZone=i,this.registry=d,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,xF||(function BW(n){xF=n}(v),v.addToWindow(d)),this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ex.assertNotInAngularZone(),mF(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())mF(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(d=>!d.updateCb||!d.updateCb(i)||(clearTimeout(d.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,d,v){let I=-1;d&&d>0&&(I=setTimeout(()=>{this._callbacks=this._callbacks.filter(q=>q.timeoutId!==I),i(this._didWork,this.getPendingTasks())},d)),this._callbacks.push({doneCb:i,timeoutId:I,updateCb:v})}whenStable(i,d,v){if(v&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,d,v),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(i){this.registry.registerApplication(i,this)}unregisterApplication(i){this.registry.unregisterApplication(i)}findProviders(i,d,v){return[]}}return n.\u0275fac=function(i){return new(i||n)(x0(ex),x0(wF),x0(dL))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})(),wF=(()=>{class n{constructor(){this._applications=new Map}registerApplication(i,d){this._applications.set(i,d)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,d=!0){return xF?.findTestabilityInTree(this,i,d)??null}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),R2=null;const wz=new z0("AllowMultipleToken"),EF=new z0("PlatformDestroyListeners");class xz{constructor(r,i){this.name=r,this.token=i}}function Tz(n,r,i=[]){const d=`Platform: ${r}`,v=new z0(d);return(I=[])=>{let q=TF();if(!q||q.injector.get(wz,!1)){const J=[...i,...I,{provide:v,useValue:!0}];n?n(J):function GW(n){if(R2&&!R2.get(wz,!1))throw new a0(400,!1);R2=n;const r=n.get(Cz);(function Ez(n){const r=n.get(dz,null);r&&r.forEach(i=>i())})(n)}(function Az(n=[],r){return tE.create({name:r,providers:[{provide:mM,useValue:"platform"},{provide:EF,useValue:new Set([()=>R2=null])},...n]})}(J,d))}return function WW(n){const r=TF();if(!r)throw new a0(401,!1);return r}()}}function TF(){return R2?.get(Cz)??null}let Cz=(()=>{class n{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,d){const v=function Sz(n,r){let i;return i="noop"===n?new zW:("zone.js"===n?void 0:n)||new ex(r),i}(d?.ngZone,function Dz(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(d)),I=[{provide:ex,useValue:v}];return v.run(()=>{const q=tE.create({providers:I,parent:this.injector,name:i.moduleType.name}),J=i.create(q),_n=J.injector.get(ST,null);if(!_n)throw new a0(402,!1);return v.runOutsideAngular(()=>{const _a=v.onError.subscribe({next:_f=>{_n.handleError(_f)}});J.onDestroy(()=>{yL(this._modules,J),_a.unsubscribe()})}),function Mz(n,r,i){try{const d=i();return sR(d)?d.catch(v=>{throw r.runOutsideAngular(()=>n.handleError(v)),v}):d}catch(d){throw r.runOutsideAngular(()=>n.handleError(d)),d}}(_n,v,()=>{const _a=J.injector.get(pL);return _a.runInitializers(),_a.donePromise.then(()=>(function e8(n){Y1(n,"Expected localeId to be defined"),"string"==typeof n&&(t8=n.toLowerCase().replace(/_/g,"-"))}(J.injector.get(aC,$M)||$M),this._moduleDoBootstrap(J),J))})})}bootstrapModule(i,d=[]){const v=Iz({},d);return function HW(n,r,i){const d=new J4(i);return Promise.resolve(d)}(0,0,i).then(I=>this.bootstrapModuleFactory(I,v))}_moduleDoBootstrap(i){const d=i.injector.get(gL);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(v=>d.bootstrap(v));else{if(!i.instance.ngDoBootstrap)throw new a0(403,!1);i.instance.ngDoBootstrap(d)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new a0(404,!1);this._modules.slice().forEach(d=>d.destroy()),this._destroyListeners.forEach(d=>d());const i=this._injector.get(EF,null);i&&(i.forEach(d=>d()),i.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(i){return new(i||n)(x0(tE))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function Iz(n,r){return Array.isArray(r)?r.reduce(Iz,n):{...n,...r}}let gL=(()=>{class n{constructor(i,d,v){this._zone=i,this._injector=d,this._exceptionHandler=v,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const I=new i1(J=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{J.next(this._stable),J.complete()})}),q=new i1(J=>{let _n;this._zone.runOutsideAngular(()=>{_n=this._zone.onStable.subscribe(()=>{ex.assertNotInAngularZone(),mF(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,J.next(!0))})})});const _a=this._zone.onUnstable.subscribe(()=>{ex.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{J.next(!1)}))});return()=>{_n.unsubscribe(),_a.unsubscribe()}});this.isStable=function pI(...n){const r=GE(n),i=function qT(n,r){return"number"==typeof DC(n)?n.pop():r}(n,1/0),d=n;return d.length?1===d.length?$1(d[0]):UE(i)(Z_(d,r)):dE}(I,q.pipe(function OC(n={}){const{connector:r=(()=>new W1),resetOnError:i=!0,resetOnComplete:d=!0,resetOnRefCountZero:v=!0}=n;return I=>{let q,J,_n,_a=0,_f=!1,gd=!1;const ay=()=>{J?.unsubscribe(),J=void 0},yy=()=>{ay(),q=_n=void 0,_f=gd=!1},xy=()=>{const Ry=q;yy(),Ry?.unsubscribe()};return o1((Ry,zy)=>{_a++,!gd&&!_f&&ay();const Ky=_n=_n??r();zy.add(()=>{_a--,0===_a&&!gd&&!_f&&(J=WE(xy,v))}),Ky.subscribe(zy),!q&&_a>0&&(q=new Uw({next:d0=>Ky.next(d0),error:d0=>{gd=!0,ay(),J=WE(yy,i,d0),Ky.error(d0)},complete:()=>{_f=!0,ay(),J=WE(yy,d),Ky.complete()}}),$1(Ry).subscribe(q))})(I)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(i,d){const v=i instanceof RO;if(!this._injector.get(pL).done)throw!v&&function IE(n){const r=y_(n)||I1(n)||k1(n);return null!==r&&r.standalone}(i),new a0(405,false);let q;q=v?i:this._injector.get(hA).resolveComponentFactory(i),this.componentTypes.push(q.componentType);const J=function UW(n){return n.isBoundToModule}(q)?void 0:this._injector.get(JD),_a=q.create(tE.NULL,[],d||q.selector,J),_f=_a.location.nativeElement,gd=_a.injector.get(bz,null);return gd?.registerApplication(_f),_a.onDestroy(()=>{this.detachView(_a.hostView),yL(this.components,_a),gd?.unregisterApplication(_f)}),this._loadComponent(_a),_a}tick(){if(this._runningTick)throw new a0(101,!1);try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(i))}finally{this._runningTick=!1}}attachView(i){const d=i;this._views.push(d),d.attachToAppRef(this)}detachView(i){const d=i;yL(this._views,d),d.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i),this._injector.get(gz,[]).concat(this._bootstrapListeners).forEach(v=>v(i))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(i=>i()),this._views.slice().forEach(i=>i.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(i){return this._destroyListeners.push(i),()=>yL(this._destroyListeners,i)}destroy(){if(this._destroyed)throw new a0(406,!1);const i=this._injector;i.destroy&&!i.destroyed&&i.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(i){return new(i||n)(x0(ex),x0(cA),x0(ST))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function yL(n,r){const i=n.indexOf(r);i>-1&&n.splice(i,1)}let Oz=!0,mL=(()=>{class n{}return n.__NG_ELEMENT_ID__=KW,n})();function KW(n){return function ZW(n,r,i){if(cD(n)&&!i){const d=mx(n.index,r);return new xE(d,d)}return 47&n.type?new xE(r[16],r):null}(f_(),Hy(),16==(16&n))}class Fz{constructor(){}supports(r){return k0(r)}create(r){return new n$(r)}}const e$=(n,r)=>r;class n${constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||e$}forEachItem(r){let i;for(i=this._itHead;null!==i;i=i._next)r(i)}forEachOperation(r){let i=this._itHead,d=this._removalsHead,v=0,I=null;for(;i||d;){const q=!d||i&&i.currentIndex<Vz(d,v,I)?i:d,J=Vz(q,v,I),_n=q.currentIndex;if(q===d)v--,d=d._nextRemoved;else if(i=i._next,null==q.previousIndex)v++;else{I||(I=[]);const _a=J-v,_f=_n-v;if(_a!=_f){for(let ay=0;ay<_a;ay++){const yy=ay<I.length?I[ay]:I[ay]=0,xy=yy+ay;_f<=xy&&xy<_a&&(I[ay]=yy+1)}I[q.previousIndex]=_f-_a}}J!==_n&&r(q,J,_n)}}forEachPreviousItem(r){let i;for(i=this._previousItHead;null!==i;i=i._nextPrevious)r(i)}forEachAddedItem(r){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)r(i)}forEachMovedItem(r){let i;for(i=this._movesHead;null!==i;i=i._nextMoved)r(i)}forEachRemovedItem(r){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)r(i)}forEachIdentityChange(r){let i;for(i=this._identityChangesHead;null!==i;i=i._nextIdentityChange)r(i)}diff(r){if(null==r&&(r=[]),!k0(r))throw new a0(900,!1);return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let v,I,q,i=this._itHead,d=!1;if(Array.isArray(r)){this.length=r.length;for(let J=0;J<this.length;J++)I=r[J],q=this._trackByFn(J,I),null!==i&&Object.is(i.trackById,q)?(d&&(i=this._verifyReinsertion(i,I,q,J)),Object.is(i.item,I)||this._addIdentityChange(i,I)):(i=this._mismatch(i,I,q,J),d=!0),i=i._next}else v=0,function F0(n,r){if(Array.isArray(n))for(let i=0;i<n.length;i++)r(n[i]);else{const i=n[R_()]();let d;for(;!(d=i.next()).done;)r(d.value)}}(r,J=>{q=this._trackByFn(v,J),null!==i&&Object.is(i.trackById,q)?(d&&(i=this._verifyReinsertion(i,J,q,v)),Object.is(i.item,J)||this._addIdentityChange(i,J)):(i=this._mismatch(i,J,q,v),d=!0),i=i._next,v++}),this.length=v;return this._truncate(i),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,i,d,v){let I;return null===r?I=this._itTail:(I=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null))?(Object.is(r.item,i)||this._addIdentityChange(r,i),this._reinsertAfter(r,I,v)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(d,v))?(Object.is(r.item,i)||this._addIdentityChange(r,i),this._moveAfter(r,I,v)):r=this._addAfter(new r$(i,d),I,v),r}_verifyReinsertion(r,i,d,v){let I=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null);return null!==I?r=this._reinsertAfter(I,r._prev,v):r.currentIndex!=v&&(r.currentIndex=v,this._addToMoves(r,v)),r}_truncate(r){for(;null!==r;){const i=r._next;this._addToRemovals(this._unlink(r)),r=i}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,i,d){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const v=r._prevRemoved,I=r._nextRemoved;return null===v?this._removalsHead=I:v._nextRemoved=I,null===I?this._removalsTail=v:I._prevRemoved=v,this._insertAfter(r,i,d),this._addToMoves(r,d),r}_moveAfter(r,i,d){return this._unlink(r),this._insertAfter(r,i,d),this._addToMoves(r,d),r}_addAfter(r,i,d){return this._insertAfter(r,i,d),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,i,d){const v=null===i?this._itHead:i._next;return r._next=v,r._prev=i,null===v?this._itTail=r:v._prev=r,null===i?this._itHead=r:i._next=r,null===this._linkedRecords&&(this._linkedRecords=new jz),this._linkedRecords.put(r),r.currentIndex=d,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const i=r._prev,d=r._next;return null===i?this._itHead=d:i._next=d,null===d?this._itTail=i:d._prev=i,r}_addToMoves(r,i){return r.previousIndex===i||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new jz),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,i){return r.item=i,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class r${constructor(r,i){this.item=r,this.trackById=i,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class i${constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,i){let d;for(d=this._head;null!==d;d=d._nextDup)if((null===i||i<=d.currentIndex)&&Object.is(d.trackById,r))return d;return null}remove(r){const i=r._prevDup,d=r._nextDup;return null===i?this._head=d:i._nextDup=d,null===d?this._tail=i:d._prevDup=i,null===this._head}}class jz{constructor(){this.map=new Map}put(r){const i=r.trackById;let d=this.map.get(i);d||(d=new i$,this.map.set(i,d)),d.add(r)}get(r,i){const v=this.map.get(r);return v?v.get(r,i):null}remove(r){const i=r.trackById;return this.map.get(i).remove(r)&&this.map.delete(i),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Vz(n,r,i){const d=n.previousIndex;if(null===d)return d;let v=0;return i&&d<i.length&&(v=i[d]),d+r+v}class zz{constructor(){}supports(r){return r instanceof Map||h_(r)}create(){return new o$}}class o${constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let i;for(i=this._mapHead;null!==i;i=i._next)r(i)}forEachPreviousItem(r){let i;for(i=this._previousMapHead;null!==i;i=i._nextPrevious)r(i)}forEachChangedItem(r){let i;for(i=this._changesHead;null!==i;i=i._nextChanged)r(i)}forEachAddedItem(r){let i;for(i=this._additionsHead;null!==i;i=i._nextAdded)r(i)}forEachRemovedItem(r){let i;for(i=this._removalsHead;null!==i;i=i._nextRemoved)r(i)}diff(r){if(r){if(!(r instanceof Map||h_(r)))throw new a0(900,!1)}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let i=this._mapHead;if(this._appendAfter=null,this._forEach(r,(d,v)=>{if(i&&i.key===v)this._maybeAddToChanges(i,d),this._appendAfter=i,i=i._next;else{const I=this._getOrCreateRecordForKey(v,d);i=this._insertBeforeOrAppend(i,I)}}),i){i._prev&&(i._prev._next=null),this._removalsHead=i;for(let d=i;null!==d;d=d._nextRemoved)d===this._mapHead&&(this._mapHead=null),this._records.delete(d.key),d._nextRemoved=d._next,d.previousValue=d.currentValue,d.currentValue=null,d._prev=null,d._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,i){if(r){const d=r._prev;return i._next=r,i._prev=d,r._prev=i,d&&(d._next=i),r===this._mapHead&&(this._mapHead=i),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=i,i._prev=this._appendAfter):this._mapHead=i,this._appendAfter=i,null}_getOrCreateRecordForKey(r,i){if(this._records.has(r)){const v=this._records.get(r);this._maybeAddToChanges(v,i);const I=v._prev,q=v._next;return I&&(I._next=q),q&&(q._prev=I),v._next=null,v._prev=null,v}const d=new s$(r);return this._records.set(r,d),d.currentValue=i,this._addToAdditions(d),d}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,i){Object.is(i,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=i,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,i){r instanceof Map?r.forEach(i):Object.keys(r).forEach(d=>i(r[d],d))}}class s${constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Bz(){return new bL([new Fz])}let bL=(()=>{class n{constructor(i){this.factories=i}static create(i,d){if(null!=d){const v=d.factories.slice();i=i.concat(v)}return new n(i)}static extend(i){return{provide:n,useFactory:d=>n.create(i,d||Bz()),deps:[[n,new iA,new XE]]}}find(i){const d=this.factories.find(v=>v.supports(i));if(null!=d)return d;throw new a0(901,!1)}}return n.\u0275prov=Ni({token:n,providedIn:"root",factory:Bz}),n})();function Hz(){return new wR([new zz])}let wR=(()=>{class n{constructor(i){this.factories=i}static create(i,d){if(d){const v=d.factories.slice();i=i.concat(v)}return new n(i)}static extend(i){return{provide:n,useFactory:d=>n.create(i,d||Hz()),deps:[[n,new iA,new XE]]}}find(i){const d=this.factories.find(v=>v.supports(i));if(d)return d;throw new a0(901,!1)}}return n.\u0275prov=Ni({token:n,providedIn:"root",factory:Hz}),n})();const l$=Tz(null,"core",[]);let c$=(()=>{class n{constructor(i){}}return n.\u0275fac=function(i){return new(i||n)(x0(gL))},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({}),n})(),wL=null;function vA(){return wL}const cE=new z0("DocumentToken");let MF=(()=>{class n{historyGo(i){throw new Error("Not implemented")}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:function(){return function d$(){return x0(Uz)}()},providedIn:"platform"}),n})();const g$=new z0("Location Initialized");let Uz=(()=>{class n extends MF{constructor(i){super(),this._doc=i,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return vA().getBaseHref(this._doc)}onPopState(i){const d=vA().getGlobalEventTarget(this._doc,"window");return d.addEventListener("popstate",i,!1),()=>d.removeEventListener("popstate",i)}onHashChange(i){const d=vA().getGlobalEventTarget(this._doc,"window");return d.addEventListener("hashchange",i,!1),()=>d.removeEventListener("hashchange",i)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(i){this.location.pathname=i}pushState(i,d,v){Gz()?this._history.pushState(i,d,v):this.location.hash=v}replaceState(i,d,v){Gz()?this._history.replaceState(i,d,v):this.location.hash=v}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}}return n.\u0275fac=function(i){return new(i||n)(x0(cE))},n.\u0275prov=Ni({token:n,factory:function(){return function y$(){return new Uz(x0(cE))}()},providedIn:"platform"}),n})();function Gz(){return!!window.history.pushState}function IF(n,r){if(0==n.length)return r;if(0==r.length)return n;let i=0;return n.endsWith("/")&&i++,r.startsWith("/")&&i++,2==i?n+r.substring(1):1==i?n+r:n+"/"+r}function qz(n){const r=n.match(/#|\?|$/),i=r&&r.index||n.length;return n.slice(0,i-("/"===n[i-1]?1:0))+n.slice(i)}function cC(n){return n&&"?"!==n[0]?"?"+n:n}let tS=(()=>{class n{historyGo(i){throw new Error("Not implemented")}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:function(){return A1($z)},providedIn:"root"}),n})();const Wz=new z0("appBaseHref");let $z=(()=>{class n extends tS{constructor(i,d){super(),this._platformLocation=i,this._removeListenerFns=[],this._baseHref=d??this._platformLocation.getBaseHrefFromDOM()??A1(cE).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return IF(this._baseHref,i)}path(i=!1){const d=this._platformLocation.pathname+cC(this._platformLocation.search),v=this._platformLocation.hash;return v&&i?`${d}${v}`:d}pushState(i,d,v,I){const q=this.prepareExternalUrl(v+cC(I));this._platformLocation.pushState(i,d,q)}replaceState(i,d,v,I){const q=this.prepareExternalUrl(v+cC(I));this._platformLocation.replaceState(i,d,q)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}}return n.\u0275fac=function(i){return new(i||n)(x0(MF),x0(Wz,8))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),m$=(()=>{class n extends tS{constructor(i,d){super(),this._platformLocation=i,this._baseHref="",this._removeListenerFns=[],null!=d&&(this._baseHref=d)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}path(i=!1){let d=this._platformLocation.hash;return null==d&&(d="#"),d.length>0?d.substring(1):d}prepareExternalUrl(i){const d=IF(this._baseHref,i);return d.length>0?"#"+d:d}pushState(i,d,v,I){let q=this.prepareExternalUrl(v+cC(I));0==q.length&&(q=this._platformLocation.pathname),this._platformLocation.pushState(i,d,q)}replaceState(i,d,v,I){let q=this.prepareExternalUrl(v+cC(I));0==q.length&&(q=this._platformLocation.pathname),this._platformLocation.replaceState(i,d,q)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}}return n.\u0275fac=function(i){return new(i||n)(x0(MF),x0(Wz,8))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})(),kF=(()=>{class n{constructor(i){this._subject=new V1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=i;const d=this._locationStrategy.getBaseHref();this._baseHref=qz(Yz(d)),this._locationStrategy.onPopState(v=>{this._subject.emit({url:this.path(!0),pop:!0,state:v.state,type:v.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(i=!1){return this.normalize(this._locationStrategy.path(i))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(i,d=""){return this.path()==this.normalize(i+cC(d))}normalize(i){return n.stripTrailingSlash(function _$(n,r){return n&&r.startsWith(n)?r.substring(n.length):r}(this._baseHref,Yz(i)))}prepareExternalUrl(i){return i&&"/"!==i[0]&&(i="/"+i),this._locationStrategy.prepareExternalUrl(i)}go(i,d="",v=null){this._locationStrategy.pushState(v,"",i,d),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+cC(d)),v)}replaceState(i,d="",v=null){this._locationStrategy.replaceState(v,"",i,d),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+cC(d)),v)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(i=0){this._locationStrategy.historyGo?.(i)}onUrlChange(i){return this._urlChangeListeners.push(i),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(d=>{this._notifyUrlChangeListeners(d.url,d.state)})),()=>{const d=this._urlChangeListeners.indexOf(i);this._urlChangeListeners.splice(d,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(i="",d){this._urlChangeListeners.forEach(v=>v(i,d))}subscribe(i,d,v){return this._subject.subscribe({next:i,error:d,complete:v})}}return n.normalizeQueryParams=cC,n.joinWithSlash=IF,n.stripTrailingSlash=qz,n.\u0275fac=function(i){return new(i||n)(x0(tS))},n.\u0275prov=Ni({token:n,factory:function(){return function v$(){return new kF(x0(tS))}()},providedIn:"root"}),n})();function Yz(n){return n.replace(/\/index.html$/,"")}function rB(n,r){r=encodeURIComponent(r);for(const i of n.split(";")){const d=i.indexOf("="),[v,I]=-1==d?[i,""]:[i.slice(0,d),i.slice(d+1)];if(v.trim()===r)return decodeURIComponent(I)}return null}let iB=(()=>{class n{constructor(i,d,v,I){this._iterableDiffers=i,this._keyValueDiffers=d,this._ngEl=v,this._renderer=I,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(i){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof i?i.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(i){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof i?i.split(/\s+/):i,this._rawClass&&(k0(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const i=this._iterableDiffer.diff(this._rawClass);i&&this._applyIterableChanges(i)}else if(this._keyValueDiffer){const i=this._keyValueDiffer.diff(this._rawClass);i&&this._applyKeyValueChanges(i)}}_applyKeyValueChanges(i){i.forEachAddedItem(d=>this._toggleClass(d.key,d.currentValue)),i.forEachChangedItem(d=>this._toggleClass(d.key,d.currentValue)),i.forEachRemovedItem(d=>{d.previousValue&&this._toggleClass(d.key,!1)})}_applyIterableChanges(i){i.forEachAddedItem(d=>{if("string"!=typeof d.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${l_(d.item)}`);this._toggleClass(d.item,!0)}),i.forEachRemovedItem(d=>this._toggleClass(d.item,!1))}_applyClasses(i){i&&(Array.isArray(i)||i instanceof Set?i.forEach(d=>this._toggleClass(d,!0)):Object.keys(i).forEach(d=>this._toggleClass(d,!!i[d])))}_removeClasses(i){i&&(Array.isArray(i)||i instanceof Set?i.forEach(d=>this._toggleClass(d,!1)):Object.keys(i).forEach(d=>this._toggleClass(d,!1)))}_toggleClass(i,d){(i=i.trim())&&i.split(/\s+/g).forEach(v=>{d?this._renderer.addClass(this._ngEl.nativeElement,v):this._renderer.removeClass(this._ngEl.nativeElement,v)})}}return n.\u0275fac=function(i){return new(i||n)(Xy(bL),Xy(wR),Xy(Qx),Xy(CT))},n.\u0275dir=H0({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class rY{constructor(r,i,d,v){this.$implicit=r,this.ngForOf=i,this.index=d,this.count=v}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let aB=(()=>{class n{constructor(i,d,v){this._viewContainer=i,this._template=d,this._differs=v,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(i){this._ngForOf=i,this._ngForOfDirty=!0}set ngForTrackBy(i){this._trackByFn=i}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(i){i&&(this._template=i)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const i=this._ngForOf;!this._differ&&i&&(this._differ=this._differs.find(i).create(this.ngForTrackBy))}if(this._differ){const i=this._differ.diff(this._ngForOf);i&&this._applyChanges(i)}}_applyChanges(i){const d=this._viewContainer;i.forEachOperation((v,I,q)=>{if(null==v.previousIndex)d.createEmbeddedView(this._template,new rY(v.item,this._ngForOf,-1,-1),null===q?void 0:q);else if(null==q)d.remove(null===I?void 0:I);else if(null!==I){const J=d.get(I);d.move(J,q),uB(J,v)}});for(let v=0,I=d.length;v<I;v++){const J=d.get(v).context;J.index=v,J.count=I,J.ngForOf=this._ngForOf}i.forEachIdentityChange(v=>{uB(d.get(v.currentIndex),v)})}static ngTemplateContextGuard(i,d){return!0}}return n.\u0275fac=function(i){return new(i||n)(Xy(jT),Xy(sC),Xy(bL))},n.\u0275dir=H0({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function uB(n,r){n.context.$implicit=r.item}let BF=(()=>{class n{constructor(i,d){this._viewContainer=i,this._context=new oY,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=d}set ngIf(i){this._context.$implicit=this._context.ngIf=i,this._updateView()}set ngIfThen(i){lB("ngIfThen",i),this._thenTemplateRef=i,this._thenViewRef=null,this._updateView()}set ngIfElse(i){lB("ngIfElse",i),this._elseTemplateRef=i,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(i,d){return!0}}return n.\u0275fac=function(i){return new(i||n)(Xy(jT),Xy(sC))},n.\u0275dir=H0({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class oY{constructor(){this.$implicit=null,this.ngIf=null}}function lB(n,r){if(r&&!r.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${l_(r)}'.`)}let WF=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({}),n})();let PY=(()=>{class n{}return n.\u0275prov=Ni({token:n,providedIn:"root",factory:()=>new LY(x0(cE),window)}),n})();class LY{constructor(r,i){this.document=r,this.window=i,this.offset=()=>[0,0]}setOffset(r){this.offset=Array.isArray(r)?()=>r:r}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(r){this.supportsScrolling()&&this.window.scrollTo(r[0],r[1])}scrollToAnchor(r){if(!this.supportsScrolling())return;const i=function FY(n,r){const i=n.getElementById(r)||n.getElementsByName(r)[0];if(i)return i;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const d=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let v=d.currentNode;for(;v;){const I=v.shadowRoot;if(I){const q=I.getElementById(r)||I.querySelector(`[name="${r}"]`);if(q)return q}v=d.nextNode()}}return null}(this.document,r);i&&(this.scrollToElement(i),i.focus())}setHistoryScrollRestoration(r){if(this.supportScrollRestoration()){const i=this.window.history;i&&i.scrollRestoration&&(i.scrollRestoration=r)}}scrollToElement(r){const i=r.getBoundingClientRect(),d=i.left+this.window.pageXOffset,v=i.top+this.window.pageYOffset,I=this.offset();this.window.scrollTo(d-I[0],v-I[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const r=pB(this.window.history)||pB(Object.getPrototypeOf(this.window.history));return!(!r||!r.writable&&!r.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function pB(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class dB{}class KF extends class eK extends class p${}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function f$(n){wL||(wL=n)}(new KF)}onAndCancel(r,i,d){return r.addEventListener(i,d,!1),()=>{r.removeEventListener(i,d,!1)}}dispatchEvent(r,i){r.dispatchEvent(i)}remove(r){r.parentNode&&r.parentNode.removeChild(r)}createElement(r,i){return(i=i||this.getDefaultDocument()).createElement(r)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(r){return r.nodeType===Node.ELEMENT_NODE}isShadowRoot(r){return r instanceof DocumentFragment}getGlobalEventTarget(r,i){return"window"===i?window:"document"===i?r:"body"===i?r.body:null}getBaseHref(r){const i=function nK(){return AR=AR||document.querySelector("base"),AR?AR.getAttribute("href"):null}();return null==i?null:function rK(n){OL=OL||document.createElement("a"),OL.setAttribute("href",n);const r=OL.pathname;return"/"===r.charAt(0)?r:`/${r}`}(i)}resetBaseElement(){AR=null}getUserAgent(){return window.navigator.userAgent}getCookie(r){return rB(document.cookie,r)}}let OL,AR=null;const vB=new z0("TRANSITION_ID"),oK=[{provide:fL,useFactory:function iK(n,r,i){return()=>{i.get(pL).donePromise.then(()=>{const d=vA(),v=r.querySelectorAll(`style[ng-transition="${n}"]`);for(let I=0;I<v.length;I++)d.remove(v[I])})}},deps:[vB,cE,tE],multi:!0}];let aK=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();const RL=new z0("EventManagerPlugins");let NL=(()=>{class n{constructor(i,d){this._zone=d,this._eventNameToPlugin=new Map,i.forEach(v=>v.manager=this),this._plugins=i.slice().reverse()}addEventListener(i,d,v){return this._findPluginFor(d).addEventListener(i,d,v)}addGlobalEventListener(i,d,v){return this._findPluginFor(d).addGlobalEventListener(i,d,v)}getZone(){return this._zone}_findPluginFor(i){const d=this._eventNameToPlugin.get(i);if(d)return d;const v=this._plugins;for(let I=0;I<v.length;I++){const q=v[I];if(q.supports(i))return this._eventNameToPlugin.set(i,q),q}throw new Error(`No event manager plugin found for event ${i}`)}}return n.\u0275fac=function(i){return new(i||n)(x0(RL),x0(ex))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();class _B{constructor(r){this._doc=r}addGlobalEventListener(r,i,d){const v=vA().getGlobalEventTarget(this._doc,r);if(!v)throw new Error(`Unsupported event target ${v} for event ${i}`);return this.addEventListener(v,i,d)}}let bB=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(i){const d=new Set;i.forEach(v=>{this._stylesSet.has(v)||(this._stylesSet.add(v),d.add(v))}),this.onStylesAdded(d)}onStylesAdded(i){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})(),CR=(()=>{class n extends bB{constructor(i){super(),this._doc=i,this._hostNodes=new Map,this._hostNodes.set(i.head,[])}_addStylesToHost(i,d,v){i.forEach(I=>{const q=this._doc.createElement("style");q.textContent=I,v.push(d.appendChild(q))})}addHost(i){const d=[];this._addStylesToHost(this._stylesSet,i,d),this._hostNodes.set(i,d)}removeHost(i){const d=this._hostNodes.get(i);d&&d.forEach(wB),this._hostNodes.delete(i)}onStylesAdded(i){this._hostNodes.forEach((d,v)=>{this._addStylesToHost(i,v,d)})}ngOnDestroy(){this._hostNodes.forEach(i=>i.forEach(wB))}}return n.\u0275fac=function(i){return new(i||n)(x0(cE))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();function wB(n){vA().remove(n)}const ZF={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},XF=/%COMP%/g;function PL(n,r,i){for(let d=0;d<r.length;d++){let v=r[d];Array.isArray(v)?PL(n,v,i):(v=v.replace(XF,n),i.push(v))}return i}function TB(n){return r=>{if("__ngUnwrap__"===r)return n;!1===n(r)&&(r.preventDefault(),r.returnValue=!1)}}let JF=(()=>{class n{constructor(i,d,v){this.eventManager=i,this.sharedStylesHost=d,this.appId=v,this.rendererByCompId=new Map,this.defaultRenderer=new QF(i)}createRenderer(i,d){if(!i||!d)return this.defaultRenderer;switch(d.encapsulation){case n0.Emulated:{let v=this.rendererByCompId.get(d.id);return v||(v=new pK(this.eventManager,this.sharedStylesHost,d,this.appId),this.rendererByCompId.set(d.id,v)),v.applyToHost(i),v}case 1:case n0.ShadowDom:return new dK(this.eventManager,this.sharedStylesHost,i,d);default:if(!this.rendererByCompId.has(d.id)){const v=PL(d.id,d.styles,[]);this.sharedStylesHost.addStyles(v),this.rendererByCompId.set(d.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(i){return new(i||n)(x0(NL),x0(CR),x0(bR))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();class QF{constructor(r){this.eventManager=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(r,i){return i?document.createElementNS(ZF[i]||i,r):document.createElement(r)}createComment(r){return document.createComment(r)}createText(r){return document.createTextNode(r)}appendChild(r,i){(CB(r)?r.content:r).appendChild(i)}insertBefore(r,i,d){r&&(CB(r)?r.content:r).insertBefore(i,d)}removeChild(r,i){r&&r.removeChild(i)}selectRootElement(r,i){let d="string"==typeof r?document.querySelector(r):r;if(!d)throw new Error(`The selector "${r}" did not match any elements`);return i||(d.textContent=""),d}parentNode(r){return r.parentNode}nextSibling(r){return r.nextSibling}setAttribute(r,i,d,v){if(v){i=v+":"+i;const I=ZF[v];I?r.setAttributeNS(I,i,d):r.setAttribute(i,d)}else r.setAttribute(i,d)}removeAttribute(r,i,d){if(d){const v=ZF[d];v?r.removeAttributeNS(v,i):r.removeAttribute(`${d}:${i}`)}else r.removeAttribute(i)}addClass(r,i){r.classList.add(i)}removeClass(r,i){r.classList.remove(i)}setStyle(r,i,d,v){v&(Tx.DashCase|Tx.Important)?r.style.setProperty(i,d,v&Tx.Important?"important":""):r.style[i]=d}removeStyle(r,i,d){d&Tx.DashCase?r.style.removeProperty(i):r.style[i]=""}setProperty(r,i,d){r[i]=d}setValue(r,i){r.nodeValue=i}listen(r,i,d){return"string"==typeof r?this.eventManager.addGlobalEventListener(r,i,TB(d)):this.eventManager.addEventListener(r,i,TB(d))}}function CB(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class pK extends QF{constructor(r,i,d,v){super(r),this.component=d;const I=PL(v+"-"+d.id,d.styles,[]);i.addStyles(I),this.contentAttr=function cK(n){return"_ngcontent-%COMP%".replace(XF,n)}(v+"-"+d.id),this.hostAttr=function hK(n){return"_nghost-%COMP%".replace(XF,n)}(v+"-"+d.id)}applyToHost(r){super.setAttribute(r,this.hostAttr,"")}createElement(r,i){const d=super.createElement(r,i);return super.setAttribute(d,this.contentAttr,""),d}}class dK extends QF{constructor(r,i,d,v){super(r),this.sharedStylesHost=i,this.hostEl=d,this.shadowRoot=d.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const I=PL(v.id,v.styles,[]);for(let q=0;q<I.length;q++){const J=document.createElement("style");J.textContent=I[q],this.shadowRoot.appendChild(J)}}nodeOrShadowRoot(r){return r===this.hostEl?this.shadowRoot:r}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(r,i){return super.appendChild(this.nodeOrShadowRoot(r),i)}insertBefore(r,i,d){return super.insertBefore(this.nodeOrShadowRoot(r),i,d)}removeChild(r,i){return super.removeChild(this.nodeOrShadowRoot(r),i)}parentNode(r){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(r)))}}let gK=(()=>{class n extends _B{constructor(i){super(i)}supports(i){return!0}addEventListener(i,d,v){return i.addEventListener(d,v,!1),()=>this.removeEventListener(i,d,v)}removeEventListener(i,d,v){return i.removeEventListener(d,v)}}return n.\u0275fac=function(i){return new(i||n)(x0(cE))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();const DB=["alt","control","meta","shift"],yK={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mK={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let vK=(()=>{class n extends _B{constructor(i){super(i)}supports(i){return null!=n.parseEventName(i)}addEventListener(i,d,v){const I=n.parseEventName(d),q=n.eventCallback(I.fullKey,v,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>vA().onAndCancel(i,I.domEventName,q))}static parseEventName(i){const d=i.toLowerCase().split("."),v=d.shift();if(0===d.length||"keydown"!==v&&"keyup"!==v)return null;const I=n._normalizeKey(d.pop());let q="",J=d.indexOf("code");if(J>-1&&(d.splice(J,1),q="code."),DB.forEach(_a=>{const _f=d.indexOf(_a);_f>-1&&(d.splice(_f,1),q+=_a+".")}),q+=I,0!=d.length||0===I.length)return null;const _n={};return _n.domEventName=v,_n.fullKey=q,_n}static matchEventFullKeyCode(i,d){let v=yK[i.key]||i.key,I="";return d.indexOf("code.")>-1&&(v=i.code,I="code."),!(null==v||!v)&&(v=v.toLowerCase()," "===v?v="space":"."===v&&(v="dot"),DB.forEach(q=>{q!==v&&(0,mK[q])(i)&&(I+=q+".")}),I+=v,I===d)}static eventCallback(i,d,v){return I=>{n.matchEventFullKeyCode(I,i)&&v.runGuarded(()=>d(I))}}static _normalizeKey(i){return"esc"===i?"escape":i}}return n.\u0275fac=function(i){return new(i||n)(x0(cE))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();const xK=Tz(l$,"browser",[{provide:gF,useValue:"browser"},{provide:dz,useValue:function _K(){KF.makeCurrent()},multi:!0},{provide:cE,useFactory:function wK(){return function lM(n){gO=n}(document),document},deps:[]}]),IB=new z0(""),kB=[{provide:dL,useClass:class sK{addToWindow(r){Gy.getAngularTestability=(d,v=!0)=>{const I=r.findTestabilityInTree(d,v);if(null==I)throw new Error("Could not find testability for element.");return I},Gy.getAllAngularTestabilities=()=>r.getAllTestabilities(),Gy.getAllAngularRootElements=()=>r.getAllRootElements(),Gy.frameworkStabilizers||(Gy.frameworkStabilizers=[]),Gy.frameworkStabilizers.push(d=>{const v=Gy.getAllAngularTestabilities();let I=v.length,q=!1;const J=function(_n){q=q||_n,I--,0==I&&d(q)};v.forEach(function(_n){_n.whenStable(J)})})}findTestabilityInTree(r,i,d){return null==i?null:r.getTestability(i)??(d?vA().isShadowRoot(i)?this.findTestabilityInTree(r,i.host,!0):this.findTestabilityInTree(r,i.parentElement,!0):null)}},deps:[]},{provide:bz,useClass:bF,deps:[ex,wF,dL]},{provide:bF,useClass:bF,deps:[ex,wF,dL]}],OB=[{provide:mM,useValue:"root"},{provide:ST,useFactory:function bK(){return new ST},deps:[]},{provide:RL,useClass:gK,multi:!0,deps:[cE,ex,gF]},{provide:RL,useClass:vK,multi:!0,deps:[cE]},{provide:JF,useClass:JF,deps:[NL,CR,bR]},{provide:AP,useExisting:JF},{provide:bB,useExisting:CR},{provide:CR,useClass:CR,deps:[cE]},{provide:NL,useClass:NL,deps:[RL,ex]},{provide:dB,useClass:aK,deps:[]},[]];let EK=(()=>{class n{constructor(i){}static withServerTransition(i){return{ngModule:n,providers:[{provide:bR,useValue:i.appId},{provide:vB,useExisting:bR},oK]}}}return n.\u0275fac=function(i){return new(i||n)(x0(IB,12))},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({providers:[...OB,...kB],imports:[WF,c$]}),n})(),RB=(()=>{class n{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}}return n.\u0275fac=function(i){return new(i||n)(x0(cE))},n.\u0275prov=Ni({token:n,factory:function(i){let d=null;return d=i?new i:function AK(){return new RB(x0(cE))}(),d},providedIn:"root"}),n})();function U0(...n){return Z_(n,GE(n))}function P2(n,r){return m(r)?s1(n,r,1):s1(n,1)}function fC(n,r){return o1((i,d)=>{let v=0;i.subscribe(G_(d,I=>n.call(r,I,v++)&&d.next(I)))})}typeof window<"u"&&window;class LB{}class FB{}class pC{constructor(r){this.normalizedNames=new Map,this.lazyUpdate=null,r?this.lazyInit="string"==typeof r?()=>{this.headers=new Map,r.split("\n").forEach(i=>{const d=i.indexOf(":");if(d>0){const v=i.slice(0,d),I=v.toLowerCase(),q=i.slice(d+1).trim();this.maybeSetNormalizedName(v,I),this.headers.has(I)?this.headers.get(I).push(q):this.headers.set(I,[q])}})}:()=>{this.headers=new Map,Object.keys(r).forEach(i=>{let d=r[i];const v=i.toLowerCase();"string"==typeof d&&(d=[d]),d.length>0&&(this.headers.set(v,d),this.maybeSetNormalizedName(i,v))})}:this.headers=new Map}has(r){return this.init(),this.headers.has(r.toLowerCase())}get(r){this.init();const i=this.headers.get(r.toLowerCase());return i&&i.length>0?i[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(r){return this.init(),this.headers.get(r.toLowerCase())||null}append(r,i){return this.clone({name:r,value:i,op:"a"})}set(r,i){return this.clone({name:r,value:i,op:"s"})}delete(r,i){return this.clone({name:r,value:i,op:"d"})}maybeSetNormalizedName(r,i){this.normalizedNames.has(i)||this.normalizedNames.set(i,r)}init(){this.lazyInit&&(this.lazyInit instanceof pC?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(r=>this.applyUpdate(r)),this.lazyUpdate=null))}copyFrom(r){r.init(),Array.from(r.headers.keys()).forEach(i=>{this.headers.set(i,r.headers.get(i)),this.normalizedNames.set(i,r.normalizedNames.get(i))})}clone(r){const i=new pC;return i.lazyInit=this.lazyInit&&this.lazyInit instanceof pC?this.lazyInit:this,i.lazyUpdate=(this.lazyUpdate||[]).concat([r]),i}applyUpdate(r){const i=r.name.toLowerCase();switch(r.op){case"a":case"s":let d=r.value;if("string"==typeof d&&(d=[d]),0===d.length)return;this.maybeSetNormalizedName(r.name,i);const v=("a"===r.op?this.headers.get(i):void 0)||[];v.push(...d),this.headers.set(i,v);break;case"d":const I=r.value;if(I){let q=this.headers.get(i);if(!q)return;q=q.filter(J=>-1===I.indexOf(J)),0===q.length?(this.headers.delete(i),this.normalizedNames.delete(i)):this.headers.set(i,q)}else this.headers.delete(i),this.normalizedNames.delete(i)}}forEach(r){this.init(),Array.from(this.normalizedNames.keys()).forEach(i=>r(this.normalizedNames.get(i),this.headers.get(i)))}}class RK{encodeKey(r){return jB(r)}encodeValue(r){return jB(r)}decodeKey(r){return decodeURIComponent(r)}decodeValue(r){return decodeURIComponent(r)}}const PK=/%(\d[a-f0-9])/gi,LK={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function jB(n){return encodeURIComponent(n).replace(PK,(r,i)=>LK[i]??r)}function LL(n){return`${n}`}class L2{constructor(r={}){if(this.updates=null,this.cloneFrom=null,this.encoder=r.encoder||new RK,r.fromString){if(r.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function NK(n,r){const i=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(v=>{const I=v.indexOf("="),[q,J]=-1==I?[r.decodeKey(v),""]:[r.decodeKey(v.slice(0,I)),r.decodeValue(v.slice(I+1))],_n=i.get(q)||[];_n.push(J),i.set(q,_n)}),i}(r.fromString,this.encoder)}else r.fromObject?(this.map=new Map,Object.keys(r.fromObject).forEach(i=>{const d=r.fromObject[i],v=Array.isArray(d)?d.map(LL):[LL(d)];this.map.set(i,v)})):this.map=null}has(r){return this.init(),this.map.has(r)}get(r){this.init();const i=this.map.get(r);return i?i[0]:null}getAll(r){return this.init(),this.map.get(r)||null}keys(){return this.init(),Array.from(this.map.keys())}append(r,i){return this.clone({param:r,value:i,op:"a"})}appendAll(r){const i=[];return Object.keys(r).forEach(d=>{const v=r[d];Array.isArray(v)?v.forEach(I=>{i.push({param:d,value:I,op:"a"})}):i.push({param:d,value:v,op:"a"})}),this.clone(i)}set(r,i){return this.clone({param:r,value:i,op:"s"})}delete(r,i){return this.clone({param:r,value:i,op:"d"})}toString(){return this.init(),this.keys().map(r=>{const i=this.encoder.encodeKey(r);return this.map.get(r).map(d=>i+"="+this.encoder.encodeValue(d)).join("&")}).filter(r=>""!==r).join("&")}clone(r){const i=new L2({encoder:this.encoder});return i.cloneFrom=this.cloneFrom||this,i.updates=(this.updates||[]).concat(r),i}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(r=>this.map.set(r,this.cloneFrom.map.get(r))),this.updates.forEach(r=>{switch(r.op){case"a":case"s":const i=("a"===r.op?this.map.get(r.param):void 0)||[];i.push(LL(r.value)),this.map.set(r.param,i);break;case"d":if(void 0===r.value){this.map.delete(r.param);break}{let d=this.map.get(r.param)||[];const v=d.indexOf(LL(r.value));-1!==v&&d.splice(v,1),d.length>0?this.map.set(r.param,d):this.map.delete(r.param)}}}),this.cloneFrom=this.updates=null)}}class FK{constructor(){this.map=new Map}set(r,i){return this.map.set(r,i),this}get(r){return this.map.has(r)||this.map.set(r,r.defaultValue()),this.map.get(r)}delete(r){return this.map.delete(r),this}has(r){return this.map.has(r)}keys(){return this.map.keys()}}function VB(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function zB(n){return typeof Blob<"u"&&n instanceof Blob}function BB(n){return typeof FormData<"u"&&n instanceof FormData}class DR{constructor(r,i,d,v){let I;if(this.url=i,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=r.toUpperCase(),function jK(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||v?(this.body=void 0!==d?d:null,I=v):I=d,I&&(this.reportProgress=!!I.reportProgress,this.withCredentials=!!I.withCredentials,I.responseType&&(this.responseType=I.responseType),I.headers&&(this.headers=I.headers),I.context&&(this.context=I.context),I.params&&(this.params=I.params)),this.headers||(this.headers=new pC),this.context||(this.context=new FK),this.params){const q=this.params.toString();if(0===q.length)this.urlWithParams=i;else{const J=i.indexOf("?");this.urlWithParams=i+(-1===J?"?":J<i.length-1?"&":"")+q}}else this.params=new L2,this.urlWithParams=i}serializeBody(){return null===this.body?null:VB(this.body)||zB(this.body)||BB(this.body)||function VK(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof L2?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||BB(this.body)?null:zB(this.body)?this.body.type||null:VB(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof L2?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(r={}){const i=r.method||this.method,d=r.url||this.url,v=r.responseType||this.responseType,I=void 0!==r.body?r.body:this.body,q=void 0!==r.withCredentials?r.withCredentials:this.withCredentials,J=void 0!==r.reportProgress?r.reportProgress:this.reportProgress;let _n=r.headers||this.headers,_a=r.params||this.params;const _f=r.context??this.context;return void 0!==r.setHeaders&&(_n=Object.keys(r.setHeaders).reduce((gd,ay)=>gd.set(ay,r.setHeaders[ay]),_n)),r.setParams&&(_a=Object.keys(r.setParams).reduce((gd,ay)=>gd.set(ay,r.setParams[ay]),_a)),new DR(i,d,I,{params:_a,headers:_n,context:_f,reportProgress:J,responseType:v,withCredentials:q})}}var Vw=(()=>((Vw=Vw||{})[Vw.Sent=0]="Sent",Vw[Vw.UploadProgress=1]="UploadProgress",Vw[Vw.ResponseHeader=2]="ResponseHeader",Vw[Vw.DownloadProgress=3]="DownloadProgress",Vw[Vw.Response=4]="Response",Vw[Vw.User=5]="User",Vw))();class t5{constructor(r,i=200,d="OK"){this.headers=r.headers||new pC,this.status=void 0!==r.status?r.status:i,this.statusText=r.statusText||d,this.url=r.url||null,this.ok=this.status>=200&&this.status<300}}class e5 extends t5{constructor(r={}){super(r),this.type=Vw.ResponseHeader}clone(r={}){return new e5({headers:r.headers||this.headers,status:void 0!==r.status?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}}class FL extends t5{constructor(r={}){super(r),this.type=Vw.Response,this.body=void 0!==r.body?r.body:null}clone(r={}){return new FL({body:void 0!==r.body?r.body:this.body,headers:r.headers||this.headers,status:void 0!==r.status?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}}class HB extends t5{constructor(r){super(r,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${r.url||"(unknown url)"}`:`Http failure response for ${r.url||"(unknown url)"}: ${r.status} ${r.statusText}`,this.error=r.error||null}}function n5(n,r){return{body:r,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let UB=(()=>{class n{constructor(i){this.handler=i}request(i,d,v={}){let I;if(i instanceof DR)I=i;else{let _n,_a;_n=v.headers instanceof pC?v.headers:new pC(v.headers),v.params&&(_a=v.params instanceof L2?v.params:new L2({fromObject:v.params})),I=new DR(i,d,void 0!==v.body?v.body:null,{headers:_n,context:v.context,params:_a,reportProgress:v.reportProgress,responseType:v.responseType||"json",withCredentials:v.withCredentials})}const q=U0(I).pipe(P2(_n=>this.handler.handle(_n)));if(i instanceof DR||"events"===v.observe)return q;const J=q.pipe(fC(_n=>_n instanceof FL));switch(v.observe||"body"){case"body":switch(I.responseType){case"arraybuffer":return J.pipe(r_(_n=>{if(null!==_n.body&&!(_n.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return _n.body}));case"blob":return J.pipe(r_(_n=>{if(null!==_n.body&&!(_n.body instanceof Blob))throw new Error("Response is not a Blob.");return _n.body}));case"text":return J.pipe(r_(_n=>{if(null!==_n.body&&"string"!=typeof _n.body)throw new Error("Response is not a string.");return _n.body}));default:return J.pipe(r_(_n=>_n.body))}case"response":return J;default:throw new Error(`Unreachable: unhandled observe type ${v.observe}}`)}}delete(i,d={}){return this.request("DELETE",i,d)}get(i,d={}){return this.request("GET",i,d)}head(i,d={}){return this.request("HEAD",i,d)}jsonp(i,d){return this.request("JSONP",i,{params:(new L2).append(d,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,d={}){return this.request("OPTIONS",i,d)}patch(i,d,v={}){return this.request("PATCH",i,n5(v,d))}post(i,d,v={}){return this.request("POST",i,n5(v,d))}put(i,d,v={}){return this.request("PUT",i,n5(v,d))}}return n.\u0275fac=function(i){return new(i||n)(x0(LB))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();class GB{constructor(r,i){this.next=r,this.interceptor=i}handle(r){return this.interceptor.intercept(r,this.next)}}const qB=new z0("HTTP_INTERCEPTORS");let zK=(()=>{class n{intercept(i,d){return d.handle(i)}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();const BK=/^\)\]\}',?\n/;let WB=(()=>{class n{constructor(i){this.xhrFactory=i}handle(i){if("JSONP"===i.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new i1(d=>{const v=this.xhrFactory.build();if(v.open(i.method,i.urlWithParams),i.withCredentials&&(v.withCredentials=!0),i.headers.forEach((yy,xy)=>v.setRequestHeader(yy,xy.join(","))),i.headers.has("Accept")||v.setRequestHeader("Accept","application/json, text/plain, */*"),!i.headers.has("Content-Type")){const yy=i.detectContentTypeHeader();null!==yy&&v.setRequestHeader("Content-Type",yy)}if(i.responseType){const yy=i.responseType.toLowerCase();v.responseType="json"!==yy?yy:"text"}const I=i.serializeBody();let q=null;const J=()=>{if(null!==q)return q;const yy=v.statusText||"OK",xy=new pC(v.getAllResponseHeaders()),Ry=function HK(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(v)||i.url;return q=new e5({headers:xy,status:v.status,statusText:yy,url:Ry}),q},_n=()=>{let{headers:yy,status:xy,statusText:Ry,url:zy}=J(),Ky=null;204!==xy&&(Ky=typeof v.response>"u"?v.responseText:v.response),0===xy&&(xy=Ky?200:0);let d0=xy>=200&&xy<300;if("json"===i.responseType&&"string"==typeof Ky){const Uy=Ky;Ky=Ky.replace(BK,"");try{Ky=""!==Ky?JSON.parse(Ky):null}catch(j0){Ky=Uy,d0&&(d0=!1,Ky={error:j0,text:Ky})}}d0?(d.next(new FL({body:Ky,headers:yy,status:xy,statusText:Ry,url:zy||void 0})),d.complete()):d.error(new HB({error:Ky,headers:yy,status:xy,statusText:Ry,url:zy||void 0}))},_a=yy=>{const{url:xy}=J(),Ry=new HB({error:yy,status:v.status||0,statusText:v.statusText||"Unknown Error",url:xy||void 0});d.error(Ry)};let _f=!1;const gd=yy=>{_f||(d.next(J()),_f=!0);let xy={type:Vw.DownloadProgress,loaded:yy.loaded};yy.lengthComputable&&(xy.total=yy.total),"text"===i.responseType&&!!v.responseText&&(xy.partialText=v.responseText),d.next(xy)},ay=yy=>{let xy={type:Vw.UploadProgress,loaded:yy.loaded};yy.lengthComputable&&(xy.total=yy.total),d.next(xy)};return v.addEventListener("load",_n),v.addEventListener("error",_a),v.addEventListener("timeout",_a),v.addEventListener("abort",_a),i.reportProgress&&(v.addEventListener("progress",gd),null!==I&&v.upload&&v.upload.addEventListener("progress",ay)),v.send(I),d.next({type:Vw.Sent}),()=>{v.removeEventListener("error",_a),v.removeEventListener("abort",_a),v.removeEventListener("load",_n),v.removeEventListener("timeout",_a),i.reportProgress&&(v.removeEventListener("progress",gd),null!==I&&v.upload&&v.upload.removeEventListener("progress",ay)),v.readyState!==v.DONE&&v.abort()}})}}return n.\u0275fac=function(i){return new(i||n)(x0(dB))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();const r5=new z0("XSRF_COOKIE_NAME"),i5=new z0("XSRF_HEADER_NAME");class $B{}let UK=(()=>{class n{constructor(i,d,v){this.doc=i,this.platform=d,this.cookieName=v,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const i=this.doc.cookie||"";return i!==this.lastCookieString&&(this.parseCount++,this.lastToken=rB(i,this.cookieName),this.lastCookieString=i),this.lastToken}}return n.\u0275fac=function(i){return new(i||n)(x0(cE),x0(gF),x0(r5))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})(),o5=(()=>{class n{constructor(i,d){this.tokenService=i,this.headerName=d}intercept(i,d){const v=i.url.toLowerCase();if("GET"===i.method||"HEAD"===i.method||v.startsWith("http://")||v.startsWith("https://"))return d.handle(i);const I=this.tokenService.getToken();return null!==I&&!i.headers.has(this.headerName)&&(i=i.clone({headers:i.headers.set(this.headerName,I)})),d.handle(i)}}return n.\u0275fac=function(i){return new(i||n)(x0($B),x0(i5))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})(),GK=(()=>{class n{constructor(i,d){this.backend=i,this.injector=d,this.chain=null}handle(i){if(null===this.chain){const d=this.injector.get(qB,[]);this.chain=d.reduceRight((v,I)=>new GB(v,I),this.backend)}return this.chain.handle(i)}}return n.\u0275fac=function(i){return new(i||n)(x0(FB),x0(tE))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})(),qK=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:o5,useClass:zK}]}}static withOptions(i={}){return{ngModule:n,providers:[i.cookieName?{provide:r5,useValue:i.cookieName}:[],i.headerName?{provide:i5,useValue:i.headerName}:[]]}}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({providers:[o5,{provide:qB,useExisting:o5,multi:!0},{provide:$B,useClass:UK},{provide:r5,useValue:"XSRF-TOKEN"},{provide:i5,useValue:"X-XSRF-TOKEN"}]}),n})(),WK=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({providers:[UB,{provide:LB,useClass:GK},WB,{provide:FB,useExisting:WB}],imports:[qK.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class HT extends W1{constructor(r){super(),this._value=r}get value(){return this.getValue()}_subscribe(r){const i=super._subscribe(r);return!i.closed&&r.next(this._value),i}getValue(){const{hasError:r,thrownError:i,_value:d}=this;if(r)throw i;return this._throwIfClosed(),d}next(r){super.next(this._value=r)}}const jL=w(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:$K}=Array,{getPrototypeOf:YK,prototype:KK,keys:ZK}=Object;function YB(n){if(1===n.length){const r=n[0];if($K(r))return{args:r,keys:null};if(function XK(n){return n&&"object"==typeof n&&YK(n)===KK}(r)){const i=ZK(r);return{args:i.map(d=>r[d]),keys:i}}}return{args:n,keys:null}}const{isArray:JK}=Array;function s5(n){return r_(r=>function QK(n,r){return JK(r)?n(...r):n(r)}(n,r))}function KB(n,r){return n.reduce((i,d,v)=>(i[d]=r[v],i),{})}function ZB(...n){const r=GE(n),i=SC(n),{args:d,keys:v}=YB(n);if(0===d.length)return Z_([],r);const I=new i1(function tZ(n,r,i=fE){return d=>{XB(r,()=>{const{length:v}=n,I=new Array(v);let q=v,J=v;for(let _n=0;_n<v;_n++)XB(r,()=>{const _a=Z_(n[_n],r);let _f=!1;_a.subscribe(G_(d,gd=>{I[_n]=gd,_f||(_f=!0,J--),J||d.next(i(I.slice()))},()=>{--q||d.complete()}))},d)},d)}}(d,r,v?q=>KB(v,q):fE));return i?I.pipe(s5(i)):I}function XB(n,r,i){n?pE(i,n,r):r()}function a5(...n){return function eZ(){return UE(1)}()(Z_(n,GE(n)))}function JB(n){return new i1(r=>{$1(n()).subscribe(r)})}function SR(n,r){const i=m(n)?n:()=>n,d=v=>v.error(i());return new i1(r?v=>r.schedule(d,0,v):d)}function u5(){return o1((n,r)=>{let i=null;n._refCount++;const d=G_(r,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(i=null);const v=n._connection,I=i;i=null,v&&(!I||v===I)&&v.unsubscribe(),r.unsubscribe()});n.subscribe(d),d.closed||(i=n.connect())})}class QB extends i1{constructor(r,i){super(),this.source=r,this.subjectFactory=i,this._subject=null,this._refCount=0,this._connection=null,W2(r)&&(this.lift=r.lift)}_subscribe(r){return this.getSubject().subscribe(r)}getSubject(){const r=this._subject;return(!r||r.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:r}=this;this._subject=this._connection=null,r?.unsubscribe()}connect(){let r=this._connection;if(!r){r=this._connection=new _e;const i=this.getSubject();r.add(this.source.subscribe(G_(i,void 0,()=>{this._teardown(),i.complete()},d=>{this._teardown(),i.error(d)},()=>this._teardown()))),r.closed&&(this._connection=null,r=_e.EMPTY)}return r}refCount(){return u5()(this)}}function _A(n,r){return o1((i,d)=>{let v=null,I=0,q=!1;const J=()=>q&&!v&&d.complete();i.subscribe(G_(d,_n=>{v?.unsubscribe();let _a=0;const _f=I++;$1(n(_n,_f)).subscribe(v=G_(d,gd=>d.next(r?r(_n,gd,_f,_a++):gd),()=>{v=null,J()}))},()=>{q=!0,J()}))})}function MR(n){return n<=0?()=>dE:o1((r,i)=>{let d=0;r.subscribe(G_(i,v=>{++d<=n&&(i.next(v),n<=d&&i.complete())}))})}function VL(n){return o1((r,i)=>{let d=!1;r.subscribe(G_(i,v=>{d=!0,i.next(v)},()=>{d||i.next(n),i.complete()}))})}function tH(n=rZ){return o1((r,i)=>{let d=!1;r.subscribe(G_(i,v=>{d=!0,i.next(v)},()=>d?i.complete():i.error(n())))})}function rZ(){return new jL}function F2(n,r){const i=arguments.length>=2;return d=>d.pipe(n?fC((v,I)=>n(v,I,d)):fE,MR(1),i?VL(r):tH(()=>new jL))}function Rx(n,r,i){const d=m(n)||r||i?{next:n,error:r,complete:i}:n;return d?o1((v,I)=>{var q;null===(q=d.subscribe)||void 0===q||q.call(d);let J=!0;v.subscribe(G_(I,_n=>{var _a;null===(_a=d.next)||void 0===_a||_a.call(d,_n),I.next(_n)},()=>{var _n;J=!1,null===(_n=d.complete)||void 0===_n||_n.call(d),I.complete()},_n=>{var _a;J=!1,null===(_a=d.error)||void 0===_a||_a.call(d,_n),I.error(_n)},()=>{var _n,_a;J&&(null===(_n=d.unsubscribe)||void 0===_n||_n.call(d)),null===(_a=d.finalize)||void 0===_a||_a.call(d)}))}):fE}function dC(n){return o1((r,i)=>{let I,d=null,v=!1;d=r.subscribe(G_(i,void 0,void 0,q=>{I=$1(n(q,dC(n)(r))),d?(d.unsubscribe(),d=null,I.subscribe(i)):v=!0})),v&&(d.unsubscribe(),d=null,I.subscribe(i))})}function iZ(n,r,i,d,v){return(I,q)=>{let J=i,_n=r,_a=0;I.subscribe(G_(q,_f=>{const gd=_a++;_n=J?n(_n,_f,gd):(J=!0,_f),d&&q.next(_n)},v&&(()=>{J&&q.next(_n),q.complete()})))}}function eH(n,r){return o1(iZ(n,r,arguments.length>=2,!0))}function l5(n){return n<=0?()=>dE:o1((r,i)=>{let d=[];r.subscribe(G_(i,v=>{d.push(v),n<d.length&&d.shift()},()=>{for(const v of d)i.next(v);i.complete()},void 0,()=>{d=null}))})}function nH(n,r){const i=arguments.length>=2;return d=>d.pipe(n?fC((v,I)=>n(v,I,d)):fE,l5(1),i?VL(r):tH(()=>new jL))}function c5(n){return o1((r,i)=>{try{r.subscribe(i)}finally{i.add(n)}})}const x_="primary",IR=Symbol("RouteTitle");class aZ{constructor(r){this.params=r||{}}has(r){return Object.prototype.hasOwnProperty.call(this.params,r)}get(r){if(this.has(r)){const i=this.params[r];return Array.isArray(i)?i[0]:i}return null}getAll(r){if(this.has(r)){const i=this.params[r];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}}function ZM(n){return new aZ(n)}function uZ(n,r,i){const d=i.path.split("/");if(d.length>n.length||"full"===i.pathMatch&&(r.hasChildren()||d.length<n.length))return null;const v={};for(let I=0;I<d.length;I++){const q=d[I],J=n[I];if(q.startsWith(":"))v[q.substring(1)]=J;else if(q!==J.path)return null}return{consumed:n.slice(0,d.length),posParams:v}}function bA(n,r){const i=n?Object.keys(n):void 0,d=r?Object.keys(r):void 0;if(!i||!d||i.length!=d.length)return!1;let v;for(let I=0;I<i.length;I++)if(v=i[I],!rH(n[v],r[v]))return!1;return!0}function rH(n,r){if(Array.isArray(n)&&Array.isArray(r)){if(n.length!==r.length)return!1;const i=[...n].sort(),d=[...r].sort();return i.every((v,I)=>d[I]===v)}return n===r}function iH(n){return Array.prototype.concat.apply([],n)}function oH(n){return n.length>0?n[n.length-1]:null}function Nx(n,r){for(const i in n)n.hasOwnProperty(i)&&r(n[i],i)}function j2(n){return U4(n)?n:sR(n)?Z_(Promise.resolve(n)):U0(n)}const hZ={exact:function uH(n,r,i){if(!nS(n.segments,r.segments)||!zL(n.segments,r.segments,i)||n.numberOfChildren!==r.numberOfChildren)return!1;for(const d in r.children)if(!n.children[d]||!uH(n.children[d],r.children[d],i))return!1;return!0},subset:lH},sH={exact:function fZ(n,r){return bA(n,r)},subset:function pZ(n,r){return Object.keys(r).length<=Object.keys(n).length&&Object.keys(r).every(i=>rH(n[i],r[i]))},ignored:()=>!0};function aH(n,r,i){return hZ[i.paths](n.root,r.root,i.matrixParams)&&sH[i.queryParams](n.queryParams,r.queryParams)&&!("exact"===i.fragment&&n.fragment!==r.fragment)}function lH(n,r,i){return cH(n,r,r.segments,i)}function cH(n,r,i,d){if(n.segments.length>i.length){const v=n.segments.slice(0,i.length);return!(!nS(v,i)||r.hasChildren()||!zL(v,i,d))}if(n.segments.length===i.length){if(!nS(n.segments,i)||!zL(n.segments,i,d))return!1;for(const v in r.children)if(!n.children[v]||!lH(n.children[v],r.children[v],d))return!1;return!0}{const v=i.slice(0,n.segments.length),I=i.slice(n.segments.length);return!!(nS(n.segments,v)&&zL(n.segments,v,d)&&n.children[x_])&&cH(n.children[x_],r,I,d)}}function zL(n,r,i){return r.every((d,v)=>sH[i](n[v].parameters,d.parameters))}class eS{constructor(r,i,d){this.root=r,this.queryParams=i,this.fragment=d}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ZM(this.queryParams)),this._queryParamMap}toString(){return yZ.serialize(this)}}class I_{constructor(r,i){this.segments=r,this.children=i,this.parent=null,Nx(i,(d,v)=>d.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return BL(this)}}class kR{constructor(r,i){this.path=r,this.parameters=i}get parameterMap(){return this._parameterMap||(this._parameterMap=ZM(this.parameters)),this._parameterMap}toString(){return dH(this)}}function nS(n,r){return n.length===r.length&&n.every((i,d)=>i.path===r[d].path)}let hH=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:function(){return new f5},providedIn:"root"}),n})();class f5{parse(r){const i=new AZ(r);return new eS(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(r){const i=`/${OR(r.root,!0)}`,d=function _Z(n){const r=Object.keys(n).map(i=>{const d=n[i];return Array.isArray(d)?d.map(v=>`${HL(i)}=${HL(v)}`).join("&"):`${HL(i)}=${HL(d)}`}).filter(i=>!!i);return r.length?`?${r.join("&")}`:""}(r.queryParams);return`${i}${d}${"string"==typeof r.fragment?`#${function mZ(n){return encodeURI(n)}(r.fragment)}`:""}`}}const yZ=new f5;function BL(n){return n.segments.map(r=>dH(r)).join("/")}function OR(n,r){if(!n.hasChildren())return BL(n);if(r){const i=n.children[x_]?OR(n.children[x_],!1):"",d=[];return Nx(n.children,(v,I)=>{I!==x_&&d.push(`${I}:${OR(v,!1)}`)}),d.length>0?`${i}(${d.join("//")})`:i}{const i=function gZ(n,r){let i=[];return Nx(n.children,(d,v)=>{v===x_&&(i=i.concat(r(d,v)))}),Nx(n.children,(d,v)=>{v!==x_&&(i=i.concat(r(d,v)))}),i}(n,(d,v)=>v===x_?[OR(n.children[x_],!1)]:[`${v}:${OR(d,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[x_]?`${BL(n)}/${i[0]}`:`${BL(n)}/(${i.join("//")})`}}function fH(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function HL(n){return fH(n).replace(/%3B/gi,";")}function p5(n){return fH(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function UL(n){return decodeURIComponent(n)}function pH(n){return UL(n.replace(/\+/g,"%20"))}function dH(n){return`${p5(n.path)}${function vZ(n){return Object.keys(n).map(r=>`;${p5(r)}=${p5(n[r])}`).join("")}(n.parameters)}`}const bZ=/^[^\/()?;=#]+/;function GL(n){const r=n.match(bZ);return r?r[0]:""}const wZ=/^[^=?&#]+/,EZ=/^[^&#]+/;class AZ{constructor(r){this.url=r,this.remaining=r}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new I_([],{}):new I_([],this.parseChildren())}parseQueryParams(){const r={};if(this.consumeOptional("?"))do{this.parseQueryParam(r)}while(this.consumeOptional("&"));return r}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const r=[];for(this.peekStartsWith("(")||r.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),r.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let d={};return this.peekStartsWith("(")&&(d=this.parseParens(!1)),(r.length>0||Object.keys(i).length>0)&&(d[x_]=new I_(r,i)),d}parseSegment(){const r=GL(this.remaining);if(""===r&&this.peekStartsWith(";"))throw new a0(4009,!1);return this.capture(r),new kR(UL(r),this.parseMatrixParams())}parseMatrixParams(){const r={};for(;this.consumeOptional(";");)this.parseParam(r);return r}parseParam(r){const i=GL(this.remaining);if(!i)return;this.capture(i);let d="";if(this.consumeOptional("=")){const v=GL(this.remaining);v&&(d=v,this.capture(d))}r[UL(i)]=UL(d)}parseQueryParam(r){const i=function xZ(n){const r=n.match(wZ);return r?r[0]:""}(this.remaining);if(!i)return;this.capture(i);let d="";if(this.consumeOptional("=")){const q=function TZ(n){const r=n.match(EZ);return r?r[0]:""}(this.remaining);q&&(d=q,this.capture(d))}const v=pH(i),I=pH(d);if(r.hasOwnProperty(v)){let q=r[v];Array.isArray(q)||(q=[q],r[v]=q),q.push(I)}else r[v]=I}parseParens(r){const i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const d=GL(this.remaining),v=this.remaining[d.length];if("/"!==v&&")"!==v&&";"!==v)throw new a0(4010,!1);let I;d.indexOf(":")>-1?(I=d.slice(0,d.indexOf(":")),this.capture(I),this.capture(":")):r&&(I=x_);const q=this.parseChildren();i[I]=1===Object.keys(q).length?q[x_]:new I_([],q),this.consumeOptional("//")}return i}peekStartsWith(r){return this.remaining.startsWith(r)}consumeOptional(r){return!!this.peekStartsWith(r)&&(this.remaining=this.remaining.substring(r.length),!0)}capture(r){if(!this.consumeOptional(r))throw new a0(4011,!1)}}function d5(n){return n.segments.length>0?new I_([],{[x_]:n}):n}function qL(n){const r={};for(const d of Object.keys(n.children)){const I=qL(n.children[d]);(I.segments.length>0||I.hasChildren())&&(r[d]=I)}return function CZ(n){if(1===n.numberOfChildren&&n.children[x_]){const r=n.children[x_];return new I_(n.segments.concat(r.segments),r.children)}return n}(new I_(n.segments,r))}function rS(n){return n instanceof eS}function MZ(n,r,i,d,v){if(0===i.length)return XM(r.root,r.root,r.root,d,v);const I=function mH(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new yH(!0,0,n);let r=0,i=!1;const d=n.reduce((v,I,q)=>{if("object"==typeof I&&null!=I){if(I.outlets){const J={};return Nx(I.outlets,(_n,_a)=>{J[_a]="string"==typeof _n?_n.split("/"):_n}),[...v,{outlets:J}]}if(I.segmentPath)return[...v,I.segmentPath]}return"string"!=typeof I?[...v,I]:0===q?(I.split("/").forEach((J,_n)=>{0==_n&&"."===J||(0==_n&&""===J?i=!0:".."===J?r++:""!=J&&v.push(J))}),v):[...v,I]},[]);return new yH(i,r,d)}(i);return I.toRoot()?XM(r.root,r.root,new I_([],{}),d,v):function q(_n){const _a=function kZ(n,r,i,d){if(n.isAbsolute)return new JM(r.root,!0,0);if(-1===d)return new JM(i,i===r.root,0);return function vH(n,r,i){let d=n,v=r,I=i;for(;I>v;){if(I-=v,d=d.parent,!d)throw new a0(4005,!1);v=d.segments.length}return new JM(d,!1,v-I)}(i,d+(RR(n.commands[0])?0:1),n.numberOfDoubleDots)}(I,r,n.snapshot?._urlSegment,_n),_f=_a.processChildren?PR(_a.segmentGroup,_a.index,I.commands):y5(_a.segmentGroup,_a.index,I.commands);return XM(r.root,_a.segmentGroup,_f,d,v)}(n.snapshot?._lastPathIndex)}function RR(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function NR(n){return"object"==typeof n&&null!=n&&n.outlets}function XM(n,r,i,d,v){let q,I={};d&&Nx(d,(_n,_a)=>{I[_a]=Array.isArray(_n)?_n.map(_f=>`${_f}`):`${_n}`}),q=n===r?i:gH(n,r,i);const J=d5(qL(q));return new eS(J,I,v)}function gH(n,r,i){const d={};return Nx(n.children,(v,I)=>{d[I]=v===r?i:gH(v,r,i)}),new I_(n.segments,d)}class yH{constructor(r,i,d){if(this.isAbsolute=r,this.numberOfDoubleDots=i,this.commands=d,r&&d.length>0&&RR(d[0]))throw new a0(4003,!1);const v=d.find(NR);if(v&&v!==oH(d))throw new a0(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class JM{constructor(r,i,d){this.segmentGroup=r,this.processChildren=i,this.index=d}}function y5(n,r,i){if(n||(n=new I_([],{})),0===n.segments.length&&n.hasChildren())return PR(n,r,i);const d=function RZ(n,r,i){let d=0,v=r;const I={match:!1,pathIndex:0,commandIndex:0};for(;v<n.segments.length;){if(d>=i.length)return I;const q=n.segments[v],J=i[d];if(NR(J))break;const _n=`${J}`,_a=d<i.length-1?i[d+1]:null;if(v>0&&void 0===_n)break;if(_n&&_a&&"object"==typeof _a&&void 0===_a.outlets){if(!bH(_n,_a,q))return I;d+=2}else{if(!bH(_n,{},q))return I;d++}v++}return{match:!0,pathIndex:v,commandIndex:d}}(n,r,i),v=i.slice(d.commandIndex);if(d.match&&d.pathIndex<n.segments.length){const I=new I_(n.segments.slice(0,d.pathIndex),{});return I.children[x_]=new I_(n.segments.slice(d.pathIndex),n.children),PR(I,0,v)}return d.match&&0===v.length?new I_(n.segments,{}):d.match&&!n.hasChildren()?m5(n,r,i):d.match?PR(n,0,v):m5(n,r,i)}function PR(n,r,i){if(0===i.length)return new I_(n.segments,{});{const d=function OZ(n){return NR(n[0])?n[0].outlets:{[x_]:n}}(i),v={};return Nx(d,(I,q)=>{"string"==typeof I&&(I=[I]),null!==I&&(v[q]=y5(n.children[q],r,I))}),Nx(n.children,(I,q)=>{void 0===d[q]&&(v[q]=I)}),new I_(n.segments,v)}}function m5(n,r,i){const d=n.segments.slice(0,r);let v=0;for(;v<i.length;){const I=i[v];if(NR(I)){const _n=NZ(I.outlets);return new I_(d,_n)}if(0===v&&RR(i[0])){d.push(new kR(n.segments[r].path,_H(i[0]))),v++;continue}const q=NR(I)?I.outlets[x_]:`${I}`,J=v<i.length-1?i[v+1]:null;q&&J&&RR(J)?(d.push(new kR(q,_H(J))),v+=2):(d.push(new kR(q,{})),v++)}return new I_(d,{})}function NZ(n){const r={};return Nx(n,(i,d)=>{"string"==typeof i&&(i=[i]),null!==i&&(r[d]=m5(new I_([],{}),0,i))}),r}function _H(n){const r={};return Nx(n,(i,d)=>r[d]=`${i}`),r}function bH(n,r,i){return n==i.path&&bA(r,i.parameters)}class gC{constructor(r,i){this.id=r,this.url=i}}class v5 extends gC{constructor(r,i,d="imperative",v=null){super(r,i),this.type=0,this.navigationTrigger=d,this.restoredState=v}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class iS extends gC{constructor(r,i,d){super(r,i),this.urlAfterRedirects=d,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class WL extends gC{constructor(r,i,d,v){super(r,i),this.reason=d,this.code=v,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class wH extends gC{constructor(r,i,d,v){super(r,i),this.error=d,this.target=v,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class PZ extends gC{constructor(r,i,d,v){super(r,i),this.urlAfterRedirects=d,this.state=v,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class LZ extends gC{constructor(r,i,d,v){super(r,i),this.urlAfterRedirects=d,this.state=v,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class FZ extends gC{constructor(r,i,d,v,I){super(r,i),this.urlAfterRedirects=d,this.state=v,this.shouldActivate=I,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class jZ extends gC{constructor(r,i,d,v){super(r,i),this.urlAfterRedirects=d,this.state=v,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class VZ extends gC{constructor(r,i,d,v){super(r,i),this.urlAfterRedirects=d,this.state=v,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zZ{constructor(r){this.route=r,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class BZ{constructor(r){this.route=r,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class HZ{constructor(r){this.snapshot=r,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class UZ{constructor(r){this.snapshot=r,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class GZ{constructor(r){this.snapshot=r,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qZ{constructor(r){this.snapshot=r,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xH{constructor(r,i,d){this.routerEvent=r,this.position=i,this.anchor=d,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class EH{constructor(r){this._root=r}get root(){return this._root.value}parent(r){const i=this.pathFromRoot(r);return i.length>1?i[i.length-2]:null}children(r){const i=_5(r,this._root);return i?i.children.map(d=>d.value):[]}firstChild(r){const i=_5(r,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(r){const i=b5(r,this._root);return i.length<2?[]:i[i.length-2].children.map(v=>v.value).filter(v=>v!==r)}pathFromRoot(r){return b5(r,this._root).map(i=>i.value)}}function _5(n,r){if(n===r.value)return r;for(const i of r.children){const d=_5(n,i);if(d)return d}return null}function b5(n,r){if(n===r.value)return[r];for(const i of r.children){const d=b5(n,i);if(d.length)return d.unshift(r),d}return[]}class yC{constructor(r,i){this.value=r,this.children=i}toString(){return`TreeNode(${this.value})`}}function QM(n){const r={};return n&&n.children.forEach(i=>r[i.value.outlet]=i),r}class TH extends EH{constructor(r,i){super(r),this.snapshot=i,w5(this,r)}toString(){return this.snapshot.toString()}}function AH(n,r){const i=function $Z(n,r){const q=new $L([],{},{},"",{},x_,r,null,n.root,-1,{});return new DH("",new yC(q,[]))}(n,r),d=new HT([new kR("",{})]),v=new HT({}),I=new HT({}),q=new HT({}),J=new HT(""),_n=new V2(d,v,q,J,I,x_,r,i.root);return _n.snapshot=i.root,new TH(new yC(_n,[]),i)}class V2{constructor(r,i,d,v,I,q,J,_n){this.url=r,this.params=i,this.queryParams=d,this.fragment=v,this.data=I,this.outlet=q,this.component=J,this.title=this.data?.pipe(r_(_a=>_a[IR]))??U0(void 0),this._futureSnapshot=_n}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(r_(r=>ZM(r)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(r_(r=>ZM(r)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function CH(n,r="emptyOnly"){const i=n.pathFromRoot;let d=0;if("always"!==r)for(d=i.length-1;d>=1;){const v=i[d],I=i[d-1];if(v.routeConfig&&""===v.routeConfig.path)d--;else{if(I.component)break;d--}}return function YZ(n){return n.reduce((r,i)=>({params:{...r.params,...i.params},data:{...r.data,...i.data},resolve:{...i.data,...r.resolve,...i.routeConfig?.data,...i._resolvedData}}),{params:{},data:{},resolve:{}})}(i.slice(d))}class $L{constructor(r,i,d,v,I,q,J,_n,_a,_f,gd,ay){this.url=r,this.params=i,this.queryParams=d,this.fragment=v,this.data=I,this.outlet=q,this.component=J,this.title=this.data?.[IR],this.routeConfig=_n,this._urlSegment=_a,this._lastPathIndex=_f,this._correctedLastPathIndex=ay??_f,this._resolve=gd}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ZM(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ZM(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(d=>d.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class DH extends EH{constructor(r,i){super(i),this.url=r,w5(this,i)}toString(){return SH(this._root)}}function w5(n,r){r.value._routerState=n,r.children.forEach(i=>w5(n,i))}function SH(n){const r=n.children.length>0?` { ${n.children.map(SH).join(", ")} } `:"";return`${n.value}${r}`}function x5(n){if(n.snapshot){const r=n.snapshot,i=n._futureSnapshot;n.snapshot=i,bA(r.queryParams,i.queryParams)||n.queryParams.next(i.queryParams),r.fragment!==i.fragment&&n.fragment.next(i.fragment),bA(r.params,i.params)||n.params.next(i.params),function lZ(n,r){if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i)if(!bA(n[i],r[i]))return!1;return!0}(r.url,i.url)||n.url.next(i.url),bA(r.data,i.data)||n.data.next(i.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function E5(n,r){const i=bA(n.params,r.params)&&function dZ(n,r){return nS(n,r)&&n.every((i,d)=>bA(i.parameters,r[d].parameters))}(n.url,r.url);return i&&!(!n.parent!=!r.parent)&&(!n.parent||E5(n.parent,r.parent))}function LR(n,r,i){if(i&&n.shouldReuseRoute(r.value,i.value.snapshot)){const d=i.value;d._futureSnapshot=r.value;const v=function ZZ(n,r,i){return r.children.map(d=>{for(const v of i.children)if(n.shouldReuseRoute(d.value,v.value.snapshot))return LR(n,d,v);return LR(n,d)})}(n,r,i);return new yC(d,v)}{if(n.shouldAttach(r.value)){const I=n.retrieve(r.value);if(null!==I){const q=I.route;return q.value._futureSnapshot=r.value,q.children=r.children.map(J=>LR(n,J)),q}}const d=function XZ(n){return new V2(new HT(n.url),new HT(n.params),new HT(n.queryParams),new HT(n.fragment),new HT(n.data),n.outlet,n.component,n)}(r.value),v=r.children.map(I=>LR(n,I));return new yC(d,v)}}const T5="ngNavigationCancelingError";function MH(n,r){const{redirectTo:i,navigationBehaviorOptions:d}=rS(r)?{redirectTo:r,navigationBehaviorOptions:void 0}:r,v=IH(!1,0,r);return v.url=i,v.navigationBehaviorOptions=d,v}function IH(n,r,i){const d=new Error("NavigationCancelingError: "+(n||""));return d[T5]=!0,d.cancellationCode=r,i&&(d.url=i),d}function kH(n){return OH(n)&&rS(n.url)}function OH(n){return n&&n[T5]}class JZ{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new FR,this.attachRef=null}}let FR=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(i,d){const v=this.getOrCreateContext(i);v.outlet=d,this.contexts.set(i,v)}onChildOutletDestroyed(i){const d=this.getContext(i);d&&(d.outlet=null,d.attachRef=null)}onOutletDeactivated(){const i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let d=this.getContext(i);return d||(d=new JZ,this.contexts.set(i,d)),d}getContext(i){return this.contexts.get(i)||null}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const YL=!1;let A5=(()=>{class n{constructor(i,d,v,I,q){this.parentContexts=i,this.location=d,this.changeDetector=I,this.environmentInjector=q,this.activated=null,this._activatedRoute=null,this.activateEvents=new V1,this.deactivateEvents=new V1,this.attachEvents=new V1,this.detachEvents=new V1,this.name=v||x_,i.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const i=this.parentContexts.getContext(this.name);i&&i.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new a0(4012,YL);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new a0(4012,YL);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new a0(4012,YL);this.location.detach();const i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,d){this.activated=i,this._activatedRoute=d,this.location.insert(i.hostView),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){const i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,d){if(this.isActivated)throw new a0(4013,YL);this._activatedRoute=i;const v=this.location,q=i._futureSnapshot.component,J=this.parentContexts.getOrCreateContext(this.name).children,_n=new QZ(i,J,v.injector);if(d&&function tX(n){return!!n.resolveComponentFactory}(d)){const _a=d.resolveComponentFactory(q);this.activated=v.createComponent(_a,v.length,_n)}else this.activated=v.createComponent(q,{index:v.length,injector:_n,environmentInjector:d??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(i){return new(i||n)(Xy(FR),Xy(jT),function vD(n){return function jS(n,r){if("class"===r)return n.classes;if("style"===r)return n.styles;const i=n.attrs;if(i){const d=i.length;let v=0;for(;v<d;){const I=i[v];if(kI(I))break;if(0===I)v+=2;else if("number"==typeof I)for(v++;v<d&&"string"==typeof i[v];)v++;else{if(I===r)return i[v+1];v+=2}}}return null}(f_(),n)}("name"),Xy(mL),Xy(cA))},n.\u0275dir=H0({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class QZ{constructor(r,i,d){this.route=r,this.childContexts=i,this.parent=d}get(r,i){return r===V2?this.route:r===FR?this.childContexts:this.parent.get(r,i)}}let C5=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=B0({type:n,selectors:[["ng-component"]],standalone:!0,features:[S8],decls:1,vars:0,template:function(i,d){1&i&&TE(0,"router-outlet")},dependencies:[A5],encapsulation:2}),n})();function RH(n,r){return n.providers&&!n._injector&&(n._injector=uL(n.providers,r,`Route: ${n.path}`)),n._injector??r}function S5(n){const r=n.children&&n.children.map(S5),i=r?{...n,children:r}:{...n};return!i.component&&!i.loadComponent&&(r||i.loadChildren)&&i.outlet&&i.outlet!==x_&&(i.component=C5),i}function sT(n){return n.outlet||x_}function NH(n,r){const i=n.filter(d=>sT(d)===r);return i.push(...n.filter(d=>sT(d)!==r)),i}function jR(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let r=n.parent;r;r=r.parent){const i=r.routeConfig;if(i?._loadedInjector)return i._loadedInjector;if(i?._injector)return i._injector}return null}class oX{constructor(r,i,d,v){this.routeReuseStrategy=r,this.futureState=i,this.currState=d,this.forwardEvent=v}activate(r){const i=this.futureState._root,d=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,d,r),x5(this.futureState.root),this.activateChildRoutes(i,d,r)}deactivateChildRoutes(r,i,d){const v=QM(i);r.children.forEach(I=>{const q=I.value.outlet;this.deactivateRoutes(I,v[q],d),delete v[q]}),Nx(v,(I,q)=>{this.deactivateRouteAndItsChildren(I,d)})}deactivateRoutes(r,i,d){const v=r.value,I=i?i.value:null;if(v===I)if(v.component){const q=d.getContext(v.outlet);q&&this.deactivateChildRoutes(r,i,q.children)}else this.deactivateChildRoutes(r,i,d);else I&&this.deactivateRouteAndItsChildren(i,d)}deactivateRouteAndItsChildren(r,i){r.value.component&&this.routeReuseStrategy.shouldDetach(r.value.snapshot)?this.detachAndStoreRouteSubtree(r,i):this.deactivateRouteAndOutlet(r,i)}detachAndStoreRouteSubtree(r,i){const d=i.getContext(r.value.outlet),v=d&&r.value.component?d.children:i,I=QM(r);for(const q of Object.keys(I))this.deactivateRouteAndItsChildren(I[q],v);if(d&&d.outlet){const q=d.outlet.detach(),J=d.children.onOutletDeactivated();this.routeReuseStrategy.store(r.value.snapshot,{componentRef:q,route:r,contexts:J})}}deactivateRouteAndOutlet(r,i){const d=i.getContext(r.value.outlet),v=d&&r.value.component?d.children:i,I=QM(r);for(const q of Object.keys(I))this.deactivateRouteAndItsChildren(I[q],v);d&&d.outlet&&(d.outlet.deactivate(),d.children.onOutletDeactivated(),d.attachRef=null,d.resolver=null,d.route=null)}activateChildRoutes(r,i,d){const v=QM(i);r.children.forEach(I=>{this.activateRoutes(I,v[I.value.outlet],d),this.forwardEvent(new qZ(I.value.snapshot))}),r.children.length&&this.forwardEvent(new UZ(r.value.snapshot))}activateRoutes(r,i,d){const v=r.value,I=i?i.value:null;if(x5(v),v===I)if(v.component){const q=d.getOrCreateContext(v.outlet);this.activateChildRoutes(r,i,q.children)}else this.activateChildRoutes(r,i,d);else if(v.component){const q=d.getOrCreateContext(v.outlet);if(this.routeReuseStrategy.shouldAttach(v.snapshot)){const J=this.routeReuseStrategy.retrieve(v.snapshot);this.routeReuseStrategy.store(v.snapshot,null),q.children.onOutletReAttached(J.contexts),q.attachRef=J.componentRef,q.route=J.route.value,q.outlet&&q.outlet.attach(J.componentRef,J.route.value),x5(J.route.value),this.activateChildRoutes(r,null,q.children)}else{const J=jR(v.snapshot),_n=J?.get(hA)??null;q.attachRef=null,q.route=v,q.resolver=_n,q.injector=J,q.outlet&&q.outlet.activateWith(v,q.injector),this.activateChildRoutes(r,null,q.children)}}else this.activateChildRoutes(r,null,d)}}class PH{constructor(r){this.path=r,this.route=this.path[this.path.length-1]}}class KL{constructor(r,i){this.component=r,this.route=i}}function sX(n,r,i){const d=n._root;return VR(d,r?r._root:null,i,[d.value])}function tI(n,r){const i=Symbol(),d=r.get(n,i);return d===i?"function"!=typeof n||function gg(n){return null!==_h(n)}(n)?r.get(n):n:d}function VR(n,r,i,d,v={canDeactivateChecks:[],canActivateChecks:[]}){const I=QM(r);return n.children.forEach(q=>{(function uX(n,r,i,d,v={canDeactivateChecks:[],canActivateChecks:[]}){const I=n.value,q=r?r.value:null,J=i?i.getContext(n.value.outlet):null;if(q&&I.routeConfig===q.routeConfig){const _n=function lX(n,r,i){if("function"==typeof i)return i(n,r);switch(i){case"pathParamsChange":return!nS(n.url,r.url);case"pathParamsOrQueryParamsChange":return!nS(n.url,r.url)||!bA(n.queryParams,r.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!E5(n,r)||!bA(n.queryParams,r.queryParams);default:return!E5(n,r)}}(q,I,I.routeConfig.runGuardsAndResolvers);_n?v.canActivateChecks.push(new PH(d)):(I.data=q.data,I._resolvedData=q._resolvedData),VR(n,r,I.component?J?J.children:null:i,d,v),_n&&J&&J.outlet&&J.outlet.isActivated&&v.canDeactivateChecks.push(new KL(J.outlet.component,q))}else q&&zR(r,J,v),v.canActivateChecks.push(new PH(d)),VR(n,null,I.component?J?J.children:null:i,d,v)})(q,I[q.value.outlet],i,d.concat([q.value]),v),delete I[q.value.outlet]}),Nx(I,(q,J)=>zR(q,i.getContext(J),v)),v}function zR(n,r,i){const d=QM(n),v=n.value;Nx(d,(I,q)=>{zR(I,v.component?r?r.children.getContext(q):null:r,i)}),i.canDeactivateChecks.push(new KL(v.component&&r&&r.outlet&&r.outlet.isActivated?r.outlet.component:null,v))}function BR(n){return"function"==typeof n}function M5(n){return n instanceof jL||"EmptyError"===n?.name}const ZL=Symbol("INITIAL_VALUE");function eI(){return _A(n=>ZB(n.map(r=>r.pipe(MR(1),function nZ(...n){const r=GE(n);return o1((i,d)=>{(r?a5(n,i,r):a5(n,i)).subscribe(d)})}(ZL)))).pipe(r_(r=>{for(const i of r)if(!0!==i){if(i===ZL)return ZL;if(!1===i||i instanceof eS)return i}return!0}),fC(r=>r!==ZL),MR(1)))}function LH(n){return function mC(...n){return G2(n)}(Rx(r=>{if(rS(r))throw MH(0,r)}),r_(r=>!0===r))}const I5={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function FH(n,r,i,d,v){const I=k5(n,r,i);return I.matched?function CX(n,r,i,d){const v=r.canMatch;return v&&0!==v.length?U0(v.map(q=>{const J=tI(q,n);return j2(function gX(n){return n&&BR(n.canMatch)}(J)?J.canMatch(r,i):n.runInContext(()=>J(r,i)))})).pipe(eI(),LH()):U0(!0)}(d=RH(r,d),r,i).pipe(r_(q=>!0===q?I:{...I5})):U0(I)}function k5(n,r,i){if(""===r.path)return"full"===r.pathMatch&&(n.hasChildren()||i.length>0)?{...I5}:{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};const v=(r.matcher||uZ)(i,n,r);if(!v)return{...I5};const I={};Nx(v.posParams,(J,_n)=>{I[_n]=J.path});const q=v.consumed.length>0?{...I,...v.consumed[v.consumed.length-1].parameters}:I;return{matched:!0,consumedSegments:v.consumed,remainingSegments:i.slice(v.consumed.length),parameters:q,positionalParamSegments:v.posParams??{}}}function XL(n,r,i,d,v="corrected"){if(i.length>0&&function MX(n,r,i){return i.some(d=>JL(n,r,d)&&sT(d)!==x_)}(n,i,d)){const q=new I_(r,function SX(n,r,i,d){const v={};v[x_]=d,d._sourceSegment=n,d._segmentIndexShift=r.length;for(const I of i)if(""===I.path&&sT(I)!==x_){const q=new I_([],{});q._sourceSegment=n,q._segmentIndexShift=r.length,v[sT(I)]=q}return v}(n,r,d,new I_(i,n.children)));return q._sourceSegment=n,q._segmentIndexShift=r.length,{segmentGroup:q,slicedSegments:[]}}if(0===i.length&&function IX(n,r,i){return i.some(d=>JL(n,r,d))}(n,i,d)){const q=new I_(n.segments,function DX(n,r,i,d,v,I){const q={};for(const J of d)if(JL(n,i,J)&&!v[sT(J)]){const _n=new I_([],{});_n._sourceSegment=n,_n._segmentIndexShift="legacy"===I?n.segments.length:r.length,q[sT(J)]=_n}return{...v,...q}}(n,r,i,d,n.children,v));return q._sourceSegment=n,q._segmentIndexShift=r.length,{segmentGroup:q,slicedSegments:i}}const I=new I_(n.segments,n.children);return I._sourceSegment=n,I._segmentIndexShift=r.length,{segmentGroup:I,slicedSegments:i}}function JL(n,r,i){return(!(n.hasChildren()||r.length>0)||"full"!==i.pathMatch)&&""===i.path}function jH(n,r,i,d){return!!(sT(n)===d||d!==x_&&JL(r,i,n))&&("**"===n.path||k5(r,n,i).matched)}function VH(n,r,i){return 0===r.length&&!n.children[i]}const QL=!1;class t3{constructor(r){this.segmentGroup=r||null}}class zH{constructor(r){this.urlTree=r}}function HR(n){return SR(new t3(n))}function BH(n){return SR(new zH(n))}class NX{constructor(r,i,d,v,I){this.injector=r,this.configLoader=i,this.urlSerializer=d,this.urlTree=v,this.config=I,this.allowRedirects=!0}apply(){const r=XL(this.urlTree.root,[],[],this.config).segmentGroup,i=new I_(r.segments,r.children);return this.expandSegmentGroup(this.injector,this.config,i,x_).pipe(r_(I=>this.createUrlTree(qL(I),this.urlTree.queryParams,this.urlTree.fragment))).pipe(dC(I=>{if(I instanceof zH)return this.allowRedirects=!1,this.match(I.urlTree);throw I instanceof t3?this.noMatchError(I):I}))}match(r){return this.expandSegmentGroup(this.injector,this.config,r.root,x_).pipe(r_(v=>this.createUrlTree(qL(v),r.queryParams,r.fragment))).pipe(dC(v=>{throw v instanceof t3?this.noMatchError(v):v}))}noMatchError(r){return new a0(4002,QL)}createUrlTree(r,i,d){const v=d5(r);return new eS(v,i,d)}expandSegmentGroup(r,i,d,v){return 0===d.segments.length&&d.hasChildren()?this.expandChildren(r,i,d).pipe(r_(I=>new I_([],I))):this.expandSegment(r,d,i,d.segments,v,!0)}expandChildren(r,i,d){const v=[];for(const I of Object.keys(d.children))"primary"===I?v.unshift(I):v.push(I);return Z_(v).pipe(P2(I=>{const q=d.children[I],J=NH(i,I);return this.expandSegmentGroup(r,J,q,I).pipe(r_(_n=>({segment:_n,outlet:I})))}),eH((I,q)=>(I[q.outlet]=q.segment,I),{}),nH())}expandSegment(r,i,d,v,I,q){return Z_(d).pipe(P2(J=>this.expandSegmentAgainstRoute(r,i,d,J,v,I,q).pipe(dC(_a=>{if(_a instanceof t3)return U0(null);throw _a}))),F2(J=>!!J),dC((J,_n)=>{if(M5(J))return VH(i,v,I)?U0(new I_([],{})):HR(i);throw J}))}expandSegmentAgainstRoute(r,i,d,v,I,q,J){return jH(v,i,I,q)?void 0===v.redirectTo?this.matchSegmentAgainstRoute(r,i,v,I,q):J&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(r,i,d,v,I,q):HR(i):HR(i)}expandSegmentAgainstRouteUsingRedirect(r,i,d,v,I,q){return"**"===v.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(r,d,v,q):this.expandRegularSegmentAgainstRouteUsingRedirect(r,i,d,v,I,q)}expandWildCardWithParamsAgainstRouteUsingRedirect(r,i,d,v){const I=this.applyRedirectCommands([],d.redirectTo,{});return d.redirectTo.startsWith("/")?BH(I):this.lineralizeSegments(d,I).pipe(s1(q=>{const J=new I_(q,{});return this.expandSegment(r,J,i,q,v,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(r,i,d,v,I,q){const{matched:J,consumedSegments:_n,remainingSegments:_a,positionalParamSegments:_f}=k5(i,v,I);if(!J)return HR(i);const gd=this.applyRedirectCommands(_n,v.redirectTo,_f);return v.redirectTo.startsWith("/")?BH(gd):this.lineralizeSegments(v,gd).pipe(s1(ay=>this.expandSegment(r,i,d,ay.concat(_a),q,!1)))}matchSegmentAgainstRoute(r,i,d,v,I){return"**"===d.path?(r=RH(d,r),d.loadChildren?(d._loadedRoutes?U0({routes:d._loadedRoutes,injector:d._loadedInjector}):this.configLoader.loadChildren(r,d)).pipe(r_(J=>(d._loadedRoutes=J.routes,d._loadedInjector=J.injector,new I_(v,{})))):U0(new I_(v,{}))):FH(i,d,v,r).pipe(_A(({matched:q,consumedSegments:J,remainingSegments:_n})=>q?this.getChildConfig(r=d._injector??r,d,v).pipe(s1(_f=>{const gd=_f.injector??r,ay=_f.routes,{segmentGroup:yy,slicedSegments:xy}=XL(i,J,_n,ay),Ry=new I_(yy.segments,yy.children);if(0===xy.length&&Ry.hasChildren())return this.expandChildren(gd,ay,Ry).pipe(r_(Uy=>new I_(J,Uy)));if(0===ay.length&&0===xy.length)return U0(new I_(J,{}));const zy=sT(d)===I;return this.expandSegment(gd,Ry,ay,xy,zy?x_:I,!0).pipe(r_(d0=>new I_(J.concat(d0.segments),d0.children)))})):HR(i)))}getChildConfig(r,i,d){return i.children?U0({routes:i.children,injector:r}):i.loadChildren?void 0!==i._loadedRoutes?U0({routes:i._loadedRoutes,injector:i._loadedInjector}):function AX(n,r,i,d){const v=r.canLoad;return void 0===v||0===v.length?U0(!0):U0(v.map(q=>{const J=tI(q,n);return j2(function hX(n){return n&&BR(n.canLoad)}(J)?J.canLoad(r,i):n.runInContext(()=>J(r,i)))})).pipe(eI(),LH())}(r,i,d).pipe(s1(v=>v?this.configLoader.loadChildren(r,i).pipe(Rx(I=>{i._loadedRoutes=I.routes,i._loadedInjector=I.injector})):function OX(n){return SR(IH(QL,3))}())):U0({routes:[],injector:r})}lineralizeSegments(r,i){let d=[],v=i.root;for(;;){if(d=d.concat(v.segments),0===v.numberOfChildren)return U0(d);if(v.numberOfChildren>1||!v.children[x_])return SR(new a0(4e3,QL));v=v.children[x_]}}applyRedirectCommands(r,i,d){return this.applyRedirectCreateUrlTree(i,this.urlSerializer.parse(i),r,d)}applyRedirectCreateUrlTree(r,i,d,v){const I=this.createSegmentGroup(r,i.root,d,v);return new eS(I,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(r,i){const d={};return Nx(r,(v,I)=>{if("string"==typeof v&&v.startsWith(":")){const J=v.substring(1);d[I]=i[J]}else d[I]=v}),d}createSegmentGroup(r,i,d,v){const I=this.createSegments(r,i.segments,d,v);let q={};return Nx(i.children,(J,_n)=>{q[_n]=this.createSegmentGroup(r,J,d,v)}),new I_(I,q)}createSegments(r,i,d,v){return i.map(I=>I.path.startsWith(":")?this.findPosParam(r,I,v):this.findOrReturn(I,d))}findPosParam(r,i,d){const v=d[i.path.substring(1)];if(!v)throw new a0(4001,QL);return v}findOrReturn(r,i){let d=0;for(const v of i){if(v.path===r.path)return i.splice(d),v;d++}return r}}class LX{}class VX{constructor(r,i,d,v,I,q,J,_n){this.injector=r,this.rootComponentType=i,this.config=d,this.urlTree=v,this.url=I,this.paramsInheritanceStrategy=q,this.relativeLinkResolution=J,this.urlSerializer=_n}recognize(){const r=XL(this.urlTree.root,[],[],this.config.filter(i=>void 0===i.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,r,x_).pipe(r_(i=>{if(null===i)return null;const d=new $L([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},x_,this.rootComponentType,null,this.urlTree.root,-1,{}),v=new yC(d,i),I=new DH(this.url,v);return this.inheritParamsAndData(I._root),I}))}inheritParamsAndData(r){const i=r.value,d=CH(i,this.paramsInheritanceStrategy);i.params=Object.freeze(d.params),i.data=Object.freeze(d.data),r.children.forEach(v=>this.inheritParamsAndData(v))}processSegmentGroup(r,i,d,v){return 0===d.segments.length&&d.hasChildren()?this.processChildren(r,i,d):this.processSegment(r,i,d,d.segments,v)}processChildren(r,i,d){return Z_(Object.keys(d.children)).pipe(P2(v=>{const I=d.children[v],q=NH(i,v);return this.processSegmentGroup(r,q,I,v)}),eH((v,I)=>v&&I?(v.push(...I),v):null),function oZ(n,r=!1){return o1((i,d)=>{let v=0;i.subscribe(G_(d,I=>{const q=n(I,v++);(q||r)&&d.next(I),!q&&d.complete()}))})}(v=>null!==v),VL(null),nH(),r_(v=>{if(null===v)return null;const I=HH(v);return function zX(n){n.sort((r,i)=>r.value.outlet===x_?-1:i.value.outlet===x_?1:r.value.outlet.localeCompare(i.value.outlet))}(I),I}))}processSegment(r,i,d,v,I){return Z_(i).pipe(P2(q=>this.processSegmentAgainstRoute(q._injector??r,q,d,v,I)),F2(q=>!!q),dC(q=>{if(M5(q))return VH(d,v,I)?U0([]):U0(null);throw q}))}processSegmentAgainstRoute(r,i,d,v,I){if(i.redirectTo||!jH(i,d,v,I))return U0(null);let q;if("**"===i.path){const J=v.length>0?oH(v).parameters:{},_n=GH(d)+v.length;q=U0({snapshot:new $L(v,J,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,WH(i),sT(i),i.component??i._loadedComponent??null,i,UH(d),_n,$H(i),_n),consumedSegments:[],remainingSegments:[]})}else q=FH(d,i,v,r).pipe(r_(({matched:J,consumedSegments:_n,remainingSegments:_a,parameters:_f})=>{if(!J)return null;const gd=GH(d)+_n.length;return{snapshot:new $L(_n,_f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,WH(i),sT(i),i.component??i._loadedComponent??null,i,UH(d),gd,$H(i),gd),consumedSegments:_n,remainingSegments:_a}}));return q.pipe(_A(J=>{if(null===J)return U0(null);const{snapshot:_n,consumedSegments:_a,remainingSegments:_f}=J;r=i._injector??r;const gd=i._loadedInjector??r,ay=function BX(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(i),{segmentGroup:yy,slicedSegments:xy}=XL(d,_a,_f,ay.filter(zy=>void 0===zy.redirectTo),this.relativeLinkResolution);if(0===xy.length&&yy.hasChildren())return this.processChildren(gd,ay,yy).pipe(r_(zy=>null===zy?null:[new yC(_n,zy)]));if(0===ay.length&&0===xy.length)return U0([new yC(_n,[])]);const Ry=sT(i)===I;return this.processSegment(gd,ay,yy,xy,Ry?x_:I).pipe(r_(zy=>null===zy?null:[new yC(_n,zy)]))}))}}function HX(n){const r=n.value.routeConfig;return r&&""===r.path&&void 0===r.redirectTo}function HH(n){const r=[],i=new Set;for(const d of n){if(!HX(d)){r.push(d);continue}const v=r.find(I=>d.value.routeConfig===I.value.routeConfig);void 0!==v?(v.children.push(...d.children),i.add(v)):r.push(d)}for(const d of i){const v=HH(d.children);r.push(new yC(d.value,v))}return r.filter(d=>!i.has(d))}function UH(n){let r=n;for(;r._sourceSegment;)r=r._sourceSegment;return r}function GH(n){let r=n,i=r._segmentIndexShift??0;for(;r._sourceSegment;)r=r._sourceSegment,i+=r._segmentIndexShift??0;return i-1}function WH(n){return n.data||{}}function $H(n){return n.resolve||{}}function YH(n){return"string"==typeof n.title||null===n.title}function O5(n){return _A(r=>{const i=n(r);return i?Z_(i).pipe(r_(()=>r)):U0(r)})}let KH=(()=>{class n{buildTitle(i){let d,v=i.root;for(;void 0!==v;)d=this.getResolvedTitleForRoute(v)??d,v=v.children.find(I=>I.outlet===x_);return d}getResolvedTitleForRoute(i){return i.data[IR]}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ni({token:n,factory:function(){return A1(ZH)},providedIn:"root"}),n})(),ZH=(()=>{class n extends KH{constructor(i){super(),this.title=i}updateTitle(i){const d=this.buildTitle(i);void 0!==d&&this.title.setTitle(d)}}return n.\u0275fac=function(i){return new(i||n)(x0(RB))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class ZX{}class JX extends class XX{shouldDetach(r){return!1}store(r,i){}shouldAttach(r){return!1}retrieve(r){return null}shouldReuseRoute(r,i){return r.routeConfig===i.routeConfig}}{}const n3=new z0("",{providedIn:"root",factory:()=>({})}),R5=new z0("ROUTES");let N5=(()=>{class n{constructor(i,d){this.injector=i,this.compiler=d,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return U0(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);const d=j2(i.loadComponent()).pipe(Rx(I=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=I}),c5(()=>{this.componentLoaders.delete(i)})),v=new QB(d,()=>new W1).pipe(u5());return this.componentLoaders.set(i,v),v}loadChildren(i,d){if(this.childrenLoaders.get(d))return this.childrenLoaders.get(d);if(d._loadedRoutes)return U0({routes:d._loadedRoutes,injector:d._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(d);const I=this.loadModuleFactoryOrRoutes(d.loadChildren).pipe(r_(J=>{this.onLoadEndListener&&this.onLoadEndListener(d);let _n,_a,_f=!1;Array.isArray(J)?_a=J:(_n=J.create(i).injector,_a=iH(_n.get(R5,[],ky.Self|ky.Optional)));return{routes:_a.map(S5),injector:_n}}),c5(()=>{this.childrenLoaders.delete(d)})),q=new QB(I,()=>new W1).pipe(u5());return this.childrenLoaders.set(d,q),q}loadModuleFactoryOrRoutes(i){return j2(i()).pipe(s1(d=>d instanceof C8||Array.isArray(d)?U0(d):Z_(this.compiler.compileModuleAsync(d))))}}return n.\u0275fac=function(i){return new(i||n)(x0(tE),x0(yF))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class tJ{}class eJ{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}}function nJ(n){throw n}function rJ(n,r,i){return r.parse("/")}const iJ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},oJ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function JH(){const n=A1(hH),r=A1(FR),i=A1(kF),d=A1(tE),v=A1(yF),I=A1(R5,{optional:!0})??[],q=A1(n3,{optional:!0})??{},J=A1(ZH),_n=A1(KH,{optional:!0}),_a=A1(tJ,{optional:!0}),_f=A1(ZX,{optional:!0}),gd=new rx(null,n,r,i,d,v,iH(I));return _a&&(gd.urlHandlingStrategy=_a),_f&&(gd.routeReuseStrategy=_f),gd.titleStrategy=_n??J,function sJ(n,r){n.errorHandler&&(r.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(r.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(r.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(r.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(r.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(r.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(r.canceledNavigationResolution=n.canceledNavigationResolution)}(q,gd),gd}let rx=(()=>{class n{constructor(i,d,v,I,q,J,_n){this.rootComponentType=i,this.urlSerializer=d,this.rootContexts=v,this.location=I,this.config=_n,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new W1,this.errorHandler=nJ,this.malformedUriErrorHandler=rJ,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>U0(void 0),this.urlHandlingStrategy=new eJ,this.routeReuseStrategy=new JX,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=q.get(N5),this.configLoader.onLoadEndListener=ay=>this.triggerEvent(new BZ(ay)),this.configLoader.onLoadStartListener=ay=>this.triggerEvent(new zZ(ay)),this.ngModule=q.get(JD),this.console=q.get(MW);const gd=q.get(ex);this.isNgZoneEnabled=gd instanceof ex&&ex.isInAngularZone(),this.resetConfig(_n),this.currentUrlTree=function cZ(){return new eS(new I_([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=AH(this.currentUrlTree,this.rootComponentType),this.transitions=new HT({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(i){const d=this.events;return i.pipe(fC(v=>0!==v.id),r_(v=>({...v,extractedUrl:this.urlHandlingStrategy.extract(v.rawUrl)})),_A(v=>{let I=!1,q=!1;return U0(v).pipe(Rx(J=>{this.currentNavigation={id:J.id,initialUrl:J.rawUrl,extractedUrl:J.extractedUrl,trigger:J.source,extras:J.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),_A(J=>{const _n=this.browserUrlTree.toString(),_a=!this.navigated||J.extractedUrl.toString()!==_n||_n!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||_a)&&this.urlHandlingStrategy.shouldProcessUrl(J.rawUrl))return QH(J.source)&&(this.browserUrlTree=J.extractedUrl),U0(J).pipe(_A(gd=>{const ay=this.transitions.getValue();return d.next(new v5(gd.id,this.serializeUrl(gd.extractedUrl),gd.source,gd.restoredState)),ay!==this.transitions.getValue()?dE:Promise.resolve(gd)}),function PX(n,r,i,d){return _A(v=>function RX(n,r,i,d,v){return new NX(n,r,i,d,v).apply()}(n,r,i,v.extractedUrl,d).pipe(r_(I=>({...v,urlAfterRedirects:I}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Rx(gd=>{this.currentNavigation={...this.currentNavigation,finalUrl:gd.urlAfterRedirects},v.urlAfterRedirects=gd.urlAfterRedirects}),function GX(n,r,i,d,v,I){return s1(q=>function jX(n,r,i,d,v,I,q="emptyOnly",J="legacy"){return new VX(n,r,i,d,v,q,J,I).recognize().pipe(_A(_n=>null===_n?function FX(n){return new i1(r=>r.error(n))}(new LX):U0(_n)))}(n,r,i,q.urlAfterRedirects,d.serialize(q.urlAfterRedirects),d,v,I).pipe(r_(J=>({...q,targetSnapshot:J}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),Rx(gd=>{if(v.targetSnapshot=gd.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!gd.extras.skipLocationChange){const yy=this.urlHandlingStrategy.merge(gd.urlAfterRedirects,gd.rawUrl);this.setBrowserUrl(yy,gd)}this.browserUrlTree=gd.urlAfterRedirects}const ay=new PZ(gd.id,this.serializeUrl(gd.extractedUrl),this.serializeUrl(gd.urlAfterRedirects),gd.targetSnapshot);d.next(ay)}));if(_a&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:ay,extractedUrl:yy,source:xy,restoredState:Ry,extras:zy}=J,Ky=new v5(ay,this.serializeUrl(yy),xy,Ry);d.next(Ky);const d0=AH(yy,this.rootComponentType).snapshot;return U0(v={...J,targetSnapshot:d0,urlAfterRedirects:yy,extras:{...zy,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=J.rawUrl,J.resolve(null),dE}),Rx(J=>{const _n=new LZ(J.id,this.serializeUrl(J.extractedUrl),this.serializeUrl(J.urlAfterRedirects),J.targetSnapshot);this.triggerEvent(_n)}),r_(J=>v={...J,guards:sX(J.targetSnapshot,J.currentSnapshot,this.rootContexts)}),function mX(n,r){return s1(i=>{const{targetSnapshot:d,currentSnapshot:v,guards:{canActivateChecks:I,canDeactivateChecks:q}}=i;return 0===q.length&&0===I.length?U0({...i,guardsResult:!0}):function vX(n,r,i,d){return Z_(n).pipe(s1(v=>function TX(n,r,i,d,v){const I=r&&r.routeConfig?r.routeConfig.canDeactivate:null;return I&&0!==I.length?U0(I.map(J=>{const _n=jR(r)??v,_a=tI(J,_n);return j2(function dX(n){return n&&BR(n.canDeactivate)}(_a)?_a.canDeactivate(n,r,i,d):_n.runInContext(()=>_a(n,r,i,d))).pipe(F2())})).pipe(eI()):U0(!0)}(v.component,v.route,i,r,d)),F2(v=>!0!==v,!0))}(q,d,v,n).pipe(s1(J=>J&&function cX(n){return"boolean"==typeof n}(J)?function _X(n,r,i,d){return Z_(r).pipe(P2(v=>a5(function wX(n,r){return null!==n&&r&&r(new HZ(n)),U0(!0)}(v.route.parent,d),function bX(n,r){return null!==n&&r&&r(new GZ(n)),U0(!0)}(v.route,d),function EX(n,r,i){const d=r[r.length-1],I=r.slice(0,r.length-1).reverse().map(q=>function aX(n){const r=n.routeConfig?n.routeConfig.canActivateChild:null;return r&&0!==r.length?{node:n,guards:r}:null}(q)).filter(q=>null!==q).map(q=>JB(()=>U0(q.guards.map(_n=>{const _a=jR(q.node)??i,_f=tI(_n,_a);return j2(function pX(n){return n&&BR(n.canActivateChild)}(_f)?_f.canActivateChild(d,n):_a.runInContext(()=>_f(d,n))).pipe(F2())})).pipe(eI())));return U0(I).pipe(eI())}(n,v.path,i),function xX(n,r,i){const d=r.routeConfig?r.routeConfig.canActivate:null;if(!d||0===d.length)return U0(!0);const v=d.map(I=>JB(()=>{const q=jR(r)??i,J=tI(I,q);return j2(function fX(n){return n&&BR(n.canActivate)}(J)?J.canActivate(r,n):q.runInContext(()=>J(r,n))).pipe(F2())}));return U0(v).pipe(eI())}(n,v.route,i))),F2(v=>!0!==v,!0))}(d,I,n,r):U0(J)),r_(J=>({...i,guardsResult:J})))})}(this.ngModule.injector,J=>this.triggerEvent(J)),Rx(J=>{if(v.guardsResult=J.guardsResult,rS(J.guardsResult))throw MH(0,J.guardsResult);const _n=new FZ(J.id,this.serializeUrl(J.extractedUrl),this.serializeUrl(J.urlAfterRedirects),J.targetSnapshot,!!J.guardsResult);this.triggerEvent(_n)}),fC(J=>!!J.guardsResult||(this.restoreHistory(J),this.cancelNavigationTransition(J,"",3),!1)),O5(J=>{if(J.guards.canActivateChecks.length)return U0(J).pipe(Rx(_n=>{const _a=new jZ(_n.id,this.serializeUrl(_n.extractedUrl),this.serializeUrl(_n.urlAfterRedirects),_n.targetSnapshot);this.triggerEvent(_a)}),_A(_n=>{let _a=!1;return U0(_n).pipe(function qX(n,r){return s1(i=>{const{targetSnapshot:d,guards:{canActivateChecks:v}}=i;if(!v.length)return U0(i);let I=0;return Z_(v).pipe(P2(q=>function WX(n,r,i,d){const v=n.routeConfig,I=n._resolve;return void 0!==v?.title&&!YH(v)&&(I[IR]=v.title),function $X(n,r,i,d){const v=function YX(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===v.length)return U0({});const I={};return Z_(v).pipe(s1(q=>function KX(n,r,i,d){const v=jR(r)??d,I=tI(n,v);return j2(I.resolve?I.resolve(r,i):v.runInContext(()=>I(r,i)))}(n[q],r,i,d).pipe(F2(),Rx(J=>{I[q]=J}))),l5(1),function sZ(n){return r_(()=>n)}(I),dC(q=>M5(q)?dE:SR(q)))}(I,n,r,d).pipe(r_(q=>(n._resolvedData=q,n.data=CH(n,i).resolve,v&&YH(v)&&(n.data[IR]=v.title),null)))}(q.route,d,n,r)),Rx(()=>I++),l5(1),s1(q=>I===v.length?U0(i):dE))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Rx({next:()=>_a=!0,complete:()=>{_a||(this.restoreHistory(_n),this.cancelNavigationTransition(_n,"",2))}}))}),Rx(_n=>{const _a=new VZ(_n.id,this.serializeUrl(_n.extractedUrl),this.serializeUrl(_n.urlAfterRedirects),_n.targetSnapshot);this.triggerEvent(_a)}))}),O5(J=>{const _n=_a=>{const _f=[];_a.routeConfig?.loadComponent&&!_a.routeConfig._loadedComponent&&_f.push(this.configLoader.loadComponent(_a.routeConfig).pipe(Rx(gd=>{_a.component=gd}),r_(()=>{})));for(const gd of _a.children)_f.push(..._n(gd));return _f};return ZB(_n(J.targetSnapshot.root)).pipe(VL(),MR(1))}),O5(()=>this.afterPreactivation()),r_(J=>{const _n=function KZ(n,r,i){const d=LR(n,r._root,i?i._root:void 0);return new TH(d,r)}(this.routeReuseStrategy,J.targetSnapshot,J.currentRouterState);return v={...J,targetRouterState:_n}}),Rx(J=>{this.currentUrlTree=J.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(J.urlAfterRedirects,J.rawUrl),this.routerState=J.targetRouterState,"deferred"===this.urlUpdateStrategy&&(J.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,J),this.browserUrlTree=J.urlAfterRedirects)}),((n,r,i)=>r_(d=>(new oX(r,d.targetRouterState,d.currentRouterState,i).activate(n),d)))(this.rootContexts,this.routeReuseStrategy,J=>this.triggerEvent(J)),Rx({next(){I=!0},complete(){I=!0}}),c5(()=>{I||q||this.cancelNavigationTransition(v,"",1),this.currentNavigation?.id===v.id&&(this.currentNavigation=null)}),dC(J=>{if(q=!0,OH(J)){kH(J)||(this.navigated=!0,this.restoreHistory(v,!0));const _n=new WL(v.id,this.serializeUrl(v.extractedUrl),J.message,J.cancellationCode);if(d.next(_n),kH(J)){const _a=this.urlHandlingStrategy.merge(J.url,this.rawUrlTree),_f={skipLocationChange:v.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||QH(v.source)};this.scheduleNavigation(_a,"imperative",null,_f,{resolve:v.resolve,reject:v.reject,promise:v.promise})}else v.resolve(!1)}else{this.restoreHistory(v,!0);const _n=new wH(v.id,this.serializeUrl(v.extractedUrl),J,v.targetSnapshot??void 0);d.next(_n);try{v.resolve(this.errorHandler(J))}catch(_a){v.reject(_a)}}return dE}))}))}resetRootComponentType(i){this.rootComponentType=i,this.routerState.root.component=this.rootComponentType}setTransition(i){this.transitions.next({...this.transitions.value,...i})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(i=>{const d="popstate"===i.type?"popstate":"hashchange";"popstate"===d&&setTimeout(()=>{const v={replaceUrl:!0},I=i.state?.navigationId?i.state:null;if(I){const J={...I};delete J.navigationId,delete J.\u0275routerPageId,0!==Object.keys(J).length&&(v.state=J)}const q=this.parseUrl(i.url);this.scheduleNavigation(q,d,I,v)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(i){this.events.next(i)}resetConfig(i){this.config=i.map(S5),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(i,d={}){const{relativeTo:v,queryParams:I,fragment:q,queryParamsHandling:J,preserveFragment:_n}=d,_a=v||this.routerState.root,_f=_n?this.currentUrlTree.fragment:q;let gd=null;switch(J){case"merge":gd={...this.currentUrlTree.queryParams,...I};break;case"preserve":gd=this.currentUrlTree.queryParams;break;default:gd=I||null}return null!==gd&&(gd=this.removeEmptyProps(gd)),MZ(_a,this.currentUrlTree,i,gd,_f??null)}navigateByUrl(i,d={skipLocationChange:!1}){const v=rS(i)?i:this.parseUrl(i),I=this.urlHandlingStrategy.merge(v,this.rawUrlTree);return this.scheduleNavigation(I,"imperative",null,d)}navigate(i,d={skipLocationChange:!1}){return function aJ(n){for(let r=0;r<n.length;r++){if(null==n[r])throw new a0(4008,false)}}(i),this.navigateByUrl(this.createUrlTree(i,d),d)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){let d;try{d=this.urlSerializer.parse(i)}catch(v){d=this.malformedUriErrorHandler(v,this.urlSerializer,i)}return d}isActive(i,d){let v;if(v=!0===d?{...iJ}:!1===d?{...oJ}:d,rS(i))return aH(this.currentUrlTree,i,v);const I=this.parseUrl(i);return aH(this.currentUrlTree,I,v)}removeEmptyProps(i){return Object.keys(i).reduce((d,v)=>{const I=i[v];return null!=I&&(d[v]=I),d},{})}processNavigations(){this.navigations.subscribe(i=>{this.navigated=!0,this.lastSuccessfulId=i.id,this.currentPageId=i.targetPageId,this.events.next(new iS(i.id,this.serializeUrl(i.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),i.resolve(!0)},i=>{this.console.warn(`Unhandled Navigation Error: ${i}`)})}scheduleNavigation(i,d,v,I,q){if(this.disposed)return Promise.resolve(!1);let J,_n,_a;q?(J=q.resolve,_n=q.reject,_a=q.promise):_a=new Promise((ay,yy)=>{J=ay,_n=yy});const _f=++this.navigationId;let gd;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(v=this.location.getState()),gd=v&&v.\u0275routerPageId?v.\u0275routerPageId:I.replaceUrl||I.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):gd=0,this.setTransition({id:_f,targetPageId:gd,source:d,restoredState:v,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:i,extras:I,resolve:J,reject:_n,promise:_a,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),_a.catch(ay=>Promise.reject(ay))}setBrowserUrl(i,d){const v=this.urlSerializer.serialize(i),I={...d.extras.state,...this.generateNgRouterState(d.id,d.targetPageId)};this.location.isCurrentPathEqualTo(v)||d.extras.replaceUrl?this.location.replaceState(v,"",I):this.location.go(v,"",I)}restoreHistory(i,d=!1){if("computed"===this.canceledNavigationResolution){const v=this.currentPageId-i.targetPageId;"popstate"!==i.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===v?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===v&&(this.resetState(i),this.browserUrlTree=i.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(v)}else"replace"===this.canceledNavigationResolution&&(d&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=i.currentRouterState,this.currentUrlTree=i.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(i,d,v){const I=new WL(i.id,this.serializeUrl(i.extractedUrl),d,v);this.triggerEvent(I),i.resolve(!1)}generateNgRouterState(i,d){return"computed"===this.canceledNavigationResolution?{navigationId:i,\u0275routerPageId:d}:{navigationId:i}}}return n.\u0275fac=function(i){qD()},n.\u0275prov=Ni({token:n,factory:function(){return JH()},providedIn:"root"}),n})();function QH(n){return"imperative"!==n}class tU{}let cJ=(()=>{class n{constructor(i,d,v,I,q){this.router=i,this.injector=v,this.preloadingStrategy=I,this.loader=q}setUpPreloading(){this.subscription=this.router.events.pipe(fC(i=>i instanceof iS),P2(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,d){const v=[];for(const I of d){I.providers&&!I._injector&&(I._injector=uL(I.providers,i,`Route: ${I.path}`));const q=I._injector??i,J=I._loadedInjector??q;I.loadChildren&&!I._loadedRoutes&&void 0===I.canLoad||I.loadComponent&&!I._loadedComponent?v.push(this.preloadConfig(q,I)):(I.children||I._loadedRoutes)&&v.push(this.processRoutes(J,I.children??I._loadedRoutes))}return Z_(v).pipe(UE())}preloadConfig(i,d){return this.preloadingStrategy.preload(d,()=>{let v;v=d.loadChildren&&void 0===d.canLoad?this.loader.loadChildren(i,d):U0(null);const I=v.pipe(s1(q=>null===q?U0(void 0):(d._loadedRoutes=q.routes,d._loadedInjector=q.injector,this.processRoutes(q.injector??i,q.routes))));return d.loadComponent&&!d._loadedComponent?Z_([I,this.loader.loadComponent(d)]).pipe(UE()):I})}}return n.\u0275fac=function(i){return new(i||n)(x0(rx),x0(yF),x0(cA),x0(tU),x0(N5))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const F5=new z0("");let eU=(()=>{class n{constructor(i,d,v={}){this.router=i,this.viewportScroller=d,this.options=v,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},v.scrollPositionRestoration=v.scrollPositionRestoration||"disabled",v.anchorScrolling=v.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(i=>{i instanceof v5?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof iS&&(this.lastId=i.id,this.scheduleScrollEvent(i,this.router.parseUrl(i.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(i=>{i instanceof xH&&(i.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(i.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,d){this.router.triggerEvent(new xH(i,"popstate"===this.lastSource?this.store[this.restoredId]:null,d))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(i){qD()},n.\u0275prov=Ni({token:n,factory:n.\u0275fac}),n})();function nI(n,r){return{\u0275kind:n,\u0275providers:r}}function j5(n){return[{provide:R5,multi:!0,useValue:n}]}function rU(){const n=A1(tE);return r=>{const i=n.get(gL);if(r!==i.components[0])return;const d=n.get(rx),v=n.get(iU);1===n.get(V5)&&d.initialNavigation(),n.get(oU,null,ky.Optional)?.setUpPreloading(),n.get(F5,null,ky.Optional)?.init(),d.resetRootComponentType(i.componentTypes[0]),v.closed||(v.next(),v.unsubscribe())}}const iU=new z0("",{factory:()=>new W1}),V5=new z0("",{providedIn:"root",factory:()=>1});const oU=new z0("");function dJ(n){return nI(0,[{provide:oU,useExisting:cJ},{provide:tU,useExisting:n}])}const sU=new z0("ROUTER_FORROOT_GUARD"),gJ=[kF,{provide:hH,useClass:f5},{provide:rx,useFactory:JH},FR,{provide:V2,useFactory:function nU(n){return n.routerState.root},deps:[rx]},N5];function yJ(){return new xz("Router",rx)}let aU=(()=>{class n{constructor(i){}static forRoot(i,d){return{ngModule:n,providers:[gJ,[],j5(i),{provide:sU,useFactory:bJ,deps:[[rx,new XE,new iA]]},{provide:n3,useValue:d||{}},d?.useHash?{provide:tS,useClass:m$}:{provide:tS,useClass:$z},{provide:F5,useFactory:()=>{const n=A1(rx),r=A1(PY),i=A1(n3);return i.scrollOffset&&r.setOffset(i.scrollOffset),new eU(n,r,i)}},d?.preloadingStrategy?dJ(d.preloadingStrategy).\u0275providers:[],{provide:xz,multi:!0,useFactory:yJ},d?.initialNavigation?wJ(d):[],[{provide:uU,useFactory:rU},{provide:gz,multi:!0,useExisting:uU}]]}}static forChild(i){return{ngModule:n,providers:[j5(i)]}}}return n.\u0275fac=function(i){return new(i||n)(x0(sU,8))},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({imports:[C5]}),n})();function bJ(n){return"guarded"}function wJ(n){return["disabled"===n.initialNavigation?nI(3,[{provide:fL,multi:!0,useFactory:()=>{const r=A1(rx);return()=>{r.setUpLocationChangeListener()}}},{provide:V5,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?nI(2,[{provide:V5,useValue:0},{provide:fL,multi:!0,deps:[tE],useFactory:r=>{const i=r.get(g$,Promise.resolve());let d=!1;return()=>i.then(()=>new Promise(I=>{const q=r.get(rx),J=r.get(iU);(function v(I){r.get(rx).events.pipe(fC(J=>J instanceof iS||J instanceof WL||J instanceof wH),r_(J=>J instanceof iS||J instanceof WL&&(0===J.code||1===J.code)&&null),fC(J=>null!==J),MR(1)).subscribe(()=>{I()})})(()=>{I(!0),d=!0}),q.afterPreactivation=()=>(I(!0),d||J.closed?U0(void 0):J),q.initialNavigation()}))}}]).\u0275providers:[]]}const uU=new z0("");let lU=(()=>{class n{constructor(i){this.router=i}ngOnInit(){}goToHome(){this.router.navigate(["/"])}}return n.\u0275fac=function(i){return new(i||n)(Xy(rx))},n.\u0275cmp=B0({type:n,selectors:[["app-header"]],decls:3,vars:0,consts:[[1,"header-container",3,"click"],["src","assets/icons/logo.svg","alt","image"],["src","assets/icons/burger-icon.svg","alt","image"]],template:function(i,d){1&i&&(Tw(0,"div",0),Ox("click",function(){return d.goToHome()}),TE(1,"img",1)(2,"img",2),Xw())},styles:[".header-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;padding:15px;background-color:#ebeae6}"]}),n})();var z2=f(587);function cU(n){return o1((r,i)=>{$1(n).subscribe(G_(i,()=>i.complete(),wy)),!i.closed&&r.subscribe(i)})}class EJ extends _e{constructor(r,i){super()}schedule(r,i=0){return this}}const s3={setInterval(n,r,...i){const{delegate:d}=s3;return d?.setInterval?d.setInterval(n,r,...i):setInterval(n,r,...i)},clearInterval(n){const{delegate:r}=s3;return(r?.clearInterval||clearInterval)(n)},delegate:void 0},hU={now:()=>(hU.delegate||Date).now(),delegate:void 0};class UR{constructor(r,i=UR.now){this.schedulerActionCtor=r,this.now=i}schedule(r,i=0,d){return new this.schedulerActionCtor(this,r).schedule(d,i)}}UR.now=hU.now;const fU=new class AJ extends UR{constructor(r,i=UR.now){super(r,i),this.actions=[],this._active=!1}flush(r){const{actions:i}=this;if(this._active)return void i.push(r);let d;this._active=!0;do{if(d=r.execute(r.state,r.delay))break}while(r=i.shift());if(this._active=!1,d){for(;r=i.shift();)r.unsubscribe();throw d}}}(class TJ extends EJ{constructor(r,i){super(r,i),this.scheduler=r,this.work=i,this.pending=!1}schedule(r,i=0){var d;if(this.closed)return this;this.state=r;const v=this.id,I=this.scheduler;return null!=v&&(this.id=this.recycleAsyncId(I,v,i)),this.pending=!0,this.delay=i,this.id=null!==(d=this.id)&&void 0!==d?d:this.requestAsyncId(I,this.id,i),this}requestAsyncId(r,i,d=0){return s3.setInterval(r.flush.bind(r,this),d)}recycleAsyncId(r,i,d=0){if(null!=d&&this.delay===d&&!1===this.pending)return i;null!=i&&s3.clearInterval(i)}execute(r,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const d=this._execute(r,i);if(d)return d;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(r,i){let v,d=!1;try{this.work(r)}catch(I){d=!0,v=I||new Error("Scheduled action threw falsy error")}if(d)return this.unsubscribe(),v}unsubscribe(){if(!this.closed){const{id:r,scheduler:i}=this,{actions:d}=i;this.work=this.state=this.scheduler=null,this.pending=!1,Y(d,this),null!=r&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,super.unsubscribe()}}}),CJ=fU;function pU(n=0,r,i=CJ){let d=-1;return null!=r&&(iD(r)?i=r:d=r),new i1(v=>{let I=function DJ(n){return n instanceof Date&&!isNaN(n)}(n)?+n-i.now():n;I<0&&(I=0);let q=0;return i.schedule(function(){v.closed||(v.next(q++),0<=d?this.schedule(void 0,d):v.complete())},I)})}const SJ=["addListener","removeListener"],MJ=["addEventListener","removeEventListener"],IJ=["on","off"];function z5(n,r,i,d){if(m(i)&&(d=i,i=void 0),d)return z5(n,r,i).pipe(s5(d));const[v,I]=function RJ(n){return m(n.addEventListener)&&m(n.removeEventListener)}(n)?MJ.map(q=>J=>n[q](r,J,i)):function kJ(n){return m(n.addListener)&&m(n.removeListener)}(n)?SJ.map(dU(n,r)):function OJ(n){return m(n.on)&&m(n.off)}(n)?IJ.map(dU(n,r)):[];if(!v&&EC(n))return s1(q=>z5(q,r,i))($1(n));if(!v)throw new TypeError("Invalid event target");return new i1(q=>{const J=(..._n)=>q.next(1<_n.length?_n:_n[0]);return v(J),()=>I(J)})}function dU(n,r){return i=>d=>n[i](r,d)}const yU="assets/icons/home-icon",mU="^[a-zA-Z ]*$";let vU=(()=>{class n{constructor(i){this._httpClient=i,this.hotels=[],this.markerSelectedSubject=new W1,this._selectedHotelIndex=0}getHotels(){return this._httpClient.get("https://lime-home-server.onrender.com/hotels").pipe(Rx(d=>{this.hotels=d.items,console.log("hotels",this.hotels)}),dC(d=>(console.log(d),this.hotels=[],U0([]))))}getSelectedHotelIndexAsObs(){return this.markerSelectedSubject.asObservable()}get selectedHotelIndex(){return this._selectedHotelIndex}set selectedHotelIndex(i){this.selectedHotelIndex!=i&&(this._selectedHotelIndex=i,this.markerSelectedSubject.next(i))}}return n.\u0275fac=function(i){return new(i||n)(x0(UB))},n.\u0275prov=Ni({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function _U(n,r,i,d,v,I,q){try{var J=n[I](q),_n=J.value}catch(_a){return void i(_a)}J.done?r(_n):Promise.resolve(_n).then(d,v)}let BJ=(()=>{class n{constructor(i){this.router=i,this.hotelInfo=null,this.price=this.getPrice()}ngOnInit(){}getKmDistance(i){return i?(i/1e3).toFixed(2):null}getPrice(){return Number((100*Math.random()+50).toFixed(0))}openBookingForm(){var i=this;return function zJ(n){return function(){var r=this,i=arguments;return new Promise(function(d,v){var I=n.apply(r,i);function q(_n){_U(I,d,v,q,J,"next",_n)}function J(_n){_U(I,d,v,q,J,"throw",_n)}q(void 0)})}}(function*(){i.router.navigate(["/booking"])})()}}return n.\u0275fac=function(i){return new(i||n)(Xy(rx))},n.\u0275cmp=B0({type:n,selectors:[["app-hotel-info-card"]],inputs:{hotelInfo:"hotelInfo",index:"index"},decls:16,vars:5,consts:[[1,"hotel-card-info"],[1,"hotel-info-container"],["alt","image","src","assets/images/hotel-thumbnail.png",1,"hotel-image"],[1,"hotel-details"],[1,"label-bold","label-city"],[1,"label-bold","label-street"],[1,"label","label-distance"],[1,"label-bold","label-price"],[1,"label","label-title"],[1,"book-button",3,"click"]],template:function(i,d){1&i&&(Tw(0,"div",0)(1,"div",1),TE(2,"img",2),Tw(3,"div",3)(4,"div",4),rT(5),Xw(),Tw(6,"div",5),rT(7),Xw(),Tw(8,"div",6),rT(9),Xw(),Tw(10,"div",7),rT(11),Xw(),Tw(12,"div",8),rT(13),Xw()()(),Tw(14,"button",9),Ox("click",function(){return d.openBookingForm()}),rT(15,"Book"),Xw()()),2&i&&(Mx(5),uR(null==d.hotelInfo||null==d.hotelInfo.address?null:d.hotelInfo.address.city),Mx(2),uR(null==d.hotelInfo||null==d.hotelInfo.address?null:d.hotelInfo.address.street),Mx(2),lR("",d.getKmDistance(null==d.hotelInfo?null:d.hotelInfo.distance)," KM FROM CITY CENTER"),Mx(2),lR("\xa3",d.price,""),Mx(2),uR(null==d.hotelInfo?null:d.hotelInfo.title))},styles:[".hotel-card-info[_ngcontent-%COMP%]{width:330px;height:100%;display:flex;flex-direction:column}.hotel-info-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:5%;height:70%;margin:5% 5% 0}.hotel-image[_ngcontent-%COMP%]{height:90%}.label-bold[_ngcontent-%COMP%]{font-weight:700;font-family:Franklin Gothic Medium,Arial Narrow,Arial,sans-serif;font-size:smaller}.label[_ngcontent-%COMP%]{font-family:Franklin Gothic Medium,Arial Narrow,Arial,sans-serif;font-size:x-small;font-family:system-ui}.label-city[_ngcontent-%COMP%]{font-size:large}.label-street[_ngcontent-%COMP%]{font-size:medium;word-break:break-all}.label-price[_ngcontent-%COMP%]{font-size:xx-large}.label-title[_ngcontent-%COMP%]{font-size:small;color:#696969;width:80%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.label-distance[_ngcontent-%COMP%]{color:#696969;margin-top:10%;margin-bottom:35%}.book-button[_ngcontent-%COMP%]{border:0;background:none;box-shadow:none;border-radius:0;width:90%;background-color:#f7941d;height:40px;margin:0 auto;display:block;height:16%;color:#fff;font-weight:700;font-size:large;font-family:Franklin Gothic Medium,Arial Narrow,Arial,sans-serif}"]}),n})();const HJ=["map"],UJ=["hotelsSlider"],GJ=function(n){return{selected:n}};function qJ(n,r){if(1&n){const i=H4();iR(0),Tw(1,"app-hotel-info-card",6),Ox("click",function(){const I=IS(i).index;return AI(GM(2).onCardClick(I))}),Xw(),oR()}if(2&n){const i=r.$implicit,d=r.index,v=GM(2);Mx(1),PT("hotelInfo",i)("index",d)("ngClass",P8(3,GJ,d==v.selectedHotelIndex))}}function WJ(n,r){if(1&n&&(iR(0),Tw(1,"div",3,4),O2(3,qJ,2,5,"ng-container",5),Xw(),oR()),2&n){const i=GM();Mx(3),PT("ngForOf",i.hotels)}}let $J=(()=>{class n{constructor(i){this.dataService=i,this.hotels=new Array,this.selectedHotelIndex=0,this.onDestroy=new W1}ngOnInit(){}ngAfterViewInit(){this.dataService.getHotels().pipe(cU(this.onDestroy)).subscribe(()=>{this.hotels=this.dataService.hotels,this.setupMap(this.hotels&&this.hotels.length>0?this.hotels[0].position.lat:0,this.hotels&&this.hotels.length>0?this.hotels[0].position.lng:0),this.hotels.forEach((v,I)=>{this.addHotelMarker(v.position.lat,v.position.lng,I)}),pU(200).subscribe(v=>{z5(this.hotelsSlider.nativeElement,"scroll").pipe(function NJ(n){return o1((r,i)=>{let d=!1,v=null,I=null;const q=()=>{if(I?.unsubscribe(),I=null,d){d=!1;const J=v;v=null,i.next(J)}};r.subscribe(G_(i,J=>{I?.unsubscribe(),d=!0,v=J,I=G_(i,q,wy),$1(n(J)).subscribe(I)},()=>{q(),i.complete()},void 0,()=>{v=I=null}))})}(()=>function PJ(n=0,r=fU){return n<0&&(n=0),pU(n,n,r)}(500))).subscribe(()=>{this.dataService.selectedHotelIndex=Math.trunc(this.hotelsSlider.nativeElement.scrollLeft/this.hotelsSlider.nativeElement.childNodes[0].clientWidth),this.refreshMarkerSelection(),this.refreshSlider(this.dataService.selectedHotelIndex)})})}),this.dataService.getSelectedHotelIndexAsObs().pipe(cU(this.onDestroy)).subscribe(i=>{this.selectedHotelIndex=i})}ngOnDestroy(){this.onDestroy.next(),this.onDestroy.complete()}setupMap(i,d){const I=new z2.Z.service.Platform({apikey:"JGUDtwriwkbFxfRNwWSTFaWMgA_2FPYBgymUz-tVjSk"}).createDefaultLayers();this.map=new z2.Z.Map(this.mapDiv.nativeElement,I.vector.normal.map,{pixelRatio:window.devicePixelRatio,center:{lat:i,lng:d},zoom:15}),new z2.Z.mapevents.Behavior(new z2.Z.mapevents.MapEvents(this.map)),z2.Z.ui.UI.createDefault(this.map,I),window.addEventListener("resize",()=>this.map.getViewPort().resize())}addHotelMarker(i,d,v){const I=new z2.Z.map.Icon(yU+(0===v?"-active":"")+".svg"),q=new z2.Z.map.Marker({lat:i,lng:d},{data:v,icon:I});q.addEventListener("tap",()=>{this.dataService.selectedHotelIndex=q.getData(),this.refreshMarkerSelection(),this.refreshSlider(v)}),this.map.addObject(q)}refreshMarkerSelection(){this.map.getObjects().forEach(i=>{const d=i,v=new z2.Z.map.Icon(yU+(this.selectedHotelIndex==d.getData()?"-active":"")+".svg");d.setIcon(v),this.map.setCenter({lat:this.hotels[this.selectedHotelIndex].position.lat,lng:this.hotels[this.selectedHotelIndex].position.lng})})}refreshSlider(i){this.hotelsSlider.nativeElement.scrollTo({left:this.hotelsSlider.nativeElement.childNodes[2*i].offsetLeft,behavior:"smooth",inline:"center",block:"center"})}onCardClick(i){this.dataService.selectedHotelIndex=i,this.refreshMarkerSelection(),this.refreshSlider(i)}}return n.\u0275fac=function(i){return new(i||n)(Xy(vU))},n.\u0275cmp=B0({type:n,selectors:[["app-here-map"]],viewQuery:function(i,d){if(1&i&&(uF(HJ,5),uF(UJ,5)),2&i){let v;mR(v=vR())&&(d.mapDiv=v.first),mR(v=vR())&&(d.hotelsSlider=v.first)}},decls:3,vars:1,consts:[["id","map"],["map",""],[4,"ngIf"],["id","hotelsSlider"],["hotelsSlider",""],[4,"ngFor","ngForOf"],[1,"hotel-info-card",3,"hotelInfo","index","ngClass","click"]],template:function(i,d){1&i&&(TE(0,"div",0,1),O2(2,WJ,4,1,"ng-container",2)),2&i&&(Mx(2),PT("ngIf",null!=d.hotels&&d.hotels.length>0))},dependencies:[BJ,iB,aB,BF],styles:["#map[_ngcontent-%COMP%]{width:100%;height:calc(100% - 52px);position:absolute;left:0}#hotelsSlider[_ngcontent-%COMP%]{position:absolute;z-index:1;margin:auto;left:0;right:0;bottom:0;height:45%;width:96%;display:flex;flex-direction:row;flex-wrap:nowrap;gap:10px;overflow-x:auto}#hotelsSlider[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{flex:0 0 auto}.hotel-info-card[_ngcontent-%COMP%]{background-color:#fff}.selected[_ngcontent-%COMP%]{background-color:#fffca8}"]}),n})(),YJ=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=B0({type:n,selectors:[["app-home-page"]],decls:2,vars:0,template:function(i,d){1&i&&TE(0,"app-header")(1,"app-here-map")},dependencies:[lU,$J]}),n})(),bU=(()=>{class n{constructor(i,d){this._renderer=i,this._elementRef=d,this.onChange=v=>{},this.onTouched=()=>{}}setProperty(i,d){this._renderer.setProperty(this._elementRef.nativeElement,i,d)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}}return n.\u0275fac=function(i){return new(i||n)(Xy(CT),Xy(Qx))},n.\u0275dir=H0({type:n}),n})(),oS=(()=>{class n extends bU{}return n.\u0275fac=function(){let r;return function(d){return(r||(r=function $w(n){return qy(()=>{const r=n.prototype.constructor,i=r[V0]||US(r),d=Object.prototype;let v=Object.getPrototypeOf(n.prototype).constructor;for(;v&&v!==d;){const I=v[V0]||US(v);if(I&&I!==i)return I;v=Object.getPrototypeOf(v)}return I=>new I})}(n)))(d||n)}}(),n.\u0275dir=H0({type:n,features:[py]}),n})();const wA=new z0("NgValueAccessor"),XJ={provide:wA,useExisting:H_(()=>a3),multi:!0},QJ=new z0("CompositionEventMode");let a3=(()=>{class n extends bU{constructor(i,d,v){super(i,d),this._compositionMode=v,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function JJ(){const n=vA()?vA().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(i){this.setProperty("value",i??"")}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}}return n.\u0275fac=function(i){return new(i||n)(Xy(CT),Xy(Qx),Xy(QJ,8))},n.\u0275dir=H0({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,d){1&i&&Ox("input",function(I){return d._handleInput(I.target.value)})("blur",function(){return d.onTouched()})("compositionstart",function(){return d._compositionStart()})("compositionend",function(I){return d._compositionEnd(I.target.value)})},features:[x1([XJ]),py]}),n})();function B2(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function xU(n){return null!=n&&"number"==typeof n.length}const Wx=new z0("NgValidators"),H2=new z0("NgAsyncValidators"),eQ=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class sS{static min(r){return function EU(n){return r=>{if(B2(r.value)||B2(n))return null;const i=parseFloat(r.value);return!isNaN(i)&&i<n?{min:{min:n,actual:r.value}}:null}}(r)}static max(r){return function TU(n){return r=>{if(B2(r.value)||B2(n))return null;const i=parseFloat(r.value);return!isNaN(i)&&i>n?{max:{max:n,actual:r.value}}:null}}(r)}static required(r){return function AU(n){return B2(n.value)?{required:!0}:null}(r)}static requiredTrue(r){return function CU(n){return!0===n.value?null:{required:!0}}(r)}static email(r){return function DU(n){return B2(n.value)||eQ.test(n.value)?null:{email:!0}}(r)}static minLength(r){return function SU(n){return r=>B2(r.value)||!xU(r.value)?null:r.value.length<n?{minlength:{requiredLength:n,actualLength:r.value.length}}:null}(r)}static maxLength(r){return function MU(n){return r=>xU(r.value)&&r.value.length>n?{maxlength:{requiredLength:n,actualLength:r.value.length}}:null}(r)}static pattern(r){return function IU(n){if(!n)return u3;let r,i;return"string"==typeof n?(i="","^"!==n.charAt(0)&&(i+="^"),i+=n,"$"!==n.charAt(n.length-1)&&(i+="$"),r=new RegExp(i)):(i=n.toString(),r=n),d=>{if(B2(d.value))return null;const v=d.value;return r.test(v)?null:{pattern:{requiredPattern:i,actualValue:v}}}}(r)}static nullValidator(r){return null}static compose(r){return LU(r)}static composeAsync(r){return FU(r)}}function u3(n){return null}function kU(n){return null!=n}function OU(n){return sR(n)?Z_(n):n}function RU(n){let r={};return n.forEach(i=>{r=null!=i?{...r,...i}:r}),0===Object.keys(r).length?null:r}function NU(n,r){return r.map(i=>i(n))}function PU(n){return n.map(r=>function nQ(n){return!n.validate}(r)?r:i=>r.validate(i))}function LU(n){if(!n)return null;const r=n.filter(kU);return 0==r.length?null:function(i){return RU(NU(i,r))}}function B5(n){return null!=n?LU(PU(n)):null}function FU(n){if(!n)return null;const r=n.filter(kU);return 0==r.length?null:function(i){return function KJ(...n){const r=SC(n),{args:i,keys:d}=YB(n),v=new i1(I=>{const{length:q}=i;if(!q)return void I.complete();const J=new Array(q);let _n=q,_a=q;for(let _f=0;_f<q;_f++){let gd=!1;$1(i[_f]).subscribe(G_(I,ay=>{gd||(gd=!0,_a--),J[_f]=ay},()=>_n--,void 0,()=>{(!_n||!gd)&&(_a||I.next(d?KB(d,J):J),I.complete())}))}});return r?v.pipe(s5(r)):v}(NU(i,r).map(OU)).pipe(r_(RU))}}function H5(n){return null!=n?FU(PU(n)):null}function jU(n,r){return null===n?[r]:Array.isArray(n)?[...n,r]:[n,r]}function VU(n){return n._rawValidators}function zU(n){return n._rawAsyncValidators}function U5(n){return n?Array.isArray(n)?n:[n]:[]}function l3(n,r){return Array.isArray(n)?n.includes(r):n===r}function BU(n,r){const i=U5(r);return U5(n).forEach(v=>{l3(i,v)||i.push(v)}),i}function HU(n,r){return U5(r).filter(i=>!l3(n,i))}class UU{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(r){this._rawValidators=r||[],this._composedValidatorFn=B5(this._rawValidators)}_setAsyncValidators(r){this._rawAsyncValidators=r||[],this._composedAsyncValidatorFn=H5(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(r){this._onDestroyCallbacks.push(r)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(r=>r()),this._onDestroyCallbacks=[]}reset(r){this.control&&this.control.reset(r)}hasError(r,i){return!!this.control&&this.control.hasError(r,i)}getError(r,i){return this.control?this.control.getError(r,i):null}}class hE extends UU{get formDirective(){return null}get path(){return null}}class U2 extends UU{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class GU{constructor(r){this._cd=r}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let qU=(()=>{class n extends GU{constructor(i){super(i)}}return n.\u0275fac=function(i){return new(i||n)(Xy(U2,2))},n.\u0275dir=H0({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,d){2&i&&nL("ng-untouched",d.isUntouched)("ng-touched",d.isTouched)("ng-pristine",d.isPristine)("ng-dirty",d.isDirty)("ng-valid",d.isValid)("ng-invalid",d.isInvalid)("ng-pending",d.isPending)},features:[py]}),n})(),WU=(()=>{class n extends GU{constructor(i){super(i)}}return n.\u0275fac=function(i){return new(i||n)(Xy(hE,10))},n.\u0275dir=H0({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,d){2&i&&nL("ng-untouched",d.isUntouched)("ng-touched",d.isTouched)("ng-pristine",d.isPristine)("ng-dirty",d.isDirty)("ng-valid",d.isValid)("ng-invalid",d.isInvalid)("ng-pending",d.isPending)("ng-submitted",d.isSubmitted)},features:[py]}),n})();const GR="VALID",h3="INVALID",rI="PENDING",qR="DISABLED";function $5(n){return(f3(n)?n.validators:n)||null}function YU(n){return Array.isArray(n)?B5(n):n||null}function Y5(n,r){return(f3(r)?r.asyncValidators:n)||null}function KU(n){return Array.isArray(n)?H5(n):n||null}function f3(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class JU{constructor(r,i){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=r,this._rawAsyncValidators=i,this._composedValidatorFn=YU(this._rawValidators),this._composedAsyncValidatorFn=KU(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(r){this._rawValidators=this._composedValidatorFn=r}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(r){this._rawAsyncValidators=this._composedAsyncValidatorFn=r}get parent(){return this._parent}get valid(){return this.status===GR}get invalid(){return this.status===h3}get pending(){return this.status==rI}get disabled(){return this.status===qR}get enabled(){return this.status!==qR}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(r){this._rawValidators=r,this._composedValidatorFn=YU(r)}setAsyncValidators(r){this._rawAsyncValidators=r,this._composedAsyncValidatorFn=KU(r)}addValidators(r){this.setValidators(BU(r,this._rawValidators))}addAsyncValidators(r){this.setAsyncValidators(BU(r,this._rawAsyncValidators))}removeValidators(r){this.setValidators(HU(r,this._rawValidators))}removeAsyncValidators(r){this.setAsyncValidators(HU(r,this._rawAsyncValidators))}hasValidator(r){return l3(this._rawValidators,r)}hasAsyncValidator(r){return l3(this._rawAsyncValidators,r)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(r={}){this.touched=!0,this._parent&&!r.onlySelf&&this._parent.markAsTouched(r)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(r=>r.markAllAsTouched())}markAsUntouched(r={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0})}),this._parent&&!r.onlySelf&&this._parent._updateTouched(r)}markAsDirty(r={}){this.pristine=!1,this._parent&&!r.onlySelf&&this._parent.markAsDirty(r)}markAsPristine(r={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(i=>{i.markAsPristine({onlySelf:!0})}),this._parent&&!r.onlySelf&&this._parent._updatePristine(r)}markAsPending(r={}){this.status=rI,!1!==r.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!r.onlySelf&&this._parent.markAsPending(r)}disable(r={}){const i=this._parentMarkedDirty(r.onlySelf);this.status=qR,this.errors=null,this._forEachChild(d=>{d.disable({...r,onlySelf:!0})}),this._updateValue(),!1!==r.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...r,skipPristineCheck:i}),this._onDisabledChange.forEach(d=>d(!0))}enable(r={}){const i=this._parentMarkedDirty(r.onlySelf);this.status=GR,this._forEachChild(d=>{d.enable({...r,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:r.emitEvent}),this._updateAncestors({...r,skipPristineCheck:i}),this._onDisabledChange.forEach(d=>d(!1))}_updateAncestors(r){this._parent&&!r.onlySelf&&(this._parent.updateValueAndValidity(r),r.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(r){this._parent=r}getRawValue(){return this.value}updateValueAndValidity(r={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===GR||this.status===rI)&&this._runAsyncValidator(r.emitEvent)),!1!==r.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!r.onlySelf&&this._parent.updateValueAndValidity(r)}_updateTreeValidity(r={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(r)),this.updateValueAndValidity({onlySelf:!0,emitEvent:r.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?qR:GR}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(r){if(this.asyncValidator){this.status=rI,this._hasOwnPendingAsyncValidator=!0;const i=OU(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(d=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(d,{emitEvent:r})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(r,i={}){this.errors=r,this._updateControlsErrors(!1!==i.emitEvent)}get(r){let i=r;return null==i||(Array.isArray(i)||(i=i.split(".")),0===i.length)?null:i.reduce((d,v)=>d&&d._find(v),this)}getError(r,i){const d=i?this.get(i):this;return d&&d.errors?d.errors[r]:null}hasError(r,i){return!!this.getError(r,i)}get root(){let r=this;for(;r._parent;)r=r._parent;return r}_updateControlsErrors(r){this.status=this._calculateStatus(),r&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(r)}_initObservables(){this.valueChanges=new V1,this.statusChanges=new V1}_calculateStatus(){return this._allControlsDisabled()?qR:this.errors?h3:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(rI)?rI:this._anyControlsHaveStatus(h3)?h3:GR}_anyControlsHaveStatus(r){return this._anyControls(i=>i.status===r)}_anyControlsDirty(){return this._anyControls(r=>r.dirty)}_anyControlsTouched(){return this._anyControls(r=>r.touched)}_updatePristine(r={}){this.pristine=!this._anyControlsDirty(),this._parent&&!r.onlySelf&&this._parent._updatePristine(r)}_updateTouched(r={}){this.touched=this._anyControlsTouched(),this._parent&&!r.onlySelf&&this._parent._updateTouched(r)}_registerOnCollectionChange(r){this._onCollectionChange=r}_setUpdateStrategy(r){f3(r)&&null!=r.updateOn&&(this._updateOn=r.updateOn)}_parentMarkedDirty(r){return!r&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(r){return null}}class p3 extends JU{constructor(r,i,d){super($5(i),Y5(d,i)),this.controls=r,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(r,i){return this.controls[r]?this.controls[r]:(this.controls[r]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(r,i,d={}){this.registerControl(r,i),this.updateValueAndValidity({emitEvent:d.emitEvent}),this._onCollectionChange()}removeControl(r,i={}){this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),delete this.controls[r],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(r,i,d={}){this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),delete this.controls[r],i&&this.registerControl(r,i),this.updateValueAndValidity({emitEvent:d.emitEvent}),this._onCollectionChange()}contains(r){return this.controls.hasOwnProperty(r)&&this.controls[r].enabled}setValue(r,i={}){(function XU(n,r,i){n._forEachChild((d,v)=>{if(void 0===i[v])throw new a0(1002,"")})})(this,0,r),Object.keys(r).forEach(d=>{(function ZU(n,r,i){const d=n.controls;if(!(r?Object.keys(d):d).length)throw new a0(1e3,"");if(!d[i])throw new a0(1001,"")})(this,!0,d),this.controls[d].setValue(r[d],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(r,i={}){null!=r&&(Object.keys(r).forEach(d=>{const v=this.controls[d];v&&v.patchValue(r[d],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(r={},i={}){this._forEachChild((d,v)=>{d.reset(r[v],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(r,i,d)=>(r[d]=i.getRawValue(),r))}_syncPendingControls(){let r=this._reduceChildren(!1,(i,d)=>!!d._syncPendingControls()||i);return r&&this.updateValueAndValidity({onlySelf:!0}),r}_forEachChild(r){Object.keys(this.controls).forEach(i=>{const d=this.controls[i];d&&r(d,i)})}_setUpControls(){this._forEachChild(r=>{r.setParent(this),r._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(r){for(const[i,d]of Object.entries(this.controls))if(this.contains(i)&&r(d))return!0;return!1}_reduceValue(){return this._reduceChildren({},(i,d,v)=>((d.enabled||this.disabled)&&(i[v]=d.value),i))}_reduceChildren(r,i){let d=r;return this._forEachChild((v,I)=>{d=i(d,v,I)}),d}_allControlsDisabled(){for(const r of Object.keys(this.controls))if(this.controls[r].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(r){return this.controls.hasOwnProperty(r)?this.controls[r]:null}}function WR(n,r){K5(n,r),r.valueAccessor.writeValue(n.value),n.disabled&&r.valueAccessor.setDisabledState?.(!0),function hQ(n,r){r.valueAccessor.registerOnChange(i=>{n._pendingValue=i,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&QU(n,r)})}(n,r),function pQ(n,r){const i=(d,v)=>{r.valueAccessor.writeValue(d),v&&r.viewToModelUpdate(d)};n.registerOnChange(i),r._registerOnDestroy(()=>{n._unregisterOnChange(i)})}(n,r),function fQ(n,r){r.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&QU(n,r),"submit"!==n.updateOn&&n.markAsTouched()})}(n,r),function cQ(n,r){if(r.valueAccessor.setDisabledState){const i=d=>{r.valueAccessor.setDisabledState(d)};n.registerOnDisabledChange(i),r._registerOnDestroy(()=>{n._unregisterOnDisabledChange(i)})}}(n,r)}function g3(n,r,i=!0){const d=()=>{};r.valueAccessor&&(r.valueAccessor.registerOnChange(d),r.valueAccessor.registerOnTouched(d)),m3(n,r),n&&(r._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function y3(n,r){n.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(r)})}function K5(n,r){const i=VU(n);null!==r.validator?n.setValidators(jU(i,r.validator)):"function"==typeof i&&n.setValidators([i]);const d=zU(n);null!==r.asyncValidator?n.setAsyncValidators(jU(d,r.asyncValidator)):"function"==typeof d&&n.setAsyncValidators([d]);const v=()=>n.updateValueAndValidity();y3(r._rawValidators,v),y3(r._rawAsyncValidators,v)}function m3(n,r){let i=!1;if(null!==n){if(null!==r.validator){const v=VU(n);if(Array.isArray(v)&&v.length>0){const I=v.filter(q=>q!==r.validator);I.length!==v.length&&(i=!0,n.setValidators(I))}}if(null!==r.asyncValidator){const v=zU(n);if(Array.isArray(v)&&v.length>0){const I=v.filter(q=>q!==r.asyncValidator);I.length!==v.length&&(i=!0,n.setAsyncValidators(I))}}}const d=()=>{};return y3(r._rawValidators,d),y3(r._rawAsyncValidators,d),i}function QU(n,r){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),r.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function rG(n,r){const i=n.indexOf(r);i>-1&&n.splice(i,1)}function iG(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const iI=class extends JU{constructor(r=null,i,d){super($5(i),Y5(d,i)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(r),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),f3(i)&&(i.nonNullable||i.initialValueIsDefault)&&(this.defaultValue=iG(r)?r.value:r)}setValue(r,i={}){this.value=this._pendingValue=r,this._onChange.length&&!1!==i.emitModelToViewChange&&this._onChange.forEach(d=>d(this.value,!1!==i.emitViewToModelChange)),this.updateValueAndValidity(i)}patchValue(r,i={}){this.setValue(r,i)}reset(r=this.defaultValue,i={}){this._applyFormState(r),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(r){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(r){this._onChange.push(r)}_unregisterOnChange(r){rG(this._onChange,r)}registerOnDisabledChange(r){this._onDisabledChange.push(r)}_unregisterOnDisabledChange(r){rG(this._onDisabledChange,r)}_forEachChild(r){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(r){iG(r)?(this.value=this._pendingValue=r.value,r.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=r}};let lG=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275dir=H0({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),hG=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({}),n})();const Q5=new z0("NgModelWithFormControlWarning"),DQ={provide:hE,useExisting:H_(()=>v3)};let v3=(()=>{class n extends hE{constructor(i,d){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new V1,this._setValidators(i),this._setAsyncValidators(d)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(m3(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){const d=this.form.get(i.path);return WR(d,i),d.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),d}getControl(i){return this.form.get(i.path)}removeControl(i){g3(i.control||null,i,!1),function mQ(n,r){const i=n.indexOf(r);i>-1&&n.splice(i,1)}(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,d){this.form.get(i.path).setValue(d)}onSubmit(i){return this.submitted=!0,function nG(n,r){n._syncPendingControls(),r.forEach(i=>{const d=i.control;"submit"===d.updateOn&&d._pendingChange&&(i.viewToModelUpdate(d._pendingValue),d._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(i),"dialog"===i?.target?.method}onReset(){this.resetForm()}resetForm(i){this.form.reset(i),this.submitted=!1}_updateDomValue(){this.directives.forEach(i=>{const d=i.control,v=this.form.get(i.path);d!==v&&(g3(d||null,i),(n=>n instanceof iI)(v)&&(WR(v,i),i.control=v))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){const d=this.form.get(i.path);(function tG(n,r){K5(n,r)})(d,i),d.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){const d=this.form.get(i.path);d&&function dQ(n,r){return m3(n,r)}(d,i)&&d.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){K5(this.form,this),this._oldForm&&m3(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(i){return new(i||n)(Xy(Wx,10),Xy(H2,10))},n.\u0275dir=H0({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,d){1&i&&Ox("submit",function(I){return d.onSubmit(I)})("reset",function(){return d.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[x1([DQ]),py,My]}),n})();const IQ={provide:U2,useExisting:H_(()=>nV)};let nV=(()=>{class n extends U2{constructor(i,d,v,I,q){super(),this._ngModelWarningConfig=q,this._added=!1,this.update=new V1,this._ngModelWarningSent=!1,this._parent=i,this._setValidators(d),this._setAsyncValidators(v),this.valueAccessor=function X5(n,r){if(!r)return null;let i,d,v;return Array.isArray(r),r.forEach(I=>{I.constructor===a3?i=I:function yQ(n){return Object.getPrototypeOf(n.constructor)===oS}(I)?d=I:v=I}),v||d||i||null}(0,I)}set isDisabled(i){}ngOnChanges(i){this._added||this._setUpControl(),function Z5(n,r){if(!n.hasOwnProperty("model"))return!1;const i=n.model;return!!i.isFirstChange()||!Object.is(r,i.currentValue)}(i,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}get path(){return function d3(n,r){return[...r.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(i){return new(i||n)(Xy(hE,13),Xy(Wx,10),Xy(H2,10),Xy(wA,10),Xy(Q5,8))},n.\u0275dir=H0({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[x1([IQ]),py,My]}),n})(),DG=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({imports:[hG]}),n})(),SG=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({imports:[DG]}),n})(),MG=(()=>{class n{static withConfig(i){return{ngModule:n,providers:[{provide:Q5,useValue:i.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({imports:[DG]}),n})();function WQ(n,r){1&n&&(Tw(0,"p",10),rT(1," Please, enter your first name "),Xw())}function $Q(n,r){1&n&&(Tw(0,"p",10),rT(1," Please, enter your last name"),Xw())}function YQ(n,r){1&n&&(Tw(0,"p",10),rT(1," Please, enter a valid email"),Xw())}function KQ(n,r){1&n&&(Tw(0,"p",10),rT(1," Please, enter a 6 digit password "),Xw())}function ZQ(n,r){if(1&n){const i=H4();Tw(0,"div",1)(1,"form",2),Ox("submit",function(){return IS(i),AI(GM().submitForm())}),Tw(2,"div",3)(3,"h1"),rT(4,"Booking Form"),Xw(),TE(5,"input",4),O2(6,WQ,2,0,"p",5),TE(7,"input",6),O2(8,$Q,2,0,"p",5),TE(9,"input",7),O2(10,YQ,2,0,"p",5),TE(11,"input",8),O2(12,KQ,2,0,"p",5),Xw(),Tw(13,"div"),TE(14,"input",9),Xw()()()}if(2&n){const i=GM();Mx(1),PT("formGroup",i.bookingForm),Mx(5),PT("ngIf",i.bookingForm.controls.firstname.invalid&&(i.bookingForm.controls.firstname.dirty||i.bookingForm.controls.firstname.touched)),Mx(2),PT("ngIf",i.bookingForm.controls.lastname.invalid&&(i.bookingForm.controls.lastname.dirty||i.bookingForm.controls.lastname.touched)),Mx(2),PT("ngIf",i.bookingForm.controls.email.invalid&&(i.bookingForm.controls.email.dirty||i.bookingForm.controls.email.touched)),Mx(2),PT("ngIf",i.bookingForm.controls.psw.invalid&&(i.bookingForm.controls.psw.dirty||i.bookingForm.controls.psw.touched))}}let XQ=(()=>{class n{constructor(i,d){this.dataService=i,this.activatedRoute=d,this.destroy$=new W1}ngOnInit(){this.activatedRoute.queryParams.subscribe(i=>{console.log(i),this.hotel=this.dataService.hotels[i.index],console.log(this.hotel)}),this.initbookingForm()}initbookingForm(){this.bookingForm=new p3({firstname:new iI("",{validators:[sS.required,sS.pattern(mU)]}),lastname:new iI("",{validators:[sS.required,sS.pattern(mU)]}),email:new iI("",{validators:[sS.required,sS.email]}),psw:new iI("",{validators:[sS.required]})}),console.log(this.bookingForm)}submitForm(){"VALID"===this.bookingForm.status&&alert("Your booking has been successfully completed!")}}return n.\u0275fac=function(i){return new(i||n)(Xy(vU),Xy(V2))},n.\u0275cmp=B0({type:n,selectors:[["app-booking-form"]],decls:1,vars:1,consts:[["id","wrap","ng-app","",4,"ngIf"],["id","wrap","ng-app",""],[3,"formGroup","submit"],[1,"form_wrap"],["type","text","formControlName","firstname","placeholder","First Name","ng-minlength","2"],["class","error",4,"ngIf"],["type","text","formControlName","lastname","placeholder","Last Name","ng-required","true"],["type","email","placeholder","Email","formControlName","email"],["type","password","placeholder","Password","formControlName","psw","ng-required","true","ng-minlength","6"],["type","submit","value","Submit"],[1,"error"]],template:function(i,d){1&i&&O2(0,ZQ,15,5,"div",0),2&i&&PT("ngIf",d.bookingForm)},dependencies:[lG,a3,qU,WU,v3,nV,BF],styles:['@import"https://fonts.googleapis.com/css?family=Muli";*[_ngcontent-%COMP%]{margin:0;font-family:Muli,sans-serif}body[_ngcontent-%COMP%]{background-color:#222}h1[_ngcontent-%COMP%]{margin-bottom:30px;font-size:1.6em;color:#b52e31}input[type=submit][_ngcontent-%COMP%]{color:#222}#wrap[_ngcontent-%COMP%]{background:#F6F6F6;margin:0 auto;height:1000px;text-align:center}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:15px;margin-bottom:10px;border-radius:7px;border:none;width:80%}form[_ngcontent-%COMP%]{margin:0 auto}.error[_ngcontent-%COMP%]{height:30px;color:#b52e31}input.ng-valid.ng-touched[_ngcontent-%COMP%]{border:2px solid green}input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:2px solid #B52E31}']}),n})();const JQ=[{path:"",component:YJ},{path:"booking",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=B0({type:n,selectors:[["app-booking-page"]],decls:2,vars:0,template:function(i,d){1&i&&TE(0,"app-header")(1,"app-booking-form")},dependencies:[lU,XQ]}),n})()}];let QQ=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({imports:[aU.forRoot(JQ),aU]}),n})(),ttt=(()=>{class n{constructor(){this.title="lime-home"}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=B0({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(i,d){1&i&&TE(0,"router-outlet")},dependencies:[A5]}),n})(),ett=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({}),n})(),IG=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({imports:[MG,WF,SG]}),n})(),ntt=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({imports:[IG,WF]}),n})(),rtt=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n}),n.\u0275inj=ba({imports:[ett,ntt,IG]}),n})(),itt=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=u1({type:n,bootstrap:[ttt]}),n.\u0275inj=ba({imports:[EK,QQ,WK,SG,MG,rtt]}),n})();(function YW(){Oz=!1})(),xK().bootstrapModule(itt).catch(n=>console.error(n))}},e=>{e(e.s=286)}]);